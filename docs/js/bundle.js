!function(t){function e(i){if(r[i])return r[i].exports;var n=r[i]={exports:{},id:i,loaded:!1};return t[i].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){(function(t){!function(t){"use strict";function e(t,e){function r(){}r.prototype=t;var i=new r;for(var n in e)i[n]=e[n];return e.toString!==Object.prototype.toString&&(i.toString=e.toString),i}function i(t){return t instanceof Array?function(){return o.iter(t)}:"function"==typeof t.iterator?n(t,t.iterator):t.iterator}function n(t,e){if(null==e)return null;null==e.__id__&&(e.__id__=sa++);var r;return null==t.hx__closures__?t.hx__closures__={}:r=t.hx__closures__[e.__id__],null==r&&(r=function(){return r.method.apply(r.scope,arguments)},r.scope=t,r.method=e,t.hx__closures__[e.__id__]=r),r}var a={},s=function(){return En.__string_rec(this,"")},o=function(){};a.HxOverrides=o,o.__name__=["HxOverrides"],o.strDate=function(t){var e=t.length;switch(e){case 8:var r=t.split(":"),i=new Date;return i.setTime(0),i.setUTCHours(r[0]),i.setUTCMinutes(r[1]),i.setUTCSeconds(r[2]),i;case 10:var n=t.split("-");return new Date(n[0],n[1]-1,n[2],0,0,0);case 19:var a=t.split(" "),s=a[0].split("-"),o=a[1].split(":");return new Date(s[0],s[1]-1,s[2],o[0],o[1],o[2]);default:throw new Zn("Invalid date format : "+t)}},o.cca=function(t,e){var r=t.charCodeAt(e);if(r==r)return r},o.substr=function(t,e,r){if(null==r)r=t.length;else if(r<0){if(0!=e)return"";r=t.length+r}return t.substr(e,r)},o.remove=function(t,e){var r=t.indexOf(e);return r!=-1&&(t.splice(r,1),!0)},o.iter=function(t){return{cur:0,arr:t,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var h=function(){};a.Lambda=h,h.__name__=["Lambda"],h.array=function(t){for(var e=[],r=i(t)();r.hasNext();){var n=r.next();e.push(n)}return e},h.indexOf=function(t,e){for(var r=0,n=i(t)();n.hasNext();){var a=n.next();if(e==a)return r;++r}return-1};var l=function(){this.length=0};a.List=l,l.__name__=["List"],l.prototype={add:function(t){var e=new u(t,null);null==this.h?this.h=e:this.q.next=e,this.q=e,this.length++},push:function(t){var e=new u(t,this.h);this.h=e,null==this.q&&(this.q=e),this.length++},remove:function(t){for(var e=null,r=this.h;null!=r;){if(r.item==t)return null==e?this.h=r.next:e.next=r.next,this.q==r&&(this.q=e),this.length--,!0;e=r,r=r.next}return!1},iterator:function(){return new R(this.h)},__class__:l};var u=function(t,e){this.item=t,this.next=e};a["_List.ListNode"]=u,u.__name__=["_List","ListNode"],u.prototype={__class__:u};var R=function(t){this.head=t};a["_List.ListIterator"]=R,R.__name__=["_List","ListIterator"],R.prototype={hasNext:function(){return null!=this.head},next:function(){var t=this.head.item;return this.head=this.head.next,t},__class__:R};var c=function(){this.boot=new Pi,_t.IS_TOUCH_BASED=Object.prototype.hasOwnProperty.call(window,"ontouchstart"),Vue.use(_,{name:"touch"});var t=new q,e=new Pt;this.boot.startStore(e);wt.BGTRAIN=t,O.signalInited.addOnce(n(this,this.onInited)),new z(t)};a.Main=c,c.__name__=["Main"],c.main=function(){new c},c.prototype={onInited:function(){this.boot.startVueWithRootComponent("#app",new vt),Pi.notifyStarted()},__class__:c};var _=r(16);Math.__name__=["Math"];var f=function(){};a.Reflect=f,f.__name__=["Reflect"],f.field=function(t,e){try{return t[e]}catch(t){return null}},f.fields=function(t){var e=[];if(null!=t){var r=Object.prototype.hasOwnProperty;for(var i in t)"__id__"!=i&&"hx__closures__"!=i&&r.call(t,i)&&e.push(i)}return e},f.isFunction=function(t){return"function"==typeof t&&!(t.__name__||t.__ename__)},f.compare=function(t,e){return t==e?0:t>e?1:-1},f.compareMethods=function(t,e){return t==e||!(!f.isFunction(t)||!f.isFunction(e))&&(t.scope==e.scope&&t.method==e.method&&null!=t.method)},f.isEnumValue=function(t){return null!=t&&null!=t.__enum__};var g=function(){};a.Std=g,g.__name__=["Std"],g.string=function(t){return En.__string_rec(t,"")},g.parseInt=function(t){var e=parseInt(t,10);return 0!=e||120!=o.cca(t,1)&&88!=o.cca(t,1)||(e=parseInt(t)),isNaN(e)?null:e},g.random=function(t){return t<=0?0:Math.floor(Math.random()*t)};var p=function(){this.b=""};a.StringBuf=p,p.__name__=["StringBuf"],p.prototype={__class__:p};var d=function(){};a.StringTools=d,d.__name__=["StringTools"],d.isSpace=function(t,e){var r=o.cca(t,e);return r>8&&r<14||32==r},d.ltrim=function(t){for(var e=t.length,r=0;r<e&&d.isSpace(t,r);)++r;return r>0?o.substr(t,r,e-r):t},d.rtrim=function(t){for(var e=t.length,r=0;r<e&&d.isSpace(t,e-r-1);)++r;return r>0?o.substr(t,0,e-r):t},d.trim=function(t){return d.ltrim(d.rtrim(t))};var v=function(){};a.Type=v,v.__name__=["Type"],v.getSuperClass=function(t){return t.__super__},v.getClassName=function(t){var e=t.__name__;return null==e?null:e.join(".")},v.resolveClass=function(t){var e=a[t];return null!=e&&e.__name__?e:null},v.resolveEnum=function(t){var e=a[t];return null!=e&&e.__ename__?e:null},v.createEmptyInstance=function(t){function e(){}return e.prototype=t.prototype,new e},v.createEnum=function(t,e,r){var i=f.field(t,e);if(null==i)throw new Zn("No such constructor "+e);if(f.isFunction(i)){if(null==r)throw new Zn("Constructor "+e+" need parameters");return i.apply(t,r)}if(null!=r&&0!=r.length)throw new Zn("Constructor "+e+" does not need parameters");return i},v.createEnumIndex=function(t,e,r){var i=t.__constructs__[e];if(null==i)throw new Zn(e+" is not a valid enum constructor index");return v.createEnum(t,i,r)},v.enumEq=function(t,e){if(t==e)return!0;try{if(t[0]!=e[0])return!1;for(var r=2,i=t.length;r<i;){var n=r++;if(!v.enumEq(t[n],e[n]))return!1}var a=t.__enum__;if(a!=e.__enum__||null==a)return!1}catch(t){return!1}return!0};var m=a["cstrain.core.BGTrainState"]={__ename__:!0,__constructs__:["STOPPED","ACCEL","SPEEDING","BRAKING"]};m.STOPPED=["STOPPED",0],m.STOPPED.toString=s,m.STOPPED.__enum__=m,m.ACCEL=function(t){var e=["ACCEL",1,t];return e.__enum__=m,e.toString=s,e},m.SPEEDING=["SPEEDING",2],m.SPEEDING.toString=s,m.SPEEDING.__enum__=m,m.BRAKING=function(t){var e=["BRAKING",3,t];return e.__enum__=m,e.toString=s,e},m.__empty_constructs__=[m.STOPPED,m.SPEEDING];var y=function(t,e,r,i){null==r&&(r=!1),this.varValues=null,this.operator=t,this.value=e,this.isVar=r,this.virtualRight=i};a["cstrain.core.Card"]=y,y.__name__=["cstrain","core","Card"],y.intArrayToFloatArr=function(t){for(var e=[],r=0,i=t.length;r<i;){var n=r++;e[n]=t[n]}return e},y.toOperation=function(t){var e=t.operator;switch(e){case 0:return C.ADD(t.value,t.isVar);case 1:return C.SUBTRACT(t.value,t.isVar);case 2:return C.MULTIPLY(t.value,t.isVar);case 3:case 4:return null!=t.varValues&&t.varValues.length>0?C.DIVIDE_BY_POLYNOMIAL(y.intArrayToFloatArr([t.value].concat(t.varValues))):C.DIVIDE(t.value,t.isVar);case 5:return C.DERIVATIVE;case 6:return C.EQUAL(t.value,t.isVar);default:throw new Zn("Card:: toOperation invalid operator:"+t.operator)}},y.prototype={setPolynomial:function(t){for(var e=t.coefs.slice(1),r=[],i=0,n=e.length;i<n;){var a=i++;r[a]=0|e[a]}this.varValues=r,this.value=0|t.coefs[0],this.isVar=0!=r.length},getPolynomial:function(){var t=[];if(null!=this.varValues)for(var e=0,r=this.varValues.length;e<r;){var i=e++;t[i]=this.varValues[i]}return E.fromCoefs([this.value+0].concat(t))},__class__:y};var x=a["cstrain.core.CardResult"]={__ename__:!0,__constructs__:["OK","PENALIZE","GUESS_CONSTANT","NOTHING","NOT_YET_AVAILABLE","GAMEOVER_OUTTA_CARDS"]};x.OK=function(t){var e=["OK",0,t];return e.__enum__=x,e.toString=s,e},x.PENALIZE=function(t){var e=["PENALIZE",1,t];return e.__enum__=x,e.toString=s,e},x.GUESS_CONSTANT=function(t,e){var r=["GUESS_CONSTANT",2,t,e];return r.__enum__=x,r.toString=s,r},x.NOTHING=["NOTHING",3],x.NOTHING.toString=s,x.NOTHING.__enum__=x,x.NOT_YET_AVAILABLE=function(t,e){var r=["NOT_YET_AVAILABLE",4,t,e];return r.__enum__=x,r.toString=s,r},x.GAMEOVER_OUTTA_CARDS=["GAMEOVER_OUTTA_CARDS",5],x.GAMEOVER_OUTTA_CARDS.toString=s,x.GAMEOVER_OUTTA_CARDS.__enum__=x,x.__empty_constructs__=[x.NOTHING,x.GAMEOVER_OUTTA_CARDS];var b=function(){this.cards=[]};a["cstrain.core.Deck"]=b,b.__name__=["cstrain","core","Deck"],b.arrayShuffleFisherYates=function(t,e){for(var r,i,n=t.length;0!=n;){var a;if(null!=e){var s=e^e<<11;e=e^e>>19^(s^s>>8),a=4.6566128742e-10*e}else a=Math.random();r=a*n--|0,i=t[n],t[n]=t[r],t[r]=i}return t},b.getCards=function(t,e,r,i){null==i&&(i=1),null==r&&(r=0);var n=[];if(0==t&&(t=3),0==e&&(e=15),0==r&&(r=1023),0!=(1&t))for(var a=0,s=i;a<s;)for(var o=(a++,0);o<4;){var h=o++;if(0!=(e&1<<h))for(var l=0;l<10;){var u=l++;0!=(r&1<<u)&&n.push(new y(h,u+1))}}if(0!=(2&t))for(var R=0,c=i;R<c;)for(var _=(R++,0);_<4;){var f=_++;0!=(e&1<<f)&&n.push(new y(f,1,!0))}return n},b.prototype={shuffle:function(t){b.arrayShuffleFisherYates(this.cards,t)},addCards:function(t,e){null==e&&(e=!0),e?this.cards=this.cards.concat(t):this.cards=t.concat(this.cards)},__class__:b};var w=function(t,e,r){null==r&&(r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890"),null==e&&(e=0),null==t&&(t=""),this.minHashLength=0,this.seps="cfhistuCFHISTU",this.alphabet="",this.salt="",this.salt=t,this.minHashLength=e<0?0:e;for(var i="",n=0,a=r.length;n<a;){var s=n++,o=r.charAt(s);i.indexOf(o)<0&&(i+=o)}r=i;if(r.length<16)throw new Zn("Alphabet must contain at least 16 unique characters.");if(r.indexOf(" ")>=0)throw new Zn("Alphabet cannot contains spaces.");for(var h=0,l=this.seps.length;h<l;){var u=h++,R=r.indexOf(this.seps.charAt(u));R==-1?this.seps=this.seps.substring(0,u)+" "+this.seps.substring(u+1):r=r.substring(0,R)+" "+r.substring(R+1)}var c=new RegExp("\\s+","g".split("u").join(""));if(r=r.replace(c,""),this.seps=this.seps.replace(c,""),this.seps=this.consistentShuffle(this.seps,t),""==this.seps||r.length/this.seps.length>3.5){var _=Math.ceil(r.length/3.5);if(1==_&&++_,_>this.seps.length){var f=_-this.seps.length;this.seps+=r.substring(0,f),r=r.substring(f)}else this.seps=this.seps.substring(0,_)}r=this.consistentShuffle(r,t);var g=12,p=Math.ceil(r.length/g);r.length<3?(this.guards=this.seps.substring(0,p),this.seps=this.seps.substring(p)):(this.guards=r.substring(0,p),r=r.substring(p)),this.alphabet=r};a["hashids.Hashids"]=w,w.__name__=["hashids","Hashids"],w.prototype={encode:function(t,e){if(null==t&&null==e)throw new Zn("Please provide a number or an array of numbers");return null==e&&(e=[]),null!=t&&e.unshift(t),0==e.length?"":this._encode(e)},decode:function(t){return""==t?[]:this._decode(t,this.alphabet)},_encode:function(t){for(var e=0,r=0,i=t.length;r<i;){var n=r++;e+=t[n]%(n+100)}for(var a,s,h,l,u,R=this.alphabet,c=R.split("")[e%R.length],_=c+"",f=0,g=t.length;f<g;){var p=f++;a=t[p],l=c+this.salt+R,R=this.consistentShuffle(R,l.substring(0,R.length));var d=this.hash(a,R);_+=d,p+1<t.length&&(a%=o.cca(d,0)+p,s=a%this.seps.length,_+=this.seps.split("")[s])}for(_.length<this.minHashLength&&(h=(e+o.cca(_,0))%this.guards.length,u=this.guards.split("")[h],_=u+_,_.length<this.minHashLength&&(h=(e+o.cca(_,2))%this.guards.length,u=this.guards.split("")[h],_+=u));_.length<this.minHashLength;){var v=R.length/2|0;R=this.consistentShuffle(R,R),_=R.substring(v)+_+R.substring(0,v);var m=_.length-this.minHashLength;if(m>0){var y=m/2|0;_=_.substring(y,y+this.minHashLength)}}return _},_decode:function(t,e){var r=[],i=0,n=new RegExp("["+this.guards+"]","g".split("u").join("")),a=t.replace(n," "),s=a.split(" ");3!=s.length&&2!=s.length||(i=1),a=s[i];var o=a.split("")[0];a=a.substring(1);var h=new RegExp("["+this.seps+"]","g".split("u").join(""));a=a.replace(h," "),s=a.split(" ");for(var l,u,R=0;R<s.length;){var c=s[R];++R,l=c,u=o+this.salt+e,e=this.consistentShuffle(e,u.substring(0,e.length)),r.push(this.unhash(l,e))}return this._encode(r)!=t&&(r=[]),r},consistentShuffle:function(t,e){if(e.length<=0)return t;for(var r=e.split(""),i=t.length-1,n=0,a=0;i>0;){n%=e.length;var s=o.cca(r[n],0);a+=s;var h=(s+n+a)%i,l=t.charAt(h);t=t.substring(0,h)+t.charAt(i)+t.substring(h+1),t=t.substring(0,i)+l+t.substring(i+1),--i,++n}return t},hash:function(t,e){for(var r="",i=e.length,n=e.split("");;)if(r=n[t%i]+r,t=Math.floor(t/i),!(t>0))break;return r},unhash:function(t,e){for(var r=0,i=t.split(""),n=0,a=t.length;n<a;){var s=n++,o=e.indexOf(i[s]);r+=o*Math.pow(e.length,t.length-s-1)|0}return r},__class__:w};var j=function(){this.uniqueID="",this.penaltyDelayMs=1,this.minTurnTime=1};a["cstrain.core.GameSettings"]=j,j.__name__=["cstrain","core","GameSettings"],j.getUniqueID=function(t,e){var r=t<0?-t:t,i=null!=e?[]:null;if(null!=i)for(var n=0,a=e.length;n<a;){var s=n++,o=e[s]<0;i.push(o?1:0),i.push(o?-e[s]:e[s])}var h=t<0?[1,r]:[0,r],l=j.HASHIDS.encode(null,null!=i?h.concat(i):h);return l},j.getSeedFromUniqueId=function(t){var e=j.HASHIDS.decode(t);return 0!=e[0]?e[1]*-1:e[1]},j.getOptionsFromUniqueId=function(t){var e=j.HASHIDS.decode(t);if(e.length>=3){for(var r=2,i=[];r<e.length;)i.push(0!=e[r]?e[r+1]*-1:e[r+1]),r+=2;return i}return null},j.prototype={__class__:j};var T=function(){};a["cstrain.core.IBGTrain"]=T,T.__name__=["cstrain","core","IBGTrain"],T.prototype={__class__:T};var S=function(){};a["cstrain.core.IRules"]=S,S.__name__=["cstrain","core","IRules"],S.prototype={__class__:S};var C=a["cstrain.core.Operation"]={__ename__:!0,__constructs__:["ADD","SUBTRACT","MULTIPLY","DIVIDE","DIVIDE_BY_POLYNOMIAL","EQUAL","DERIVATIVE"]};C.ADD=function(t,e){var r=["ADD",0,t,e];return r.__enum__=C,r.toString=s,r},C.SUBTRACT=function(t,e){var r=["SUBTRACT",1,t,e];return r.__enum__=C,r.toString=s,r},C.MULTIPLY=function(t,e){var r=["MULTIPLY",2,t,e];return r.__enum__=C,r.toString=s,r},C.DIVIDE=function(t,e){var r=["DIVIDE",3,t,e];return r.__enum__=C,r.toString=s,r},C.DIVIDE_BY_POLYNOMIAL=function(t){var e=["DIVIDE_BY_POLYNOMIAL",4,t];return e.__enum__=C,e.toString=s,e},C.EQUAL=function(t,e){var r=["EQUAL",5,t,e];return r.__enum__=C,r.toString=s,r},C.DERIVATIVE=["DERIVATIVE",6],C.DERIVATIVE.toString=s,C.DERIVATIVE.__enum__=C,C.__empty_constructs__=[C.DERIVATIVE];var M=a["cstrain.core.PenaltyDesc"]={__ename__:!0,__constructs__:["LOST_IN_TRANSIT","MISSED_STOP","WRONG_CONSTANT","FURTHER_GUESS","CLOSER_GUESS"]};M.LOST_IN_TRANSIT=["LOST_IN_TRANSIT",0],M.LOST_IN_TRANSIT.toString=s,M.LOST_IN_TRANSIT.__enum__=M,M.MISSED_STOP=["MISSED_STOP",1],M.MISSED_STOP.toString=s,M.MISSED_STOP.__enum__=M,M.WRONG_CONSTANT=["WRONG_CONSTANT",2],M.WRONG_CONSTANT.toString=s,M.WRONG_CONSTANT.__enum__=M,M.FURTHER_GUESS=function(t){var e=["FURTHER_GUESS",3,t];return e.__enum__=M,e.toString=s,e},M.CLOSER_GUESS=function(t){var e=["CLOSER_GUESS",4,t];return e.__enum__=M,e.toString=s,e},M.__empty_constructs__=[M.LOST_IN_TRANSIT,M.MISSED_STOP,M.WRONG_CONSTANT];var k=function(){this.startTime=0,this.lastMovedTime=0,this.lostInTransits=0,this.reachedStops=0,this.missedStops=0};a["cstrain.core.PlayerStats"]=k,k.__name__=["cstrain","core","PlayerStats"],k.prototype={__class__:k};var E=function(){this.coefs=[0]};a["cstrain.core.Polynomial"]=E,E.__name__=["cstrain","core","Polynomial"],E.fromCoefs=function(t){var e=new E;return e.coefs=t,e},E.gcd=function(t,e){var r=1;for(t=Math.abs(0|t),e=Math.abs(0|e);0!=r;)r=t%e|0,t=e,e=r;return 0|t},E.gcd_mult=function(t){for(var e=t[t.length-1],r=t.length-1;--r>-1;)0!=(0|t[r])&&(e=E.gcd(e,t[r]));return 0|e},E.createDeg1x=function(){var t=new E;return t.coefs.push(1),t},E.trim=function(t){for(var e=t.coefs.length-1;e>0&&0==(t.coefs.length-1<e?null:t.coefs[e]);)t.coefs.splice(e,1),--e},E.floatToStringPrecision=function(t,e){return t*=Math.pow(10,e),g.string(Math.round(t)/Math.pow(10,e))},E.PrintOut=function(t,e,r){for(var i=t.coefs[0],n=t.coefs[0],a=0!=n?E.floatToStringPrecision(n,2)+"":"",s=[(0!=i?i<0?"":"+":"")+a],h=1,l=t.coefs.length;h<l;){var u=h++,R=t.coefs[u],c=t.coefs[u],_=0!=c?(1!=c||u<1?E.floatToStringPrecision(c,2)+"":"")+(u>=1?e:"")+(u>=2?r?"<sup>"+u+"</sup>":"^"+u:""):"";s.push((0!=R?R<0?"":"+":"")+_)}return s.reverse(),"+"==s[0].charAt(0)&&(s[0]=o.substr(s[0],1,null)),s.join(" ")},E.Copy=function(t){var e=new E;return e.coefs=t.coefs.concat([]),e},E.prototype={isRootFor:function(t){return this.coefs.length>1&&0==this.evalValueFloat(t)},findRoot:function(){if(this.isRootFor(0))return 0;if(this.coefs[0]%1!=0||this.coefs[this.coefs.length-1]%1!=0)return Ri.trace("Invalid not whole number coeffs!",{fileName:"Polynomial.hx",lineNumber:36,className:"cstrain.core.Polynomial",methodName:"findRoot"}),null;for(var t=0|Math.abs(this.coefs[0]),e=0|Math.abs(this.coefs[this.coefs.length-1]),r=1,i=t+1;r<i;){var n=r++;if(t%n==0)for(var a=1,s=e+1;a<s;){var o=a++;if(e%o==0){var h=n/o;if(this.isRootFor(h))return h;if(this.isRootFor(-h))return-h}}}return null},reduceByRoot:function(t){for(var e=[],r=0,i=9999,n=!1,a=this.coefs.length;--a>-1;){var s=this.coefs[a];i=s+r,n=!0,r=i*t,e.unshift(i)}return!(!n||0!=i)&&(e.shift(),this.coefs=e,!0)},isWhole:function(){for(var t=0,e=this.coefs.length;t<e;){var r=t++;if(this.coefs[r]%1!=0)return!1}return!0},findCommonFactor:function(){return this.isWhole()&&this.coefs.length>1?E.gcd_mult(this.coefs):1},factorisation:function(t){null==t&&(t=!1);var e=[],r=this.findRoot();if(null==r||!t&&r%1!=0){var i=E.Copy(this),n=i.findCommonFactor();if(1!=n){for(var a=0,s=this.coefs.length;a<s;){var o=a++;i.coefs[o]/=n}e.push(E.fromCoefs([n]))}e.push(i)}else{e.push(E.fromCoefs([-r,1]));var h=E.Copy(this);h.reduceByRoot(r),this.addToArray(e,h.factorisation())}return e},addToArray:function(t,e){for(var r=0,i=e.length;r<i;){var n=r++;t.push(e[n])}},differentiate:function(){var t=new E;if(this.coefs.length-1==0)return t;for(var e=0,r=this.coefs.length-1;e<r;){var i=e++;t.coefs[i]=this.coefs[i+1]*(i+1)}return t},isZero:function(){return this.coefs.length-1==0&&0==(this.coefs.length-1<0?null:this.coefs[0])},addCoef:function(t,e){var r=this.coefs.length-1<t?null:this.coefs[t];null==r&&(r=0),this.setCoef(t,r+e)},setCoef:function(t,e){for(;this.coefs.length-1<t;)this.coefs.push(0);this.coefs[t]=e},copyFrom:function(t){for(var e=[],r=0,i=t.coefs.length;r<i;){var n=r++;e[n]=t.coefs[n]}this.coefs=e},add:function(t){var e,r;this.coefs.length-1>t.coefs.length-1?(e=E.Copy(this),r=t):(e=E.Copy(t),r=this);for(var i=0,n=r.coefs.length-1+1;i<n;){var a=i++;e.addCoef(a,r.coefs.length-1<a?null:r.coefs[a])}return E.trim(e),e},sub:function(t){var e=this.add(t.mulI(-1));return E.trim(e),e},divisionWithRemainder:function(t){if(t.isZero())throw new Zn("divisionWithRemainder:: / by zero");for(var e=[],r=this,i=new E,n=r.coefs.length-1-(t.coefs.length-1);n>=0&&!r.isZero();){var a=r.coefs.length-1,s=r.coefs.length-1<a?null:r.coefs[a],o=t.coefs.length-1,h=t.coefs.length-1<o?null:t.coefs[o],l=s/h;i.setCoef(n,l);var u=new E;u.setCoef(n,l),r=r.sub(t.mul(u)),n=r.coefs.length-1-(t.coefs.length-1)}return e.push(i),e.push(r),e},div:function(t){return this.divisionWithRemainder(t)[0]},mul:function(t){for(var e=new E,r=this.coefs.length-1,i=t.coefs.length-1,n=0,a=r+1;n<a;)for(var s=n++,o=0,h=i+1;o<h;){var l=o++,u=this.coefs.length-1<s?null:this.coefs[s],R=t.coefs.length-1<l?null:t.coefs[l];e.addCoef(s+l,u*R)}return E.trim(e),e},mulI:function(t){for(var e=E.Copy(this),r=0,i=e.coefs.length;r<i;){var n=r++;e.setCoef(n,(e.coefs.length-1<n?null:e.coefs[n])*t)}return E.trim(e),e},evalValueInt:function(t){for(var e=0,r=0,i=this.coefs.length;r<i;){var n=r++;e+=this.coefs[n]*Math.pow(t,n)}return 0|e},evalValueFloat:function(t){for(var e=0,r=0,i=this.coefs.length;r<i;){var n=r++;e+=this.coefs[n]*Math.pow(t,n)}return e},cleanupPolynomial:function(){for(var t=this.coefs.length;--t>0&&0==this.coefs[t];)this.coefs.pop()},performOperationImmutable:function(t){var e=null;switch(t[1]){case 0:var r=t[3],i=t[2];e=this.add(E.fromCoefs(r?[0,i]:[i]));break;case 1:var n=t[3],a=t[2];e=this.sub(E.fromCoefs(n?[0,a]:[a]));break;case 2:var s=t[3],o=t[2];e=this.mul(E.fromCoefs(s?[0,o]:[o]));break;case 3:var h=t[3],l=t[2];if(0==l)throw new Zn("Divide by zero error detected!");e=h?this.div(E.fromCoefs([0,l])):this.mul(E.fromCoefs([1/l]));break;case 4:var u=t[2];Ri.trace("This shouldn't happen DIVIDE_BY_POLYNIMAL for immutable",{fileName:"Polynomial.hx",lineNumber:520,className:"cstrain.core.Polynomial",methodName:"performOperationImmutable"}),e=this.div(E.fromCoefs(u));break;case 6:e=this.differentiate();break;default:Ri.trace("UInaccounted for operation:"+g.string(t),{fileName:"Polynomial.hx",lineNumber:525,className:"cstrain.core.Polynomial",methodName:"performOperationImmutable"})}return e},performOperation:function(t){switch(t[1]){case 0:var e=t[3],r=t[2];e&&this.coefs.length<2&&this.coefs.push(0),this.coefs[e?1:0]+=r;break;case 1:var i=t[3],n=t[2];i&&this.coefs.length<2&&this.coefs.push(0),this.coefs[i?1:0]-=n;break;case 2:var a=t[3],s=t[2];a&&this.coefs.unshift(0);for(var o=0,h=this.coefs.length;o<h;){var l=o++;this.coefs[l]*=s}break;case 3:var u=t[3],R=t[2];if(0==R)throw new Zn("Divide by zero error detected!");if(u)this.copyFrom(this.div(E.createDeg1x()));else for(var c=0,_=this.coefs.length;c<_;){var f=c++;this.coefs[f]/=R}break;case 4:var p=t[2],d=this.div(E.fromCoefs(p));this.copyFrom(d);break;case 6:var v=this.differentiate();this.copyFrom(v);break;default:Ri.trace("UInaccounted for operation:"+g.string(t),{fileName:"Polynomial.hx",lineNumber:580,className:"cstrain.core.Polynomial",methodName:"performOperation"})}this.cleanupPolynomial()},__class__:E};var A=function(){};a["h3d.IDrawable"]=A,A.__name__=["h3d","IDrawable"];var I=function(){var t=this,e=ke.CURRENT;null!=e?(this.engine=e,e.onReady=n(this,this.setup),fi.delay(n(this,this.setup),0)):Zi.start(function(){e=new ke,t.engine=e,e.onReady=n(t,t.setup),e.init()})};a["hxd.App"]=I,I.__name__=["hxd","App"],I.__interfaces__=[A],I.prototype={onResize:function(){},render:function(t){this.s3d.render(t),this.s2d.render(t)},setup:function(){var t=this,e=!1;this.engine.onResized=function(){null!=t.s2d&&(t.s2d.checkResize(),e&&t.onResize())},this.s3d=new Ur,this.s2d=new me,this.sevents=new Yi,this.sevents.addScene(this.s2d),this.sevents.addScene(this.s3d),this.loadAssets(function(){e=!0,t.init(),Ki.skip(),t.mainLoop(),Zi.setLoop(n(t,t.mainLoop)),zi.initialize()})},loadAssets:function(t){t()},init:function(){},mainLoop:function(){Ki.update(),this.sevents.checkEvents(),this.isDisposed||(this.update(Ki.tmod),this.isDisposed||(this.s2d.setElapsedTime(Ki.tmod/60),this.s3d.setElapsedTime(Ki.tmod/60),this.engine.render(this)))},update:function(t){},__class__:I};var P=function(t){null==t&&(t=[]),this.valueClasses=t,this.slots=B.NIL,this.priorityBased=!1};a["msignal.Signal"]=P,P.__name__=["msignal","Signal"],P.prototype={add:function(t){return this.registerListener(t)},addOnce:function(t){return this.registerListener(t,!0)},addWithPriority:function(t,e){return null==e&&(e=0),this.registerListener(t,!1,e)},addOnceWithPriority:function(t,e){return null==e&&(e=0),this.registerListener(t,!0,e)},remove:function(t){var e=this.slots.find(t);return null==e?null:(this.slots=this.slots.filterNot(t),e)},removeAll:function(){this.slots=B.NIL},registerListener:function(t,e,r){if(null==r&&(r=0),null==e&&(e=!1),this.registrationPossible(t,e)){var i=this.createSlot(t,e,r);return this.priorityBased||0==r||(this.priorityBased=!0),this.priorityBased||0!=r?this.slots=this.slots.insertWithPriority(i):this.slots=this.slots.prepend(i),i}return this.slots.find(t)},registrationPossible:function(t,e){if(!this.slots.nonEmpty)return!0;var r=this.slots.find(t);return null==r},createSlot:function(t,e,r){return null==r&&(r=0),null==e&&(e=!1),null},get_numListeners:function(){return this.slots.get_length()},__class__:P};var D=function(){P.call(this)};a["msignal.Signal0"]=D,D.__name__=["msignal","Signal0"],D.__super__=P,D.prototype=e(P.prototype,{dispatch:function(){for(var t=this.slots;t.nonEmpty;)t.head.execute(),t=t.tail},createSlot:function(t,e,r){return null==r&&(r=0),null==e&&(e=!1),new ra(this,t,e,r)},__class__:D});var B=function(t,e){this.nonEmpty=!1,null==t&&null==e?this.nonEmpty=!1:null!=t&&(this.head=t,this.tail=null==e?B.NIL:e,this.nonEmpty=!0)};a["msignal.SlotList"]=B,B.__name__=["msignal","SlotList"],B.prototype={get_length:function(){if(!this.nonEmpty)return 0;if(this.tail==B.NIL)return 1;for(var t=0,e=this;e.nonEmpty;)++t,e=e.tail;return t},prepend:function(t){return new B(t,this)},insertWithPriority:function(t){if(!this.nonEmpty)return new B(t);var e=t.priority;if(e>=this.head.priority)return this.prepend(t);for(var r=new B(this.head),i=r,n=this.tail;n.nonEmpty;){if(e>n.head.priority)return i.tail=n.prepend(t),r;i=i.tail=new B(n.head),n=n.tail}return i.tail=new B(t),r},filterNot:function(t){if(!this.nonEmpty||null==t)return this;if(f.compareMethods(this.head.listener,t))return this.tail;for(var e=new B(this.head),r=e,i=this.tail;i.nonEmpty;){if(f.compareMethods(i.head.listener,t))return r.tail=i.tail,e;r=r.tail=new B(i.head),i=i.tail}return this},find:function(t){if(!this.nonEmpty)return null;for(var e=this;e.nonEmpty;){if(f.compareMethods(e.head.listener,t))return e.head;e=e.tail}return null},__class__:B};var V=function(t){P.call(this,[t])};a["msignal.Signal1"]=V,V.__name__=["msignal","Signal1"],V.__super__=P,V.prototype=e(P.prototype,{dispatch:function(t){for(var e=this.slots;e.nonEmpty;)e.head.execute(t),e=e.tail},createSlot:function(t,e,r){return null==r&&(r=0),null==e&&(e=!1),new ia(this,t,e,r)},__class__:V});var O=function(){this._needToRender=!0,I.call(this)};a["cstrain.h2d.AbstractBGScene"]=O,O.__name__=["cstrain","h2d","AbstractBGScene"],O.__super__=I,O.prototype=e(I.prototype,{init:function(){I.prototype.init.call(this),N.WIDTH=this.s2d.width,N.HEIGHT=this.s2d.height,O.signalInited.dispatch()},__class__:O});var F=function(t){this.alpha=1,this.matA=1,this.matB=0,this.matC=0,this.matD=1,this.absX=0,this.absY=0,this.posChanged=!0,this.x=0,this.posChanged=!0,this.y=0,this.posChanged=!0,this.scaleX=1,this.posChanged=!0,this.scaleY=1,this.posChanged=!0,this.rotation=0,this.posChanged=null!=t,this.set_visible(!0),this.children=[],null!=t&&t.addChild(this)};a["h2d.Sprite"]=F,F.__name__=["h2d","Sprite"],F.prototype={getBounds:function(t,e){return null==e?e=new ae:(e.xMin=1e20,e.yMin=1e20,e.xMax=-1e20,e.yMax=-1e20),null!=t&&t.syncPos(),t!=this&&this.syncPos(),this.getBoundsRec(t,e,!1),(e.xMax<=e.xMin||e.yMax<=e.yMin)&&(this.addBounds(t,e,-1,-1,2,2),e.xMax=e.xMin=.5*(e.xMax+e.xMin),e.yMax=e.yMin=.5*(e.yMax+e.yMin)),e},getBoundsRec:function(t,e,r){if(this.posChanged){this.calcAbsPos();for(var i=0,n=this.children;i<n.length;){var a=n[i];++i,a.posChanged=!0}this.posChanged=!1}var s=this.children.length;if(0==s)return e.xMin=1e20,e.yMin=1e20,e.xMax=-1e20,void(e.yMax=-1e20);if(1==s){var o=this.children[0];return void(o.visible?o.getBoundsRec(t,e,r):(e.xMin=1e20,e.yMin=1e20,e.xMax=-1e20,e.yMax=-1e20))}for(var h=1/0,l=1/0,u=-(1/0),R=-(1/0),c=0,_=this.children;c<_.length;){var f=_[c];++c,f.visible&&(f.getBoundsRec(t,e,r),e.xMin<h&&(h=e.xMin),e.yMin<l&&(l=e.yMin),e.xMax>u&&(u=e.xMax),e.yMax>R&&(R=e.yMax))}e.xMin=h,e.yMin=l,e.xMax=u,e.yMax=R},addBounds:function(t,e,r,i,n,a){if(!(n<=0||a<=0)){if(null==t){var s=r*this.matA+i*this.matC+this.absX,o=r*this.matB+i*this.matD+this.absY;s<e.xMin&&(e.xMin=s),s>e.xMax&&(e.xMax=s),o<e.yMin&&(e.yMin=o),o>e.yMax&&(e.yMax=o);var h=(r+n)*this.matA+i*this.matC+this.absX,l=(r+n)*this.matB+i*this.matD+this.absY;h<e.xMin&&(e.xMin=h),h>e.xMax&&(e.xMax=h),l<e.yMin&&(e.yMin=l),l>e.yMax&&(e.yMax=l);var u=r*this.matA+(i+a)*this.matC+this.absX,R=r*this.matB+(i+a)*this.matD+this.absY;u<e.xMin&&(e.xMin=u),u>e.xMax&&(e.xMax=u),R<e.yMin&&(e.yMin=R),R>e.yMax&&(e.yMax=R);var c=(r+n)*this.matA+(i+a)*this.matC+this.absX,_=(r+n)*this.matB+(i+a)*this.matD+this.absY;return c<e.xMin&&(e.xMin=c),c>e.xMax&&(e.xMax=c),_<e.yMin&&(e.yMin=_),void(_>e.yMax&&(e.yMax=_))}if(t==this)return e.xMin>r&&(e.xMin=r),e.yMin>i&&(e.yMin=i),e.xMax<r+n&&(e.xMax=r+n),void(e.yMax<i+a&&(e.yMax=i+a));var f=t.matA*t.matD-t.matB*t.matC;if(0!=f){var g,p,d=1/f,v=t.matD*d,m=-t.matB*d,y=-t.matC*d,x=t.matA*d,b=this.absX-t.absX,w=this.absY-t.absY;g=r*this.matA+i*this.matC+b,p=r*this.matB+i*this.matD+w;var j=g*v+p*y,T=g*m+p*x;j<e.xMin&&(e.xMin=j),j>e.xMax&&(e.xMax=j),T<e.yMin&&(e.yMin=T),T>e.yMax&&(e.yMax=T),g=(r+n)*this.matA+i*this.matC+b,p=(r+n)*this.matB+i*this.matD+w;var S=g*v+p*y,C=g*m+p*x;S<e.xMin&&(e.xMin=S),S>e.xMax&&(e.xMax=S),C<e.yMin&&(e.yMin=C),C>e.yMax&&(e.yMax=C),g=r*this.matA+(i+a)*this.matC+b,p=r*this.matB+(i+a)*this.matD+w;var M=g*v+p*y,k=g*m+p*x;M<e.xMin&&(e.xMin=M),M>e.xMax&&(e.xMax=M),k<e.yMin&&(e.yMin=k),k>e.yMax&&(e.yMax=k),g=(r+n)*this.matA+(i+a)*this.matC+b,p=(r+n)*this.matB+(i+a)*this.matD+w;var E=g*v+p*y,A=g*m+p*x;E<e.xMin&&(e.xMin=E),E>e.xMax&&(e.xMax=E),A<e.yMin&&(e.yMin=A),A>e.yMax&&(e.yMax=A)}}},localToGlobal:function(t){this.syncPos(),null==t&&(t=new be);var e=t.x*this.matA+t.y*this.matC+this.absX,r=t.x*this.matB+t.y*this.matD+this.absY;return t.x=e,t.y=r,t},globalToLocal:function(t){this.syncPos(),t.x-=this.absX,t.y-=this.absY;var e=1/(this.matA*this.matD-this.matB*this.matC),r=(t.x*this.matD-t.y*this.matC)*e,i=(-t.x*this.matB+t.y*this.matA)*e;return t.x=r,t.y=i,t},getScene:function(){for(var t=this;null!=t.parent;)t=t.parent;return t instanceof me?t:null},set_visible:function(t){return this.visible==t?t:(this.visible=t,null!=this.parentContainer&&this.parentContainer.contentChanged(this),t)},addChild:function(t){this.addChildAt(t,this.children.length)},addChildAt:function(t,e){e<0&&(e=0),e>this.children.length&&(e=this.children.length);for(var r=this;null!=r;){if(r==t)throw new Zn("Recursive addChild");r=r.parent}if(null!=t.parent){var i=t.allocated;t.allocated=!1,t.parent.removeChild(t),t.allocated=i}this.children.splice(e,0,t),!this.allocated&&t.allocated&&t.onRemove(),t.parent=this,t.parentContainer=this.parentContainer,t.posChanged=!0,this.allocated&&(t.allocated?t.onParentChanged():t.onAdd()),null!=this.parentContainer&&this.parentContainer.contentChanged(this)},onParentChanged:function(){for(var t=0,e=this.children;t<e.length;){var r=e[t];++t,r.onParentChanged()}},onAdd:function(){this.allocated=!0,null!=this.filter&&this.filter.bind(this);for(var t=0,e=this.children;t<e.length;){var r=e[t];++t,r.onAdd()}},onRemove:function(){this.allocated=!1,null!=this.filter&&this.filter.unbind(this);for(var t=0,e=this.children;t<e.length;){var r=e[t];++t,r.onRemove()}},removeChild:function(t){o.remove(this.children,t)&&(t.allocated&&t.onRemove(),t.parent=null,null!=t.parentContainer&&t.setParentContainer(null),t.posChanged=!0,null!=this.parentContainer&&this.parentContainer.contentChanged(this))},setParentContainer:function(t){this.parentContainer=t;for(var e=0,r=this.children;e<r.length;){var i=r[e];++e,i.setParentContainer(t)}},draw:function(t){},sync:function(t){var e=this.posChanged;e&&(this.calcAbsPos(),this.posChanged=!1),this.lastFrame=t.frame;for(var r=0,i=this.children.length;r<i;){var n=this.children[r];if(null==n)break;n.lastFrame!=t.frame&&(e&&(n.posChanged=!0),n.sync(t)),this.children[r]!=n?(r=0,i=this.children.length):++r}},syncPos:function(){if(null!=this.parent&&this.parent.syncPos(),this.posChanged){this.calcAbsPos();for(var t=0,e=this.children;t<e.length;){var r=e[t];++t,r.posChanged=!0}this.posChanged=!1}},calcAbsPos:function(){if(null==this.parent){var t,e;0==this.rotation?(t=1,e=0,this.matA=this.scaleX,this.matB=0,this.matC=0,this.matD=this.scaleY):(t=Math.cos(this.rotation),e=Math.sin(this.rotation),this.matA=this.scaleX*t,this.matB=this.scaleX*e,this.matC=this.scaleY*-e,this.matD=this.scaleY*t),this.absX=this.x,this.absY=this.y}else{if(0==this.rotation)this.matA=this.scaleX*this.parent.matA,this.matB=this.scaleX*this.parent.matB,this.matC=this.scaleY*this.parent.matC,this.matD=this.scaleY*this.parent.matD;else{var r=Math.cos(this.rotation),i=Math.sin(this.rotation),n=this.scaleX*r,a=this.scaleX*i,s=this.scaleY*-i,o=this.scaleY*r;this.matA=n*this.parent.matA+a*this.parent.matC,this.matB=n*this.parent.matB+a*this.parent.matD,this.matC=s*this.parent.matA+o*this.parent.matC,this.matD=s*this.parent.matB+o*this.parent.matD}this.absX=this.x*this.parent.matA+this.y*this.parent.matC+this.parent.absX,this.absY=this.x*this.parent.matB+this.y*this.parent.matD+this.parent.absY}},emitTile:function(t,e){null==F.nullDrawable&&(F.nullDrawable=new ie(null)),
F.nullDrawable.absX=this.absX,F.nullDrawable.absY=this.absY,F.nullDrawable.matA=this.matA,F.nullDrawable.matB=this.matB,F.nullDrawable.matC=this.matC,F.nullDrawable.matD=this.matD,t.drawTile(F.nullDrawable,e)},clipBounds:function(t,e){var r,i,n,a,s,o,h=t.tmpBounds;if(null!=t.inFilter){var l=t.baseShader.filterMatrixA__,u=t.baseShader.filterMatrixB__;r=this.matA*l.x+this.matB*l.y,i=this.matA*u.x+this.matB*u.y,n=this.matC*l.x+this.matD*l.y,a=this.matC*u.x+this.matD*u.y,s=this.absX*l.x+this.absY*l.y+l.z,o=this.absX*u.x+this.absY*u.y+u.z}else r=this.matA,i=this.matB,n=this.matC,a=this.matD,s=this.absX,o=this.absY;h.xMin=1e20,h.yMin=1e20,h.xMax=-1e20,h.yMax=-1e20;var R=e.xMin,c=e.yMin,_=R*r+c*n+s,f=R*i+c*a+o;_<h.xMin&&(h.xMin=_),_>h.xMax&&(h.xMax=_),f<h.yMin&&(h.yMin=f),f>h.yMax&&(h.yMax=f);var g=e.xMax,p=e.yMin,d=g*r+p*n+s,v=g*i+p*a+o;d<h.xMin&&(h.xMin=d),d>h.xMax&&(h.xMax=d),v<h.yMin&&(h.yMin=v),v>h.yMax&&(h.yMax=v);var m=e.xMin,y=e.yMax,x=m*r+y*n+s,b=m*i+y*a+o;x<h.xMin&&(h.xMin=x),x>h.xMax&&(h.xMax=x),b<h.yMin&&(h.yMin=b),b>h.yMax&&(h.yMax=b);var w=e.xMax,j=e.yMax,T=w*r+j*n+s,S=w*i+j*a+o;T<h.xMin&&(h.xMin=T),T>h.xMax&&(h.xMax=T),S<h.yMin&&(h.yMin=S),S>h.yMax&&(h.yMax=S),h.xMin<t.curX&&(h.xMin=t.curX),h.yMin<t.curY&&(h.yMin=t.curY),h.xMax>t.curX+t.curWidth&&(h.xMax=t.curX+t.curWidth),h.yMax>t.curY+t.curHeight&&(h.yMax=t.curY+t.curHeight);var C=1/(r*a-i*n),M=h.xMin,k=h.yMin,E=h.xMax,A=h.yMax;h.xMin=1e20,h.yMin=1e20,h.xMax=-1e20,h.yMax=-1e20;var I=M,P=k;I-=s,P-=o;var D=(I*a-P*n)*C,B=(-I*i+P*r)*C;D<h.xMin&&(h.xMin=D),D>h.xMax&&(h.xMax=D),B<h.yMin&&(h.yMin=B),B>h.yMax&&(h.yMax=B);var V=E,O=k;V-=s,O-=o;var F=(V*a-O*n)*C,L=(-V*i+O*r)*C;F<h.xMin&&(h.xMin=F),F>h.xMax&&(h.xMax=F),L<h.yMin&&(h.yMin=L),L>h.yMax&&(h.yMax=L);var G=M,N=A;G-=s,N-=o;var z=(G*a-N*n)*C,q=(-G*i+N*r)*C;z<h.xMin&&(h.xMin=z),z>h.xMax&&(h.xMax=z),q<h.yMin&&(h.yMin=q),q>h.yMax&&(h.yMax=q);var U=E,Y=A;U-=s,Y-=o;var W=(U*a-Y*n)*C,H=(-U*i+Y*r)*C;W<h.xMin&&(h.xMin=W),W>h.xMax&&(h.xMax=W),H<h.yMin&&(h.yMin=H),H>h.yMax&&(h.yMax=H);var X=e.xMin,Z=h.xMin;e.xMin=X<Z?Z:X;var K=e.yMin,$=h.yMin;e.yMin=K<$?$:K;var Q=e.xMax,J=h.xMax;e.xMax=Q>J?J:Q;var tt=e.yMax,et=h.yMax;e.yMax=tt>et?et:tt},drawFilters:function(t){if(t.pushFilter(this)){var e=t.tmpBounds,r=new ae,i=-1;this.filter.sync(t,this),this.filter.autoBounds?i=this.filter.boundsExtend:(this.filter.getBounds(this,e),e.xMin<r.xMin&&(r.xMin=e.xMin),e.xMax>r.xMax&&(r.xMax=e.xMax),e.yMin<r.yMin&&(r.yMin=e.yMin),e.yMax>r.yMax&&(r.yMax=e.yMax)),i>=0&&(this.getBounds(this,e),e.xMin-=i,e.yMin-=i,e.xMax+=i,e.yMax+=i,e.xMin<r.xMin&&(r.xMin=e.xMin),e.xMax>r.xMax&&(r.xMax=e.xMax),e.yMin<r.yMin&&(r.yMin=e.yMin),e.yMax>r.yMax&&(r.yMax=e.yMax)),this.clipBounds(t,r);var n=Math.floor(r.xMin+1e-10),a=Math.floor(r.yMin+1e-10),s=Math.ceil(r.xMax-n-1e-10),o=Math.ceil(r.yMax-a-1e-10);if(!(s<=0||o<=0||r.xMax<r.xMin)){var h=t.textures.allocTarget("filterTemp",t,s,o,!1);t.pushTarget(h,n,a,s,o),t.engine.clear(0);var l,u,R,c,_=t.globalAlpha,f=t.baseShader,g=f.filterMatrixA__;R=g.x,u=g.y,l=g.z,c=g.w;var p,d,v,m,y=f.filterMatrixB__;v=y.x,d=y.y,p=y.z,m=y.w;var x=(t.inFilter,1/(this.matA*this.matD-this.matB*this.matC)),b=this.matD*x,w=-this.matB*x,j=-this.matC*x,T=this.matA*x,S=-(this.absX*b+this.absY*j),C=-(this.absX*w+this.absY*T),M=f.filterMatrixA__;M.x=b,M.y=j,M.z=S,M.w=1;var k=f.filterMatrixB__;k.x=w,k.y=T,k.z=C,k.w=1,t.globalAlpha=1,this.draw(t);for(var E=0,A=this.children;E<A.length;){var I=A[E];++E,I.drawRec(t)}var P=ye.fromTexture(h);P.dx=n,P.dy=a;var D=P;P=this.filter.draw(t,P),P!=D&&null!=P&&(P.dx+=n,P.dy+=a);var B=f.filterMatrixA__;B.x=R,B.y=u,B.z=l,B.w=c;var V=f.filterMatrixB__;V.x=v,V.y=d,V.z=p,V.w=m,t.popTarget(),t.popFilter(),null!=P&&(t.globalAlpha=_*this.alpha,this.emitTile(t,P),t.globalAlpha=_)}}},drawRec:function(t){if(this.visible){if(this.posChanged){this.calcAbsPos();for(var e=0,r=this.children;e<r.length;){var i=r[e];++e,i.posChanged=!0}this.posChanged=!1}if(null!=this.filter)this.drawFilters(t);else{var n=t.globalAlpha;if(t.globalAlpha*=this.alpha,t.front2back){for(var a=this.children.length,s=0,o=a;s<o;){var h=s++;this.children[a-1-h].drawRec(t)}this.draw(t)}else{this.draw(t);for(var l=0,u=this.children;l<u.length;){var R=u[l];++l,R.drawRec(t)}}t.globalAlpha=n}}},contentChanged:function(t){},__class__:F};var L=function(t){F.call(this,t)};a["cstrain.h2d.Entity"]=L,L.__name__=["cstrain","h2d","Entity"],L.__super__=F,L.prototype=e(F.prototype,{update:function(t){},restoreFilter:function(t){},reset:function(){},__class__:L});var G=function(t,e,r){this.heightMap=[],L.call(this),this.graphics=new ue(this),this.baseHeight=e,this.color=r,this.speed=t,this.generateHeightMap(),this.createShape()};a["cstrain.h2d.Mountain"]=G,G.__name__=["cstrain","h2d","Mountain"],G.__super__=L,G.prototype=e(L.prototype,{reset:function(){this.posChanged=!0,this.x=0,this.heightMap=[],this.generateHeightMap(),this.createShape()},update:function(t){var e=this;if(e.posChanged=!0,e.x+=this.speed*t,this.x<-(this.width-N.WIDTH)){var r=(this.width-N.WIDTH)/10|0;this.heightMap.splice(0,r);var i=this;i.posChanged=!0,i.x+=10*r,this.generateHeightMap(),this.createShape()}},generateHeightMap:function(){this.divide(this.baseHeight,this.baseHeight,0,200),this.width=10*this.heightMap.length},divide:function(t,e,r,i){if(r<6){var n=-i/2,a=(t+e)/2+(n+Math.random()*(i/2-n));this.divide(t,a,r+1,i/2),this.divide(a,e,r+1,i/2)}else this.heightMap.push(t)},createShape:function(){var t=this.graphics;t.clear(),t.beginFill(this.color);var e=N.HEIGHT;t.flush(),t.addVertex(0,e,t.curR,t.curG,t.curB,t.curA,0*t.ma+e*t.mc+t.mx,0*t.mb+e*t.md+t.my);for(var r=0;r<this.heightMap.length;){var i=10*r,n=this.heightMap[r];t.addVertex(i,n,t.curR,t.curG,t.curB,t.curA,i*t.ma+n*t.mc+t.mx,i*t.mb+n*t.md+t.my),++r}var a=10*(r-1),s=N.HEIGHT;t.addVertex(a,s,t.curR,t.curG,t.curB,t.curA,a*t.ma+s*t.mc+t.mx,a*t.mb+s*t.md+t.my),t.endFill(),t.lineStyle(1,this.color);var o=this.heightMap[0];t.flush(),t.addVertex(0,o,t.curR,t.curG,t.curB,t.curA,0*t.ma+o*t.mc+t.mx,0*t.mb+o*t.md+t.my);var h=2*N.HEIGHT;t.addVertex(0,h,t.curR,t.curG,t.curB,t.curA,0*t.ma+h*t.mc+t.mx,0*t.mb+h*t.md+t.my)},__class__:G});var N=function(){};a["cstrain.h2d.SceneSettings"]=N,N.__name__=["cstrain","h2d","SceneSettings"];var z=function(t){this.renderCount=0,this.unitTimeLength=30,this._curLoc=0,this.debug=!1,this.entities=[],O.call(this),this.model=t};a["cstrain.h2d.TrainBGScene"]=z,z.__name__=["cstrain","h2d","TrainBGScene"],z.__super__=O,z.prototype=e(O.prototype,{reset:function(){this._curLoc=0,this._needToRender=!0;for(var t=0,e=this.entities;t<e.length;){var r=e[t];++t,r.reset()}},update:function(t){zi.isPressed(71)&&this.model.travelTo(this.model.get_targetDest()+1|0),this.model.update(),O.signalUpdate.dispatch(t);var e=this.model.get_currentPosition(),r=(e-this._curLoc)*this.unitTimeLength;if(r<0&&0==e)return void this.reset();if(this.renderCount<60&&(this._needToRender=!0,this.renderCount++),this._needToRender||this.model.movingState!=m.STOPPED){this._needToRender=this.model.movingState!=m.STOPPED;for(var i=0,n=this.entities;i<n.length;){var a=n[i];++i,a.update(r)}this._curLoc=e}else this._needToRender=!1},init:function(){O.prototype.init.call(this),new ue(this.scene);var t=new we(this.s2d),e=this.s2d.width,r=this.s2d.height,i=t.content,n=0,a=0,s=i.tmp;if(s.pos==s.array.length){var o=s.array.length<<1;o<128&&(o=128);var h=new ga(o);h.set(s.array),s.array=h}s.array[s.pos++]=n;var l=i.tmp;if(l.pos==l.array.length){var u=l.array.length<<1;u<128&&(u=128);var R=new ga(u);R.set(l.array),l.array=R}l.array[l.pos++]=a;var c=i.tmp;if(c.pos==c.array.length){var _=c.array.length<<1;_<128&&(_=128);var f=new ga(_);f.set(c.array),c.array=f}c.array[c.pos++]=0;var g=i.tmp;if(g.pos==g.array.length){var p=g.array.length<<1;p<128&&(p=128);var d=new ga(p);d.set(g.array),g.array=d}g.array[g.pos++]=0;var v=i.tmp;if(v.pos==v.array.length){var m=v.array.length<<1;m<128&&(m=128);var y=new ga(m);y.set(v.array),v.array=y}v.array[v.pos++]=.3176470588235294;var x=i.tmp;if(x.pos==x.array.length){var b=x.array.length<<1;b<128&&(b=128);var w=new ga(b);w.set(x.array),x.array=w}x.array[x.pos++]=.2823529411764706;var j=i.tmp;if(j.pos==j.array.length){var T=j.array.length<<1;T<128&&(T=128);var S=new ga(T);S.set(j.array),j.array=S}j.array[j.pos++]=.2901960784313726;var C=i.tmp;if(C.pos==C.array.length){var M=C.array.length<<1;M<128&&(M=128);var k=new ga(M);k.set(C.array),C.array=k}C.array[C.pos++]=1;var E=i.tmp;if(E.pos==E.array.length){var A=E.array.length<<1;A<128&&(A=128);var I=new ga(A);I.set(E.array),E.array=I}E.array[E.pos++]=n+e;var P=i.tmp;if(P.pos==P.array.length){var D=P.array.length<<1;D<128&&(D=128);var B=new ga(D);B.set(P.array),P.array=B}P.array[P.pos++]=a;var V=i.tmp;if(V.pos==V.array.length){var L=V.array.length<<1;L<128&&(L=128);var N=new ga(L);N.set(V.array),V.array=N}V.array[V.pos++]=1;var z=i.tmp;if(z.pos==z.array.length){var q=z.array.length<<1;q<128&&(q=128);var U=new ga(q);U.set(z.array),z.array=U}z.array[z.pos++]=0;var Y=i.tmp;if(Y.pos==Y.array.length){var W=Y.array.length<<1;W<128&&(W=128);var H=new ga(W);H.set(Y.array),Y.array=H}Y.array[Y.pos++]=.3176470588235294;var X=i.tmp;if(X.pos==X.array.length){var Z=X.array.length<<1;Z<128&&(Z=128);var K=new ga(Z);K.set(X.array),X.array=K}X.array[X.pos++]=.2823529411764706;var $=i.tmp;if($.pos==$.array.length){var Q=$.array.length<<1;Q<128&&(Q=128);var J=new ga(Q);J.set($.array),$.array=J}$.array[$.pos++]=.2901960784313726;var tt=i.tmp;if(tt.pos==tt.array.length){var et=tt.array.length<<1;et<128&&(et=128);var rt=new ga(et);rt.set(tt.array),tt.array=rt}tt.array[tt.pos++]=1;var it=i.tmp;if(it.pos==it.array.length){var nt=it.array.length<<1;nt<128&&(nt=128);var at=new ga(nt);at.set(it.array),it.array=at}it.array[it.pos++]=n;var st=i.tmp;if(st.pos==st.array.length){var ot=st.array.length<<1;ot<128&&(ot=128);var ht=new ga(ot);ht.set(st.array),st.array=ht}st.array[st.pos++]=a+r;var lt=i.tmp;if(lt.pos==lt.array.length){var ut=lt.array.length<<1;ut<128&&(ut=128);var Rt=new ga(ut);Rt.set(lt.array),lt.array=Rt}lt.array[lt.pos++]=0;var ct=i.tmp;if(ct.pos==ct.array.length){var _t=ct.array.length<<1;_t<128&&(_t=128);var ft=new ga(_t);ft.set(ct.array),ct.array=ft}ct.array[ct.pos++]=1;var gt=i.tmp;if(gt.pos==gt.array.length){var pt=gt.array.length<<1;pt<128&&(pt=128);var dt=new ga(pt);dt.set(gt.array),gt.array=dt}gt.array[gt.pos++]=.5882352941176471;var vt=i.tmp;if(vt.pos==vt.array.length){var mt=vt.array.length<<1;mt<128&&(mt=128);var yt=new ga(mt);yt.set(vt.array),vt.array=yt}vt.array[vt.pos++]=.39215686274509803;var xt=i.tmp;if(xt.pos==xt.array.length){var bt=xt.array.length<<1;bt<128&&(bt=128);var wt=new ga(bt);wt.set(xt.array),xt.array=wt}xt.array[xt.pos++]=.3058823529411765;var jt=i.tmp;if(jt.pos==jt.array.length){var Tt=jt.array.length<<1;Tt<128&&(Tt=128);var St=new ga(Tt);St.set(jt.array),jt.array=St}jt.array[jt.pos++]=1;var Ct=i.tmp;if(Ct.pos==Ct.array.length){var Mt=Ct.array.length<<1;Mt<128&&(Mt=128);var kt=new ga(Mt);kt.set(Ct.array),Ct.array=kt}Ct.array[Ct.pos++]=n+e;var Et=i.tmp;if(Et.pos==Et.array.length){var At=Et.array.length<<1;At<128&&(At=128);var It=new ga(At);It.set(Et.array),Et.array=It}Et.array[Et.pos++]=a+r;var Pt=i.tmp;if(Pt.pos==Pt.array.length){var Dt=Pt.array.length<<1;Dt<128&&(Dt=128);var Bt=new ga(Dt);Bt.set(Pt.array),Pt.array=Bt}Pt.array[Pt.pos++]=1;var Vt=i.tmp;if(Vt.pos==Vt.array.length){var Ot=Vt.array.length<<1;Ot<128&&(Ot=128);var Ft=new ga(Ot);Ft.set(Vt.array),Vt.array=Ft}Vt.array[Vt.pos++]=0;var Lt=i.tmp;if(Lt.pos==Lt.array.length){var Gt=Lt.array.length<<1;Gt<128&&(Gt=128);var Nt=new ga(Gt);Nt.set(Lt.array),Lt.array=Nt}Lt.array[Lt.pos++]=.5882352941176471;var zt=i.tmp;if(zt.pos==zt.array.length){var qt=zt.array.length<<1;qt<128&&(qt=128);var Ut=new ga(qt);Ut.set(zt.array),zt.array=Ut}zt.array[zt.pos++]=.39215686274509803;var Yt=i.tmp;if(Yt.pos==Yt.array.length){var Wt=Yt.array.length<<1;Wt<128&&(Wt=128);var Ht=new ga(Wt);Ht.set(Yt.array),Yt.array=Ht}Yt.array[Yt.pos++]=.3058823529411765;var Xt=i.tmp;if(Xt.pos==Xt.array.length){var Zt=Xt.array.length<<1;Zt<128&&(Zt=128);var Kt=new ga(Zt);Kt.set(Xt.array),Xt.array=Kt}Xt.array[Xt.pos++]=1,n<i.xMin&&(i.xMin=n),a<i.yMin&&(i.yMin=a),n+=e,a+=r,n>i.xMax&&(i.xMax=n),a>i.yMax&&(i.yMax=a),this.s2d.addChild(this.scene=new F);var $t=this.scene;$t.posChanged=!0,$t.y+=.12*this.s2d.height;for(var Qt=64,Jt=53,te=44,ee=23,re=19,ie=21,ne=4,ae=0,se=ne;ae<se;){var oe=ae++,he=oe/(ne-1),le=Qt*(1-he)+ee*he,Re=Jt*(1-he)+re*he,ce=te*(1-he)+ie*he,_e=.55*this.s2d.height+25*oe,fe=(0|le)<<16|(0|Re)<<8|(0|ce),ge=new G(-Math.pow(oe+1,2),_e,fe);this.scene.addChild(ge),this.entities.push(ge)}this.restoreFilters(this.debug)},restoreFilters:function(t){for(var e=0,r=this.entities;e<r.length;){var i=r[e];++e,i.restoreFilter(t)}},__class__:z});var q=function(){this._braking=!0,this.movingState=m.STOPPED,this._startTime=-1,this._forceStop=!1,this.pickupAndDownMidpointRatio=.5,this.pickdownTimeSpan=1,this.pickupTimeSpan=1,this.easeFuncs=ht.create(2),this._tweenDuration=0,this._tweenProgress=0,this._startIndex=-1,this._isStarted=!1,this._maxSpeed=2,this._reseting=!0,this._targetDest=0,this._curLoc=0,this.calcPickupTime(),this.setPickupTimespans(5,5)};a["cstrain.rules.SceneModel"]=q,q.__name__=["cstrain","rules","SceneModel"],q.__interfaces__=[T],q.prototype={get_targetDest:function(){return this._targetDest},getTimeLeft:function(){return(this._tweenDuration-this._tweenProgress)/30},calcPickupTime:function(){this._pickupTime=this.easeFuncs.deriativeGetX(this._maxSpeed),this._pickupTimeDistCovered=this.easeFuncs.distCovered(this._pickupTime),this._pickupTimeDiff=this._pickupTime-this._pickupTimeDistCovered/this._maxSpeed},setPickupTimespans:function(t,e){this.pickupTimeSpan=t,this.pickdownTimeSpan=e,this.pickupAndDownMidpointRatio=this.pickupTimeSpan/(this.pickupTimeSpan+this.pickdownTimeSpan)},resetTo:function(t){this._reseting=!0,this._targetDest=t},get_currentPosition:function(){return this._curLoc},travelTo:function(t){if(this._isStarted){if(this._braking){var e=this._tweenProgress-this._tweenDuration+30*this.pickdownTimeSpan,r=e/=30*this.pickdownTimeSpan;e=this.easeFuncs.distCovered_Out(e),e*=this.pickdownTimeSpan,e+=this._targetDest-this.pickdownTimeSpan,this._curLoc=e,r=1-r;e-=this.easeFuncs.distCovered(r)*this.pickupTimeSpan;this._startIndex=e,this._tweenProgress=r*(30*this.pickupTimeSpan),this._startTime=(new Date).getTime()/1e3-this._tweenProgress/30,this._targetDest=t}else this._targetDest=t;this._tweenDuration=30*(t-this._startIndex)/this._maxSpeed+this._pickupTimeDiff*this.pickupTimeSpan*30+this._pickupTimeDiff*this.pickdownTimeSpan*30}else{this._targetDest=t,this._isStarted=!0;var i=0|this._curLoc;this._startTime=(new Date).getTime()/1e3,this._startIndex=i,this._tweenProgress=0,this._tweenDuration=30*(t-this._startIndex)/this._maxSpeed+this._pickupTimeDiff*this.pickupTimeSpan*30+this._pickupTimeDiff*this.pickdownTimeSpan*30}if(this._pickupTimeDistCovered*this.pickupTimeSpan+this._pickupTimeDistCovered*this.pickdownTimeSpan>=this._targetDest-this._startIndex){var n=this._targetDest-this._startIndex;this._tweenDuration=30*this.easeFuncs.distCoveredGetX(n/this.pickupTimeSpan*this.pickupAndDownMidpointRatio)*this.pickupTimeSpan+30*this.easeFuncs.distCoveredGetX(n/this.pickdownTimeSpan*(1-this.pickupAndDownMidpointRatio))*this.pickdownTimeSpan}},update:function(){if(this._reseting)return this._curLoc=this._targetDest,this._isStarted=!1,this._curVelocity=0,this.movingState=m.STOPPED,void(this._reseting=!1);if(this._isStarted){this._tweenProgress=30*((new Date).getTime()/1e3-this._startTime),this._tweenProgress>this._tweenDuration&&(this._tweenProgress=this._tweenDuration),this._braking=!1;var t=0,e=this._pickupTimeDistCovered*this.pickupTimeSpan+this._pickupTimeDistCovered*this.pickdownTimeSpan>=this._targetDest-this._startIndex,r=30*this._pickupTime*this.pickupTimeSpan+30*this._pickupTime*this.pickdownTimeSpan>=this._tweenDuration;e!=r&&Ri.trace("Error MISMATCH assertion!:"+(null==e?"null":""+e)+" , "+(null==r?"null":""+r),{fileName:"SceneModel.hx",lineNumber:276,className:"cstrain.rules.SceneModel",methodName:"update"});var i=!1;if(e&&(i=this._tweenProgress>=this._tweenDuration*this.pickupAndDownMidpointRatio),e&&!i||!e&&this._tweenProgress<30*this._pickupTime*this.pickupTimeSpan)t=this._tweenProgress/(30*this.pickupTimeSpan),this._curVelocity=this.easeFuncs.deriative(t),t=this.easeFuncs.distCovered(t),t*=this.pickupTimeSpan,t+=this._startIndex,this.movingState=m.ACCEL(e);else if(e&&i||!e&&this._tweenProgress>=this._tweenDuration-30*this._pickupTime*this.pickdownTimeSpan)this._braking=!0,t=this._tweenProgress-this._tweenDuration+30*this.pickdownTimeSpan,t/=30*this.pickdownTimeSpan,this._curVelocity=this.easeFuncs.deriative_Out(t),t=this.easeFuncs.distCovered_Out(t),t*=this.pickdownTimeSpan,t+=this._targetDest-this.pickdownTimeSpan,this.movingState=m.BRAKING(e);else if(e)Ri.trace("ERROr no resolution!",{fileName:"SceneModel.hx",lineNumber:325,className:"cstrain.rules.SceneModel",methodName:"update"});else{this._curVelocity=this._maxSpeed;var n=(this._tweenProgress-30*this._pickupTime*this.pickupTimeSpan)/(this._tweenDuration-(30*this._pickupTime*this.pickupTimeSpan+30*this._pickupTime*this.pickdownTimeSpan));t=(this._startIndex+this._pickupTimeDistCovered*this.pickupTimeSpan)*(1-n)+(this._targetDest-this._pickupTimeDistCovered*this.pickdownTimeSpan)*n,this.movingState=m.SPEEDING}this._curLoc=t,this._tweenProgress>=this._tweenDuration&&(this._tweenProgress=this._tweenDuration,this._isStarted=!1,this._curVelocity=0,this.movingState=m.STOPPED)}else this.movingState=m.STOPPED;this._forceStop&&(this._forceStop=!1,this._isStarted=!1,this.movingState=m.STOPPED)},__class__:q};var U=function(){this._lastReceivedTime=0,this.commenced=!1,this.gameSettings=new j,this.onCardResult=new V,this.polynomialValueCached=!1,this.gameSettings.penaltyDelayMs=2e3};a["cstrain.rules.TestGame"]=U,U.__name__=["cstrain","rules","TestGame"],U.__interfaces__=[S],U.prototype={buildDeck:function(t){this.deck.addCards(b.getCards(1,3,0,1*t)),this.deck.addCards(b.getCards(1,12,2,1*t)),this.deck.addCards(b.getCards(2,1,0,8*t-1)),this.deck.addCards(b.getCards(2,2,0,8*t)),this.deck.addCards(b.getCards(2,12,0,4*t)),this.deck.shuffle(this.rng),this.curDeck=this.deck,this.curDeckIndex=this.curDeck.cards.length-1,this.thePopupCard=new y(0,1,!0)},getFakeValueOf:function(t){var e=Math.ceil(t/20);0==e&&(e=1);var r=20*e,i=0|Math.ceil(r/8);return Math.random()>=.5?t-i-(r*Math.random()|0)|0:t+i+(r*Math.random()|0)|0},getCloserValueTo:function(t,e){var r=t-e;return e+=t>=e?0|Math.ceil(Math.random()*r):0|Math.floor(Math.random()*r)},getFakeValueOfCloserValue:function(t){var e=Math.ceil(t/20);0==e&&(e=1);var r=20*e,i=0|Math.ceil(r/2);return Math.random()>=.5?t-i-(0|Math.floor(r*Math.random()))|0:t+i+(0|Math.ceil(r*Math.random()))|0},getCardResult:function(t){var e=null!=this.thePopupCard,r=null;if(e?r=this.thePopupCard:(r=this.curDeckIndex>=0?this.curDeck.cards[this.curDeckIndex]:null,this.curDeckIndex--),null==r)return x.GAMEOVER_OUTTA_CARDS;this.thePopupCard=null;var i;if(this.curDeckIndex<0)i=4;else{var n=0;i=n}if(r.operator<=5){if(this.polynomial.performOperation(y.toOperation(r)),this.currentPlayerStats.lastMovedTime=(new Date).getTime(),t)return this.polynomial.coefs.length<=1?Math.random()>=.5?x.GUESS_CONSTANT(new y(6,0|this.polynomial.coefs[0],!1,new y(6,this.getFakeValueOf(this.polynomial.coefs[0]),!1)),!1):x.GUESS_CONSTANT(new y(6,this.getFakeValueOf(this.polynomial.coefs[0]),!1,new y(6,0|this.polynomial.coefs[0],!1)),!1):x.PENALIZE({desc:M.LOST_IN_TRANSIT,delayNow:.75});if(this.polynomial.coefs.length<=1)return x.PENALIZE({desc:M.MISSED_STOP,delayNow:2});var a=e?0:1|i;return x.OK(a)}if(6==r.operator){var s=this.wildGuess?this.polynomialValueCached?this.polynomialValue:this.polynomialValue=this.polynomial.evalValueInt(this.secretVarValue):0|this.polynomial.coefs[0],o=this.wildGuess?Math.abs(r.virtualRight.value-s)<Math.abs(r.value-s):r.virtualRight.value==s,h=t?r.virtualRight.value:r.value;if(this._valueChosen=h,t&&o||!t&&!o){if(s!=h)return this.wildGuess||Ri.trace("Should not happen exception occured mismatch with swipe and correct answre for !wildGuess..",{fileName:"TestGame.hx",lineNumber:169,className:"cstrain.rules.TestGame",methodName:"getCardResult"}),x.PENALIZE({desc:M.CLOSER_GUESS(s>h),delayNow:1});this.thePopupCard=new y(0,1,!0),this.secretVarValue=0|Math.ceil(10*Math.random()),this.polynomialValueCached=!1;var l=2|i;return x.OK(l)}return this.wildGuess?x.PENALIZE({delayNow:2,desc:M.FURTHER_GUESS(s>h)}):(this.thePopupCard=new y(0,1,!0),x.PENALIZE({desc:M.WRONG_CONSTANT,delayNow:1}))}var u=r.operator;return Ri.trace("Unaccounted for opreation: "+(0==u?"+":1==u?"-":2==u?"*":4==u?"\\":3==u?"/":6==u?"=":5==u?"(d?/dn) ":"?"),{fileName:"TestGame.hx",lineNumber:194,className:"cstrain.rules.TestGame",methodName:"getCardResult"}),Ri.trace("Exception CardResult.NOTHING detected. Should not happen!",{fileName:"TestGame.hx",lineNumber:198,className:"cstrain.rules.TestGame",methodName:"getCardResult"}),x.NOTHING},restart:function(t,e){Ri.trace([t,e],{fileName:"TestGame.hx",lineNumber:222,className:"cstrain.rules.TestGame",methodName:"restart"}),null==t&&(t=lt.newSeed()),this._startingSeed=t,this.gameSettings.uniqueID=j.getUniqueID(t,e),this._options=e,this.rng=lt._new(t),this.deck=new b,this.thePopupCard=null,this.polynomial=new E,this.wildGuess=!1,this.secretVarValue=0|Math.ceil(10*Math.random()),this.polynomialValueCached=!1,this._lastReceivedTime=0,this._penaltyTime=0,this.commenced=!1,this.currentPlayerStats=new k,this.buildDeck(null!=e&&e.length>0?e[0]:1)},getAllCards:function(){var t=this.deck.cards.concat([]);return t.reverse(),t},playCard:function(t){var e=(new Date).getTime()/1e3*1e3,r=this._penaltyTime>=this.gameSettings.minTurnTime?this._penaltyTime:this.gameSettings.minTurnTime;if(e-this._lastReceivedTime<r)return x.NOT_YET_AVAILABLE(r-(e-this._lastReceivedTime),this._penaltyTime);var i=this.getCardResult(t);switch(i[1]){case 1:switch(i[2].desc[1]){case 0:this.wildGuess=!0,this.currentPlayerStats.lostInTransits++;break;case 1:this.wildGuess=!0;var n=this.polynomialValueCached?this.polynomialValue:this.polynomialValue=this.polynomial.evalValueInt(this.secretVarValue);n!=(0|this.polynomial.coefs[0])&&Ri.trace("Assertion failed values mismatched between secret and constant at constant station!:"+g.string([n,0|this.polynomial.coefs[0]]),{fileName:"TestGame.hx",lineNumber:289,className:"cstrain.rules.TestGame",methodName:"playCard"});var a=this.getFakeValueOf(n),s=this.getFakeValueOf(n);s==a&&(s=this.getFakeValueOfCloserValue(a)),this.thePopupCard=new y(6,a,!1,new y(6,s,!1)),this.currentPlayerStats.missedStops++;break;case 3:case 4:var o=this.wildGuess?this.polynomialValueCached?this.polynomialValue:this.polynomialValue=this.polynomial.evalValueInt(this.secretVarValue):0|this.polynomial.coefs[0],h=(this.polynomialValueCached?this.polynomialValue:this.polynomialValue=this.polynomial.evalValueInt(this.secretVarValue),this.getCloserValueTo(o,this._valueChosen)),l=this.getCloserValueTo(o,this._valueChosen);l==h&&(l=this.getFakeValueOfCloserValue(h)),this.thePopupCard=new y(6,h,!1,new y(6,l,!1))}break;case 2:var u=i[3],R=i[2];this.wildGuess=u;0|this.polynomial.coefs[0];this.thePopupCard=R,this.currentPlayerStats.reachedStops++}if(1==i[1]){var c=i[2];if(null!=c.delayNow&&(c.delayNow*=this.gameSettings.penaltyDelayMs,this._penaltyTime=c.delayNow,c.desc==M.LOST_IN_TRANSIT||c.desc==M.MISSED_STOP)){var _=null!=this._scene?this._scene.getTimeLeft():0;Ri.trace("TIME ADDED:"+_,{fileName:"TestGame.hx",lineNumber:321,className:"cstrain.rules.TestGame",methodName:"playCard"}),this._penaltyTime+=1e3*_,c.delayNow+=1e3*_}}else this._penaltyTime=0;return this._lastReceivedTime=e,this.onCardResult.dispatch(i),i},getPlayerStats:function(){return this.currentPlayerStats},getGameSettings:function(){return this.gameSettings},getTopmostCard:function(){if(!this.commenced){this.commenced=!0;var t=(new Date).getTime()/1e3;this.currentPlayerStats.startTime=1e3*t}return null!=this.thePopupCard?this.thePopupCard:this.curDeckIndex>=0?this.curDeck.cards[this.curDeckIndex]:null},pickAFactor:function(t){for(var e=[],r=0,i=t.length;r<i;){var n=r++,a=t[n];a.coefs.length>1&&e.push(a)}if(0!=e.length){var s=this.rng^this.rng<<11;return e[4.6566128742e-10*(this.rng=this.rng^this.rng>>19^(s^s>>8))*e.length|0]}var o=this.rng^this.rng<<11;return t[4.6566128742e-10*(this.rng=this.rng^this.rng>>19^(o^o>>8))*t.length|0]},arrPolynomialNot1:function(t){return!(t.coefs.length<=1)||1!=Math.abs(t.coefs[0])},getNextCardBelow:function(){var t=null!=this.thePopupCard?this.curDeckIndex>=0?this.curDeck.cards[this.curDeckIndex]:null:this.curDeckIndex>=1?this.curDeck.cards[this.curDeckIndex-1]:null;if(null==t)return null;if(null==this.thePopupCard&&3==t.operator&&null==t.varValues){var e,r=this.curDeckIndex>=0?this.curDeck.cards[this.curDeckIndex]:null;if(r.operator<=5?(e=this.polynomial.performOperationImmutable(y.toOperation(r)),this._lastResultTest=e):(Ri.trace("Unforeseen card expected operatable for getNextCardBelow()",{fileName:"TestGame.hx",lineNumber:397,className:"cstrain.rules.TestGame",methodName:"getNextCardBelow"}),e=E.Copy(this.polynomial)),t.isVar){if(0==e.coefs[0])return t.setPolynomial(E.fromCoefs([0,t.value])),t;var i=e.factorisation();if(i=i.filter(n(this,this.arrPolynomialNot1)),i.length>1){var a=this.pickAFactor(i);t.setPolynomial(a)}else{var s=this.rng^this.rng<<11;4.6566128742e-10*(this.rng=this.rng^this.rng>>19^(s^s>>8))>.5?(t.operator=4,t.setPolynomial(E.fromCoefs([0,t.value]))):t.operator=5}return t}var o=e.findCommonFactor();if(1!=o)return o<=t.value?(t.value=o,t.varValues=U.EMPTY_ARRAY,t):(t.value=o,t.varValues=U.EMPTY_ARRAY,t);var h=this.rng^this.rng<<11;return 4.6566128742e-10*(this.rng=this.rng^this.rng>>19^(h^h>>8))>=.5?(t.operator=4,t.value=o,t.varValues=U.EMPTY_ARRAY):t.operator=5,t}return t},getPolynomial:function(){return this.polynomial},getDeckIndex:function(){return this.curDeck.cards.length-this.curDeckIndex-1},setScene:function(t){this._scene=t},__class__:U};var Y=function(){this.signalDamaged=new ta,this.value=100};a["cstrain.rules.components.Health"]=Y,Y.__name__=["cstrain","rules","components","Health"],Y.prototype={damage:function(t){this.value-=t,this.signalDamaged.dispatch(t,this.value)},__class__:Y};var W=function(){};a["cstrain.rules.monster.IMonsterSpecs"]=W,W.__name__=["cstrain","rules","monster","IMonsterSpecs"];var H=function(t){this.timer=0,this.dance=0,this.headOffset=0,this.frozen=!1,null==t&&(t=new X),this.specs=t,this.state=0,this.angry=!1,this.weaponCooldownTime=t.baseFireRate,this.asleepTime=t.startSleepTime,this.currentPosition=0};a["cstrain.rules.monster.MonsterModel"]=H,H.__name__=["cstrain","rules","monster","MonsterModel"],H.prototype={__class__:H};var X=function(){};a["cstrain.rules.monster.MonsterSpecs"]=X,X.__name__=["cstrain","rules","monster","MonsterSpecs"],X.__interfaces__=[W],X.prototype={__class__:X};var Z=function(){X.call(this),this.baseDamage=1,this.startSleepTime=6,this.baseFireRate=.3,this.baseSpeed=.5,this.baseAttackRange=.5};a["cstrain.rules.monster.StartMonsterSpecs"]=Z,Z.__name__=["cstrain","rules","monster","StartMonsterSpecs"],Z.__super__=X,Z.prototype=e(X.prototype,{dummyAddDifficulty:function(){this.baseSpeed+=.5},__class__:Z});var K=function(){this.maxHealth=100};a["cstrain.rules.player.PlayerSpecs"]=K,K.__name__=["cstrain","rules","player","PlayerSpecs"],K.prototype={__class__:K};var $=function(){};a["ecx.Service"]=$,$.__name__=["ecx","Service"],$.prototype={initialize:function(){},__serviceType:function(){return-1},__allocate:function(){},__inject:function(){},__class__:$};var Q=function(){this._flags=0};a["ecx.System"]=Q,Q.__name__=["ecx","System"],Q.__super__=$,Q.prototype=e($.prototype,{update:function(){},onEntityAdded:function(t,e){},onEntityRemoved:function(t,e){},__configure:function(){},_addFamily:function(t){return null==this._families&&(this._families=[]),this._families.push(t),t.entities},__class__:Q});var J=function(t){Q.call(this),this.gameVue=t};a["cstrain.rules.systems.GameVueDataSystem"]=J,J.__name__=["cstrain","rules","systems","GameVueDataSystem"],J.__super__=Q,J.prototype=e(Q.prototype,{update:function(){var t,e,r,i=this.playerF;for(t=0,e=i.length,r=i.buffer;t!=e;){var n=r[t++],a=n,s=this._train.data[a];this.gameVue.currentProgress=s.get_currentPosition()}var o,h,l,u=this.monsterF;for(o=0,h=u.length,l=u.buffer;o!=h;){var R=l[o++],c=R;this.gameVue.updateMonsterPosition(this._monster.data[c])}},__configure:function(){for(var t=(this.world,new Jt(this.world,this)),e=[0,4],r=null!=e?e.length:0,i=new Array(r),n=0,a=r;n<a;){var s=n++;i[s]=null}t._requiredComponents=i;for(var o=0,h=t._requiredComponents.length;o<h;){var l=o++;t._requiredComponents[l]=t._world._components[e[l]]}this.playerF=this._addFamily(t);for(var u=new Jt(this.world,this),R=[1],c=null!=R?R.length:0,_=new Array(c),f=0,g=c;f<g;){var p=f++;_[p]=null}u._requiredComponents=_;for(var d=0,v=u._requiredComponents.length;d<v;){var m=d++;u._requiredComponents[m]=u._world._components[R[m]]}this.monsterF=this._addFamily(u)},__serviceType:function(){var t=9;return t},__inject:function(){var t=this.world,e=t._services[3];this._monster=e;var r=t._services[2];this._train=r;var i=t._services[11];this._health=i},__class__:J});var tt=function(){this._listenFreeze=!1,Q.call(this)};a["cstrain.rules.systems.MonsterChasePlayerSystem"]=tt,tt.__name__=["cstrain","rules","systems","MonsterChasePlayerSystem"],tt.__super__=Q,tt.prototype=e(Q.prototype,{update:function(){var t,e,r,i,n=this.monsterF;if(e=0,r=n.length,i=n.buffer,e!=r){var a=i[e++];if(t=this._monster.data[a],this._listenFreeze)return t.frozen=!0,t.angry=!1,void(t.state=0);t.frozen=!1;var s,o,h,l=this.player;if(s=0,o=l.length,h=l.buffer,s!=o){var u=this._timeSystem.deltaTime,R=h[s++],c=R,_=this._train.data[c].get_currentPosition(),f=_-t.currentPosition;if(t.asleepTime>0&&(t.asleepTime-=u),t.asleepTime>0)return t.angry=!1,void(t.state=0);t.weaponCooldownTime>0&&(t.weaponCooldownTime-=u);var g=f<0?-f:f;if(g>t.specs.baseAttackRange){t.angry=!1,t.state=f>0?2:1;var p=t.specs.baseSpeed*u;t.currentPosition+=(f>0?1:-1)*(p>=g?g:p)}else{t.angry=!0;var d=this._health.data[c];t.weaponCooldownTime<=0&&(d.damage(t.specs.baseDamage+Math.floor(-t.weaponCooldownTime)*t.specs.baseFireRate),t.weaponCooldownTime=t.specs.baseFireRate);var v=_-t.specs.baseAttackRange,m=2*t.specs.baseAttackRange,y=(t.currentPosition-v)/m;if(t.timer<=0?0==t.state?y<.5?t.state=2:t.state=1:(y<.15625&&2!=t.state&&(t.timer=2),y>.9375&&1!=t.state&&(t.timer=2)):(t.state=0,1.3333333333333333==t.timer&&(t.dance=.6666666666666666),t.timer-=u),1==t.state){var x=2/m*u/30,b=_-t.specs.baseAttackRange-t.currentPosition,w=b<0?-b:b;y-=x>=w?w:x}if(2==t.state){var j=2/m*u/30,T=_+t.specs.baseAttackRange-t.currentPosition,S=T<0?-T:T;y+=j>=S?S:j}t.dance>0&&(t.dance>.5?t.headOffset=2:t.dance>.3333333333333333?t.headOffset=0:t.dance>.16666666666666666?t.headOffset=-2:t.headOffset=0,t.dance-=u),t.currentPosition=v+y*m}}else t.angry=!1,t.state=0}},setRules:function(t){return null==t?void(null!=this._rules&&(this._rules.onCardResult.remove(n(this,this.onCardResultReceived)),this._rules=null)):(null!=this._rules&&this._rules!=t&&this._rules.onCardResult.remove(n(this,this.onCardResultReceived)),this._rules=t,this._rules.onCardResult.add(n(this,this.onCardResultReceived)),void(this._listenFreeze=!0))},onCardResultReceived:function(t){var e=!1;switch(t[1]){case 0:var r=t[2];0!=(6&r)&&(e=!0);break;case 3:return}this._listenFreeze=e},__configure:function(){for(var t=(this.world,new Jt(this.world,this)),e=[4,0],r=null!=e?e.length:0,i=new Array(r),n=0,a=r;n<a;){var s=n++;i[s]=null}t._requiredComponents=i;for(var o=0,h=t._requiredComponents.length;o<h;){var l=o++;t._requiredComponents[l]=t._world._components[e[l]]}this.player=this._addFamily(t);for(var u=new Jt(this.world,this),R=[1],c=null!=R?R.length:0,_=new Array(c),f=0,g=c;f<g;){var p=f++;_[p]=null}u._requiredComponents=_;for(var d=0,v=u._requiredComponents.length;d<v;){
var m=d++;u._requiredComponents[m]=u._world._components[R[m]]}this.monsterF=this._addFamily(u)},__serviceType:function(){var t=0;return t},__inject:function(){var t=this.world,e=t._services[11];this._health=e;var r=t._services[2];this._train=r;var i=t._services[3];this._monster=i;var n=t._services[4];this._timeSystem=n},__class__:tt});var et=function(t,e){this.monsterSpecs=null!=e?e:new Z,this.playerSpecs=null!=t?t:new K;var r=new Lt,i=1,n=2;r.include(new Gt),r.add(this._updateService=new ot),r.add(this._health=new nt),r.add(this._train=new st),r.add(this._monster=new at),r.add(this.monsterChase=new tt,i),r.add(this.vueSystem=new J(null),n),this.world=Ot.createWorld(r,2)};a["cstrain.rules.world.GameWorld"]=et,et.__name__=["cstrain","rules","world","GameWorld"],et.prototype={commence:function(t,e,r){var i=this.world.create();this.playerE=i;var a=this._health,s=new Y;a.data[i]=s;var o=this.health=s;o.signalDamaged.add(n(this,this.onPlayerDamaged)),this._train.data[i]=t,i=this.world.create();var h=this._monster,l=new H(this.monsterSpecs);h.data[i]=l,this.monsterChase.setRules(r),this.vueSystem.gameVue=e,e.maxHealth=this.playerSpecs.maxHealth},onPlayerDamaged:function(t,e){if(e<=0){this._health.data[this.playerE]=null;var r=this.world,i=this.playerE,a=i;0!=(r._activeMask[a>>>5]&1<<(31&a))&&r.markEntityAsChanged(i),this.health.signalDamaged.remove(n(this,this.onPlayerDamaged)),this.health=null}this.vueSystem.gameVue.health=e},end:function(){null!=this.health&&(this.health.signalDamaged.remove(n(this,this.onPlayerDamaged)),this.health=null);for(var t=1,e=this.world.capacity;t<e;){var r=t++,i=(this.world,r);this.world.destroy(i)}this.world.invalidate();var a=this.world;Ri.trace("ENDING:"+(a.capacity-a.used),{fileName:"GameWorld.hx",lineNumber:137,className:"cstrain.rules.world.GameWorld",methodName:"end"})},update:function(t){this._updateService._runner.updateFrame()},__class__:et};var rt=function(){};a["ecx.IComponent"]=rt,rt.__name__=["ecx","IComponent"],rt.prototype={__class__:rt};var it=function(){};a["ecx.AutoComp"]=it,it.__name__=["ecx","AutoComp"],it.__interfaces__=[rt],it.__super__=$,it.prototype=e($.prototype,{has:function(t){return!1},destroy:function(t){},__componentType:function(){return-1},__class__:it});var nt=function(){};a["cstrain.rules.world.HealthComp"]=nt,nt.__name__=["cstrain","rules","world","HealthComp"],nt.__super__=it,nt.prototype=e(it.prototype,{__allocate:function(){for(var t=this.world.capacity,e=new Array(t),r=0,i=t;r<i;){var n=r++;e[n]=null}this.data=e},destroy:function(t){this.data[t]=null},has:function(t){return null!=this.data[t]},__serviceType:function(){var t=11;return t},__componentType:function(){var t=4;return t},__class__:nt});var at=function(){};a["cstrain.rules.world.MonsterModelComp"]=at,at.__name__=["cstrain","rules","world","MonsterModelComp"],at.__super__=it,at.prototype=e(it.prototype,{__allocate:function(){for(var t=this.world.capacity,e=new Array(t),r=0,i=t;r<i;){var n=r++;e[n]=null}this.data=e},destroy:function(t){this.data[t]=null},has:function(t){return null!=this.data[t]},__serviceType:function(){var t=3;return t},__componentType:function(){var t=1;return t},__class__:at});var st=function(){};a["cstrain.rules.world.IBGTrainComp"]=st,st.__name__=["cstrain","rules","world","IBGTrainComp"],st.__super__=it,st.prototype=e(it.prototype,{__allocate:function(){for(var t=this.world.capacity,e=new Array(t),r=0,i=t;r<i;){var n=r++;e[n]=null}this.data=e},destroy:function(t){this.data[t]=null},has:function(t){return null!=this.data[t]},__serviceType:function(){var t=2;return t},__componentType:function(){var t=0;return t},__class__:st});var ot=function(){};a["cstrain.rules.world.UpdateService"]=ot,ot.__name__=["cstrain","rules","world","UpdateService"],ot.__super__=$,ot.prototype=e($.prototype,{initialize:function(){Ri.trace("Update service inited",{fileName:"GameWorld.hx",lineNumber:161,className:"cstrain.rules.world.UpdateService",methodName:"initialize"})},__serviceType:function(){var t=1;return t},__inject:function(){var t=this.world,e=t._services[5];this._runner=e},__class__:ot});var ht=function(){};a["cstrain.util.EaseFunctions"]=ht,ht.__name__=["cstrain","util","EaseFunctions"],ht.linearDistCovered=function(t){return t},ht.linearDistCoveredGetX=function(t){return t},ht.linearDeriative=function(t){return 1},ht.linearDeriativeGetX=function(t){return 0},ht.quadraticDistCovered=function(t){return t*t},ht.quadraticDistCovered_Out=function(t){return t*(2-t)},ht.quadraticDistCoveredGetX=function(t){return Math.sqrt(t)},ht.quadraticDeriative=function(t){return 2*t},ht.quadraticDeriative_Out=function(t){return 2-2*t},ht.quadraticDeriativeGetX=function(t){return t/2},ht.cubicDistCovered=function(t){return t*t*t},ht.cubicDistCovered_Out=function(t){return--t*t*t+1},ht.cubicDistCoveredGetX=function(t){return Math.pow(t,.3333333333333333)},ht.cubicDeriative=function(t){return 3*t*t},ht.cubicDeriative_Out=function(t){return 3*t*t-6*t+3},ht.cubicDeriativeGetX=function(t){return Math.sqrt(t/3)},ht.quarticDistCovered=function(t){return t*t*t*t},ht.quarticDistCovered_Out=function(t){return 1- --t*t*t*t},ht.quarticDistCoveredGetX=function(t){return Math.pow(t,.25)},ht.quarticDeriative=function(t){return 4*t*t*t},ht.quarticDeriative_Out=function(t){return-4*t*t*t+12*t*t-12*t+4*t},ht.quarticDeriativeGetX=function(t){return Math.pow(t/4,.3333333333333333)},ht.quinticDistCovered=function(t){return t*t*t*t*t},ht.quinticDistCovered_Out=function(t){return 1+--t*t*t*t*t},ht.quinticDistCoveredGetX=function(t){return Math.pow(t,.2)},ht.quinticDeriative=function(t){return 5*t*t*t*t},ht.quinticDeriativeGetX=function(t){return Math.pow(t/5,.25)},ht.create=function(t){var e=new ht;switch(t){case 0:e.distCovered=ht.linearDistCovered,e.distCovered_Out=ht.linearDistCovered,e.distCoveredGetX=ht.linearDistCoveredGetX,e.deriative=ht.linearDeriative,e.deriative_Out=ht.linearDeriative,e.deriativeGetX=ht.linearDeriativeGetX;break;case 1:e.distCovered=ht.quadraticDistCovered,e.distCovered_Out=ht.quadraticDistCovered_Out,e.distCoveredGetX=ht.quadraticDistCoveredGetX,e.deriative=ht.quadraticDeriative,e.deriative_Out=ht.quadraticDeriative_Out,e.deriativeGetX=ht.quadraticDeriativeGetX;break;case 2:e.distCovered=ht.cubicDistCovered,e.distCovered_Out=ht.cubicDistCovered_Out,e.distCoveredGetX=ht.cubicDistCoveredGetX,e.deriative=ht.cubicDeriative,e.deriative_Out=ht.cubicDeriative_Out,e.deriativeGetX=ht.cubicDeriativeGetX;break;case 3:e.distCovered=ht.quarticDistCovered,e.distCovered_Out=ht.quarticDistCovered_Out,e.distCoveredGetX=ht.quarticDistCoveredGetX,e.deriative=ht.quarticDeriative,e.deriative_Out=ht.quarticDeriative_Out,e.deriativeGetX=ht.quarticDeriativeGetX;break;case 4:e.distCovered=ht.quinticDistCovered,e.distCovered_Out=ht.quinticDistCovered_Out,e.distCoveredGetX=ht.quinticDistCoveredGetX,e.deriative=ht.quinticDeriative,e.deriative_Out=ht.quinticDistCovered_Out,e.deriativeGetX=ht.quinticDeriativeGetX;break;default:t>0&&Ri.trace("Warning:: no easing functions case found",{fileName:"EaseFunctions.hx",lineNumber:193,className:"cstrain.util.EaseFunctions",methodName:"create"})}return e},ht.prototype={__class__:ht};var lt={};a["cstrain.util._FastRNG.FastRNG_Impl_"]=lt,lt.__name__=["cstrain","util","_FastRNG","FastRNG_Impl_"],lt._new=function(t){var e=null==t?lt.newSeed():t;return e},lt.newSeed=function(){return 2147483647*(2*Math.random()-1)|0};var ut=function(){this._Init()};a["haxevx.vuex.core.VComponent"]=ut,ut.__name__=["haxevx","vuex","core","VComponent"],ut.__super__=Object,ut.prototype=e(Object.prototype,{_Init:function(){},__class__:ut});var Rt=function(){ut.call(this)};a["haxevx.vuex.core.VxComponent"]=Rt,Rt.__name__=["haxevx","vuex","core","VxComponent"],Rt.__super__=ut,Rt.prototype=e(ut.prototype,{__class__:Rt});var ct=function(){Rt.call(this)};a["cstrain.vuex.components.BaseCardView"]=ct,ct.__name__=["cstrain","vuex","components","BaseCardView"],ct.getEmptyBelt=function(t){for(var e=[],r=0,i=t;r<i;){var n=r++;e[n]={card:null}}return e},ct.getBeltData=function(t){return{refCards:ct.getEmptyBelt(t),topCardIndex:t-1,beltAmount:t}},ct.__super__=Rt,ct.prototype=e(Rt.prototype,{Created:function(){this.$data._stack=ee.Stack({throwOutConfidence:n(this,this.confidenceHandler),maxRotation:22,rotation:n(this,this.rotationHandler)}),this.$data._stack.on("throwout",n(this,this.onThrowOut)),this.$data._stack.on("throwoutend",n(this,this.onThrowOutEnd))},rotationHandler:function(t,e,r,i){var n=Math.min(Math.max(t/r.offsetWidth,-1),1),a=(e>0?1:-1)*Math.min(Math.abs(e)/100,1),s=n*a*i;return s+15*n},Components:function(){var t={};return t.CardV=new ft,t},confidenceHandler:function(t,e,r){var i=Math.min(Math.abs(t)/r.offsetWidth,1),n=Math.min(Math.abs(e)/r.offsetHeight,1);return Math.min(1,Math.max(2*i,2*n))},onThrowOutEnd:function(t){var e=t.target,r=g.parseInt(e.getAttribute("index")),i=r<this.beltAmount-1?r+1:0,n=e.parentNode;n.removeChild(e);for(var a=n.firstChild;g.parseInt(a.getAttribute("index"))!=i;)a=a.nextSibling;n.insertBefore(e,a);var s=this.$data._stack.getCard(e);s.throwIn(0,0)},onThrowOut:function(t){var e,r=this,i=this.$data._stack;return e=t.throwDirection!=re.RIGHT?this.$store.dispatch("cstrain_vuex_game_GameActions|swipe",!1):this.$store.dispatch("cstrain_vuex_game_GameActions|swipe",!0),e.then(function(e){switch(e[1]){case 3:case 4:var n=i.getCard(t.target);n.throwIn(0,0);break;default:--r.topCardIndex,r.topCardIndex<0&&(r.topCardIndex=r.beltAmount-1)}}),e},Data:function(){return ct.getBeltData(7)},_Init:function(){var t=ct,e=t.prototype;this.created=e.Created,this.components=this.Components(),this.data=e.Data,this.methods={rotationHandler:e.rotationHandler,confidenceHandler:e.confidenceHandler,onThrowOutEnd:e.onThrowOutEnd,onThrowOut:e.onThrowOut}},__class__:ct});var _t=function(){};a["cstrain.vuex.components.TouchVUtil"]=_t,_t.__name__=["cstrain","vuex","components","TouchVUtil"];var ft=function(){ut.call(this)};a["cstrain.vuex.components.CardV"]=ft,ft.__name__=["cstrain","vuex","components","CardV"],ft.getCardCopy=function(t){var e,r=null!=t.varValues&&t.varValues.length>0,i=t.isVar;if(t.operator<=5){var n=t.operator;e=0==n?"+":1==n?"-":2==n?"*":4==n?"\\":3==n?"/":6==n?"=":5==n?"(d?/dn) ":"?"}else e="";return e+(r?"("+E.PrintOut(t.getPolynomial(),"n",!0)+")":5==t.operator?"":i?"n":t.value+"")},ft.__super__=ut,ft.prototype=e(ut.prototype,{Data:function(){return{}},Mounted:function(){this.$data._card=this.stack.createCard(this.$el)},testReturn:function(t){return!1},get_cardCopy:function(){var t=null!=this.card?this.card.operator<=5?ft.getCardCopy(this.card):ft.getCardCopy(this.card)+" :: "+ft.getCardCopy(this.card.virtualRight):"?";return t},Template:function(){return'\r\n\t\t\t<li class="'+ft.STYLE.card+'" :index="index"><span style="font-size:9px; color:#aaaaaa" v-show="false">{{index}},<slot></slot>:</span>&nbsp;<span v-html="cardCopy"></span></li>\r\n\t\t'},_Init:function(){var t=ft,e=t.prototype;this.data=e.Data,this.mounted=e.Mounted,this.template=this.Template(),this.computed={cardCopy:e.get_cardCopy},this.methods={testReturn:e.testReturn,get_cardCopy:e.get_cardCopy},this.props={card:{type:Object},stack:{type:Object},index:{type:Number}}},__class__:ft});var gt=function(){ct.call(this)};a["cstrain.vuex.components.CardView"]=gt,gt.__name__=["cstrain","vuex","components","CardView"],gt.__super__=ct,gt.prototype=e(ct.prototype,{myData:function(){return this.$data},tickDown:function(){this.$data.secondsLeft--},Data:function(){this.$store.state.game.cards;return{swipedAlready:!1,topCardIndex:6,secondsLeft:0,respawnCount:0,nextBeltCardIndex:7,beltAmount:7,refCards:ct.getEmptyBelt(7)}},Deactivated:function(){null!=this.$data._timer2&&(this.$data._timer2.stop(),this.$data._timer2=null),null!=this.$data._timer&&(this.$data._timer.stop(),this.$data._timer=null)},get_delayTimeInSec:function(){return this.$store.state.game.delayTimeLeft/1e3},startTickDownNow:function(){this.$data._timer=new fi(1e3),this.$data._timer.run=n(this,this.tickDown)},startTickDown:function(){this.$data._timer2=null,this.tickDown(),this.startTickDownNow()},watch_delayTimeInSec:function(t){var e=0|Math.floor(t);if(this.$data.secondsLeft=e+1,t>0){var r=t-(0|t);r>0?this.$data._timer2=fi.delay(n(this,this.startTickDown),1e3*r|0):this.startTickDown()}else null!=this.$data._timer&&(this.$data._timer.stop(),this.$data._timer=null)},swipe:function(t){this.$store.dispatch("cstrain_vuex_game_GameActions|swipe",t)},get_tickStr:function(){return this.$store.game.gameGetters.get_swipedCorrectly()?"✓":"✗"},get_penaltiedStr:function(){return this.$store.game.gameGetters.get_isPenalized()?"!":"..."},get_penaltiedStrStyle:function(){return{color:this.$store.game.gameGetters.get_isPenalized()?"#ff0000":"inherit"}},get_curCardIndex:function(){return this.$store.game.gameGetters.get_curCardIndex()},get_totalCards:function(){return this.$store.game.gameGetters.get_totalCards()},get_gotDelay:function(){return this.$store.state.game.delayTimeLeft>0},onThrowOut:function(t){return this.$data.swipedAlready=!0,ct.prototype.onThrowOut.call(this,t)},getCardForIndex:function(t){var e=this.$store.state.game.topCard,r=this.$store.state.game.nextCardBelow,i=0!=this.$store.state.game.delayTimeLeft,n=this.topCardIndex!=t;return i?null:n?this.topCardIndex-1!=t?null:r:e},isPolynomialForIndex:function(t){var e=this.getCardForIndex(t);return null!=e?null!=e.varValues&&e.varValues.length>0&&e.varValues.length>1:null},get_penaltyDesc:function(){return this.$store.game.gameGetters.get_simplePenaltyPhrase()},get_showStack:function(){return this.$store.game.gameGetters.get_cardsLeft()>0},getProjectedIndexOffset:function(t){var e=this.beltAmount;return t<=this.topCardIndex?this.topCardIndex-t:e-t+this.topCardIndex},getProjectedCardIndex:function(t){var e=!this.$store.game.gameGetters.get_isMainDeckCard(),r=this.curCardIndex,i=r+this.getProjectedIndexOffset(t);return e?r==t?-1:i-1:i},isVisibleProjected:function(t){return this.getProjectedCardIndex(t)<this.$store.game.gameGetters.get_totalCards()},get_showUniqueID:function(){return!this.$data.swipedAlready},get_uniqueID:function(){return this.$store.state.game.settings.uniqueID},get_isAtStop:function(){return this.$store.game.gameGetters.get_isAtStop()},get_isAtStopReady:function(){return this.$store.game.gameGetters.get_isAtStopReadyToGo()},Template:function(){return'\r\n\t\t\t<div class="'+gt.STYLE.cardview+'">\r\n\t\t\t\t<div class="'+gt.STYLE.hudIndicators+'">\r\n\t\t\t\t\t<h3>{{ tickStr }} <span :style="penaltiedStrStyle">{{ penaltiedStr }}</span> &nbsp; {{ curCardIndex}} / {{ totalCards}}<span v-show="isAtStop" class="fa fa-train '+gt.mySTYLE.icon+" "+gt.mySTYLE.stopIcon+'" :class="{ \''+gt.mySTYLE.ready+'\':isAtStopReady }"></span></h3>\r\n\t\t\t\t</div>\r\n\t\t\t\t\r\n\t\t\t\t<h4 style="font-size:9px" v-show="false">{{ topCardIndex}}</h4>\r\n\t\t\t\t<ul class="'+gt.STYLE.cardstack+'">\r\n\t\t\t\t\t<CardV v-for="(ref, i) in refCards" :card="getCardForIndex(i)" :style="{\'visibility\': isVisibleProjected(i) ? \'visible\' : \'hidden\' }" :class="{\''+ft.STYLE.polynomial+'\':isPolynomialForIndex(i)}" :stack="$data._stack" :index="i" :key="i"></CardV>\r\n\t\t\t\t</ul>\r\n\t\t\t\t\r\n\t\t\t\t<div class="'+gt.STYLE.delayPopup+'" v-show="gotDelay ">\r\n\t\t\t\t\t<div class="'+gt.STYLE.content+'">\r\n\t\t\t\t\t\t<h4 >{{ penaltyDesc }}!</h4>\r\n\t\t\t\t\t\t<div class="">{{ secondsLeft }}   seconds left.</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t\r\n\t\t\t\t<div v-show="showUniqueID" class="'+gt.STYLE.delayPopup+" "+gt.STYLE.uniqueid+'">\r\n\t\t\t\t\t<div class="'+gt.STYLE.content+'">\r\n\t\t\t\t\t\t<h2 class="">{{ uniqueID }}</h2>\r\n\t\t\t\t\t\t<p>Before your first swipe, challenge friend(s) to join you on the above ID to race them live!</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t'},_Init:function(){var t=gt,e=t.prototype;ct.prototype._Init.call(this),this.data=e.Data,this.deactivated=e.Deactivated,this.template=this.Template(),Bi.dynamicSetOverwrite(null!=this.computed?this.computed:this.computed={},{delayTimeInSec:e.get_delayTimeInSec,tickStr:e.get_tickStr,penaltiedStr:e.get_penaltiedStr,curCardIndex:e.get_curCardIndex,totalCards:e.get_totalCards,gotDelay:e.get_gotDelay,penaltyDesc:e.get_penaltyDesc,showStack:e.get_showStack,showUniqueID:e.get_showUniqueID,uniqueID:e.get_uniqueID,penaltiedStrStyle:e.get_penaltiedStrStyle,isAtStop:e.get_isAtStop,isAtStopReady:e.get_isAtStopReady}),Bi.dynamicSetOverwrite(null!=this.methods?this.methods:this.methods={},{myData:e.myData,tickDown:e.tickDown,get_delayTimeInSec:e.get_delayTimeInSec,startTickDownNow:e.startTickDownNow,startTickDown:e.startTickDown,watch_delayTimeInSec:e.watch_delayTimeInSec,swipe:e.swipe,get_tickStr:e.get_tickStr,get_penaltiedStr:e.get_penaltiedStr,get_penaltiedStrStyle:e.get_penaltiedStrStyle,get_curCardIndex:e.get_curCardIndex,get_totalCards:e.get_totalCards,get_gotDelay:e.get_gotDelay,onThrowOut:e.onThrowOut,getCardForIndex:e.getCardForIndex,isPolynomialForIndex:e.isPolynomialForIndex,get_penaltyDesc:e.get_penaltyDesc,get_showStack:e.get_showStack,getProjectedIndexOffset:e.getProjectedIndexOffset,getProjectedCardIndex:e.getProjectedCardIndex,isVisibleProjected:e.isVisibleProjected,get_showUniqueID:e.get_showUniqueID,get_uniqueID:e.get_uniqueID,get_isAtStop:e.get_isAtStop,get_isAtStopReady:e.get_isAtStopReady}),this.watch={delayTimeInSec:e.watch_delayTimeInSec}},__class__:gt});var pt=function(){Rt.call(this)};a["cstrain.vuex.components.GameMenu"]=pt,pt.__name__=["cstrain","vuex","components","GameMenu"],pt.__super__=Rt,pt.prototype=e(Rt.prototype,{Data:function(){return{joinKey:"",gameOptions:[1]}},loseInputFocus:function(){window.scrollTo(0,0)},beginGame:function(){this.$store.dispatch("cstrain_vuex_game_GameMenuActions|newGame",{options:{options:this.gameOptions},store:this.$store}),window.scrollTo(0,0)},get_joinEnabled:function(){return null!=this.joinKey&&""!=this.joinKey},joinGame:function(t){this.joinEnabled?this.$store.dispatch("cstrain_vuex_game_GameMenuActions|joinGame",{joinCode:this.joinKey,store:this.$store}):null!=t&&t.preventDefault()},Template:function(){return'<div class="'+pt.STYLE.gameMenu+'">\r\n\t\t\t<h2>New Game</h2>\r\n\t\t\t<div class="'+pt.STYLE.gametitle+'">TestGame</div>\r\n\t\t\t<div class="'+pt.STYLE.gameOpts+'">\r\n\t\t\t\t<label for="gameoption_1">Length of Race:</label>\r\n\t\t\t\t<select id="gameoption_1" v-model.number="gameOptions[0]" v-on:blur="loseInputFocus()">\r\n\t\t\t\t\t<option :value="n" v-for="n in 8">{{n}}</option>\r\n\t\t\t\t</select>\r\n\t\t\t</div>\r\n\t\t\t<br/>\r\n\t\t\t<div class="'+pt.STYLE.btnZone+'">\r\n\t\t\t\t<touch tag="button"  v-on:tap="beginGame()">Begin</touch>\r\n\t\t\t</div>\r\n\t\t\t<hr/>\r\n\t\t\t<h2>Join Game</h2>\r\n\t\t\t<input type="text" v-model="joinKey" v-on:blur="loseInputFocus()"></input>\r\n\t\t\t<div class="'+pt.STYLE.btnZone+'">\r\n\t\t\t\t<touch tag="button" v-on:tap="joinGame($event)">Connect</touch>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t'},_Init:function(){var t=pt,e=t.prototype;this.data=e.Data,this.template=this.Template(),this.computed={joinEnabled:e.get_joinEnabled},this.methods={loseInputFocus:e.loseInputFocus,beginGame:e.beginGame,get_joinEnabled:e.get_joinEnabled,joinGame:e.joinGame}},__class__:pt});var dt=function(){Rt.call(this)};a["cstrain.vuex.components.GameView"]=dt,dt.__name__=["cstrain","vuex","components","GameView"],dt.__super__=Rt,dt.prototype=e(Rt.prototype,{Components:function(){var t={};return t.CardView=new gt,t.PopupCardView=new mt,t.TrainProgressBarView=new yt,t},Created:function(){this.$store.commit("cstrain_vuex_game_GameMutator|resume"),this.$store.state.game._signalUpdate.add((aa=this.$store.state.game._gameWorld,n(aa,aa.update)))},myUpdate:function(t){},toggleExpression:function(){this.$store.commit("cstrain_vuex_game_GameMutator|showOrHideExpression")},get_showInstructions:function(){return this.$store.game.gameGetters.get_showInstructions()},toggleInstructions:function(){this.$store.commit("cstrain_vuex_game_GameMutator|toggleInstructions")},get_helpBtnShown:function(){return 0==this.$store.state.game.delayTimeLeft},get_showGameOver:function(){return this.$store.game.gameGetters.get_cardsLeft()<=0&&this.$store.state.game.cardsOutDetected},quitGame:function(){this.$store.dispatch("cstrain_vuex_game_GameMenuActions|quitGame",this.$store)},get_gotHealth:function(){return null!=this.$store.state.game.vueData},get_HPStyle:function(){return{transform:"scaleY("+this.$store.game.gameGetters.get_healthRatio()+")"}},get_healthAmt:function(){return this.$store.game.gameGetters.get_healthInt()},get_isAlive:function(){return this.$store.game.gameGetters.get_isAliveHP()},Template:function(){var t="";return'\r\n\t\t\t<div class="'+dt.STYLE.gameview+'">\r\n\t\t\t\t<TrainProgressBarView />\r\n\t\t\t\t<touch tag="a" class="'+dt.STYLE.quitbtn+'" style="cursor:pointer" v-on:tap="quitGame()" >\r\n\t\t\t\t\t[quit]\r\n\t\t\t\t</touch>\r\n\t\t\t\t<keep-alive>\r\n\t\t\t\t\t<CardView v-show="isAlive"></CardView>\r\n\t\t\t\t</keep-alive>\r\n\t\t\t\t<PopupCardView v-show="isAlive"></PopupCardView>\r\n\t\t\t\t<div class="'+dt.STYLE.healthBar+'" v-if="gotHealth">\r\n\t\t\t\t\t<div class="'+dt.STYLE.healthLabel+'">{{  healthAmt }}</div>\r\n\t\t\t\t\t<div class="'+dt.STYLE.meter+'" v-bind:style="HPStyle"></div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="'+dt.STYLE.blocker+'" v-show="showInstructions" :class="{\''+dt.STYLE.showInstruct+'\':showInstructions}"></div>\r\n\t\t\t\t<div v-if="cardResult">\r\n\t\t\t\t\t<p>{{ cardResult }}</p>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="'+dt.STYLE.xpression+'" style="font-style:italic" v-html="polyexpression"></div>\r\n\t\t\t\t<br/>\r\n\t\t\t\t'+t+'\r\n\t\t\t\t<div class="'+dt.STYLE.gameover+'" v-show="showGameOver && isAlive">\r\n\t\t\t\t\t<div class="'+dt.STYLE.anim+'">\r\n\t\t\t\t\t\t<h1>Congratulations!</h1>\r\n\t\t\t\t\t\t<h2>You\'ve finished the race!</h2>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class="'+dt.STYLE.gameover+'" v-show="!isAlive">\r\n\t\t\t\t\t<div class="'+dt.STYLE.anim+'">\r\n\t\t\t\t\t\t<h1>Game Over!</h1>\r\n\t\t\t\t\t\t<h2>You died!</h2>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t'},get_currentCard:function(){return this.$store.state.game.topCard},get_cardResult:function(){return this.$store.state.game.cardResult},get_toggleExprLabel:function(){return this.$store.state.game.showExpression?"Hide":"Show"},get_polyexpression:function(){return this.$store.game.gameGetters.get_polynomialExpr()},_Init:function(){var t=dt,e=t.prototype;this.components=this.Components(),this.created=e.Created,this.template=this.Template(),this.computed={currentCard:e.get_currentCard,cardResult:e.get_cardResult,polyexpression:e.get_polyexpression,toggleExprLabel:e.get_toggleExprLabel,showInstructions:e.get_showInstructions,helpBtnShown:e.get_helpBtnShown,showGameOver:e.get_showGameOver,gotHealth:e.get_gotHealth,HPStyle:e.get_HPStyle,healthAmt:e.get_healthAmt,isAlive:e.get_isAlive},this.methods={myUpdate:e.myUpdate,toggleExpression:e.toggleExpression,get_showInstructions:e.get_showInstructions,toggleInstructions:e.toggleInstructions,get_helpBtnShown:e.get_helpBtnShown,get_showGameOver:e.get_showGameOver,quitGame:e.quitGame,get_gotHealth:e.get_gotHealth,get_HPStyle:e.get_HPStyle,get_healthAmt:e.get_healthAmt,get_isAlive:e.get_isAlive,get_currentCard:e.get_currentCard,get_cardResult:e.get_cardResult,get_toggleExprLabel:e.get_toggleExprLabel,get_polyexpression:e.get_polyexpression}},__class__:dt});var vt=function(){Rt.call(this)};a["cstrain.vuex.components.MainVue"]=vt,vt.__name__=["cstrain","vuex","components","MainVue"],vt.__super__=Rt,vt.prototype=e(Rt.prototype,{Components:function(){var t={};return t.GameView=new dt,t.GameMenu=new pt,t},get_gameInProgress:function(){return null!=this.$store.state.game},Template:function(){return'\r\n\t\t\t<div>\r\n\t\t\t\t<GameMenu v-if="!gameInProgress" />\r\n\t\t\t\t<GameView v-if="gameInProgress"/>\r\n\t\t\t</div>\r\n\t\t'},_Init:function(){var t=vt,e=t.prototype;this.components=this.Components(),this.template=this.Template(),this.computed={gameInProgress:e.get_gameInProgress},this.methods={get_gameInProgress:e.get_gameInProgress}},__class__:vt});var mt=function(){ct.call(this)};a["cstrain.vuex.components.PopupCardView"]=mt,mt.__name__=["cstrain","vuex","components","PopupCardView"],mt.__super__=ct,mt.prototype=e(ct.prototype,{Data:function(){return ct.getBeltData(7)},getCardForIndex:function(t){var e=0!=this.$store.state.game.delayTimeLeft,r=this.topCardIndex!=t;return e?null:r?(this.topCardIndex-1!=t,null):this.$store.state.game.topCard},get_isPopupChoicing:function(){return this.$store.game.gameGetters.get_isPopupChoicing()},Template:function(){return'\r\n\t\t\t<div class="'+mt.STYLE.popupCardview+'" :class="{\''+mt.STYLE.shown+'\':isPopupChoicing}">\r\n\t\t\t\t<h4 v-show="false" style="position: absolute;right: 5px;top: 100vh;transform: translateY(-50px);">{{ topCardIndex}}</h4>\r\n\t\t\t\t<ul class="'+mt.STYLE.cardstack+'">\r\n\t\t\t\t\t<CardV v-for="(ref, i) in refCards" :card="getCardForIndex(i)" :stack="$data._stack" :index="i" :key="i"></CardV>\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\t\t'},_Init:function(){var t=mt,e=t.prototype;ct.prototype._Init.call(this),this.data=e.Data,this.template=this.Template(),Bi.dynamicSetOverwrite(null!=this.computed?this.computed:this.computed={},{isPopupChoicing:e.get_isPopupChoicing}),Bi.dynamicSetOverwrite(null!=this.methods?this.methods:this.methods={},{getCardForIndex:e.getCardForIndex,get_isPopupChoicing:e.get_isPopupChoicing})},__class__:mt});var yt=function(){Rt.call(this)};a["cstrain.vuex.components.TrainProgressBarView"]=yt,yt.__name__=["cstrain","vuex","components","TrainProgressBarView"],yt.__super__=Rt,yt.prototype=e(Rt.prototype,{get_scrubberStyle:function(){var t=100*this.$store.game.gameGetters.get_progress();return{transform:"translateX("+t+"%)"}},get_scrubberStyleMonster:function(){var t=100*this.$store.game.gameGetters.get_monsterProgress();return{transform:"translateX("+t+"%)"}},get_scrubStyle:function(){var t=this.$store.game.gameGetters.get_progressUnit();return{width:100*t+"%"}},get_scrubStyleMonster:function(){var t=this.$store.game.gameGetters.get_progressUnit();return{width:100*t*this.$store.game.gameGetters.get_monsterRangeScale()+"%"}},Template:function(){return'\r\n\t\t<div class="'+yt.STYLE.trainprogressBar+'">\r\n\t\t\t<div class="'+yt.STYLE.scrubber+'" v-bind:style="scrubberStyle">\r\n\t\t\t\t<div class="'+yt.STYLE.scrub+'" v-bind:style="scrubStyle">\r\n\t\t\t\t\t<div class="fa fa-angle-up '+yt.STYLE.marker+'"></div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class="'+yt.STYLE.scrubber+'" v-bind:style="scrubberStyleMonster">\r\n\t\t\t\t<div class="'+yt.STYLE.enemyScrub+'" v-bind:style="scrubStyleMonster">\r\n\t\t\t\t\t<div class="fa fa-angle-down '+yt.STYLE.marker+'"></div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>'},_Init:function(){var t=yt,e=t.prototype;this.template=this.Template(),this.computed={scrubberStyle:e.get_scrubberStyle,scrubberStyleMonster:e.get_scrubberStyleMonster,scrubStyle:e.get_scrubStyle,scrubStyleMonster:e.get_scrubStyleMonster},this.methods={get_scrubberStyle:e.get_scrubberStyle,get_scrubberStyleMonster:e.get_scrubberStyleMonster,get_scrubStyle:e.get_scrubStyle,get_scrubStyleMonster:e.get_scrubStyleMonster}},__class__:yt});var xt=function(){};a["cstrain.vuex.game.GameActions"]=xt,xt.__name__=["cstrain","vuex","game","GameActions"],xt.clearTimer=function(){null!=xt.TIMER&&(xt.TIMER.stop(),xt.TIMER=null)},xt.prototype={swipe:function(t,e){return new Promise(function(r,i){var n=t.state._rules.playCard(e);switch(n[1]){case 4:case 5:break;default:t.commit("cstrain_vuex_game_GameMutator|notifySwipe",e?2:1)}switch(n[1]){case 0:var a=n[2];t.commit("cstrain_vuex_game_GameMutator|setPenalty",null),t.commit("cstrain_vuex_game_GameMutator|updateProgress"),0!=(4&a)&&(t.state.cardsOutDetected=!0,t.commit("cstrain_vuex_store_GameStoreMutator|saveGameForNextLevel",{LAST_MONSTER_SPECS:t.state._monsterSpecs,LAST_PLAYER_SPECS:t.state._playerSpecs})),t.commit("cstrain_vuex_game_GameMutator|resume");break;case 1:var s=n[2];if(t.commit("cstrain_vuex_game_GameMutator|setPenalty",s),s.desc!=M.MISSED_STOP&&s.desc!=M.LOST_IN_TRANSIT||(s.desc==M.MISSED_STOP&&t.commit("cstrain_vuex_game_GameMutator|encounterStationStop"),t.commit("cstrain_vuex_game_GameMutator|updateProgress")),null!=s.delayNow){var o=s.delayNow;t.commit("cstrain_vuex_game_GameMutator|setDelay",o),s.delayNow>0?xt.TIMER=fi.delay(function(){xt.TIMER=null,t.commit("cstrain_vuex_game_GameMutator|setDelay",0),null!=t.state.curPenalty&&t.state.curPenalty.desc==M.WRONG_CONSTANT&&t.commit("cstrain_vuex_game_GameMutator|setPenalty",null),t.commit("cstrain_vuex_game_GameMutator|resume")},0|o):t.commit("cstrain_vuex_game_GameMutator|resume")}var h=s.desc;4==h[1]?t.commit("cstrain_vuex_game_GameMutator|setPenaltySwipeCorrect",!0):t.commit("cstrain_vuex_game_GameMutator|setPenaltySwipeCorrect",!1);break;case 2:n[3],n[2];t.commit("cstrain_vuex_game_GameMutator|encounterStationStop"),t.commit("cstrain_vuex_game_GameMutator|updateProgress"),t.commit("cstrain_vuex_game_GameMutator|resume");break;case 4:var l=n[3],u=n[2];Ri.trace("Not yet available to swipe!:"+g.string([u,l]),{fileName:"GameActions.hx",lineNumber:114,className:"cstrain.vuex.game.GameActions",methodName:"swipe"});break;case 5:t.commit("cstrain_vuex_game_GameMutator|traceCardResult",n);break;default:Ri.trace("Uncaught case: "+g.string(n),{fileName:"GameActions.hx",lineNumber:122,className:"cstrain.vuex.game.GameActions",methodName:"swipe"})}r(n)})},_SetInto:function(t,e){var r=xt,i=r.prototype;t[e+"cstrain_vuex_game_GameActions|swipe"]=i.swipe},__class__:xt};var bt=function(){};a["cstrain.vuex.game.GameGetters"]=bt,bt.__name__=["cstrain","vuex","game","GameGetters"],bt.Get_polynomialExpr=function(t){return t.showExpression?null!=t.polynomial?E.PrintOut(t.polynomial,"n",!0):"..":""},bt.Get_simpleChosenNumber=function(t){return null!=t._chosenCard?2==t.chosenSwipe?t._chosenCard.virtualRight.value:t._chosenCard.value:0},bt.Get_notChosenNumber=function(t){return null!=t._chosenCard?2==t.chosenSwipe?t._chosenCard.value:t._chosenCard.virtualRight.value:0},bt.Get_isPenalized=function(t){return null!=t.curPenalty},bt.Get_cardsLeft=function(t){return(null!=t.cards?t.cards.length:0)-t.curCardIndex},bt.Get_healthInt=function(t){return t.vueData.health>=1?0|t.vueData.health:t.vueData.health>0?1:0},bt.Get_healthRatio=function(t){return(t.vueData.health>=1?0|t.vueData.health:t.vueData.health>0?1:0)/t.vueData.maxHealth},bt.Get_isAliveHP=function(t){return(t.vueData.health>=1?0|t.vueData.health:t.vueData.health>0?1:0)>0},bt.Get_isPopupChoicing=function(t){return null!=t.topCard&&6==t.topCard.operator},bt.Get_isAtStop=function(t){var e=null!=t.topCard&&t.topCard!=t.cards[t.curCardIndex],r=null!=t.topCard&&6==t.topCard.operator;return null!=t.curPenalty?r:e},bt.Get_isAtStopReadyToGo=function(t){return!(!bt.Get_isAtStop(t)||null!=t.topCard&&6==t.topCard.operator)&&null==t.curPenalty},bt.Get_isMainDeckCard=function(t){return t.topCard==(t.curCardIndex<t.cards.length?t.cards[t.curCardIndex]:null)},bt.Get_progressUnit=function(t){return 1/(null!=t.cards?t.cards.length:0)},bt.Get_progress=function(t){return t.vueData.currentProgress/t.cards.length},bt.Get_monsterProgress=function(t){return null!=t.vueData&&null!=t.vueData.monster?t.vueData.monster.position/t.cards.length:0},bt.Get_monsterRangeScale=function(t){return null!=t.vueData&&null!=t.vueData.monster?t.vueData.monster.range:1},bt.Get_swipedCorrectly=function(t){return null==t.curPenalty||t.penaltySwipeCorrect},bt.Get_showInstructions=function(t){return t.showInstructions},bt.Get_totalCards=function(t){return null!=t.cards?t.cards.length:0},bt.Get_curCardIndex=function(t){return t.curCardIndex},bt.Get_simplePenaltyPhrase=function(t){var e=t.curPenalty;if(null==e)return"Unknown reason delay!";var r=e.desc;switch(r[1]){case 0:return"Lost in transit...";case 1:return"You missed a stop!";case 2:return"Oops, Guessed constant wrongly. The answer is "+(null!=t._chosenCard?2==t.chosenSwipe?t._chosenCard.value:t._chosenCard.virtualRight.value:0)+"!";
case 3:var i=r[2];return"You guessed "+(null!=t._chosenCard?2==t.chosenSwipe?t._chosenCard.virtualRight.value:t._chosenCard.value:0)+", which is a further answer. Guess "+(i?"higher":"lower")+"!";case 4:var n=r[2];return"You guessed "+(null!=t._chosenCard?2==t.chosenSwipe?t._chosenCard.virtualRight.value:t._chosenCard.value:0)+", which is a closer answer. Guess "+(n?"higher":"lower")+"!"}},bt.prototype={get_polynomialExpr:function(){return this._stg[this._+"polynomialExpr_cstrain_vuex_game_GameGetters"]},get_simpleChosenNumber:function(){return this._stg[this._+"simpleChosenNumber_cstrain_vuex_game_GameGetters"]},get_notChosenNumber:function(){return this._stg[this._+"notChosenNumber_cstrain_vuex_game_GameGetters"]},get_isPenalized:function(){return this._stg[this._+"isPenalized_cstrain_vuex_game_GameGetters"]},get_cardsLeft:function(){return this._stg[this._+"cardsLeft_cstrain_vuex_game_GameGetters"]},get_healthInt:function(){return this._stg[this._+"healthInt_cstrain_vuex_game_GameGetters"]},get_healthRatio:function(){return this._stg[this._+"healthRatio_cstrain_vuex_game_GameGetters"]},get_isAliveHP:function(){return this._stg[this._+"isAliveHP_cstrain_vuex_game_GameGetters"]},get_isPopupChoicing:function(){return this._stg[this._+"isPopupChoicing_cstrain_vuex_game_GameGetters"]},get_isAtStop:function(){return this._stg[this._+"isAtStop_cstrain_vuex_game_GameGetters"]},get_isAtStopReadyToGo:function(){return this._stg[this._+"isAtStopReadyToGo_cstrain_vuex_game_GameGetters"]},get_isMainDeckCard:function(){return this._stg[this._+"isMainDeckCard_cstrain_vuex_game_GameGetters"]},get_progressUnit:function(){return this._stg[this._+"progressUnit_cstrain_vuex_game_GameGetters"]},get_progress:function(){return this._stg[this._+"progress_cstrain_vuex_game_GameGetters"]},get_monsterProgress:function(){return this._stg[this._+"monsterProgress_cstrain_vuex_game_GameGetters"]},get_monsterRangeScale:function(){return this._stg[this._+"monsterRangeScale_cstrain_vuex_game_GameGetters"]},get_swipedCorrectly:function(){return this._stg[this._+"swipedCorrectly_cstrain_vuex_game_GameGetters"]},get_showInstructions:function(){return this._stg[this._+"showInstructions_cstrain_vuex_game_GameGetters"]},get_totalCards:function(){return this._stg[this._+"totalCards_cstrain_vuex_game_GameGetters"]},get_curCardIndex:function(){return this._stg[this._+"curCardIndex_cstrain_vuex_game_GameGetters"]},get_simplePenaltyPhrase:function(){return this._stg[this._+"simplePenaltyPhrase_cstrain_vuex_game_GameGetters"]},_SetInto:function(t,e){this._=e,Di.stack.push(this);var r=bt;t[e+"polynomialExpr_cstrain_vuex_game_GameGetters"]=r.Get_polynomialExpr,t[e+"simpleChosenNumber_cstrain_vuex_game_GameGetters"]=r.Get_simpleChosenNumber,t[e+"notChosenNumber_cstrain_vuex_game_GameGetters"]=r.Get_notChosenNumber,t[e+"isPenalized_cstrain_vuex_game_GameGetters"]=r.Get_isPenalized,t[e+"cardsLeft_cstrain_vuex_game_GameGetters"]=r.Get_cardsLeft,t[e+"healthInt_cstrain_vuex_game_GameGetters"]=r.Get_healthInt,t[e+"healthRatio_cstrain_vuex_game_GameGetters"]=r.Get_healthRatio,t[e+"isAliveHP_cstrain_vuex_game_GameGetters"]=r.Get_isAliveHP,t[e+"isPopupChoicing_cstrain_vuex_game_GameGetters"]=r.Get_isPopupChoicing,t[e+"isAtStop_cstrain_vuex_game_GameGetters"]=r.Get_isAtStop,t[e+"isAtStopReadyToGo_cstrain_vuex_game_GameGetters"]=r.Get_isAtStopReadyToGo,t[e+"isMainDeckCard_cstrain_vuex_game_GameGetters"]=r.Get_isMainDeckCard,t[e+"progressUnit_cstrain_vuex_game_GameGetters"]=r.Get_progressUnit,t[e+"progress_cstrain_vuex_game_GameGetters"]=r.Get_progress,t[e+"monsterProgress_cstrain_vuex_game_GameGetters"]=r.Get_monsterProgress,t[e+"monsterRangeScale_cstrain_vuex_game_GameGetters"]=r.Get_monsterRangeScale,t[e+"swipedCorrectly_cstrain_vuex_game_GameGetters"]=r.Get_swipedCorrectly,t[e+"showInstructions_cstrain_vuex_game_GameGetters"]=r.Get_showInstructions,t[e+"totalCards_cstrain_vuex_game_GameGetters"]=r.Get_totalCards,t[e+"curCardIndex_cstrain_vuex_game_GameGetters"]=r.Get_curCardIndex,t[e+"simplePenaltyPhrase_cstrain_vuex_game_GameGetters"]=r.Get_simplePenaltyPhrase},_InjNative:function(t){this._stg=t},__class__:bt};var wt=function(){};a["cstrain.vuex.game.GameMenuActions"]=wt,wt.__name__=["cstrain","vuex","game","GameMenuActions"],wt.prototype={newGame:function(t,e){var r=new U;r.setScene(wt.BGTRAIN),r.restart(e.options.seed,e.options.options);var i=new St(r,wt.BGTRAIN,t.state._savedLevelStats),n=e.store;i._Init("game/"),n.game=i,n.registerModule("game",i),Pi.clearModuleInjStack(n),t.commit("cstrain_vuex_game_GameMutator|restart")},joinGame:function(t,e){var r=new U;r.setScene(wt.BGTRAIN),r.restart(j.getSeedFromUniqueId(e.joinCode),j.getOptionsFromUniqueId(e.joinCode));var i=new St(r,wt.BGTRAIN,t.state._savedLevelStats),n=e.store;i._Init("game/"),n.game=i,n.registerModule("game",i),Pi.clearModuleInjStack(n),t.commit("cstrain_vuex_game_GameMutator|restart")},quitGame:function(t,e){xt.clearTimer(),t.state.game._signalUpdate.removeAll(),t.state.game._gameWorld.end(),e.unregisterModule("game"),wt.BGTRAIN.resetTo(0)},_SetInto:function(t,e){var r=wt,i=r.prototype;t[e+"cstrain_vuex_game_GameMenuActions|newGame"]=i.newGame,t[e+"cstrain_vuex_game_GameMenuActions|joinGame"]=i.joinGame,t[e+"cstrain_vuex_game_GameMenuActions|quitGame"]=i.quitGame},__class__:wt};var jt=function(){};a["haxevx.vuex.core.IModule"]=jt,jt.__name__=["haxevx","vuex","core","IModule"];var Tt=function(){};a["haxevx.vuex.core.VModule"]=Tt,Tt.__name__=["haxevx","vuex","core","VModule"],Tt.__interfaces__=[jt],Tt.prototype={_InjNative:function(t){this._stg=t},__class__:Tt};var St=function(t,e,r){if(null==St.gameWorld)null==r?St.gameWorld=new et:St.gameWorld=new et(r.LAST_PLAYER_SPECS,r.LAST_MONSTER_SPECS);else if(null!=r){var i=St.gameWorld,n=r.LAST_PLAYER_SPECS,a=r.LAST_MONSTER_SPECS;i.monsterSpecs=null!=a?a:new Z,i.playerSpecs=null!=n?n:new K}this.rules=t,this.bgTrain=e,this.state=new Mt(t)};a["cstrain.vuex.game.GameModule"]=St,St.__name__=["cstrain","vuex","game","GameModule"],St.__super__=Tt,St.prototype=e(Tt.prototype,{_InjNative:function(t){Tt.prototype._InjNative.call(this,t),this.state._rules=this.rules,this.state._bgTrain=this.bgTrain,this.state._gameWorld=St.gameWorld,this.state._monsterSpecs=St.gameWorld.monsterSpecs,this.state._playerSpecs=St.gameWorld.playerSpecs,this.state._signalUpdate=O.signalUpdate;var e=new kt;new Vue({data:e}),this.state.vueData=e,St.gameWorld.commence(this.bgTrain,e,this.rules)},_Init:function(t){this._=t,Di.stack.push(this),null!=this.state?this.state._=t:this.state={_:t};var e,r=t,i=St;i.prototype;e={},this.getters=e,this.gameGetters=new bt,this.gameGetters._SetInto(e,r),e={},this.mutations=e,(new Ct)._SetInto(e,""),e={},this.actions=e,(new xt)._SetInto(e,"")},__class__:St});var Ct=function(){};a["cstrain.vuex.game.GameMutator"]=Ct,Ct.__name__=["cstrain","vuex","game","GameMutator"],Ct.Get_currentProgress=function(t){var e=null!=t._bgTrain,r=t.curCardIndex;return e&&(r=t._bgTrain.get_currentPosition()),r},Ct.prototype={restart:function(t){t.setupWithRules(t._rules)},notifySwipe:function(t,e){t.chosenSwipe=e,0!=e&&(t._chosenCard=t.topCard)},toggleInstructions:function(t){t.showInstructions=!t.showInstructions},updateProgress:function(t){t.curCardIndex=t._rules.getDeckIndex(),null!=t._bgTrain&&t._bgTrain.travelTo(t.curCardIndex)},setPenalty:function(t,e){t.curPenalty=e},setPenaltySwipeCorrect:function(t,e){t.penaltySwipeCorrect=e},setDelay:function(t,e){t.delayTimeLeft=e},traceCardResult:function(t,e){t.cardResult=e},encounterStationStop:function(t){t.stopsEncountedSoFar++},resume:function(t){t.penaltySwipeCorrect=!0,t.delayTimeLeft=0,t.topCard=t._rules.getTopmostCard();t.nextCardBelow;t.nextCardBelow=t._rules.getNextCardBelow();t.nextCardBelow;t.polynomial=E.Copy(t._rules.getPolynomial())},updateExpression:function(t){t.polynomial=E.Copy(t._rules.getPolynomial())},showOrHideExpression:function(t,e){null==e&&(e=!t.showExpression),t.showExpression=e},_SetInto:function(t,e){var r=Ct,i=r.prototype;t[e+"cstrain_vuex_game_GameMutator|restart"]=i.restart,t[e+"cstrain_vuex_game_GameMutator|notifySwipe"]=i.notifySwipe,t[e+"cstrain_vuex_game_GameMutator|toggleInstructions"]=i.toggleInstructions,t[e+"cstrain_vuex_game_GameMutator|updateProgress"]=i.updateProgress,t[e+"cstrain_vuex_game_GameMutator|setPenalty"]=i.setPenalty,t[e+"cstrain_vuex_game_GameMutator|setPenaltySwipeCorrect"]=i.setPenaltySwipeCorrect,t[e+"cstrain_vuex_game_GameMutator|setDelay"]=i.setDelay,t[e+"cstrain_vuex_game_GameMutator|traceCardResult"]=i.traceCardResult,t[e+"cstrain_vuex_game_GameMutator|encounterStationStop"]=i.encounterStationStop,t[e+"cstrain_vuex_game_GameMutator|resume"]=i.resume,t[e+"cstrain_vuex_game_GameMutator|updateExpression"]=i.updateExpression,t[e+"cstrain_vuex_game_GameMutator|showOrHideExpression"]=i.showOrHideExpression},__class__:Ct};var Mt=function(t){this.cardsOutDetected=!1,this.showInstructions=!1,this.stopsEncountedSoFar=0,this.chosenSwipe=0,this.penaltySwipeCorrect=!0,this.curPenalty=null,this.delayTimeLeft=0,this.showExpression=!1,this.polynomial=null,this.cardResult=null,this.nextCardBelow=null,this.topCard=null,this.curCardIndex=0,this.setupWithRules(t)};a["cstrain.vuex.game.GameState"]=Mt,Mt.__name__=["cstrain","vuex","game","GameState"],Mt.prototype={setupWithRules:function(t){this.cards=t.getAllCards(),this.settings=t.getGameSettings(),this.playerStats=t.getPlayerStats()},__class__:Mt};var kt=function(){this.monster=null,this.maxHealth=100,this.health=100,this.currentProgress=0};a["cstrain.vuex.game.GameVueData"]=kt,kt.__name__=["cstrain","vuex","game","GameVueData"],kt.prototype={changeMonster:function(t){this.monster={position:t.currentPosition,range:t.specs.baseAttackRange}},updateMonsterPosition:function(t){null==this.monster&&this.changeMonster(t),this.monster.position=t.currentPosition},__class__:kt};var Et=function(){};a["haxevx.vuex.core.IVxContext"]=Et,Et.__name__=["haxevx","vuex","core","IVxContext"],Et.prototype={__class__:Et};var At=function(){};a["haxevx.vuex.core.IVxContext1"]=At,At.__name__=["haxevx","vuex","core","IVxContext1"],At.prototype={__class__:At};var It=function(){};a["haxevx.vuex.core.VxStore"]=It,It.__name__=["haxevx","vuex","core","VxStore"],It.prototype={dispatch:function(t,e,r){return null},commit:function(t,e,r){},__class__:It};var Pt=function(){It.call(this),this.state=new Bt,this._Init("")};a["cstrain.vuex.store.GameStore"]=Pt,Pt.__name__=["cstrain","vuex","store","GameStore"],Pt.__super__=It,Pt.prototype=e(It.prototype,{_Init:function(t){this._=t,Di.stack.push(this),null!=this.state?this.state._=t:this.state={_:t};var e,r=Pt;r.prototype;e={},this.getters=e,(new Dt)._SetInto(e),e={},this.mutations=e,(new Vt)._SetInto(e,""),e={},this.actions=e,(new wt)._SetInto(e,""),e={},this.modules=e,null!=this.game&&(e.game=this.game,this.game._Init(t+"game/"))},_InjNative:function(t){this._stg=t},__class__:Pt});var Dt=function(){};a["cstrain.vuex.store.StoreGetters"]=Dt,Dt.__name__=["cstrain","vuex","store","StoreGetters"],Dt.Get_isTouchBased=function(t){return _t.IS_TOUCH_BASED},Dt.prototype={_SetInto:function(t){var e=Dt;t.isTouchBased=e.Get_isTouchBased},__class__:Dt};var Bt=function(){};a["cstrain.vuex.store.GameStoreState"]=Bt,Bt.__name__=["cstrain","vuex","store","GameStoreState"],Bt.prototype={saveLevel:function(t,e){this._savedLevelStats={LAST_MONSTER_SPECS:e,LAST_PLAYER_SPECS:t}},__class__:Bt};var Vt=function(){};a["cstrain.vuex.store.GameStoreMutator"]=Vt,Vt.__name__=["cstrain","vuex","store","GameStoreMutator"],Vt.prototype={saveGameForNextLevel:function(t,e){null!=e.LAST_MONSTER_SPECS&&e.LAST_MONSTER_SPECS.dummyAddDifficulty(),t.saveLevel(e.LAST_PLAYER_SPECS,e.LAST_MONSTER_SPECS)},_SetInto:function(t,e){var r=Vt,i=r.prototype;t[e+"cstrain_vuex_store_GameStoreMutator|saveGameForNextLevel"]=i.saveGameForNextLevel},__class__:Vt};var Ot=function(){};a["ecx.Engine"]=Ot,Ot.__name__=["ecx","Engine"],Ot.createWorld=function(t,e){null==e&&(e=65536);var r=new Ft(Ot._worlds.length,t,e);return Ot._worlds[r.id]=r,r};var Ft=function(t,e,r){this.used=0,this.id=t,$t.construct(this,r,e)};a["ecx.World"]=Ft,Ft.__name__=["ecx","World"],Ft.prototype={create:function(){var t=this.allocNextEntity(),e=t,r=e>>>5,i=this._aliveMask;i[r]|=1<<(31&e);var n=t,a=n>>>5,s=this._activeMask;return s[a]|=1<<(31&n),this.markEntityAsChanged(t),t},destroy:function(t){var e,r=this._removedMask,i=t,n=i>>>5,a=1<<(31&i),s=r[n];if(0==(s&a)?(r[n]=s|a,e=!0):e=!1,e){var o=this._removedVector;o.buffer[o.length]=t,++o.length}},invalidate:function(){(this._removedVector.length>0||this._changedVector.length>0)&&(this.destroyEntities(),this.changeEntities(),Jt.updateVector(this._families))},destroyComponents:function(t){for(var e=this._components,r=0,i=e.length;r<i;){var n=r++,a=e[n];a.has(t)&&e[n].destroy(t)}var s=t;0!=(this._activeMask[s>>>5]&1<<(31&s))&&this.markEntityAsChanged(t)},allocNextEntity:function(){++this.used;var t=this._pool.pop();return t},destroyEntities:function(){for(var t=this._removedVector,e=this._pool,r=this._removedMask,i=this._activeMask,n=this._aliveMask,a=this._families,s=0;s<t.length;)for(var o=t.length;s<o;){for(var h=t.buffer[s],l=h,u=0,R=a.length;u<R;){var c=u++;a[c].__disableEntity(l)}this.destroyComponents(l);var _=l,f=_>>>5,g=i;g[f]&=~(1<<(31&_));var p=l,d=p>>>5,v=n;v[d]&=~(1<<(31&p));var m=l,y=m>>>5,x=r;x[y]&=~(1<<(31&m)),e.push(l),++s}var b=t.length;this.used-=b,t.length=0},changeEntities:function(){for(var t=this._changedVector,e=this._changedMask,r=this._activeMask,i=this._aliveMask,n=this._families,a=n.length,s=0;s<t.length;)for(var o=t.length;s<o;){var h=t.buffer[s],l=h,u=l,R=0!=(i[u>>>5]&1<<(31&u));if(R){var c=l,_=0!=(r[c>>>5]&1<<(31&c));if(_)for(var f=0,g=a;f<g;){var p=f++;n[p].__change(l)}else for(var d=0,v=a;d<v;){var m=d++;n[m].__disableEntity(l)}}var y=l,x=y>>>5,b=e;b[x]&=~(1<<(31&y)),++s}t.length=0},markEntityAsChanged:function(t){var e,r=this._changedMask,i=t,n=i>>>5,a=1<<(31&i),s=r[n];if(0==(s&a)?(r[n]=s|a,e=!0):e=!1,e){var o=this._changedVector;o.buffer[o.length]=t,++o.length}},__class__:Ft};var Lt=function(t){if(this._priorities=[],this._services=[],null!=t)for(var e=0;e<t.length;){var r=t[e];++e,this.include(r)}};a["ecx.WorldConfig"]=Lt,Lt.__name__=["ecx","WorldConfig"],Lt.prototype={add:function(t,e){null==e&&(e=0),this._services.push(t),this._priorities.push(e)},include:function(t){for(var e=t._services,r=t._priorities,i=e.length,n=0,a=i;n<a;){var s=n++;this.add(e[s],r[s])}},__class__:Lt};var Gt=function(){Lt.call(this),this.add(new Wt),this.add(new Zt,-1e3),this.add(new Ut,-999),this.add(new Yt,1e3),this.add(new qt),this.add(new Nt)};a["ecx.common.EcxCommon"]=Gt,Gt.__name__=["ecx","common","EcxCommon"],Gt.__super__=Lt,Gt.prototype=e(Lt.prototype,{__class__:Gt});var Nt=function(){};a["ecx.common.components.Fsm"]=Nt,Nt.__name__=["ecx","common","components","Fsm"],Nt.__super__=it,Nt.prototype=e(it.prototype,{__allocate:function(){for(var t=this.world.capacity,e=new Array(t),r=0,i=t;r<i;){var n=r++;e[n]=null}this.data=e},destroy:function(t){this.data[t]=null},has:function(t){return null!=this.data[t]},__serviceType:function(){var t=10;return t},__componentType:function(){var t=3;return t},__class__:Nt});var zt=function(){this._exit=new Ti,this._enter=new Ti};a["ecx.common.components.FsmData"]=zt,zt.__name__=["ecx","common","components","FsmData"],zt.prototype={__class__:zt};var qt=function(){};a["ecx.common.components.Name"]=qt,qt.__name__=["ecx","common","components","Name"],qt.__super__=it,qt.prototype=e(it.prototype,{__allocate:function(){for(var t=this.world.capacity,e=new Array(t),r=0,i=t;r<i;){var n=r++;e[n]=null}this.data=e},destroy:function(t){this.data[t]=null},has:function(t){return null!=this.data[t]},__serviceType:function(){var t=8;return t},__componentType:function(){var t=2;return t},__class__:qt});var Ut=function(){this._accDeltaTime=0,this._lastTime=0,this._frames=0,this.inverval=.25,this.frameTimeAverage=0,this.framesPerSecond=0,Q.call(this)};a["ecx.common.systems.FpsMeter"]=Ut,Ut.__name__=["ecx","common","systems","FpsMeter"],Ut.__super__=Q,Ut.prototype=e(Q.prototype,{update:function(){++this._frames,this._accDeltaTime+=this._time.deltaTime;var t=this._time.totalTime;t-this._lastTime>=this.inverval&&(this.framesPerSecond=this._frames/this.inverval,this.frameTimeAverage=this._accDeltaTime/this._frames,this._lastTime=t,this._frames=0,this._accDeltaTime=0)},__serviceType:function(){var t=7;return t},__inject:function(){var t=this.world,e=t._services[4];this._time=e},__class__:Ut});var Yt=function(){Q.call(this)};a["ecx.common.systems.FsmSystem"]=Yt,Yt.__name__=["ecx","common","systems","FsmSystem"],Yt.__super__=Q,Yt.prototype=e(Q.prototype,{update:function(){var t,e,r,i=this._entities;for(t=0,e=i.length,r=i.buffer;t!=e;){var n=r[t++],a=n,s=this._fsm.data[a];if(s.state!=s._next){var o=s.state,h=s._exit,l=null!=_a[o]?h.getReserved(o):h.h[o],u=s._next,R=s._enter,c=null!=_a[u]?R.getReserved(u):R.h[u];null!=l&&l(this.world,a),null!=c&&c(this.world,a),s.state=s._next;var _=this.world,f=a;0!=(_._activeMask[f>>>5]&1<<(31&f))&&_.markEntityAsChanged(a)}}},__configure:function(){for(var t=(this.world,new Jt(this.world,this)),e=[3],r=null!=e?e.length:0,i=new Array(r),n=0,a=r;n<a;){var s=n++;i[s]=null}t._requiredComponents=i;for(var o=0,h=t._requiredComponents.length;o<h;){var l=o++;t._requiredComponents[l]=t._world._components[e[l]]}this._entities=this._addFamily(t)},__serviceType:function(){var t=6;return t},__inject:function(){var t=this.world,e=t._services[10];this._fsm=e},__class__:Yt});var Wt=function(t){null==t&&(t=!1),this._profiler=new Ht,this.profile=t};a["ecx.common.systems.SystemRunner"]=Wt,Wt.__name__=["ecx","common","systems","SystemRunner"],Wt.__super__=$,Wt.prototype=e($.prototype,{updateFrame:function(){if(this.profile)return void this.updateAndProfileSystems();this.world.invalidate();var t,e,r,i=this.world._systems;for(t=0,e=i.length,r=i;t!=e;){var n=r[t++];n.update(),this.world.invalidate()}},initialize:function(){var t,e,r,i=this.world._systems;for(t=0,e=i.length,r=i;t!=e;){var n=r[t++];this._profiler.add(n)}},updateAndProfileSystems:function(){this._profiler.prepare(),this.world.invalidate();var t,e,r,i=this.world._systems;for(t=0,e=i.length,r=i;t!=e;){var n=r[t++];this._profiler.start(),n.update(),this._profiler.trackUpdate(),this._profiler.trackEntities(this.world),this.world.invalidate(),this._profiler.trackInvalidate()}this._profiler.finish()},__serviceType:function(){var t=5;return t},__class__:Wt});var Ht=function(){this._period=20,this._startTime=0,this._index=0,this._timesCounter=0,this._invalidateTimes=[],this._updateTimes=[],this.invalidateTotal=0,this.updateTotal=0,this.data=[]};a["ecx.common.systems._SystemRunner.SystemProfiler"]=Ht,Ht.__name__=["ecx","common","systems","_SystemRunner","SystemProfiler"],Ht.prototype={add:function(t){var e=v.getClassName(null==t?null:En.getClass(t)).split(".");this.data.push(new Xt(e[e.length-1])),this._updateTimes.push(0),this._invalidateTimes.push(0)},prepare:function(){this._index=0},finish:function(){if(++this._timesCounter,this._timesCounter>=this._period){for(var t=0,e=0,r=0,i=this.data.length;r<i;){var n=r++;t+=this._updateTimes[n],e+=this._invalidateTimes[n],this.data[n].updateTime=this._updateTimes[n]/this._timesCounter,this.data[n].updateTime>this.data[n].updateTimeMax&&(this.data[n].updateTimeMax=this.data[n].updateTime),this.data[n].invalidateTime=this._invalidateTimes[n]/this._timesCounter,this.data[n].invalidateTime>this.data[n].invalidateTimeMax&&(this.data[n].invalidateTimeMax=this.data[n].invalidateTime),this._updateTimes[n]=0,this._invalidateTimes[n]=0}this.updateTotal=t/this._timesCounter,this.invalidateTotal=e/this._timesCounter,this._timesCounter=0}},start:function(){this._startTime=(new Date).getTime()/1e3},trackUpdate:function(){var t=(new Date).getTime()/1e3;this._updateTimes[this._index]+=t-this._startTime,this._startTime=t},trackInvalidate:function(){var t=(new Date).getTime()/1e3;this._invalidateTimes[this._index]+=t-this._startTime,this._startTime=t,++this._index},trackEntities:function(t){var e=t._changedVector.length,r=t._removedVector.length;e>this.data[this._index].changed&&(this.data[this._index].changed=e),r>this.data[this._index].removed&&(this.data[this._index].removed=r)},__class__:Ht};var Xt=function(t){this.removed=0,this.changed=0,this.invalidateTimeMax=0,this.invalidateTime=0,this.updateTimeMax=0,this.updateTime=0,this.name=t};a["ecx.common.systems.ProfileInfo"]=Xt,Xt.__name__=["ecx","common","systems","ProfileInfo"],Xt.prototype={__class__:Xt};var Zt=function(){this.currentFrame=0,this.totalTime=0,this.deltaTime=0,Q.call(this)};a["ecx.common.systems.TimeSystem"]=Zt,Zt.__name__=["ecx","common","systems","TimeSystem"],Zt.__super__=Q,Zt.prototype=e(Q.prototype,{initialize:function(){this._lastTime=this._startTime=(new Date).getTime()/1e3},update:function(){var t=(new Date).getTime()/1e3;this.deltaTime=t-this._lastTime,this.totalTime=t-this._startTime,++this.currentFrame,this._lastTime=t},__serviceType:function(){var t=4;return t},__class__:Zt});var Kt=function(t){this._tail=0,this._head=0,this._mask=t-1;var e=new Int32Array(t);this._buffer=e};a["ecx.ds.CInt32RingBuffer"]=Kt,Kt.__name__=["ecx","ds","CInt32RingBuffer"],Kt.prototype={pop:function(){var t=this._head;return this._head=t+1,this._head&=this._mask,this._buffer[t]},push:function(t){var e=this._tail;this._buffer[e]=t,++e,this._tail=e&this._mask},__class__:Kt};var $t=function(){};a["ecx.managers.WorldConstructor"]=$t,$t.__name__=["ecx","managers","WorldConstructor"],$t.construct=function(t,e,r){e=Xn.require(e)+1,t.capacity=e,t._components=$t.createComponentsData(r),t._pool=$t.createEntityPool(e);var i,n=new Int32Array(Math.ceil(e/32));i=n,t._aliveMask=i;var a,s=new Int32Array(Math.ceil(e/32));a=s,t._activeMask=a,t._changedVector=new Qt(e-1),t._removedVector=new Qt(e-1);var o,h=new Int32Array(Math.ceil(e/32));o=h,t._changedMask=o;var l,u=new Int32Array(Math.ceil(e/32));l=u,t._removedMask=l,t._services=$t.createServicesLookup(r),t._orderedServices=$t.createServicesOrder(r),$t.routeServices(t),$t.createFamilyList(t),$t.initializeServices(t),$t.deleteConfigurators(t)},$t.createComponentsData=function(t){for(var e=[],r=0,i=0,n=t._services;i<n.length;){var a=n[i];if(++i,En.__instanceof(a,rt)){var s=a;e.push(s);var o=s.__componentType();o>r&&(r=o)}}for(var h=r+1,l=new Array(h),u=0,R=h;u<R;){var c=u++;l[c]=null}for(var _=l,f=0;f<e.length;){var g=e[f];++f,_[g.__componentType()]=g}return _},$t.createEntityPool=function(t){for(var e=new Kt(t-1),r=0,i=e._buffer.length;r<i;){var n=r++;e._buffer[n]=n+1}return e},$t.createServicesLookup=function(t){for(var e=[],r=0,i=t._services;r<i.length;){var n=i[r];++r,e[n.__serviceType()]=n}for(var a=e.length,s=new Array(a),o=0,h=a;o<h;){var l=o++;s[l]=null}for(var u=s,R=0,c=e.length;R<c;){var _=R++;u[_]=e[_]}return u},$t.createServicesOrder=function(t){for(var e=t._services,r=t._priorities,i=[],n=0,a=e.length;n<a;){var s=n++;i.push(s)}i.sort(function(t,e){return r[t]-r[e]});for(var o=e.length,h=new Array(o),l=0,u=o;l<u;){var R=l++;h[R]=null}for(var c=h,_=0,f=e.length;_<f;){var g=_++;c[g]=e[i[g]]}return c},$t.routeServices=function(t){for(var e=[],r=[],i=0,n=t._orderedServices;i<n.length;){var a=n[i];++i,a.world=t;var s=a instanceof Q?a:null;null!=s&&(s.__configure(),null!=s._families&&s._families.length>0&&e.push(s),0==(2&s._flags)&&r.push(s)),a.__allocate(),a.__inject()}for(var o=r.length,h=new Array(o),l=0,u=o;l<u;){var R=l++;h[R]=null}for(var c=h,_=0,f=r.length;_<f;){var g=_++;c[g]=r[g]}t._systems=c;for(var p=e.length,d=new Array(p),v=0,m=p;v<m;){var y=v++;d[y]=null}for(var x=d,b=0,w=e.length;b<w;){var j=b++;x[j]=e[j]}t._processors=x},$t.createFamilyList=function(t){for(var e=[],r=0,i=t._processors;r<i.length;){var n=i[r];++r;for(var a=0,s=n._families;a<s.length;){var o=s[a];++a,e.push(o)}}for(var h=e.length,l=new Array(h),u=0,R=h;u<R;){var c=u++;l[c]=null}for(var _=l,f=0,g=e.length;f<g;){var p=f++;_[p]=e[p]}t._families=_},$t.initializeServices=function(t){for(var e=0,r=t._orderedServices;e<r.length;){var i=r[e];++e,i.initialize()}},$t.deleteConfigurators=function(t){};var Qt=function(t){null==t&&(t=16),this.length=0;var e=new Int32Array(t);this.buffer=e};a["ecx.types.EntityVector"]=Qt,Qt.__name__=["ecx","types","EntityVector"],Qt.prototype={restoreOrder:function(t,e,r){null==r&&(r=0),null==e&&(e=0);for(var i=t,n=e/32|0,a=0==r?i.length:Math.ceil(r/32),s=0,o=n,h=a;o<h;){var l=o++,u=i[l];if(0!=u)for(var R=l<<5,c=0;c<32;){var _=c++;0!=(u&1<<_)&&(this.buffer[s]=R+_,++s)}}this.length=s},grow:function(t){for(var e=this.buffer,r=e.length;r<t;)r=1+1.5*r|0;if(r>e.length){var i=new Int32Array(r);this.buffer=i;for(var n=0,a=this.length;n<a;){var s=n++;this.buffer[s]=e[s]}}},__class__:Qt};var Jt=function(t,e){this.total=0,this.changed=!1;var r=t.capacity;this.entities=new Qt;var i,n=new Int32Array(Math.ceil(r/32));i=n,this._containedMask=i,this._world=t,this._system=e};a["ecx.types.FamilyData"]=Jt,Jt.__name__=["ecx","types","FamilyData"],Jt.updateVector=function(t){for(var e=0,r=t.length;e<r;){var i=e++,n=t[i];if(n.changed){var a=n.entities,s=n.total;s>=a.buffer.length&&a.grow(s+1),n.entities.restoreOrder(n._containedMask),n.changed=!1}}},Jt.prototype={require:function(t){for(var e=null!=t?t.length:0,r=new Array(e),i=0,n=e;i<n;){var a=i++;r[a]=null}this._requiredComponents=r;for(var s=0,o=this._requiredComponents.length;s<o;){var h=s++;this._requiredComponents[h]=this._world._components[t[h]]}return this},check:function(t){for(var e=this._requiredComponents,r=0,i=e.length;r<i;){var n=r++;if(!e[n].has(t))return!1}return!0},__invalidate:function(){var t=this.entities,e=this.total;e>=t.buffer.length&&t.grow(e+1),this.entities.restoreOrder(this._containedMask),this.changed=!1},__change:function(t){var e=t,r=0!=(this._containedMask[e>>>5]&1<<(31&e)),i=this.check(t);i!=r&&(i?this.__enableEntity(t):this.__disableEntity(t))},__enableEntity:function(t){var e,r=t;if(e=0==(this._containedMask[r>>>5]&1<<(31&r))&&this.check(t)){var i=t,n=i>>>5,a=this._containedMask;a[n]|=1<<(31&i),this._system.onEntityAdded(t,this),this.changed=!0,++this.total}},__disableEntity:function(t){var e=t;if(0!=(this._containedMask[e>>>5]&1<<(31&e))){var r=t,i=r>>>5,n=this._containedMask;n[i]&=~(1<<(31&r)),this._system.onEntityRemoved(t,this),this.changed=!0,--this.total}},__class__:Jt};var te=function(){};a["ecx.types.TypeManager"]=te,te.__name__=["ecx","types","TypeManager"];var ee=r(8),re=r(8).Direction,ie=function(t){F.call(this,t),this.blendMode=ne.Alpha,this.color=new Pe(1,1,1,1)};a["h2d.Drawable"]=ie,ie.__name__=["h2d","Drawable"],ie.__super__=F,ie.prototype=e(F.prototype,{emitTile:function(t,e){null==e&&(e=new ye(null,0,0,5,5)),!t.drawTile(this,e)},__class__:ie});var ne=a["h2d.BlendMode"]={__ename__:!0,__constructs__:["None","Alpha","Add","SoftAdd","Multiply","Erase","Screen"]};ne.None=["None",0],ne.None.toString=s,ne.None.__enum__=ne,ne.Alpha=["Alpha",1],ne.Alpha.toString=s,ne.Alpha.__enum__=ne,ne.Add=["Add",2],ne.Add.toString=s,ne.Add.__enum__=ne,ne.SoftAdd=["SoftAdd",3],ne.SoftAdd.toString=s,ne.SoftAdd.__enum__=ne,ne.Multiply=["Multiply",4],ne.Multiply.toString=s,ne.Multiply.__enum__=ne,ne.Erase=["Erase",5],ne.Erase.toString=s,ne.Erase.__enum__=ne,ne.Screen=["Screen",6],ne.Screen.toString=s,ne.Screen.__enum__=ne,ne.__empty_constructs__=[ne.None,ne.Alpha,ne.Add,ne.SoftAdd,ne.Multiply,ne.Erase,ne.Screen];var ae=function(){this.xMin=1e20,this.yMin=1e20,this.xMax=-1e20,this.yMax=-1e20};a["h2d.col.Bounds"]=ae,ae.__name__=["h2d","col","Bounds"],ae.prototype={__class__:ae};var se=function(t,e,r,i,n,a){this.x=t,this.y=e,this.r=r,this.g=i,this.b=n,this.a=a};a["h2d._Graphics.GPoint"]=se,se.__name__=["h2d","_Graphics","GPoint"],se.prototype={__class__:se};var oe=function(){};a["h3d.impl._Serializable.EmptyInterface"]=oe,oe.__name__=["h3d","impl","_Serializable","EmptyInterface"];var he=function(){};a["h3d.prim.Primitive"]=he,he.__name__=["h3d","prim","Primitive"],he.__interfaces__=[oe],he.prototype={getBounds:function(){throw new Zn("not implemented for "+g.string(this))},alloc:function(t){throw new Zn("not implemented")},render:function(t){(null==this.buffer||this.buffer.isDisposed())&&this.alloc(t),null==this.indexes?0!=(this.buffer.flags&1<<Te.Quads[1])?t.renderBuffer(this.buffer,t.mem.quadIndexes,2,0,-1):t.renderBuffer(this.buffer,t.mem.triIndexes,3,0,-1):t.renderIndexed(this.buffer,this.indexes)},dispose:function(){null!=this.buffer&&(this.buffer.dispose(),this.buffer=null),null!=this.indexes&&(this.indexes.dispose(),this.indexes=null)},toString:function(){return v.getClassName(En.getClass(this)).split(".").pop()},__class__:he};var le=function(){this.buffers=[]};a["h2d._Graphics.GraphicsContent"]=le,le.__name__=["h2d","_Graphics","GraphicsContent"],le.__super__=he,le.prototype=e(he.prototype,{next:function(){var t=this.tmp.pos>>3;if(t<32768)return!1;this.buffers.push({buf:this.tmp,idx:this.index,vbuf:null,ibuf:null});var e=Ni._new(0);this.tmp=e;var r=new Array(0);return this.index=r,he.prototype.dispose.call(this),!0},alloc:function(t){if(!(this.index.length<=0)){this.buffer=Se.ofFloats(this.tmp,8,[Te.RawFormat]),this.indexes=Ee.alloc(this.index);for(var e=0,r=this.buffers;e<r.length;){var i=r[e];++e,(null==i.vbuf||i.vbuf.isDisposed())&&(i.vbuf=Se.ofFloats(i.buf,8,[Te.RawFormat])),(null==i.ibuf||i.ibuf.isDisposed())&&(i.ibuf=Ee.alloc(i.idx))}}},render:function(t){if(!(this.index.length<=0)){(null==this.buffer||this.buffer.isDisposed())&&this.alloc(ke.CURRENT);for(var e=0,r=this.buffers;e<r.length;){var i=r[e];++e,t.renderIndexed(i.vbuf,i.ibuf)}he.prototype.render.call(this,t)}},dispose:function(){for(var t=0,e=this.buffers;t<e.length;){var r=e[t];++t,null!=r.vbuf&&r.vbuf.dispose(),null!=r.ibuf&&r.ibuf.dispose(),r.vbuf=null,r.ibuf=null}he.prototype.dispose.call(this)},clear:function(){this.dispose();var t=Ni._new(0);this.tmp=t;var e=new Array(0);this.index=e,this.buffers=[]},__class__:le});var ue=function(t){this.bevel=.25,this.my=0,this.mx=0,this.md=1,this.mc=0,this.mb=0,this.ma=1,ie.call(this,t),this.content=new le,this.tile=ye.fromColor(16777215),this.clear()};a["h2d.Graphics"]=ue,ue.__name__=["h2d","Graphics"],ue.__super__=ie,ue.prototype=e(ie.prototype,{onRemove:function(){ie.prototype.onRemove.call(this),this.clear()},clear:function(){this.content.clear(),this.tmpPoints=[],this.pindex=0,this.lineSize=0,this.xMin=1/0,this.yMin=1/0,this.yMax=-(1/0),this.xMax=-(1/0)},getBoundsRec:function(t,e,r){ie.prototype.getBoundsRec.call(this,t,e,r),null!=this.tile&&this.addBounds(t,e,this.xMin,this.yMin,this.xMax-this.xMin,this.yMax-this.yMin)},isConvex:function(t){for(var e=!0,r=!1,i=0,n=t.length;i<n;){var a=i++,s=t[a],o=t[(a+1)%t.length],h=t[(a+2)%t.length],l=(o.x-s.x)*(h.y-s.y)-(o.y-s.y)*(h.x-s.x)>0;if(e)e=!1,r=l;else if(r!=l)return!1}return!0},flushLine:function(t){var e=this.tmpPoints,r=e.length-1,i=e[r],n=e[0],a=n.x==i.x&&n.y==i.y,s=e.length;if(a)n!=i&&(--s,--r,i=e[r]);else{var o=e[r-1];null==o&&(o=n),e.push(new se(2*i.x-o.x,2*i.y-o.y,0,0,0,0));var h=e[1];null==h&&(h=n),i=new se(2*n.x-h.x,2*n.y-h.y,0,0,0,0)}for(var l=0,u=s;l<u;){var R=l++,c=e[(R+1)%e.length],_=i.y-n.y,f=n.x-i.x,g=1/Math.sqrt(_*_+f*f),p=n.y-c.y,d=c.x-n.x,v=1/Math.sqrt(p*p+d*d),m=_*g+p*v,y=f*g+d*v,x=1/Math.sqrt(m*m+y*y);m*=x,y*=x;var b=m*_*g+y*f*g;b<.1&&(b=.1);var w=.5*this.lineSize/b;if(m*=w,y*=w,b>this.bevel){var j=this.content,T=n.x+m,S=n.y+y,C=n.r,M=n.g,k=n.b,E=n.a,A=j.tmp;if(A.pos==A.array.length){var I=A.array.length<<1;I<128&&(I=128);var P=new ga(I);P.set(A.array),A.array=P}A.array[A.pos++]=T;var D=j.tmp;if(D.pos==D.array.length){var B=D.array.length<<1;B<128&&(B=128);var V=new ga(B);V.set(D.array),D.array=V}D.array[D.pos++]=S;var O=j.tmp;if(O.pos==O.array.length){var F=O.array.length<<1;F<128&&(F=128);var L=new ga(F);L.set(O.array),O.array=L}O.array[O.pos++]=0;var G=j.tmp;if(G.pos==G.array.length){var N=G.array.length<<1;N<128&&(N=128);var z=new ga(N);z.set(G.array),G.array=z}G.array[G.pos++]=0;var q=j.tmp;if(q.pos==q.array.length){var U=q.array.length<<1;U<128&&(U=128);var Y=new ga(U);Y.set(q.array),
q.array=Y}q.array[q.pos++]=C;var W=j.tmp;if(W.pos==W.array.length){var H=W.array.length<<1;H<128&&(H=128);var X=new ga(H);X.set(W.array),W.array=X}W.array[W.pos++]=M;var Z=j.tmp;if(Z.pos==Z.array.length){var K=Z.array.length<<1;K<128&&(K=128);var $=new ga(K);$.set(Z.array),Z.array=$}Z.array[Z.pos++]=k;var Q=j.tmp;if(Q.pos==Q.array.length){var J=Q.array.length<<1;J<128&&(J=128);var tt=new ga(J);tt.set(Q.array),Q.array=tt}Q.array[Q.pos++]=E;var et=this.content,rt=n.x-m,it=n.y-y,nt=n.r,at=n.g,st=n.b,ot=n.a,ht=et.tmp;if(ht.pos==ht.array.length){var lt=ht.array.length<<1;lt<128&&(lt=128);var ut=new ga(lt);ut.set(ht.array),ht.array=ut}ht.array[ht.pos++]=rt;var Rt=et.tmp;if(Rt.pos==Rt.array.length){var ct=Rt.array.length<<1;ct<128&&(ct=128);var _t=new ga(ct);_t.set(Rt.array),Rt.array=_t}Rt.array[Rt.pos++]=it;var ft=et.tmp;if(ft.pos==ft.array.length){var gt=ft.array.length<<1;gt<128&&(gt=128);var pt=new ga(gt);pt.set(ft.array),ft.array=pt}ft.array[ft.pos++]=0;var dt=et.tmp;if(dt.pos==dt.array.length){var vt=dt.array.length<<1;vt<128&&(vt=128);var mt=new ga(vt);mt.set(dt.array),dt.array=mt}dt.array[dt.pos++]=0;var yt=et.tmp;if(yt.pos==yt.array.length){var xt=yt.array.length<<1;xt<128&&(xt=128);var bt=new ga(xt);bt.set(yt.array),yt.array=bt}yt.array[yt.pos++]=nt;var wt=et.tmp;if(wt.pos==wt.array.length){var jt=wt.array.length<<1;jt<128&&(jt=128);var Tt=new ga(jt);Tt.set(wt.array),wt.array=Tt}wt.array[wt.pos++]=at;var St=et.tmp;if(St.pos==St.array.length){var Ct=St.array.length<<1;Ct<128&&(Ct=128);var Mt=new ga(Ct);Mt.set(St.array),St.array=Mt}St.array[St.pos++]=st;var kt=et.tmp;if(kt.pos==kt.array.length){var Et=kt.array.length<<1;Et<128&&(Et=128);var At=new ga(Et);At.set(kt.array),kt.array=At}kt.array[kt.pos++]=ot;var It=R==r?t:this.pindex+2;(R<s-1||a)&&(this.content.index.push(this.pindex),this.content.index.push(this.pindex+1),this.content.index.push(It),this.content.index.push(this.pindex+1),this.content.index.push(It),this.content.index.push(It+1)),this.pindex+=2}else{var Pt=c.x-n.x,Dt=c.y-n.y,Bt=Pt*m+Dt*y,Vt=-y,Ot=m,Ft=Vt*_*g+Ot*f*g,Lt=.5*this.lineSize/Ft;Vt*=Lt,Ot*=Lt;var Gt=R==r?t:this.pindex+3;if(Bt>0){var Nt=this.content,zt=n.x+m,qt=n.y+y,Ut=n.r,Yt=n.g,Wt=n.b,Ht=n.a,Xt=Nt.tmp;if(Xt.pos==Xt.array.length){var Zt=Xt.array.length<<1;Zt<128&&(Zt=128);var Kt=new ga(Zt);Kt.set(Xt.array),Xt.array=Kt}Xt.array[Xt.pos++]=zt;var $t=Nt.tmp;if($t.pos==$t.array.length){var Qt=$t.array.length<<1;Qt<128&&(Qt=128);var Jt=new ga(Qt);Jt.set($t.array),$t.array=Jt}$t.array[$t.pos++]=qt;var te=Nt.tmp;if(te.pos==te.array.length){var ee=te.array.length<<1;ee<128&&(ee=128);var re=new ga(ee);re.set(te.array),te.array=re}te.array[te.pos++]=0;var ie=Nt.tmp;if(ie.pos==ie.array.length){var ne=ie.array.length<<1;ne<128&&(ne=128);var ae=new ga(ne);ae.set(ie.array),ie.array=ae}ie.array[ie.pos++]=0;var oe=Nt.tmp;if(oe.pos==oe.array.length){var he=oe.array.length<<1;he<128&&(he=128);var le=new ga(he);le.set(oe.array),oe.array=le}oe.array[oe.pos++]=Ut;var ue=Nt.tmp;if(ue.pos==ue.array.length){var Re=ue.array.length<<1;Re<128&&(Re=128);var ce=new ga(Re);ce.set(ue.array),ue.array=ce}ue.array[ue.pos++]=Yt;var _e=Nt.tmp;if(_e.pos==_e.array.length){var fe=_e.array.length<<1;fe<128&&(fe=128);var ge=new ga(fe);ge.set(_e.array),_e.array=ge}_e.array[_e.pos++]=Wt;var pe=Nt.tmp;if(pe.pos==pe.array.length){var de=pe.array.length<<1;de<128&&(de=128);var ve=new ga(de);ve.set(pe.array),pe.array=ve}pe.array[pe.pos++]=Ht;var me=this.content,ye=n.x-Vt,xe=n.y-Ot,be=n.r,we=n.g,je=n.b,Te=n.a,Se=me.tmp;if(Se.pos==Se.array.length){var Ce=Se.array.length<<1;Ce<128&&(Ce=128);var Me=new ga(Ce);Me.set(Se.array),Se.array=Me}Se.array[Se.pos++]=ye;var ke=me.tmp;if(ke.pos==ke.array.length){var Ee=ke.array.length<<1;Ee<128&&(Ee=128);var Ae=new ga(Ee);Ae.set(ke.array),ke.array=Ae}ke.array[ke.pos++]=xe;var Ie=me.tmp;if(Ie.pos==Ie.array.length){var Pe=Ie.array.length<<1;Pe<128&&(Pe=128);var De=new ga(Pe);De.set(Ie.array),Ie.array=De}Ie.array[Ie.pos++]=0;var Be=me.tmp;if(Be.pos==Be.array.length){var Ve=Be.array.length<<1;Ve<128&&(Ve=128);var Oe=new ga(Ve);Oe.set(Be.array),Be.array=Oe}Be.array[Be.pos++]=0;var Fe=me.tmp;if(Fe.pos==Fe.array.length){var Le=Fe.array.length<<1;Le<128&&(Le=128);var Ge=new ga(Le);Ge.set(Fe.array),Fe.array=Ge}Fe.array[Fe.pos++]=be;var Ne=me.tmp;if(Ne.pos==Ne.array.length){var ze=Ne.array.length<<1;ze<128&&(ze=128);var qe=new ga(ze);qe.set(Ne.array),Ne.array=qe}Ne.array[Ne.pos++]=we;var Ue=me.tmp;if(Ue.pos==Ue.array.length){var Ye=Ue.array.length<<1;Ye<128&&(Ye=128);var We=new ga(Ye);We.set(Ue.array),Ue.array=We}Ue.array[Ue.pos++]=je;var He=me.tmp;if(He.pos==He.array.length){var Xe=He.array.length<<1;Xe<128&&(Xe=128);var Ze=new ga(Xe);Ze.set(He.array),He.array=Ze}He.array[He.pos++]=Te;var Ke=this.content,$e=n.x+Vt,Qe=n.y+Ot,Je=n.r,tr=n.g,er=n.b,rr=n.a,ir=Ke.tmp;if(ir.pos==ir.array.length){var nr=ir.array.length<<1;nr<128&&(nr=128);var ar=new ga(nr);ar.set(ir.array),ir.array=ar}ir.array[ir.pos++]=$e;var sr=Ke.tmp;if(sr.pos==sr.array.length){var or=sr.array.length<<1;or<128&&(or=128);var hr=new ga(or);hr.set(sr.array),sr.array=hr}sr.array[sr.pos++]=Qe;var lr=Ke.tmp;if(lr.pos==lr.array.length){var ur=lr.array.length<<1;ur<128&&(ur=128);var Rr=new ga(ur);Rr.set(lr.array),lr.array=Rr}lr.array[lr.pos++]=0;var cr=Ke.tmp;if(cr.pos==cr.array.length){var _r=cr.array.length<<1;_r<128&&(_r=128);var fr=new ga(_r);fr.set(cr.array),cr.array=fr}cr.array[cr.pos++]=0;var gr=Ke.tmp;if(gr.pos==gr.array.length){var pr=gr.array.length<<1;pr<128&&(pr=128);var dr=new ga(pr);dr.set(gr.array),gr.array=dr}gr.array[gr.pos++]=Je;var vr=Ke.tmp;if(vr.pos==vr.array.length){var mr=vr.array.length<<1;mr<128&&(mr=128);var yr=new ga(mr);yr.set(vr.array),vr.array=yr}vr.array[vr.pos++]=tr;var xr=Ke.tmp;if(xr.pos==xr.array.length){var br=xr.array.length<<1;br<128&&(br=128);var wr=new ga(br);wr.set(xr.array),xr.array=wr}xr.array[xr.pos++]=er;var jr=Ke.tmp;if(jr.pos==jr.array.length){var Tr=jr.array.length<<1;Tr<128&&(Tr=128);var Sr=new ga(Tr);Sr.set(jr.array),jr.array=Sr}jr.array[jr.pos++]=rr,this.content.index.push(this.pindex),this.content.index.push(Gt),this.content.index.push(this.pindex+2),this.content.index.push(this.pindex+2),this.content.index.push(Gt),this.content.index.push(Gt+1)}else{var Cr=this.content,Mr=n.x+Vt,kr=n.y+Ot,Er=n.r,Ar=n.g,Ir=n.b,Pr=n.a,Dr=Cr.tmp;if(Dr.pos==Dr.array.length){var Br=Dr.array.length<<1;Br<128&&(Br=128);var Vr=new ga(Br);Vr.set(Dr.array),Dr.array=Vr}Dr.array[Dr.pos++]=Mr;var Or=Cr.tmp;if(Or.pos==Or.array.length){var Fr=Or.array.length<<1;Fr<128&&(Fr=128);var Lr=new ga(Fr);Lr.set(Or.array),Or.array=Lr}Or.array[Or.pos++]=kr;var Gr=Cr.tmp;if(Gr.pos==Gr.array.length){var Nr=Gr.array.length<<1;Nr<128&&(Nr=128);var zr=new ga(Nr);zr.set(Gr.array),Gr.array=zr}Gr.array[Gr.pos++]=0;var qr=Cr.tmp;if(qr.pos==qr.array.length){var Ur=qr.array.length<<1;Ur<128&&(Ur=128);var Yr=new ga(Ur);Yr.set(qr.array),qr.array=Yr}qr.array[qr.pos++]=0;var Wr=Cr.tmp;if(Wr.pos==Wr.array.length){var Hr=Wr.array.length<<1;Hr<128&&(Hr=128);var Xr=new ga(Hr);Xr.set(Wr.array),Wr.array=Xr}Wr.array[Wr.pos++]=Er;var Zr=Cr.tmp;if(Zr.pos==Zr.array.length){var Kr=Zr.array.length<<1;Kr<128&&(Kr=128);var $r=new ga(Kr);$r.set(Zr.array),Zr.array=$r}Zr.array[Zr.pos++]=Ar;var Qr=Cr.tmp;if(Qr.pos==Qr.array.length){var Jr=Qr.array.length<<1;Jr<128&&(Jr=128);var ti=new ga(Jr);ti.set(Qr.array),Qr.array=ti}Qr.array[Qr.pos++]=Ir;var ei=Cr.tmp;if(ei.pos==ei.array.length){var ri=ei.array.length<<1;ri<128&&(ri=128);var ii=new ga(ri);ii.set(ei.array),ei.array=ii}ei.array[ei.pos++]=Pr;var ni=this.content,ai=n.x-m,si=n.y-y,oi=n.r,hi=n.g,li=n.b,ui=n.a,Ri=ni.tmp;if(Ri.pos==Ri.array.length){var ci=Ri.array.length<<1;ci<128&&(ci=128);var _i=new ga(ci);_i.set(Ri.array),Ri.array=_i}Ri.array[Ri.pos++]=ai;var fi=ni.tmp;if(fi.pos==fi.array.length){var gi=fi.array.length<<1;gi<128&&(gi=128);var pi=new ga(gi);pi.set(fi.array),fi.array=pi}fi.array[fi.pos++]=si;var di=ni.tmp;if(di.pos==di.array.length){var vi=di.array.length<<1;vi<128&&(vi=128);var mi=new ga(vi);mi.set(di.array),di.array=mi}di.array[di.pos++]=0;var yi=ni.tmp;if(yi.pos==yi.array.length){var xi=yi.array.length<<1;xi<128&&(xi=128);var bi=new ga(xi);bi.set(yi.array),yi.array=bi}yi.array[yi.pos++]=0;var wi=ni.tmp;if(wi.pos==wi.array.length){var ji=wi.array.length<<1;ji<128&&(ji=128);var Ti=new ga(ji);Ti.set(wi.array),wi.array=Ti}wi.array[wi.pos++]=oi;var Si=ni.tmp;if(Si.pos==Si.array.length){var Ci=Si.array.length<<1;Ci<128&&(Ci=128);var Mi=new ga(Ci);Mi.set(Si.array),Si.array=Mi}Si.array[Si.pos++]=hi;var ki=ni.tmp;if(ki.pos==ki.array.length){var Ei=ki.array.length<<1;Ei<128&&(Ei=128);var Ai=new ga(Ei);Ai.set(ki.array),ki.array=Ai}ki.array[ki.pos++]=li;var Ii=ni.tmp;if(Ii.pos==Ii.array.length){var Pi=Ii.array.length<<1;Pi<128&&(Pi=128);var Di=new ga(Pi);Di.set(Ii.array),Ii.array=Di}Ii.array[Ii.pos++]=ui;var Bi=this.content,Vi=n.x-Vt,Oi=n.y-Ot,Fi=n.r,Li=n.g,Gi=n.b,Ni=n.a,zi=Bi.tmp;if(zi.pos==zi.array.length){var qi=zi.array.length<<1;qi<128&&(qi=128);var Ui=new ga(qi);Ui.set(zi.array),zi.array=Ui}zi.array[zi.pos++]=Vi;var Yi=Bi.tmp;if(Yi.pos==Yi.array.length){var Wi=Yi.array.length<<1;Wi<128&&(Wi=128);var Hi=new ga(Wi);Hi.set(Yi.array),Yi.array=Hi}Yi.array[Yi.pos++]=Oi;var Xi=Bi.tmp;if(Xi.pos==Xi.array.length){var Zi=Xi.array.length<<1;Zi<128&&(Zi=128);var Ki=new ga(Zi);Ki.set(Xi.array),Xi.array=Ki}Xi.array[Xi.pos++]=0;var $i=Bi.tmp;if($i.pos==$i.array.length){var Qi=$i.array.length<<1;Qi<128&&(Qi=128);var Ji=new ga(Qi);Ji.set($i.array),$i.array=Ji}$i.array[$i.pos++]=0;var tn=Bi.tmp;if(tn.pos==tn.array.length){var en=tn.array.length<<1;en<128&&(en=128);var rn=new ga(en);rn.set(tn.array),tn.array=rn}tn.array[tn.pos++]=Fi;var nn=Bi.tmp;if(nn.pos==nn.array.length){var an=nn.array.length<<1;an<128&&(an=128);var sn=new ga(an);sn.set(nn.array),nn.array=sn}nn.array[nn.pos++]=Li;var on=Bi.tmp;if(on.pos==on.array.length){var hn=on.array.length<<1;hn<128&&(hn=128);var ln=new ga(hn);ln.set(on.array),on.array=ln}on.array[on.pos++]=Gi;var un=Bi.tmp;if(un.pos==un.array.length){var Rn=un.array.length<<1;Rn<128&&(Rn=128);var cn=new ga(Rn);cn.set(un.array),un.array=cn}un.array[un.pos++]=Ni,this.content.index.push(this.pindex+1),this.content.index.push(Gt),this.content.index.push(this.pindex+2),this.content.index.push(this.pindex+1),this.content.index.push(Gt),this.content.index.push(Gt+1)}this.content.index.push(this.pindex),this.content.index.push(this.pindex+1),this.content.index.push(this.pindex+2),this.pindex+=3}i=n,n=c}},flushFill:function(t){if(!(this.tmpPoints.length<3)){var e,r=this.tmpPoints,i=r[0],n=r[r.length-1],a=null,s=i.x-n.x;if((s<0?-s:s)<1e-9){var o=i.y-n.y;e=(o<0?-o:o)<1e-9}else e=!1;if(e&&(a=r.pop()),this.isConvex(r))for(var h=1,l=r.length-1;h<l;){var u=h++;this.content.index.push(t),this.content.index.push(t+u),this.content.index.push(t+u+1)}else{var R=ue.EARCUT;null==R&&(R=new Qi,ue.EARCUT=R);for(var c=0,_=R.triangulate_h2d__Graphics_GPoint(r);c<_.length;){var f=_[c];++c,this.content.index.push(f+t)}}null!=a&&r.push(a)}},flush:function(){0!=this.tmpPoints.length&&(this.doFill&&(this.flushFill(this.pindex),this.pindex+=this.tmpPoints.length,this.content.next()&&(this.pindex=0)),this.lineSize>0&&(this.flushLine(this.pindex),this.content.next()&&(this.pindex=0)),this.tmpPoints=[])},beginFill:function(t,e){null==e&&(e=1),null==t&&(t=0),this.flush(),this.curA=e,this.curR=(t>>16&255)/255,this.curG=(t>>8&255)/255,this.curB=(255&t)/255,this.doFill=!0},lineStyle:function(t,e,r){null==r&&(r=1),null==e&&(e=0),null==t&&(t=0),this.flush(),this.lineSize=t,this.lineA=r,this.lineR=(e>>16&255)/255,this.lineG=(e>>8&255)/255,this.lineB=(255&e)/255},endFill:function(){this.flush(),this.doFill=!1},addVertex:function(t,e,r,i,n,a,s,o){if(null==o&&(o=0),null==s&&(s=0),t<this.xMin&&(this.xMin=t),e<this.yMin&&(this.yMin=e),t>this.xMax&&(this.xMax=t),e>this.yMax&&(this.yMax=e),this.doFill){var h=this.content,l=h.tmp;if(l.pos==l.array.length){var u=l.array.length<<1;u<128&&(u=128);var R=new ga(u);R.set(l.array),l.array=R}l.array[l.pos++]=t;var c=h.tmp;if(c.pos==c.array.length){var _=c.array.length<<1;_<128&&(_=128);var f=new ga(_);f.set(c.array),c.array=f}c.array[c.pos++]=e;var g=h.tmp;if(g.pos==g.array.length){var p=g.array.length<<1;p<128&&(p=128);var d=new ga(p);d.set(g.array),g.array=d}g.array[g.pos++]=s;var v=h.tmp;if(v.pos==v.array.length){var m=v.array.length<<1;m<128&&(m=128);var y=new ga(m);y.set(v.array),v.array=y}v.array[v.pos++]=o;var x=h.tmp;if(x.pos==x.array.length){var b=x.array.length<<1;b<128&&(b=128);var w=new ga(b);w.set(x.array),x.array=w}x.array[x.pos++]=r;var j=h.tmp;if(j.pos==j.array.length){var T=j.array.length<<1;T<128&&(T=128);var S=new ga(T);S.set(j.array),j.array=S}j.array[j.pos++]=i;var C=h.tmp;if(C.pos==C.array.length){var M=C.array.length<<1;M<128&&(M=128);var k=new ga(M);k.set(C.array),C.array=k}C.array[C.pos++]=n;var E=h.tmp;if(E.pos==E.array.length){var A=E.array.length<<1;A<128&&(A=128);var I=new ga(A);I.set(E.array),E.array=I}E.array[E.pos++]=a}this.tmpPoints.push(new se(t,e,this.lineR,this.lineG,this.lineB,this.lineA))},draw:function(t){t.beginDrawObject(this,this.tile.innerTex)&&this.content.render(t.engine)},sync:function(t){ie.prototype.sync.call(this,t),this.flush();var e=this.content;(null==e.buffer||e.buffer.isDisposed())&&e.alloc(ke.CURRENT)},__class__:ue});var Re=function(){};a["hxd.Interactive"]=Re,Re.__name__=["hxd","Interactive"],Re.prototype={__class__:Re};var ce=function(t,e,r){this.mouseDownButton=-1,this.propagateEvents=!1,this.cancelEvents=!1,ie.call(this,r),this.width=t,this.height=e,this.set_cursor(Oi.Button)};a["h2d.Interactive"]=ce,ce.__name__=["h2d","Interactive"],ce.__interfaces__=[Re],ce.__super__=ie,ce.prototype=e(ie.prototype,{onAdd:function(){this.scene=this.getScene(),null!=this.scene&&this.scene.addEventTarget(this),this.updateMask(),ie.prototype.onAdd.call(this)},draw:function(t){null!=this.backgroundColor&&this.emitTile(t,ye.fromColor(this.backgroundColor,0|this.width,0|this.height,(this.backgroundColor>>>24)/255))},getBoundsRec:function(t,e,r){ie.prototype.getBoundsRec.call(this,t,e,r),(null!=this.backgroundColor||r)&&this.addBounds(t,e,0,0,0|this.width,0|this.height)},onParentChanged:function(){ie.prototype.onParentChanged.call(this),null!=this.scene&&(this.scene.removeEventTarget(this),this.scene.addEventTarget(this)),this.updateMask()},updateMask:function(){this.parentMask=null;for(var t=this.parent;null!=t;){var e=t instanceof fe?t:null;if(null!=e){this.parentMask=e;break}t=t.parent}},onRemove:function(){null!=this.scene&&(this.scene.removeEventTarget(this,!0),this.scene=null),ie.prototype.onRemove.call(this)},checkBounds:function(t){var e=t.kind;switch(e[1]){case 4:case 6:case 7:case 10:return!1;default:return!0}},getInteractiveScene:function(){return this.scene},handleEvent:function(t){if(null!=this.parentMask&&this.checkBounds(t)){var e=this.parentMask,r=new be(t.relX,t.relY);this.localToGlobal(r);for(var i=r.x,n=r.y;null!=e;){r.x=i,r.y=n;var a=e.globalToLocal(r);if(a.x<0||a.y<0||a.x>e.width||a.y>e.height)return void(t.cancel=!0);e=e.parentMask}}if(this.isEllipse&&this.checkBounds(t)){var s=.5*this.width,o=.5*this.height,h=(t.relX-s)/s,l=(t.relY-o)/o;if(h*h+l*l>1)return void(t.cancel=!0)}this.propagateEvents&&(t.propagate=!0),this.cancelEvents&&(t.cancel=!0);var u=t.kind;switch(u[1]){case 0:(this.enableRightButton||0==t.button)&&(this.mouseDownButton=t.button,this.onPush(t));break;case 1:(this.enableRightButton||0==t.button)&&(this.onRelease(t),this.mouseDownButton==t.button&&this.onClick(t)),this.mouseDownButton=-1;break;case 2:this.onMove(t);break;case 3:this.onOver(t),t.cancel||null==this.cursor||Zi.setCursor(this.cursor);break;case 4:this.mouseDownButton=-1,this.onOut(t),t.cancel||Zi.setCursor(Oi.Default);break;case 5:this.onWheel(t);break;case 6:this.onFocus(t);break;case 7:this.onFocusLost(t);break;case 8:this.onKeyDown(t);break;case 9:this.onKeyUp(t);break;case 10:(this.enableRightButton||0==t.button)&&(t.kind=Li.ERelease,this.onRelease(t),t.kind=Li.EReleaseOutside),this.mouseDownButton=-1;break;case 11:this.onTextInput(t);break;case 12:this.onCheck(t)}},set_cursor:function(t){return this.cursor=t,this.isOver()&&null!=this.cursor&&Zi.setCursor(this.cursor),t},isOver:function(){return null!=this.scene&&null!=this.scene.events&&this.scene.events.currentOver==this},onOver:function(t){},onOut:function(t){},onPush:function(t){},onRelease:function(t){},onClick:function(t){},onMove:function(t){},onWheel:function(t){},onFocus:function(t){},onFocusLost:function(t){},onKeyUp:function(t){},onKeyDown:function(t){},onCheck:function(t){},onTextInput:function(t){},__class__:ce});var _e=function(t){F.call(this,t),this.layersIndexes=[],this.layerCount=0};a["h2d.Layers"]=_e,_e.__name__=["h2d","Layers"],_e.__super__=F,_e.prototype=e(F.prototype,{addChild:function(t){this.addChildAt(t,0)},addChildAt:function(t,e){if(t.parent==this){var r=t.allocated;t.allocated=!1,this.removeChild(t),t.allocated=r}for(;e>=this.layerCount;)this.layersIndexes[this.layerCount++]=this.children.length;F.prototype.addChildAt.call(this,t,this.layersIndexes[e]);for(var i=e,n=this.layerCount;i<n;){var a=i++;this.layersIndexes[a]++}},removeChild:function(t){for(var e=0,r=this.children.length;e<r;){var i=e++;if(this.children[i]==t){this.children.splice(i,1),t.allocated&&t.onRemove(),t.parent=null;for(var n=this.layerCount-1;n>=0&&this.layersIndexes[n]>i;)this.layersIndexes[n]--,--n;break}}},__class__:_e});var fe=function(t,e,r){F.call(this,r),this.width=t,this.height=e};a["h2d.Mask"]=fe,fe.__name__=["h2d","Mask"],fe.__super__=F,fe.prototype=e(F.prototype,{onParentChanged:function(){F.prototype.onParentChanged.call(this),this.updateMask()},onAdd:function(){F.prototype.onAdd.call(this),this.updateMask()},updateMask:function(){this.parentMask=null;for(var t=this.parent;null!=t;){var e=t instanceof fe?t:null;if(null!=e){this.parentMask=e;break}t=t.parent}},getBoundsRec:function(t,e,r){F.prototype.getBoundsRec.call(this,t,e,r);var i=e.xMin,n=e.yMin,a=e.xMax,s=e.yMax;e.xMin=1e20,e.yMin=1e20,e.xMax=-1e20,e.yMax=-1e20,this.addBounds(t,e,0,0,this.width,this.height),i>e.xMin&&(e.xMin=i),n>e.yMin&&(e.yMin=n),a<e.xMax&&(e.xMax=a),s<e.yMax&&(e.yMax=s)},drawRec:function(t){var e=this.absX,r=this.absY,i=this.width*this.matA+this.height*this.matC+this.absX,n=this.width*this.matB+this.height*this.matD+this.absY;if(t.hasRenderZone){var a=t.renderX,s=t.renderY,o=t.renderW,h=t.renderH;t.setRenderZone(e,r,i-e,n-r),F.prototype.drawRec.call(this,t),t.setRenderZone(a,s,o,h)}else t.setRenderZone(e,r,i-e,n-r),F.prototype.drawRec.call(this,t),t.hasRenderZone=!1,t.engine.setRenderZone()},__class__:fe});var ge=function(){this.engine=ke.CURRENT,this.frame=0,this.time=0,this.elapsedTime=1/Zi.getDefaultFrameRate()};a["h3d.impl.RenderContext"]=ge,ge.__name__=["h3d","impl","RenderContext"],ge.prototype={__class__:ge};var pe=function(t){this.tmpBounds=new ae,this.defaultSmooth=!1,this.globalAlpha=1,ge.call(this),this.scene=t,this.bufPos=0,this.manager=new Ar,this.pass=new _r("",null),this.pass.depth(!0,er.Always),this.pass.set_culling(Je.None),this.baseShader=new Wr,this.baseShader.priority=100,this.baseShader.zValue__=0,this.baseShaderList=new Nn(this.baseShader),this.targetsStack=[],this.filterStack=[],this.textures=new $e};a["h2d.RenderContext"]=pe,pe.__name__=["h2d","RenderContext"],pe.__super__=ge,pe.prototype=e(ge.prototype,{begin:function(){this.texture=null,this.currentObj=null,this.bufPos=0,this.stride=0,this.curX=0,this.curY=0,this.inFilter=null,this.curWidth=this.scene.width,this.curHeight=this.scene.height,this.manager.globals.set("time",this.time);var t=this.baseShader;t.constModified=!0,t.pixelAlign__=!1;var e=this.baseShader.halfPixelInverse__;e.x=.5/this.engine.width,e.y=.5/this.engine.height,e.z=0,e.w=1;var r=this.baseShader.viewport__;r.x=.5*-this.scene.width,r.y=.5*-this.scene.height,r.z=2/this.scene.width,r.w=-2/this.scene.height;var i=this.baseShader.filterMatrixA__;i.x=1,i.y=0,i.z=0,i.w=1;var n=this.baseShader.filterMatrixB__;n.x=0,n.y=1,n.z=0,n.w=1,this.baseShaderList.next=null,this.initShaders(this.baseShaderList),this.engine.selectMaterial(this.pass),this.textures.begin(this)},initShaders:function(t){if(this.currentShaders=t,this.compiledShader=this.manager.compileShaders(t),null==this.buffers)this.buffers=new Kr(this.compiledShader);else{var e=this.buffers,r=this.compiledShader;e.vertex.grow(r.vertex),e.fragment.grow(r.fragment)}this.manager.fillGlobals(this.buffers,this.compiledShader),this.engine.selectShader(this.compiledShader),this.engine.uploadShaderBuffers(this.buffers,0)},end:function(){if(this.texture=null,this.currentObj=null,this.baseShaderList.next=null,0!=this.targetsStack.length)throw new Zn("Missing popTarget()")},pushFilter:function(t){return!(0==this.filterStack.length&&null!=this.onEnterFilter&&!this.onEnterFilter(t))&&(this.filterStack.push(t),this.inFilter=t,!0)},popFilter:function(){var t=this.filterStack.pop();this.filterStack.length>0?this.inFilter=this.filterStack[this.filterStack.length-1]:(this.inFilter=null,null!=this.onLeaveFilter&&this.onLeaveFilter(t))},pushTarget:function(t,e,r,i,n){null==n&&(n=-1),null==i&&(i=-1),null==r&&(r=0),null==e&&(e=0),this.engine.pushTarget(t),this.initShaders(this.baseShaderList),i<0&&(i=null==t?this.scene.width:t.width),n<0&&(n=null==t?this.scene.height:t.height);var a=this.baseShader.halfPixelInverse__;a.x=.5/(null==t?this.engine.width:t.width),a.y=.5/(null==t?this.engine.height:t.height),a.z=0,a.w=1;var s=this.baseShader.viewport__;s.x=.5*-i-e,s.y=.5*-n-r,s.z=2/i,s.w=-2/n,this.targetsStack.push({t:t,x:e,y:r,w:i,h:n,renderZone:this.hasRenderZone?{x:this.renderX,y:this.renderY,w:this.renderW,h:this.renderH}:null}),this.curX=e,this.curY=r,this.curWidth=i,this.curHeight=n,this.hasRenderZone&&(this.hasRenderZone=!1,this.engine.setRenderZone())},popTarget:function(t){null==t&&(t=!0);var e=this.targetsStack.pop();if(null==e)throw new Zn("Too many popTarget()");if(this.engine.popTarget(),t){var r=this.targetsStack[this.targetsStack.length-1],i=null==r?null:r.t,n=null==r?0:r.x,a=null==r?0:r.y,s=null==r?this.scene.width:r.w,o=null==r?this.scene.height:r.h;this.initShaders(this.baseShaderList);var h=this.baseShader.halfPixelInverse__;h.x=.5/(null==i?this.engine.width:i.width),h.y=.5/(null==i?this.engine.height:i.height),h.z=0,h.w=1;var l=this.baseShader.viewport__;l.x=.5*-s-n,l.y=.5*-o-a,l.z=2/s,l.w=-2/o,this.curX=n,this.curY=a,this.curWidth=s,this.curHeight=o}var u=e.renderZone;null!=u&&this.setRenderZone(u.x,u.y,u.w,u.h)},setRenderZone:function(t,e,r,i){this.hasRenderZone=!0,this.renderX=t,this.renderY=e,this.renderW=r,this.renderH=i;var n=this.engine.width/this.scene.width,a=this.engine.height/this.scene.height;if(null!=this.inFilter){var s=this.baseShader.filterMatrixA__,o=this.baseShader.filterMatrixB__,h=t+r,l=e+i,u=t*s.x+e*s.y+s.z,R=t*o.x+e*o.y+o.z,c=h*s.x+l*s.y+s.z,_=h*o.x+l*o.y+o.z;t=u,e=R,r=c-u,i=_-R}this.engine.setRenderZone((t-this.curX)*n+1e-10|0,(e-this.curY)*a+1e-10|0,r*n+1e-10|0,i*a+1e-10|0)},drawScene:function(){this.scene.drawRec(this)},beforeDraw:function(){null==this.texture&&(this.texture=pr.fromColor(16711935)),this.baseShader.texture__=this.texture,this.texture.set_filter((null==this.currentObj.smooth?this.defaultSmooth:this.currentObj.smooth)?nr.Linear:nr.Nearest),this.texture.set_wrap(this.currentObj.tileWrap?ar.Repeat:ar.Clamp);var t=this.currentObj.blendMode;this.inFilter==this.currentObj&&t==ne.Erase&&(t=ne.Add),this.pass.setBlendMode(t),this.manager.fillParams(this.buffers,this.compiledShader,this.currentShaders),this.engine.selectMaterial(this.pass),this.engine.uploadShaderBuffers(this.buffers,1),this.engine.uploadShaderBuffers(this.buffers,2)},beginDrawObject:function(t,e){if(!this.beginDraw(t,e,!0))return!1;if(this.inFilter==t){var r=this.baseShader.color__;r.x=1,r.y=1,r.z=1,r.w=1}else{var i=this.baseShader.color__;i.x=t.color.x,i.y=t.color.y,i.z=t.color.z,i.w=t.color.w*this.globalAlpha}var n=this.baseShader.absoluteMatrixA__;n.x=t.matA,n.y=t.matC,n.z=t.absX,n.w=1;var a=this.baseShader.absoluteMatrixB__;return a.x=t.matB,a.y=t.matD,a.z=t.absY,a.w=1,this.beforeDraw(),!0},drawTile:function(t,e){var r,i,n,a,s,o;if(null!=this.inFilter){var h=this.baseShader.filterMatrixA__,l=this.baseShader.filterMatrixB__;r=t.matA*h.x+t.matB*h.y,i=t.matA*l.x+t.matB*l.y,n=t.matC*h.x+t.matD*h.y,a=t.matC*l.x+t.matD*l.y,s=t.absX*h.x+t.absY*h.y+h.z,o=t.absX*l.x+t.absY*l.y+l.z}else r=t.matA,i=t.matB,n=t.matC,a=t.matD,s=t.absX,o=t.absY;if(0==i&&0==n){var u=e.dx+.5*e.width,R=e.dy+.5*e.height,c=t.matA,_=c<0?-c:c,f=t.matD,g=f<0?-f:f,p=1.5*(e.width>e.height?e.width:e.height)*(_<g?g:_),d=s+u*r-this.curX,v=o+R*a-this.curY;if(d<-p||v<-p||d-p>this.curWidth||v-p>this.curHeight)return!1}else{var m=1e20,y=1e20,x=-1e20,b=-1e20,w=(.5*e.width,.5*e.height,e.dx*r+e.dy*n),j=e.dx*i+e.dy*a;w<m&&(m=w),w>x&&(x=w),j<y&&(y=j),j>b&&(b=j);var T=e.width,S=(T+e.dx)*r+e.dy*n,C=(T+e.dx)*i+e.dy*a;S<m&&(m=S),S>x&&(x=S),C<y&&(y=C),C>b&&(b=C);var M=e.height,k=e.dx*r+(M+e.dy)*n,E=e.dx*i+(M+e.dy)*a;k<m&&(m=k),k>x&&(x=k),E<y&&(y=E),E>b&&(b=E);var A=e.width,I=e.height,P=(A+e.dx)*r+(I+e.dy)*n,D=(A+e.dx)*i+(I+e.dy)*a;P<m&&(m=P),P>x&&(x=P),D<y&&(y=D),D>b&&(b=D);var B=s-this.curX,V=o-this.curY;if(B+x<0||V+b<0||B+m>this.curWidth||V+y>this.curHeight)return!1}if(!this.beginDraw(t,e.innerTex,!0,!0))return!1;if(this.inFilter==t){var O=this.baseShader.color__;O.x=1,O.y=1,O.z=1,O.w=1}else{var F=this.baseShader.color__;F.x=t.color.x,F.y=t.color.y,F.z=t.color.z,F.w=t.color.w*this.globalAlpha}var L=this.baseShader.absoluteMatrixA__;L.x=e.width*t.matA,L.y=e.height*t.matC,L.z=t.absX+e.dx*t.matA+e.dy*t.matC,L.w=1;var G=this.baseShader.absoluteMatrixB__;G.x=e.width*t.matB,G.y=e.height*t.matD,G.z=t.absY+e.dx*t.matB+e.dy*t.matD,G.w=1;var N=this.baseShader.uvPos__;if(N.x=e.u,N.y=e.v,N.z=e.u2-e.u,N.w=e.v2-e.v,this.beforeDraw(),null==this.fixedBuffer||this.fixedBuffer.isDisposed()){this.fixedBuffer=new Se(4,8,[Te.Quads,Te.RawFormat]);for(var z=Ni._new(0),q=z,U=0,Y=[0,0,0,0,1,1,1,1,0,1,0,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1];U<Y.length;){var W=Y[U];if(++U,q.pos==q.array.length){var H=q.array.length<<1;H<128&&(H=128);var X=new ga(H);X.set(q.array),q.array=X}q.array[q.pos++]=W}this.fixedBuffer.uploadVector(q,0,4)}var Z=this.engine;return Z.renderBuffer(this.fixedBuffer,Z.mem.quadIndexes,2,0,-1),!0},beginDraw:function(t,e,r,i){if(null==i&&(i=!1),null!=this.onBeginDraw&&!this.onBeginDraw(t))return!1;for(var n=8,a=!1,s=!1,o=t.shaders,h=this.currentShaders.next;null!=o&&null!=h;){var l=o.s,u=h.s;o=o.next,h=h.next;var R=u.instance;l!=u&&(s=!0),l.updateConstants(this.manager.globals),l.instance!=R&&(a=!0)}if(null==o&&null==h&&this.baseShader.isRelative__==r&&this.baseShader.hasUVPos__==i&&this.baseShader.killAlpha__==this.killAlpha||(a=!0),a){var c=this.baseShader;c.constModified=!0,c.hasUVPos__=i;var _=this.baseShader;_.constModified=!0,_.isRelative__=r;var f=this.baseShader;f.constModified=!0,f.killAlpha__=this.killAlpha,this.baseShader.updateConstants(this.manager.globals),this.baseShaderList.next=t.shaders,this.initShaders(this.baseShaderList)}else if(s){if(this.currentShaders!=this.baseShaderList)throw new Zn("!");this.currentShaders.next=t.shaders}return this.texture=e,this.stride=n,this.currentObj=t,!0},__class__:pe});var de=function(t,e){ie.call(this,e),this.tile=t,this.rangeMin=this.rangeMax=-1,this.curColor=new Pe(1,1,1,1),this.content=new xe};a["h2d.TileGroup"]=de,de.__name__=["h2d","TileGroup"],de.__super__=ie,de.prototype=e(ie.prototype,{getBoundsRec:function(t,e,r){ie.prototype.getBoundsRec.call(this,t,e,r),this.addBounds(t,e,this.content.xMin,this.content.yMin,this.content.xMax-this.content.xMin,this.content.yMax-this.content.yMin)},onRemove:function(){this.content.dispose(),ie.prototype.onRemove.call(this)},draw:function(t){this.drawWith(t,this)},sync:function(t){ie.prototype.sync.call(this,t);var e=this.content;(null==e.buffer||e.buffer.isDisposed())&&e.alloc(ke.CURRENT)},drawWith:function(t,e){var r=this.content.triCount();if(0!=r&&t.beginDrawObject(e,this.tile.innerTex)){var i=this.rangeMin<0?0:2*this.rangeMin;this.rangeMax>0&&this.rangeMax<2*r&&(r=2*this.rangeMax),this.content.doRender(t.engine,i,r-i)}},__class__:de});var ve=function(){};a["hxd.InteractiveScene"]=ve,ve.__name__=["hxd","InteractiveScene"],ve.prototype={__class__:ve};var me=function(){_e.call(this,null);var t=ke.CURRENT;this.ctx=new pe(this),this.width=t.width,this.height=t.height,this.interactive=[],this.eventListeners=[],this.stage=Wi.getInstance(),this.posChanged=!0};a["h2d.Scene"]=me,me.__name__=["h2d","Scene"],me.__interfaces__=[ve,A],me.__super__=_e,me.prototype=e(_e.prototype,{setEvents:function(t){this.events=t},checkResize:function(){if(!this.fixedSize){var t=ke.CURRENT;this.width==t.width&&this.height==t.height||(this.width=t.width,this.height=t.height,this.posChanged=!0)}},dispatchListeners:function(t){this.screenToLocal(t);for(var e=0,r=this.eventListeners;e<r.length;){var i=r[e];if(++e,i(t),!t.propagate)break}},isInteractiveVisible:function(t){for(var e=t;null!=e;){if(!e.visible)return!1;e=e.parent}return!0},screenToLocal:function(t){var e=t.relX*this.width/(this.stage.get_width()*this.scaleX)-this.x,r=t.relY*this.height/(this.stage.get_height()*this.scaleY)-this.y,i=e*this.matA+r*this.matB+this.absX,n=e*this.matC+r*this.matD+this.absY;t.relX=i,t.relY=n},dispatchEvent:function(t,e){var r=e;this.screenToLocal(t);var i=t.relX,n=t.relY,a=i-r.absX,s=n-r.absY,o=r.width*r.matA,h=r.width*r.matC,l=h*a+o*s,u=r.height*r.matB,R=r.height*r.matD,c=u*s+R*a,_=o*R-h*u;t.relX=c/_*r.width,t.relY=l/_*r.height,r.handleEvent(t)},handleEvent:function(t,e){this.screenToLocal(t);for(var r=t.relX,i=t.relY,n=null==e?0:this.interactive.indexOf(e)+1,a=n,s=this.interactive.length;a<s;){var o=a++,h=this.interactive[o];if(null==h)break;var l=r-h.absX,u=i-h.absY,R=h.width*h.matA,c=h.width*h.matC,_=c*l+R*u;if(!(_<0)){var f=h.height*h.matB,g=h.height*h.matD,p=f*u+g*l;if(!(p<0)){var d=R*g-c*f;if(!(_>=d||p>=d)){for(var v=!0,m=h;null!=m;){if(!m.visible){v=!1;break}m=m.parent}if(v){if(t.relX=p/d*h.width,t.relY=_/d*h.height,h.handleEvent(t),!t.cancel)return h;t.cancel=!1,t.propagate=!1}}}}}return null},addEventTarget:function(t){for(var e=t,r=0;null!=e;)e=e.parent,++r;for(var i=r,n=0,a=this.interactive.length;n<a;){for(var s=n++,o=t,h=this.interactive[s],l=i,u=h,R=0;null!=u;)u=u.parent,++R;for(var c=R,_=o,f=h;l>c;)o=_,_=_.parent,--l;for(;c>l;)h=f,f=f.parent,--c;for(;_!=f;)o=_,_=_.parent,h=f,f=f.parent;for(var g=-1,p=0,d=_.children.length;p<d;){var v=p++;if(_.children[v]==o){g=v;break}}for(var m=g,y=-1,x=0,b=f.children.length;x<b;){var w=x++;if(f.children[w]==h){y=w;break}}if(m>y)return void this.interactive.splice(s,0,t)}this.interactive.push(t)},removeEventTarget:function(t,e){null==e&&(e=!1),o.remove(this.interactive,t),e&&null!=this.events&&this.events.onRemove(t)},setElapsedTime:function(t){this.ctx.elapsedTime=t},render:function(t){this.ctx.engine=t,this.ctx.frame++,this.ctx.time+=this.ctx.elapsedTime,this.ctx.globalAlpha=this.alpha,this.sync(this.ctx),0!=this.children.length&&(this.ctx.begin(),this.ctx.drawScene(),this.ctx.end())},sync:function(t){this.allocated||this.onAdd(),this.fixedSize||this.width==t.engine.width&&this.height==t.engine.height||(this.width=t.engine.width,this.height=t.engine.height,this.posChanged=!0),_e.prototype.sync.call(this,t)},__class__:me});var ye=function(t,e,r,i,n,a,s){null==s&&(s=0),null==a&&(a=0),this.innerTex=t,this.x=e,this.y=r,this.width=i,this.height=n,this.dx=a,this.dy=s,null!=t&&this.setTexture(t)};a["h2d.Tile"]=ye,ye.__name__=["h2d","Tile"],ye.fromColor=function(t,e,r,i,n){null==i&&(i=1),null==r&&(r=1),null==e&&(e=1);var a=new ye(pr.fromColor(t,i,n),0,0,1,1);return a.width=e,a.height=r,a},ye.fromTexture=function(t){return new ye(t,0,0,t.width,t.height)},ye.prototype={setTexture:function(t){this.innerTex=t,null!=t&&(this.u=this.x/t.width,this.v=this.y/t.height,this.u2=(this.x+this.width)/t.width,this.v2=(this.y+this.height)/t.height)},__class__:ye};var xe=function(){this.clear()};a["h2d._TileGroup.TileLayerContent"]=xe,xe.__name__=["h2d","_TileGroup","TileLayerContent"],
xe.__super__=he,xe.prototype=e(he.prototype,{clear:function(){var t=Ni._new(0);this.tmp=t,null!=this.buffer&&this.buffer.dispose(),this.buffer=null,this.xMin=1/0,this.yMin=1/0,this.xMax=-(1/0),this.yMax=-(1/0)},triCount:function(){return null==this.buffer?this.tmp.pos>>4:this.buffer.totalVertices()>>1},alloc:function(t){null==this.tmp&&this.clear(),this.buffer=Se.ofFloats(this.tmp,8,[Te.Quads,Te.RawFormat])},doRender:function(t,e,r){(null==this.buffer||this.buffer.isDisposed())&&this.alloc(ke.CURRENT),t.renderBuffer(this.buffer,t.mem.quadIndexes,2,e,r)},__class__:xe});var be=function(t,e){null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e};a["h2d.col.Point"]=be,be.__name__=["h2d","col","Point"],be.prototype={__class__:be};var we=function(t){de.call(this,ye.fromColor(16777215),t)};a["h2d.css.Fill"]=we,we.__name__=["h2d","css","Fill"],we.__super__=de,we.prototype=e(de.prototype,{__class__:we});var je=function(){this.boundsExtend=0,this.autoBounds=!0};a["h2d.filter.Filter"]=je,je.__name__=["h2d","filter","Filter"],je.prototype={sync:function(t,e){},bind:function(t){},unbind:function(t){},getBounds:function(t,e){t.getBounds(t,e),e.xMin-=this.boundsExtend,e.yMin-=this.boundsExtend,e.xMax+=this.boundsExtend,e.yMax+=this.boundsExtend},draw:function(t,e){return e},__class__:je};var Te=a["h3d.BufferFlag"]={__ename__:!0,__constructs__:["Dynamic","Triangles","Quads","Managed","RawFormat","NoAlloc"]};Te.Dynamic=["Dynamic",0],Te.Dynamic.toString=s,Te.Dynamic.__enum__=Te,Te.Triangles=["Triangles",1],Te.Triangles.toString=s,Te.Triangles.__enum__=Te,Te.Quads=["Quads",2],Te.Quads.toString=s,Te.Quads.__enum__=Te,Te.Managed=["Managed",3],Te.Managed.toString=s,Te.Managed.__enum__=Te,Te.RawFormat=["RawFormat",4],Te.RawFormat.toString=s,Te.RawFormat.__enum__=Te,Te.NoAlloc=["NoAlloc",5],Te.NoAlloc.toString=s,Te.NoAlloc.__enum__=Te,Te.__empty_constructs__=[Te.Dynamic,Te.Triangles,Te.Quads,Te.Managed,Te.RawFormat,Te.NoAlloc];var Se=function(t,e,r,i){this.id=Se.GUID++,this.vertices=t;var n=0;if(this.flags=n,null!=r)for(var a=0;a<r.length;){var s=r[a];++a,this.flags|=1<<s[1]}0==(this.flags&1<<Te.NoAlloc[1])&&ke.CURRENT.mem.allocBuffer(this,e)};a["h3d.Buffer"]=Se,Se.__name__=["h3d","Buffer"],Se.ofFloats=function(t,e,r,i){var n=t.pos/e|0,a=new Se(n,e,r,i);return a.uploadVector(t,0,n),a},Se.prototype={isDisposed:function(){return null==this.buffer||null==this.buffer.vbuf},dispose:function(){null!=this.buffer&&(this.buffer.freeBuffer(this),this.buffer=null,null!=this.next&&this.next.dispose())},totalVertices:function(){for(var t=0,e=this;null!=e;)t+=e.vertices,e=e.next;return t},uploadVector:function(t,e,r,i){null==i&&(i=0);for(var n=this;null!=n&&i>=n.vertices;)i-=n.vertices,n=n.next;for(;r>0;){if(null==n)throw new Zn("Too many vertices");var a=r+i>n.vertices?n.vertices-i:r;n.buffer.uploadVertexBuffer(n.position+i,a,t,e),i=0,e+=a*this.buffer.stride,r-=a,n=n.next}},__class__:Se};var Ce=function(t,e,r,i,n,a){null==a&&(a=!1),null==n&&(n=4e3),null==i&&(i=.02),null==r&&(r=1.333333),null==e&&(e=1),null==t&&(t=25),this.viewY=0,this.viewX=0,this.fovY=t,this.zoom=e,this.screenRatio=r,this.zNear=i,this.zFar=n,this.rightHanded=a,this.pos=new Pe(2,3,4),this.up=new Pe(0,0,1),this.target=new Pe(0,0,0),this.m=new Ae,this.mcam=new Ae,this.mproj=new Ae,this.update()};a["h3d.Camera"]=Ce,Ce.__name__=["h3d","Camera"],Ce.prototype={getInverseViewProj:function(){return null==this.minv&&(this.minv=new Ae),this.needInv&&(this.minv.initInverse(this.m),this.needInv=!1),this.minv},unproject:function(t,e,r){var i=new Pe(t,e,r),n=this.getInverseViewProj(),a=i.x*n._11+i.y*n._21+i.z*n._31+i.w*n._41,s=i.x*n._12+i.y*n._22+i.z*n._32+i.w*n._42,o=i.x*n._13+i.y*n._23+i.z*n._33+i.w*n._43,h=1/(i.x*n._14+i.y*n._24+i.z*n._34+i.w*n._44);return i.x=a*h,i.y=s*h,i.z=o*h,i.w=1,i},update:function(){if(null!=this.follow){var t=this.pos;t.x=0,t.y=0,t.z=0,t.w=1;var e=this.target;if(e.x=0,e.y=0,e.z=0,e.w=1,this.follow.pos.localToGlobal(this.pos),this.follow.target.localToGlobal(this.target),null!=this.follow.pos.name)for(var r=this.follow.pos;null!=r;){if(null!=r.currentAnimation){var i=r.currentAnimation.getPropValue(this.follow.pos.name,"FOVY");if(null!=i){this.fovY=i;break}}r=r.parent}}this.makeCameraMatrix(this.mcam),this.makeFrustumMatrix(this.mproj),this.m.multiply(this.mcam,this.mproj),this.needInv=!0,null!=this.miview&&(this.miview._44=0)},getFrustumCorners:function(){return[this.unproject(-1,1,0),this.unproject(1,1,0),this.unproject(1,-1,0),this.unproject(-1,-1,0),this.unproject(-1,1,1),this.unproject(1,1,1),this.unproject(1,-1,1),this.unproject(-1,-1,1)]},makeCameraMatrix:function(t){var e;if(this.rightHanded){var r=this.pos,i=this.target;e=new Pe(r.x-i.x,r.y-i.y,r.z-i.z,r.w-i.w)}else{var n=this.target,a=this.pos;e=new Pe(n.x-a.x,n.y-a.y,n.z-a.z,n.w-a.w)}e.normalize();var s=this.up,o=new Pe(s.y*e.z-s.z*e.y,s.z*e.x-s.x*e.z,s.x*e.y-s.y*e.x,1);o.normalize(),0==Math.sqrt(o.x*o.x+o.y*o.y+o.z*o.z)&&(o.x=e.y,o.y=e.z,o.z=e.x);var h,l,u,R;u=e.y*o.z-e.z*o.y,l=e.z*o.x-e.x*o.z,h=e.x*o.y-e.y*o.x,R=1,t._11=o.x,t._12=u,t._13=e.x,t._14=0,t._21=o.y,t._22=l,t._23=e.y,t._24=0,t._31=o.z,t._32=h,t._33=e.z,t._34=0;var c=this.pos;t._41=-(o.x*c.x+o.y*c.y+o.z*c.z);var _=this.pos;t._42=-(u*_.x+l*_.y+h*_.z);var f=this.pos;t._43=-(e.x*f.x+e.y*f.y+e.z*f.z),t._44=1},makeFrustumMatrix:function(t){t.zero();var e=this.orthoBounds;if(null!=e){var r=1/(e.xMax-e.xMin),i=1/(e.yMax-e.yMin),n=1/(e.zMax-e.zMin);t._11=2*r,t._22=2*i,t._33=n,t._41=-(e.xMin+e.xMax)*r,t._42=-(e.yMin+e.yMax)*i,t._43=-e.zMin*n,t._44=1}else{var a=Math.PI/180,s=Math.atan(Math.tan(.5*this.fovY*a)*this.screenRatio),o=this.zoom/Math.tan(s);t._11=o,t._22=o*this.screenRatio,t._33=this.zFar/(this.zFar-this.zNear),t._34=1,t._43=-(this.zNear*this.zFar)/(this.zFar-this.zNear)}t._11+=this.viewX*t._14,t._21+=this.viewX*t._24,t._31+=this.viewX*t._34,t._41+=this.viewX*t._44,t._12+=this.viewY*t._14,t._22+=this.viewY*t._24,t._32+=this.viewY*t._34,t._42+=this.viewY*t._44,this.rightHanded&&(t._33*=-1,t._34*=-1)},__class__:Ce};var Me=function(t,e){this.t=t,this.next=e};a["h3d._Engine.TargetTmp"]=Me,Me.__name__=["h3d","_Engine","TargetTmp"],Me.prototype={__class__:Me};var ke=function(t,e){null==e&&(e=0),null==t&&(t=!0),this.resCache=new wi,this.textureColorCache=new bi,this.tmpVector=new Pe,this.frameCount=0,this.backgroundColor=-16777216,this.hardware=t,this.antiAlias=e,this.autoResize=!0,this.set_fullScreen(!Zi.getValue(Xi.IsWindowed)),this.stage=Wi.getInstance(),this.realFps=Zi.getDefaultFrameRate(),this.lastTime=(new Date).getTime()/1e3,this.stage.addResizeEvent(n(this,this.onStageResize)),this.driver=new He(this.antiAlias),ke.CURRENT=this};a["h3d.Engine"]=ke,ke.__name__=["h3d","Engine"],ke.prototype={init:function(){this.driver.init(n(this,this.onCreate),!this.hardware)},selectShader:function(t){this.needFlushTarget&&this.doFlushTarget(),this.driver.selectShader(t)&&this.shaderSwitches++},selectMaterial:function(t){this.driver.selectMaterial(t)},uploadShaderBuffers:function(t,e){this.driver.uploadShaderBuffers(t,e)},selectBuffer:function(t){return!t.isDisposed()&&(this.needFlushTarget&&this.doFlushTarget(),this.driver.selectBuffer(t),!0)},renderBuffer:function(t,e,r,i,n){if(null==n&&(n=-1),null==i&&(i=0),!e.isDisposed())for(;;){var a=t.vertices/r|0,s=t.position/r|0;if(i>0){if(i>=a){if(i-=a,t=t.next,null==t)break;continue}s+=i,a-=i,i=0}if(n>=0){if(0==n)return;n-=a,n<0&&(a+=n,n=0)}if(a>0&&this.selectBuffer(t)&&(this.driver.draw(e.ibuf,3*s,a),this.drawTriangles+=a,this.drawCalls++),t=t.next,null==t)break}},renderIndexed:function(t,e,r,i){if(null==i&&(i=-1),null==r&&(r=0),null!=t.next)throw new Zn("Buffer is split");if(!e.isDisposed()){var n=e.count/3|0;i<0&&(i=n-r),i>0&&this.selectBuffer(t)&&(this.driver.draw(e.ibuf,3*r,i),this.drawTriangles+=i,this.drawCalls++)}},set_debug:function(t){return this.debug=t,this.driver.setDebug(this.debug),t},onCreate:function(t){ke.CURRENT=this,this.autoResize&&(this.width=this.stage.get_width(),this.height=this.stage.get_height()),t?this.mem.onContextLost():(this.mem=new Ke(this.driver),this.mem.init()),this.hardware=this.driver.hasFeature(ze.HardwareAccelerated),this.set_debug(this.debug),this.set_fullScreen(this.fullScreen),this.resize(this.width,this.height),t?this.onContextLost():this.onReady()},onContextLost:function(){},onReady:function(){},onStageResize:function(){if(this.autoResize&&!this.driver.isDisposed()){var t=this.stage.get_width(),e=this.stage.get_height();t==this.width&&e==this.height||this.resize(t,e),this.onResized()}},set_fullScreen:function(t){return this.fullScreen=t,null!=this.mem&&Zi.getValue(Xi.IsWindowed)&&this.stage.setFullScreen(t),t},onResized:function(){},resize:function(t,e){t<32&&(t=32),e<32&&(e=32),this.width=t,this.height=e,this.driver.isDisposed()||this.driver.resize(t,e)},begin:function(){return!this.driver.isDisposed()&&(this.frameCount++,this.drawTriangles=0,this.shaderSwitches=0,this.drawCalls=0,this.targetStack=null,this.needFlushTarget=null!=this.currentTarget,this.driver.begin(this.frameCount),null!=this.backgroundColor&&this.clear(this.backgroundColor,1,0),!0)},end:function(){this.driver.present()},getCurrentTarget:function(){return null==this.targetStack?null:this.targetStack.t},pushTarget:function(t){var e=this.targetTmp;null==e?e=new Me(t,this.targetStack):(this.targetTmp=e.next,e.t=t,e.next=this.targetStack),this.targetStack=e,this.needFlushTarget=this.currentTarget!=t},popTarget:function(){var t=this.targetStack;if(null==t)throw new Zn("popTarget() with no matching pushTarget()");this.targetStack=t.next;var e=null==this.targetStack?null:this.targetStack.t;this.needFlushTarget=this.currentTarget!=e,t.t=null,t.next=this.targetTmp,this.targetTmp=t},doFlushTarget:function(){var t=null==this.targetStack?null:this.targetStack.t;this.currentTarget=t,this.driver.setRenderTarget(t),this.needFlushTarget=!1},clear:function(t,e,r){if(null!=t){var i=this.tmpVector;i.x=(t>>16&255)/255,i.y=(t>>8&255)/255,i.z=(255&t)/255,i.w=(t>>>24)/255}this.needFlushTarget&&this.doFlushTarget(),this.driver.clear(null==t?null:this.tmpVector,e,r)},setRenderZone:function(t,e,r,i){null==i&&(i=-1),null==r&&(r=-1),null==e&&(e=0),null==t&&(t=0),this.driver.setRenderZone(t,e,r,i)},render:function(t){if(!this.begin())return!1;t.render(this),this.end();var e=(new Date).getTime()/1e3-this.lastTime;if(this.lastTime+=e,e>0){var r=1/e;r>2*this.realFps?r=2*this.realFps:r<.5*this.realFps&&(r=.5*this.realFps);var i=e/.5;i>.3&&(i=.3),this.realFps=this.realFps*(1-i)+r*i}return!0},__class__:ke};var Ee=function(t){this.mem=ke.CURRENT.mem,this.count=t,this.mem.allocIndexes(this)};a["h3d.Indexes"]=Ee,Ee.__name__=["h3d","Indexes"],Ee.alloc=function(t,e,r){null==r&&(r=-1),null==e&&(e=0),r<0&&(r=t.length);var i=new Ee(r);return i.upload(t,0,r),i},Ee.prototype={isDisposed:function(){return null==this.ibuf},upload:function(t,e,r,i){null==i&&(i=0),this.mem.driver.uploadIndexBuffer(this.ibuf,e,r,t,i)},dispose:function(){null!=this.ibuf&&this.mem.deleteIndexes(this)},__class__:Ee};var Ae=function(){};a["h3d.Matrix"]=Ae,Ae.__name__=["h3d","Matrix"],Ae.prototype={zero:function(){this._11=0,this._12=0,this._13=0,this._14=0,this._21=0,this._22=0,this._23=0,this._24=0,this._31=0,this._32=0,this._33=0,this._34=0,this._41=0,this._42=0,this._43=0,this._44=0},identity:function(){this._11=1,this._12=0,this._13=0,this._14=0,this._21=0,this._22=1,this._23=0,this._24=0,this._31=0,this._32=0,this._33=1,this._34=0,this._41=0,this._42=0,this._43=0,this._44=1},multiply3x4:function(t,e){var r=t._11,i=t._12,n=t._13,a=t._21,s=t._22,o=t._23,h=t._31,l=t._32,u=t._33,R=t._41,c=t._42,_=t._43,f=e._11,g=e._12,p=e._13,d=e._21,v=e._22,m=e._23,y=e._31,x=e._32,b=e._33,w=e._41,j=e._42,T=e._43;this._11=r*f+i*d+n*y,this._12=r*g+i*v+n*x,this._13=r*p+i*m+n*b,this._14=0,this._21=a*f+s*d+o*y,this._22=a*g+s*v+o*x,this._23=a*p+s*m+o*b,this._24=0,this._31=h*f+l*d+u*y,this._32=h*g+l*v+u*x,this._33=h*p+l*m+u*b,this._34=0,this._41=R*f+c*d+_*y+w,this._42=R*g+c*v+_*x+j,this._43=R*p+c*m+_*b+T,this._44=1},multiply:function(t,e){var r=t._11,i=t._12,n=t._13,a=t._14,s=t._21,o=t._22,h=t._23,l=t._24,u=t._31,R=t._32,c=t._33,_=t._34,f=t._41,g=t._42,p=t._43,d=t._44,v=e._11,m=e._12,y=e._13,x=e._14,b=e._21,w=e._22,j=e._23,T=e._24,S=e._31,C=e._32,M=e._33,k=e._34,E=e._41,A=e._42,I=e._43,P=e._44;this._11=r*v+i*b+n*S+a*E,this._12=r*m+i*w+n*C+a*A,this._13=r*y+i*j+n*M+a*I,this._14=r*x+i*T+n*k+a*P,this._21=s*v+o*b+h*S+l*E,this._22=s*m+o*w+h*C+l*A,this._23=s*y+o*j+h*M+l*I,this._24=s*x+o*T+h*k+l*P,this._31=u*v+R*b+c*S+_*E,this._32=u*m+R*w+c*C+_*A,this._33=u*y+R*j+c*M+_*I,this._34=u*x+R*T+c*k+_*P,this._41=f*v+g*b+p*S+d*E,this._42=f*m+g*w+p*C+d*A,this._43=f*y+g*j+p*M+d*I,this._44=f*x+g*T+p*k+d*P},inverse3x4:function(t){var e=t._11,r=t._12,i=t._13,n=t._21,a=t._22,s=t._23,o=t._31,h=t._32,l=t._33,u=t._41,R=t._42,c=t._43;this._11=a*l-s*h,this._12=i*h-r*l,this._13=r*s-i*a,this._14=0,this._21=s*o-n*l,this._22=e*l-i*o,this._23=i*n-e*s,this._24=0,this._31=n*h-a*o,this._32=r*o-e*h,this._33=e*a-r*n,this._34=0,this._41=-n*h*c+n*l*R+o*a*c-o*s*R-u*a*l+u*s*h,this._42=e*h*c-e*l*R-o*r*c+o*i*R+u*r*l-u*i*h,this._43=-e*a*c+e*s*R+n*r*c-n*i*R-u*r*s+u*i*a,this._44=e*a*l-e*s*h-n*r*l+n*i*h+o*r*s-o*i*a,this._44=1;var _=e*this._11+r*this._21+i*this._31;if((_<0?-_:_)<1e-10)return void this.zero();var f=1/_;this._11*=f,this._12*=f,this._13*=f,this._21*=f,this._22*=f,this._23*=f,this._31*=f,this._32*=f,this._33*=f,this._41*=f,this._42*=f,this._43*=f},initInverse:function(t){var e=t._11,r=t._12,i=t._13,n=t._14,a=t._21,s=t._22,o=t._23,h=t._24,l=t._31,u=t._32,R=t._33,c=t._34,_=t._41,f=t._42,g=t._43,p=t._44;this._11=s*R*p-s*c*g-u*o*p+u*h*g+f*o*c-f*h*R,this._12=-r*R*p+r*c*g+u*i*p-u*n*g-f*i*c+f*n*R,this._13=r*o*p-r*h*g-s*i*p+s*n*g+f*i*h-f*n*o,this._14=-r*o*c+r*h*R+s*i*c-s*n*R-u*i*h+u*n*o,this._21=-a*R*p+a*c*g+l*o*p-l*h*g-_*o*c+_*h*R,this._22=e*R*p-e*c*g-l*i*p+l*n*g+_*i*c-_*n*R,this._23=-e*o*p+e*h*g+a*i*p-a*n*g-_*i*h+_*n*o,this._24=e*o*c-e*h*R-a*i*c+a*n*R+l*i*h-l*n*o,this._31=a*u*p-a*c*f-l*s*p+l*h*f+_*s*c-_*h*u,this._32=-e*u*p+e*c*f+l*r*p-l*n*f-_*r*c+_*n*u,this._33=e*s*p-e*h*f-a*r*p+a*n*f+_*r*h-_*n*s,this._34=-e*s*c+e*h*u+a*r*c-a*n*u-l*r*h+l*n*s,this._41=-a*u*g+a*R*f+l*s*g-l*o*f-_*s*R+_*o*u,this._42=e*u*g-e*R*f-l*r*g+l*i*f+_*r*R-_*i*u,this._43=-e*s*g+e*o*f+a*r*g-a*i*f-_*r*o+_*i*s,this._44=e*s*R-e*o*u-a*r*R+a*i*u+l*r*o-l*i*s;var d=e*this._11+r*this._21+i*this._31+n*this._41;return(d<0?-d:d)<1e-10?void this.zero():(d=1/d,this._11*=d,this._12*=d,this._13*=d,this._14*=d,this._21*=d,this._22*=d,this._23*=d,this._24*=d,this._31*=d,this._32*=d,this._33*=d,this._34*=d,this._41*=d,this._42*=d,this._43*=d,void(this._44*=d))},load:function(t){this._11=t[0],this._12=t[1],this._13=t[2],this._14=t[3],this._21=t[4],this._22=t[5],this._23=t[6],this._24=t[7],this._31=t[8],this._32=t[9],this._33=t[10],this._34=t[11],this._41=t[12],this._42=t[13],this._43=t[14],this._44=t[15]},__class__:Ae};var Ie=function(t,e,r,i){null==i&&(i=1),null==r&&(r=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=r,this.w=i};a["h3d.Quat"]=Ie,Ie.__name__=["h3d","Quat"],Ie.prototype={saveToMatrix:function(t){var e=this.x*this.x,r=this.x*this.y,i=this.x*this.z,n=this.x*this.w,a=this.y*this.y,s=this.y*this.z,o=this.y*this.w,h=this.z*this.z,l=this.z*this.w;return t._11=1-2*(a+h),t._12=2*(r+l),t._13=2*(i-o),t._14=0,t._21=2*(r-l),t._22=1-2*(e+h),t._23=2*(s+n),t._24=0,t._31=2*(i+o),t._32=2*(s-n),t._33=1-2*(e+a),t._34=0,t._41=0,t._42=0,t._43=0,t._44=1,t},__class__:Ie};var Pe=function(t,e,r,i){null==i&&(i=1),null==r&&(r=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=r,this.w=i};a["h3d.Vector"]=Pe,Pe.__name__=["h3d","Vector"],Pe.prototype={normalize:function(){var t=this.x*this.x+this.y*this.y+this.z*this.z;t=t<1e-10?0:1/Math.sqrt(t),this.x*=t,this.y*=t,this.z*=t},__class__:Pe};var De=function(){};a["h3d.anim.AnimatedObject"]=De,De.__name__=["h3d","anim","AnimatedObject"];var Be=function(t,e,r){this.name=t,this.frameCount=e,this.sampling=r,this.objects=[],this.lastEvent=-1,this.frame=0,this.speed=1,this.loop=!0,this.pause=!1};a["h3d.anim.Animation"]=Be,Be.__name__=["h3d","anim","Animation"],Be.prototype={getPropValue:function(t,e){return null},sync:function(t){throw null==t&&(t=!1),new Zn("assert")},isPlaying:function(){return!this.pause&&(this.speed<0?-this.speed:this.speed)>1e-6},endFrame:function(){return this.frameCount},update:function(t){if(!this.isInstance)throw new Zn("You must instanciate this animation first");if(!this.isPlaying())return 0;if(null!=this.events&&null!=this.onEvent){var e=0|this.frame,r=this.frame+t*this.speed*this.sampling|0;r>=this.frameCount&&(r=this.frameCount-1);for(var i=e,n=r+1;i<n;){var a=i++;if(a!=this.lastEvent&&(this.lastEvent=a,null!=this.events[a])){var s=this.frame,o=t;t-=(a-this.frame)/(this.speed*this.sampling),this.frame=a;for(var h=0,l=this.events[a];h<l.length;){var u=l[h];++h,this.onEvent(u)}if(this.frame==a&&a==this.frameCount-1){this.frame=s,t=o;break}return t}}}if(null!=this.onAnimEnd){var R=this.endFrame(),c=0==this.speed?0:(R-this.frame)/(this.speed*this.sampling);if(c<=t&&c>0)return this.frame=R,t-=c,this.onAnimEnd(),this.frame==R&&this.isPlaying()&&(this.loop?this.frame=0:t=0),t}return this.frame+=t*this.speed*this.sampling,this.frame>=this.frameCount&&(this.loop?this.frame%=this.frameCount:this.frame=this.frameCount),0},__class__:Be};var Ve=function(){};a["h3d.col.Collider"]=Ve,Ve.__name__=["h3d","col","Collider"],Ve.__interfaces__=[oe],Ve.prototype={__class__:Ve};var Oe=function(){this.xMin=1e20,this.xMax=-1e20,this.yMin=1e20,this.yMax=-1e20,this.zMin=1e20,this.zMax=-1e20};a["h3d.col.Bounds"]=Oe,Oe.__name__=["h3d","col","Bounds"],Oe.__interfaces__=[Ve],Oe.prototype={rayIntersection:function(t,e){var r=(this.xMin-t.px)/t.lx,i=(this.yMin-t.py)/t.ly,n=(this.zMin-t.pz)/t.lz,a=(this.xMax-t.px)/t.lx,s=(this.yMax-t.py)/t.ly,o=(this.zMax-t.pz)/t.lz,h=r>a?a:r,l=i>s?s:i,u=n>o?o:n,R=r<a?a:r,c=i<s?s:i,_=n<o?o:n,f=R>c?c:R,g=f>_?_:f,p=h<l?l:h,d=p<u?u:p;return g<d?-1:d},intersection:function(t,e){var r=t.xMin,i=e.xMin,n=r<i?i:r,a=t.yMin,s=e.yMin,o=a<s?s:a,h=t.zMin,l=e.zMin,u=h<l?l:h,R=t.xMax,c=e.xMax,_=R>c?c:R,f=t.yMax,g=e.yMax,p=f>g?g:f,d=t.zMax,v=e.zMax,m=d>v?v:d;this.xMin=n,this.xMax=_,this.yMin=o,this.yMax=p,this.zMin=u,this.zMax=m},scaleCenter:function(t){var e=.5*(this.xMax-this.xMin)*t,r=.5*(this.yMax-this.yMin)*t,i=.5*(this.zMax-this.zMin)*t,n=.5*(this.xMax+this.xMin),a=.5*(this.yMax+this.yMin),s=.5*(this.zMax+this.zMin);this.xMin=n-e,this.yMin=a-r,this.zMin=s-i,this.xMax=n+e,this.yMax=a+r,this.zMax=s+i},__class__:Oe};var Fe=function(t){this.checkNearFar=!0,this.pleft=new Le(t._14+t._11,t._24+t._21,t._34+t._31,-(t._44+t._41)),this.pright=new Le(t._14-t._11,t._24-t._21,t._34-t._31,t._41-t._44),this.ptop=new Le(t._14-t._12,t._24-t._22,t._34-t._32,t._42-t._44),this.pbottom=new Le(t._14+t._12,t._24+t._22,t._34+t._32,-(t._44+t._42)),this.pnear=new Le(t._13,t._23,t._33,-t._43),this.pfar=new Le(t._14-t._13,t._24-t._23,t._34-t._33,t._43-t._44);var e=this.pleft,r=1/Math.sqrt(e.nx*e.nx+e.ny*e.ny+e.nz*e.nz);e.nx*=r,e.ny*=r,e.nz*=r,e.d*=r;var i=this.pright,n=1/Math.sqrt(i.nx*i.nx+i.ny*i.ny+i.nz*i.nz);i.nx*=n,i.ny*=n,i.nz*=n,i.d*=n;var a=this.ptop,s=1/Math.sqrt(a.nx*a.nx+a.ny*a.ny+a.nz*a.nz);a.nx*=s,a.ny*=s,a.nz*=s,a.d*=s;var o=this.pbottom,h=1/Math.sqrt(o.nx*o.nx+o.ny*o.ny+o.nz*o.nz);o.nx*=h,o.ny*=h,o.nz*=h,o.d*=h;var l=this.pnear,u=1/Math.sqrt(l.nx*l.nx+l.ny*l.ny+l.nz*l.nz);l.nx*=u,l.ny*=u,l.nz*=u,l.d*=u;var R=this.pfar,c=1/Math.sqrt(R.nx*R.nx+R.ny*R.ny+R.nz*R.nz);R.nx*=c,R.ny*=c,R.nz*=c,R.d*=c};a["h3d.col.Frustum"]=Fe,Fe.__name__=["h3d","col","Frustum"],Fe.prototype={hasSphere:function(t){var e,r,i=t.x;r=t.y,e=t.z;var n=this.pleft;if(n.nx*i+n.ny*r+n.nz*e-n.d<-t.r)return!1;var a=this.pright;if(a.nx*i+a.ny*r+a.nz*e-a.d<-t.r)return!1;var s=this.ptop;if(s.nx*i+s.ny*r+s.nz*e-s.d<-t.r)return!1;var o=this.pbottom;if(o.nx*i+o.ny*r+o.nz*e-o.d<-t.r)return!1;if(this.checkNearFar){var h=this.pnear;if(h.nx*i+h.ny*r+h.nz*e-h.d<-t.r)return!1;var l=this.pfar;if(l.nx*i+l.ny*r+l.nz*e-l.d<-t.r)return!1}return!0},__class__:Fe};var Le=function(t,e,r,i){this.nx=t,this.ny=e,this.nz=r,this.d=i};a["h3d.col.Plane"]=Le,Le.__name__=["h3d","col","Plane"],Le.prototype={__class__:Le};var Ge=function(){};a["h3d.col.Ray"]=Ge,Ge.__name__=["h3d","col","Ray"],Ge.prototype={normalize:function(){var t=this.lx*this.lx+this.ly*this.ly+this.lz*this.lz;1!=t&&(t=t<1e-10?0:1/Math.sqrt(t),this.lx*=t,this.ly*=t,this.lz*=t)},__class__:Ge};var Ne=function(t,e,r,i){null==i&&(i=0),null==r&&(r=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=r,this.r=i};a["h3d.col.Sphere"]=Ne,Ne.__name__=["h3d","col","Sphere"],Ne.__interfaces__=[Ve],Ne.prototype={rayIntersection:function(t,e){var r=this.r*this.r,i=t.px+t.lx,n=t.py+t.ly,a=t.pz+t.lz,s=t.lx*t.lx+t.ly*t.ly+t.lz*t.lz,o=2*t.lx*(this.x-i)+2*t.ly*(this.y-n)+2*t.lz*(this.z-a),h=this.x*this.x+this.y*this.y+this.z*this.z+(i*i+n*n+a*a)-2*(this.x*i+this.y*n+this.z*a)-r,l=o*o-4*s*h;if(l<0)return-1;l=Math.sqrt(l);var u=(-o+l)/(2*s);return 1-u},__class__:Ne};var ze=a["h3d.impl.Feature"]={__ename__:!0,__constructs__:["StandardDerivatives","FloatTextures","AllocDepthBuffer","HardwareAccelerated","MultipleRenderTargets","Queries"]};ze.StandardDerivatives=["StandardDerivatives",0],ze.StandardDerivatives.toString=s,ze.StandardDerivatives.__enum__=ze,ze.FloatTextures=["FloatTextures",1],ze.FloatTextures.toString=s,ze.FloatTextures.__enum__=ze,ze.AllocDepthBuffer=["AllocDepthBuffer",2],ze.AllocDepthBuffer.toString=s,ze.AllocDepthBuffer.__enum__=ze,ze.HardwareAccelerated=["HardwareAccelerated",3],ze.HardwareAccelerated.toString=s,ze.HardwareAccelerated.__enum__=ze,ze.MultipleRenderTargets=["MultipleRenderTargets",4],ze.MultipleRenderTargets.toString=s,ze.MultipleRenderTargets.__enum__=ze,ze.Queries=["Queries",5],ze.Queries.toString=s,ze.Queries.__enum__=ze,ze.__empty_constructs__=[ze.StandardDerivatives,ze.FloatTextures,ze.AllocDepthBuffer,ze.HardwareAccelerated,ze.MultipleRenderTargets,ze.Queries];var qe=function(){};a["h3d.impl.Driver"]=qe,qe.__name__=["h3d","impl","Driver"],qe.prototype={hasFeature:function(t){return!1},isDisposed:function(){return!0},begin:function(t){},generateMipMaps:function(t){throw new Zn("Mipmaps auto generation is not supported on this platform")},clear:function(t,e,r){},init:function(t,e){null==e&&(e=!1)},resize:function(t,e){},selectShader:function(t){return!1},selectMaterial:function(t){},uploadShaderBuffers:function(t,e){},selectBuffer:function(t){},draw:function(t,e,r){},setRenderZone:function(t,e,r,i){},setRenderTarget:function(t,e,r){null==r&&(r=0),null==e&&(e=0)},allocDepthBuffer:function(t){return null},disposeDepthBuffer:function(t){},getDefaultDepthBuffer:function(){return null},present:function(){},setDebug:function(t){},allocTexture:function(t){return null},allocIndexes:function(t){return null},allocVertexes:function(t){return null},disposeTexture:function(t){},disposeIndexes:function(t){},disposeVertexes:function(t){},uploadIndexBuffer:function(t,e,r,i,n){},uploadVertexBuffer:function(t,e,r,i,n){},uploadTextureBitmap:function(t,e,r,i){},uploadTexturePixels:function(t,e,r,i){},__class__:qe};var Ue=function(t,e,r){this.s=t,this.vertex=e,this.shader=r};a["h3d.impl._GlDriver.CompiledShader"]=Ue,Ue.__name__=["h3d","impl","_GlDriver","CompiledShader"],Ue.prototype={__class__:Ue};var Ye=function(){};a["h3d.impl._GlDriver.CompiledAttribute"]=Ye,Ye.__name__=["h3d","impl","_GlDriver","CompiledAttribute"],Ye.prototype={__class__:Ye};var We=function(){};a["h3d.impl._GlDriver.CompiledProgram"]=We,We.__name__=["h3d","impl","_GlDriver","CompiledProgram"],We.prototype={__class__:We};var He=function(t){if(null==t&&(t=0),this.firstShader=!0,this.boundTextures=[],this.canvas=Wi.getInstance().canvas,this.gl=Kn.getContextWebGL(this.canvas,{alpha:!1,antialias:t>0}),null==this.gl)throw new Zn("Could not acquire GL context");"undefined"!=typeof WebGLDebugUtils&&(this.gl=WebGLDebugUtils.makeDebugContext(this.gl)),this.commonFB=this.gl.createFramebuffer(),this.programs=new bi,this.curAttribs=0,this.curMatBits=-1,this.defStencil=new fr};a["h3d.impl.GlDriver"]=He,He.__name__=["h3d","impl","GlDriver"],He.__super__=qe,He.prototype=e(qe.prototype,{setDebug:function(t){this.debug=t},begin:function(t){this.frame=t,this.resetStream(),this.gl.useProgram(null),this.curShader=null,this.curBuffer=null},getDriverName:function(t){var e=this.gl.getParameter(7937);return t?e+=" GLv"+g.string(this.gl.getParameter(7938)):e=e.split("/").shift(),e=e.split("WebGL ").join(""),"OpenGL "+e},compileShader:function(t,e){var r=e.vertex?35633:35632,i=this.gl.createShader(r),n=t.run(e.data);this.gl.shaderSource(i,n),this.gl.compileShader(i);this.gl.getShaderInfoLog(i);if(1!=this.gl.getShaderParameter(i,35713)){var a=this.gl.getShaderInfoLog(i),s=g.parseInt(o.substr(a,9,null)),h=null==s?null:n.split("\n")[s-1];h=null==h?"":"("+d.trim(h)+")";for(var l=n.split("\n"),u=0,R=l.length;u<R;){var c=u++;l[c]=c+1+"\t"+l[c]}throw new Zn("An error occurred compiling the shaders: "+a+h+"\n\n"+l.join("\n"))}return new Ue(i,e.vertex,e)},initShader:function(t,e,r){var i=e.vertex?"vertex":"fragment";e.globals=this.gl.getUniformLocation(t.p,i+"Globals"),e.params=this.gl.getUniformLocation(t.p,i+"Params");for(var n=[],a=0,s=r.textures2DCount;a<s;){var o=a++;n.push(this.gl.getUniformLocation(t.p,i+"Textures["+o+"]"))}e.textures=n;for(var h=[],l=0,u=r.texturesCubeCount;l<u;){var R=l++;h.push(this.gl.getUniformLocation(t.p,i+"TexturesCube["+R+"]"))}e.cubeTextures=h},selectShader:function(t){var e=this.programs.h[t.id];if(null==e){e=new We;var r=new An;null!=this.shaderVersion?r.version=this.shaderVersion:r.glES=!0,e.vertex=this.compileShader(r,t.vertex),e.fragment=this.compileShader(r,t.fragment),e.p=this.gl.createProgram(),this.gl.attachShader(e.p,e.vertex.s),this.gl.attachShader(e.p,e.fragment.s);var i=null;try{this.gl.linkProgram(e.p),1!=this.gl.getProgramParameter(e.p,35714)&&(i=this.gl.getProgramInfoLog(e.p))}catch(t){throw t instanceof Zn&&(t=t.val),new Zn("Shader linkage error: "+g.string(t)+" ("+this.getDriverName(!1)+")")}if(this.gl.deleteShader(e.vertex.s),this.gl.deleteShader(e.fragment.s),null!=i)throw this.gl.deleteProgram(e.p),new Zn("Program linkage failure: "+i+"\nVertex=\n"+r.run(t.vertex.data)+"\n\nFragment=\n"+r.run(t.fragment.data));this.firstShader=!1,this.initShader(e,e.vertex,t.vertex),this.initShader(e,e.fragment,t.fragment),e.attribNames=[],e.attribs=[],e.stride=0;for(var n=0,a=t.vertex.data.vars;n<a.length;){var s=a[n];++n;var o=s.kind;if(1==o[1]){var h,l=5126,u=s.type;switch(u[1]){case 3:h=1;break;case 5:var R=u[2];h=R;break;case 9:var c=u[2];l=5120,h=c;break;default:throw new Zn("assert "+g.string(s.type))}var _=this.gl.getAttribLocation(e.p,r.varNames.get(s.id));if(_<0){e.stride+=h;continue}var f=new Ye;f.type=l,f.size=h,f.index=_,f.offset=e.stride,e.attribs.push(f),e.attribNames.push(s.name),e.stride+=h}}this.programs.h[t.id]=e}if(this.curShader==e)return!1;this.gl.useProgram(e.p);for(var p=this.curAttribs,d=e.attribs.length;p<d;){var v=p++;this.gl.enableVertexAttribArray(v),this.curAttribs++}for(;this.curAttribs>e.attribs.length;)this.gl.disableVertexAttribArray(--this.curAttribs);this.curShader=e,this.curBuffer=null;for(var m=0,y=this.boundTextures.length;m<y;){var x=m++;this.boundTextures[x]=null}return!0},uploadShaderBuffers:function(t,e){this.uploadBuffer(this.curShader.vertex,t.vertex,e),this.uploadBuffer(this.curShader.fragment,t.fragment,e)},uploadBuffer:function(t,e,r){switch(r){case 0:if(null!=t.globals){var i=e.globals.subarray(0,4*t.shader.globalsSize);this.gl.uniform4fv(t.globals,i)}break;case 1:if(null!=t.params){var n=e.params.subarray(0,4*t.shader.paramsSize);this.gl.uniform4fv(t.params,n)}break;case 2:for(var a=t.textures.length,s=0,o=t.textures.length+t.cubeTextures.length;s<o;){var h=s++,l=e.tex[h];if(null==l||null==l.t&&null==l.realloc){var u=hr.loadingTextureColor;l=pr.fromColor(u,(u>>>24)/255)}null!=l&&null==l.t&&null!=l.realloc&&(l.alloc(),l.realloc()),l.lastFrame=this.frame;var R=h>=a,c=R?t.cubeTextures[h-a]:t.textures[h];if(null!=c&&this.boundTextures[h]!=l.t){this.boundTextures[h]=l.t;var _=R?34067:3553;this.gl.activeTexture(33984+h),this.gl.uniform1i(c,h),this.gl.bindTexture(_,l.t.t);var f=l.mipMap[1],g=l.filter[1],p=l.wrap[1],d=f|g<<3|p<<6;if(d!=l.t.bits){l.t.bits=d;var v=He.TFILTERS[f][g];this.gl.texParameteri(_,10240,v[0]),this.gl.texParameteri(_,10241,v[1]);var m=He.TWRAP[p];this.gl.texParameteri(_,10242,m),this.gl.texParameteri(_,10243,m)}}}}},selectMaterial:function(t){this.selectMaterialBits(t.bits);var e=this.defStencil;null==t.stencil?this.curStEnabled&&(this.gl.disable(2960),this.curStEnabled=!1):(e=t.stencil,this.curStEnabled||(this.gl.enable(2960),this.curStEnabled=!0)),this.selectStencilBits(e.opBits,e.frontRefBits,e.backRefBits)},selectMaterialBits:function(t){var e=t^this.curMatBits;if(this.curMatBits<0&&(e=-1),0!=e){if(0!=(3&e)){var r=3&t;0==r?this.gl.disable(2884):((this.curMatBits<0||0==(3&this.curMatBits))&&this.gl.enable(2884),this.gl.cullFace(He.FACES[r]))}if(0!=(4194240&e)){var i=t>>6&15,n=t>>10&15,a=t>>14&15,s=t>>18&15;i==a&&n==s?0==i&&1==n?this.gl.disable(3042):((this.curMatBits<0||0==(this.curMatBits>>6&15)&&1==(this.curMatBits>>10&15))&&this.gl.enable(3042),this.gl.blendFunc(He.BLEND[i],He.BLEND[n])):((this.curMatBits<0||0==(this.curMatBits>>6&15)&&1==(this.curMatBits>>10&15))&&this.gl.enable(3042),this.gl.blendFuncSeparate(He.BLEND[i],He.BLEND[n],He.BLEND[a],He.BLEND[s]))}if(0!=(62914560&e)){var o=t>>22&3,h=t>>24&3;o==h?this.gl.blendEquation(He.OP[o]):this.gl.blendEquationSeparate(He.OP[o],He.OP[h])}if(0!=(4&e)&&this.gl.depthMask(0!=(t>>2&1)),0!=(56&e)){var l=t>>3&7;0==l?this.gl.disable(2929):((this.curMatBits<0||0==(this.curMatBits>>3&7))&&this.gl.enable(2929),this.gl.depthFunc(He.COMPARE[l]))}if(0!=(1006632960&e)){var u=t>>26&15;this.gl.colorMask(0!=(1&u),0!=(2&u),0!=(4&u),0!=(8&u))}this.curMatBits=t}},selectStencilBits:function(t,e,r){var i=t^this.curStOpBits,n=e^this.curStFrBits,a=r^this.curStBrBits;0!=(i|n|a)&&(0!=(4088&i)&&this.gl.stencilOpSeparate(He.FACES[2],He.STENCIL_OP[t>>3&7],He.STENCIL_OP[t>>6&7],He.STENCIL_OP[t>>9&7]),0!=(16744448&i)&&this.gl.stencilOpSeparate(He.FACES[1],He.STENCIL_OP[t>>15&7],He.STENCIL_OP[t>>18&7],He.STENCIL_OP[t>>21&7]),0!=(7&i|65535&n)&&this.gl.stencilFuncSeparate(He.FACES[2],He.COMPARE[7&t],255&e,e>>8&255),0!=(28672&i|65535&a)&&this.gl.stencilFuncSeparate(He.FACES[1],He.COMPARE[t>>12&7],255&r,r>>8&255),0!=(16711680&n)&&this.gl.stencilMaskSeparate(He.FACES[2],e>>16&255),0!=(16711680&a)&&this.gl.stencilMaskSeparate(He.FACES[1],r>>16&255),this.curStOpBits=t,this.curStFrBits=e,this.curStBrBits=r)},clear:function(t,e,r){var i=0;null!=t&&(this.gl.colorMask(!0,!0,!0,!0),this.curMatBits>=0&&(this.curMatBits|=1006632960),this.gl.clearColor(t.x,t.y,t.z,t.w),i|=16384),null!=e&&(this.gl.depthMask(!0),this.curMatBits>=0&&(this.curMatBits|=4),this.gl.clearDepth(e),i|=256),null!=r&&(this.selectStencilBits(this.defStencil.opBits,this.defStencil.frontRefBits,this.defStencil.backRefBits),this.gl.clearStencil(r),i|=1024),0!=i&&this.gl.clear(i),null!=this.curTarget&&(this.curTarget.flags|=1<<or.WasCleared[1])},resize:function(t,e){""==this.canvas.style.width&&(this.canvas.style.width=(t/window.devicePixelRatio|0)+"px",this.canvas.style.height=(e/window.devicePixelRatio|0)+"px"),this.canvas.width=t,this.canvas.height=e,this.bufferWidth=t,this.bufferHeight=e,this.gl.viewport(0,0,t,e),null!=this.defaultDepth&&(this.disposeDepthBuffer(this.defaultDepth),this.defaultDepth.width=this.bufferWidth,this.defaultDepth.height=this.bufferHeight,this.defaultDepth.b=this.allocDepthBuffer(this.defaultDepth))},getChannels:function(t){var e=t.internalFmt;switch(e){case 6406:return 6406;case 6408:return 6408;default:throw new Zn("Invalid format "+t.internalFmt)}},allocTexture:function(t){var e=this.gl.createTexture(),r={t:e,width:t.width,height:t.height,internalFmt:6408,pixelFmt:5121,bits:-1},i=t.format;switch(i[1]){case 2:break;case 4:if(!this.hasFeature(ze.FloatTextures))throw new Zn("Unsupported texture format "+g.string(t.format));r.pixelFmt=5126;break;case 5:r.internalFmt=6406;break;
default:throw new Zn("Unsupported texture format "+g.string(t.format))}t.lastFrame=this.frame,t.flags&=-1-(1<<or.WasCleared[1]);var n=0!=(t.flags&1<<or.Cube[1])?34067:3553;this.gl.bindTexture(n,r.t);var a=!1;if(0!=(t.flags&1<<or.Cube[1]))for(var s=0;s<6;){var o=s++;if(this.gl.texImage2D(He.CUBE_FACES[o],0,r.internalFmt,r.width,r.height,0,this.getChannels(r),r.pixelFmt,null),1285==this.gl.getError()){a=!0;break}}else this.gl.texImage2D(n,0,r.internalFmt,r.width,r.height,0,this.getChannels(r),r.pixelFmt,null),1285==this.gl.getError()&&(a=!0);return this.gl.bindTexture(n,null),a?(this.gl.deleteTexture(r.t),null):r},allocDepthBuffer:function(t){var e=this.gl.createRenderbuffer();return this.gl.bindRenderbuffer(36161,e),this.gl.renderbufferStorage(36161,33189,t.width,t.height),this.gl.bindRenderbuffer(36161,null),{r:e}},disposeDepthBuffer:function(t){null!=t.b&&null!=t.b.r&&(this.gl.deleteRenderbuffer(t.b.r),t.b=null)},getDefaultDepthBuffer:function(){return null!=this.defaultDepth?this.defaultDepth:(this.defaultDepth=new lr(this.bufferWidth,this.bufferHeight),this.defaultDepth)},allocVertexes:function(t){var e=this.gl.createBuffer();if(this.gl.bindBuffer(34962,e),t.size*t.stride==0)throw new Zn("assert");this.gl.bufferData(34962,t.size*t.stride*4,0!=(t.flags&1<<Te.Dynamic[1])?35048:35044);var r=1285==this.gl.getError();return this.gl.bindBuffer(34962,null),r?(this.gl.deleteBuffer(e),null):{b:e,stride:t.stride}},allocIndexes:function(t){var e=this.gl.createBuffer();this.gl.bindBuffer(34963,e),this.gl.bufferData(34963,2*t,35044);var r=1285==this.gl.getError();return this.gl.bindBuffer(34963,null),this.curIndexBuffer=null,r?(this.gl.deleteBuffer(e),null):e},disposeTexture:function(t){var e=t.t;null!=e&&(t.t=null,this.gl.deleteTexture(e.t))},disposeIndexes:function(t){this.gl.deleteBuffer(t)},disposeVertexes:function(t){this.gl.deleteBuffer(t.b)},generateMipMaps:function(t){var e=0!=(t.flags&1<<or.Cube[1])?34067:3553;this.gl.bindTexture(e,t.t.t),this.gl.generateMipmap(e),this.gl.bindTexture(e,null)},uploadTextureBitmap:function(t,e,r,i){if(t.format!=gr.RGBA||0!=(t.flags&1<<or.Cube[1])){var n=e.getPixels();this.uploadTexturePixels(t,n,r,i),n.dispose()}else{var a=e.ctx;this.gl.bindTexture(3553,t.t.t),this.gl.pixelStorei(37440,1),this.gl.texImage2D(3553,r,t.t.internalFmt,this.getChannels(t.t),t.t.pixelFmt,a.getImageData(0,0,e.ctx.canvas.width,e.ctx.canvas.height)),this.gl.bindTexture(3553,null)}},resetStream:function(){},uploadTexturePixels:function(t,e,r,i){var n=0!=(t.flags&1<<or.Cube[1]),a=n?34067:3553,s=n?He.CUBE_FACES[i]:3553;this.gl.bindTexture(a,t.t.t),e.convert(t.format),this.gl.pixelStorei(37440,n?0:1),this.gl.texImage2D(s,r,t.t.internalFmt,e.width,e.height,0,this.getChannels(t.t),t.t.pixelFmt,new pa(e.bytes.b.bufferValue)),this.gl.bindTexture(a,null)},uploadVertexBuffer:function(t,e,r,i,n){var a=t.stride;this.gl.bindBuffer(34962,t.b);var s=i.array,o=new ga(s.buffer,4*n,r*a);this.gl.bufferSubData(34962,e*a*4,o),this.gl.bindBuffer(34962,null)},uploadIndexBuffer:function(t,e,r,i,n){this.gl.bindBuffer(34963,t);var a=new Uint16Array(i),s=new Uint16Array(a.buffer,2*n,r);this.gl.bufferSubData(34963,2*e,s),this.gl.bindBuffer(34963,null),this.curIndexBuffer=null},selectBuffer:function(t){if(t!=this.curBuffer){if(null!=this.curBuffer&&t.buffer==this.curBuffer.buffer&&0!=(t.buffer.flags&1<<Te.RawFormat[1])==(0!=(this.curBuffer.flags&1<<Te.RawFormat[1])))return void(this.curBuffer=t);if(null==this.curShader)throw new Zn("No shader selected");this.curBuffer=t;var e=t.buffer.vbuf;if(e.stride<this.curShader.stride)throw new Zn("Buffer stride ("+e.stride+") and shader stride ("+this.curShader.stride+") mismatch");if(this.gl.bindBuffer(34962,e.b),0!=(t.flags&1<<Te.RawFormat[1]))for(var r=0,i=this.curShader.attribs;r<i.length;){var n=i[r];++r;var a=n.offset;this.gl.vertexAttribPointer(n.index,n.size,n.type,!1,4*e.stride,4*a)}else for(var s=8,o=0,h=this.curShader.attribs.length;o<h;){var l,u=o++,R=this.curShader.attribs[u],c=this.curShader.attribNames[u];switch(c){case"normal":if(e.stride<6)throw new Zn("Buffer is missing NORMAL data, set it to RAW format ?");l=3;break;case"position":l=0;break;case"uv":if(e.stride<8)throw new Zn("Buffer is missing UV data, set it to RAW format ?");l=6;break;default:var _=c;if(l=s,s+=R.size,s>e.stride)throw new Zn("Buffer is missing '"+_+"' data, set it to RAW format ?")}this.gl.vertexAttribPointer(R.index,R.size,R.type,!1,4*e.stride,4*l)}}},draw:function(t,e,r){t!=this.curIndexBuffer&&(this.curIndexBuffer=t,this.gl.bindBuffer(34963,t)),this.gl.drawElements(4,3*r,5123,2*e)},present:function(){},isDisposed:function(){return this.gl.isContextLost()},setRenderZone:function(t,e,r,i){if(0==t&&0==e&&r<0&&i<0)this.gl.disable(3089);else{this.gl.enable(3089);var n=null==this.curTarget?this.bufferHeight:this.curTarget.height;this.gl.scissor(t,n-(e+i),r,i)}},setRenderTarget:function(t,e,r){if(null==r&&(r=0),null==e&&(e=0),null!=this.curTarget&&this.numTargets>1){for(;this.numTargets>1;)this.gl.framebufferTexture2D(36160,36064+--this.numTargets,3553,null,0);null!=this.mrtExt&&this.mrtExt.drawBuffersWEBGL([36064])}if(this.curTarget=t,null==t)return this.gl.bindFramebuffer(36160,null),void this.gl.viewport(0,0,this.bufferWidth,this.bufferHeight);if(r>0)throw new Zn("Cannot render to mipLevel, use upload() instead");if(null==t.t&&t.alloc(),0!=(t.flags&1<<or.MipMapped[1])&&0==(t.flags&1<<or.WasCleared[1])){var i=0!=(t.flags&1<<or.Cube[1])?34067:3553;this.gl.bindTexture(i,t.t.t),this.gl.generateMipmap(i),this.gl.bindTexture(i,null)}t.flags|=1<<or.WasCleared[1],t.lastFrame=this.frame,this.gl.bindFramebuffer(36160,this.commonFB),this.gl.framebufferTexture2D(36160,36064,0!=(t.flags&1<<or.Cube[1])?He.CUBE_FACES[e]:3553,t.t.t,r),null!=t.depthBuffer?this.gl.framebufferRenderbuffer(36160,36096,36161,t.depthBuffer.b.r):this.gl.framebufferRenderbuffer(36160,36096,36161,null),this.gl.viewport(0,0,t.width>>r,t.height>>r);for(var n=0,a=this.boundTextures.length;n<a;){var s=n++;this.boundTextures[s]=null}},init:function(t,e){null==e&&(e=!1);var r=!1;if("complete"==window.document.readyState){var i=t;fi.delay(function(){i(!1)},1)}else window.addEventListener("load",function(e){r||(r=!0,t(!1))})},hasFeature:function(t){switch(t[1]){case 0:return null!=this.gl.getExtension("OES_standard_derivatives");case 1:return null!=this.gl.getExtension("OES_texture_float")&&null!=this.gl.getExtension("OES_texture_float_linear");case 2:return!0;case 3:return!0;case 4:return null!=this.mrtExt||null!=(this.mrtExt=this.gl.getExtension("WEBGL_draw_buffers"));case 5:return!1}},__class__:He});var Xe=function(t,e,r){this.pos=t,this.count=e,this.next=r};a["h3d.impl._ManagedBuffer.FreeCell"]=Xe,Xe.__name__=["h3d","impl","_ManagedBuffer","FreeCell"],Xe.prototype={__class__:Xe};var Ze=function(t,e,r){var i=0;if(this.flags=i,null!=r)for(var n=0;n<r.length;){var a=r[n];++n,this.flags|=1<<a[1]}this.size=e,this.stride=t,this.freeList=new Xe(0,e,null),this.mem=ke.CURRENT.mem,this.mem.allocManaged(this)};a["h3d.impl.ManagedBuffer"]=Ze,Ze.__name__=["h3d","impl","ManagedBuffer"],Ze.prototype={uploadVertexBuffer:function(t,e,r,i){null==i&&(i=0),this.mem.driver.uploadVertexBuffer(this.vbuf,t,e,r,i)},allocPosition:function(t,e){for(var r=this.freeList;null!=r;){if(r.count>=t){var i=(e-r.pos%e)%e;if(0==i)break;if(r.count>=t+i){r.next=new Xe(r.pos+i,r.count-i,r.next),r.count=i,r=r.next;break}}r=r.next}if(null==r)return-1;var n=r.pos;return r.pos+=t,r.count-=t,n},allocBuffer:function(t){var e=0!=(t.flags&1<<Te.Quads[1])?4:0!=(t.flags&1<<Te.Triangles[1])?3:1,r=this.allocPosition(t.vertices,e);return!(r<0)&&(t.position=r,t.buffer=this,!0)},freeBuffer:function(t){for(var e=null,r=this.freeList,i=t.vertices,n=t.position+i;null!=r;){if(r.pos==n){r.pos-=i,r.count+=i,null!=e&&e.pos+e.count==r.pos&&(e.count+=r.count,e.next=r.next),i=0;break}if(r.pos>n){if(null!=e&&e.pos+e.count==t.position)e.count+=i;else{var a=new Xe(t.position,i,r);null==e?this.freeList=a:e.next=a}i=0;break}e=r,r=r.next}if(0!=i)throw new Zn("assert");this.freeList.count==this.size&&0==(this.flags&1<<Te.Managed[1])&&this.dispose()},dispose:function(){this.mem.freeManaged(this)},__class__:Ze};var Ke=function(t){this.bufferCount=0,this.texMemory=0,this.usedMemory=0,this.driver=t};a["h3d.impl.MemoryManager"]=Ke,Ke.__name__=["h3d","impl","MemoryManager"],Ke.prototype={init:function(){this.indexes=[],this.textures=[],this.buffers=[],this.initIndexes()},initIndexes:function(){for(var t=new Array(0),e=t,r=0;r<65533;){var i=r++;e.push(i)}this.triIndexes=Ee.alloc(e);for(var n=new Array(0),a=n,s=0,o=16383;s<o;){var h=s++,l=h<<2;a.push(l),a.push(l+1),a.push(l+2),a.push(l+2),a.push(l+1),a.push(l+3)}a.push(65533),this.quadIndexes=Ee.alloc(a)},garbage:function(){},cleanManagedBuffers:function(){for(var t=1,e=this.buffers.length;t<e;)for(var r=t++,i=this.buffers[r],n=null;null!=i;)i.freeList.count==i.size?(i.dispose(),null==n?this.buffers[r]=i.next:n.next=i.next):n=i,i=i.next},allocManaged:function(t){if(null==t.vbuf){var e=t.size*t.stride*4;if(0!=e){for(;this.usedMemory+e>4294967296||this.bufferCount>=65536||null==(t.vbuf=this.driver.allocVertexes(t));){var r=this.usedMemory-this.freeMemorySize();if(this.garbage(),this.cleanManagedBuffers(),this.usedMemory-this.freeMemorySize()==r){if(this.bufferCount>=65536)throw new Zn("Too many buffers");throw new Zn("Memory full ("+Math.ceil(r/1024)+" KB,"+this.bufferCount+" buffers)")}}this.usedMemory+=e,this.bufferCount++}}},freeManaged:function(t){null!=t.vbuf&&(this.driver.disposeVertexes(t.vbuf),t.vbuf=null,this.usedMemory-=t.size*t.stride*4,this.bufferCount--)},allocBuffer:function(t,e){var r=0!=(t.flags&1<<Te.Quads[1])?65532:0!=(t.flags&1<<Te.Triangles[1])?65533:65534;if(t.vertices>r){if(65534==r)throw new Zn("Cannot split buffer with "+t.vertices+" vertices if it's not Quads/Triangles");var i=t.vertices-r;t.vertices=r,this.allocBuffer(t,e);for(var n=t;null!=n.next;)n=n.next;for(var a=[],s=0,o=Ke.ALL_FLAGS;s<o.length;){var h=o[s];++s,0!=(t.flags&1<<h[1])&&a.push(h)}return void(n.next=new Se(i,e,a))}if(0!=(t.flags&1<<Te.Managed[1])){for(var l=this.buffers[e],u=null;null!=l;){if(l.allocBuffer(t))return;u=l,l=l.next}var R=0!=(t.flags&1<<Te.Triangles[1])?3:0!=(t.flags&1<<Te.Quads[1])?4:0;if(null==l&&R>0){for(var c=t.vertices,_=c;_>2048;)for(l=this.buffers[e],_>>=1,_-=_%R,t.vertices=_;null!=l;){if(l.allocBuffer(t)){for(var f=[],g=0,p=Ke.ALL_FLAGS;g<p.length;){var d=p[g];++g,0!=(t.flags&1<<d[1])&&f.push(d)}return void(t.next=new Se(c-_,e,f))}l=l.next}t.vertices=c}if(l=new Ze(e,65533,[Te.Managed]),null==u?this.buffers[e]=l:u.next=l,!l.allocBuffer(t))throw new Zn("assert")}else{var v=new Ze(e,t.vertices);if(!v.allocBuffer(t))throw new Zn("assert")}},deleteIndexes:function(t){o.remove(this.indexes,t),this.driver.disposeIndexes(t.ibuf),t.ibuf=null,this.usedMemory-=2*t.count},allocIndexes:function(t){t.ibuf=this.driver.allocIndexes(t.count),this.indexes.push(t),this.usedMemory+=2*t.count},bpp:function(t){return 4},cleanTextures:function(t){null==t&&(t=!0),this.textures.sort(n(this,this.sortByLRU));for(var e=0,r=this.textures;e<r.length;){var i=r[e];if(++e,null!=i.realloc&&(t||i.lastFrame<ke.CURRENT.frameCount-3600))return i.dispose(),!0}return!1},sortByLRU:function(t,e){return t.lastFrame-e.lastFrame},deleteTexture:function(t){o.remove(this.textures,t),this.driver.disposeTexture(t),this.texMemory-=t.width*t.height*this.bpp(t)},allocTexture:function(t){this.cleanTextures(!1);if(t.t=this.driver.allocTexture(t),null==t.t){if(!this.cleanTextures(!0))throw new Zn("Maximum texture memory reached");return void this.allocTexture(t)}this.textures.push(t),this.texMemory+=t.width*t.height*this.bpp(t)},onContextLost:function(){this.dispose(),this.initIndexes()},dispose:function(){this.triIndexes.dispose(),this.quadIndexes.dispose(),this.triIndexes=null,this.quadIndexes=null;for(var t=0,e=this.textures.slice();t<e.length;){var r=e[t];++t,r.dispose()}for(var i=0,n=this.buffers.slice();i<n.length;){var a=n[i];++i;for(var s=a;null!=s;)s.dispose(),s=s.next}for(var o=0,h=this.indexes.slice();o<h.length;){var l=h[o];++o,l.dispose()}this.buffers=[],this.indexes=[],this.textures=[],this.bufferCount=0,this.usedMemory=0,this.texMemory=0},freeMemorySize:function(){for(var t=0,e=0,r=this.buffers;e<r.length;){var i=r[e];++e;for(var n=i;null!=n;){for(var a=n.freeList;null!=a;)t+=a.count*n.stride*4,a=a.next;n=n.next}}return t},__class__:Ke};var $e=function(){this.position=0,this.cache=[];ke.CURRENT;this.defaultFormat=pr.nativeFormat,this.defaultDepthBuffer=lr.getDefault()};a["h3d.impl.TextureCache"]=$e,$e.__name__=["h3d","impl","TextureCache"],$e.prototype={begin:function(t){if(this.frame!=t.frame){for(;this.cache.length>this.position;){var e=this.cache.pop();null!=e&&e.dispose()}this.frame=t.frame,this.position=0}},allocTarget:function(t,e,r,i,n,a){null==n&&(n=!0),this.begin(e);var s=this.cache[this.position];if(null==a&&(a=this.defaultFormat),null==s||null==s.t&&null==s.realloc||s.width!=r||s.height!=i||s.format!=a){null!=s&&s.dispose();var o=[or.Target];s=new pr(r,i,o,a),this.cache[this.position]=s}return s.depthBuffer=n?this.defaultDepthBuffer:null,s.setName(t),this.position++,s},__class__:$e};var Qe=function(t){null!=t&&this.addPass(new _r("default",null)).addShader(t)};a["h3d.mat.BaseMaterial"]=Qe,Qe.__name__=["h3d","mat","BaseMaterial"],Qe.__interfaces__=[oe],Qe.prototype={addPass:function(t){for(var e=null,r=this.passes;null!=r;)e=r,r=r.nextPass;return null==e?this.passes=t:e.nextPass=t,t.nextPass=null,t},__class__:Qe};var Je=a["h3d.mat.Face"]={__ename__:!0,__constructs__:["None","Back","Front","Both"]};Je.None=["None",0],Je.None.toString=s,Je.None.__enum__=Je,Je.Back=["Back",1],Je.Back.toString=s,Je.Back.__enum__=Je,Je.Front=["Front",2],Je.Front.toString=s,Je.Front.__enum__=Je,Je.Both=["Both",3],Je.Both.toString=s,Je.Both.__enum__=Je,Je.__empty_constructs__=[Je.None,Je.Back,Je.Front,Je.Both];var tr=a["h3d.mat.Blend"]={__ename__:!0,__constructs__:["One","Zero","SrcAlpha","SrcColor","DstAlpha","DstColor","OneMinusSrcAlpha","OneMinusSrcColor","OneMinusDstAlpha","OneMinusDstColor","ConstantColor","ConstantAlpha","OneMinusConstantColor","OneMinusConstantAlpha","SrcAlphaSaturate"]};tr.One=["One",0],tr.One.toString=s,tr.One.__enum__=tr,tr.Zero=["Zero",1],tr.Zero.toString=s,tr.Zero.__enum__=tr,tr.SrcAlpha=["SrcAlpha",2],tr.SrcAlpha.toString=s,tr.SrcAlpha.__enum__=tr,tr.SrcColor=["SrcColor",3],tr.SrcColor.toString=s,tr.SrcColor.__enum__=tr,tr.DstAlpha=["DstAlpha",4],tr.DstAlpha.toString=s,tr.DstAlpha.__enum__=tr,tr.DstColor=["DstColor",5],tr.DstColor.toString=s,tr.DstColor.__enum__=tr,tr.OneMinusSrcAlpha=["OneMinusSrcAlpha",6],tr.OneMinusSrcAlpha.toString=s,tr.OneMinusSrcAlpha.__enum__=tr,tr.OneMinusSrcColor=["OneMinusSrcColor",7],tr.OneMinusSrcColor.toString=s,tr.OneMinusSrcColor.__enum__=tr,tr.OneMinusDstAlpha=["OneMinusDstAlpha",8],tr.OneMinusDstAlpha.toString=s,tr.OneMinusDstAlpha.__enum__=tr,tr.OneMinusDstColor=["OneMinusDstColor",9],tr.OneMinusDstColor.toString=s,tr.OneMinusDstColor.__enum__=tr,tr.ConstantColor=["ConstantColor",10],tr.ConstantColor.toString=s,tr.ConstantColor.__enum__=tr,tr.ConstantAlpha=["ConstantAlpha",11],tr.ConstantAlpha.toString=s,tr.ConstantAlpha.__enum__=tr,tr.OneMinusConstantColor=["OneMinusConstantColor",12],tr.OneMinusConstantColor.toString=s,tr.OneMinusConstantColor.__enum__=tr,tr.OneMinusConstantAlpha=["OneMinusConstantAlpha",13],tr.OneMinusConstantAlpha.toString=s,tr.OneMinusConstantAlpha.__enum__=tr,tr.SrcAlphaSaturate=["SrcAlphaSaturate",14],tr.SrcAlphaSaturate.toString=s,tr.SrcAlphaSaturate.__enum__=tr,tr.__empty_constructs__=[tr.One,tr.Zero,tr.SrcAlpha,tr.SrcColor,tr.DstAlpha,tr.DstColor,tr.OneMinusSrcAlpha,tr.OneMinusSrcColor,tr.OneMinusDstAlpha,tr.OneMinusDstColor,tr.ConstantColor,tr.ConstantAlpha,tr.OneMinusConstantColor,tr.OneMinusConstantAlpha,tr.SrcAlphaSaturate];var er=a["h3d.mat.Compare"]={__ename__:!0,__constructs__:["Always","Never","Equal","NotEqual","Greater","GreaterEqual","Less","LessEqual"]};er.Always=["Always",0],er.Always.toString=s,er.Always.__enum__=er,er.Never=["Never",1],er.Never.toString=s,er.Never.__enum__=er,er.Equal=["Equal",2],er.Equal.toString=s,er.Equal.__enum__=er,er.NotEqual=["NotEqual",3],er.NotEqual.toString=s,er.NotEqual.__enum__=er,er.Greater=["Greater",4],er.Greater.toString=s,er.Greater.__enum__=er,er.GreaterEqual=["GreaterEqual",5],er.GreaterEqual.toString=s,er.GreaterEqual.__enum__=er,er.Less=["Less",6],er.Less.toString=s,er.Less.__enum__=er,er.LessEqual=["LessEqual",7],er.LessEqual.toString=s,er.LessEqual.__enum__=er,er.__empty_constructs__=[er.Always,er.Never,er.Equal,er.NotEqual,er.Greater,er.GreaterEqual,er.Less,er.LessEqual];var rr=a["h3d.mat.StencilOp"]={__ename__:!0,__constructs__:["Keep","Zero","Replace","Increment","IncrementWrap","Decrement","DecrementWrap","Invert"]};rr.Keep=["Keep",0],rr.Keep.toString=s,rr.Keep.__enum__=rr,rr.Zero=["Zero",1],rr.Zero.toString=s,rr.Zero.__enum__=rr,rr.Replace=["Replace",2],rr.Replace.toString=s,rr.Replace.__enum__=rr,rr.Increment=["Increment",3],rr.Increment.toString=s,rr.Increment.__enum__=rr,rr.IncrementWrap=["IncrementWrap",4],rr.IncrementWrap.toString=s,rr.IncrementWrap.__enum__=rr,rr.Decrement=["Decrement",5],rr.Decrement.toString=s,rr.Decrement.__enum__=rr,rr.DecrementWrap=["DecrementWrap",6],rr.DecrementWrap.toString=s,rr.DecrementWrap.__enum__=rr,rr.Invert=["Invert",7],rr.Invert.toString=s,rr.Invert.__enum__=rr,rr.__empty_constructs__=[rr.Keep,rr.Zero,rr.Replace,rr.Increment,rr.IncrementWrap,rr.Decrement,rr.DecrementWrap,rr.Invert];var ir=a["h3d.mat.MipMap"]={__ename__:!0,__constructs__:["None","Nearest","Linear"]};ir.None=["None",0],ir.None.toString=s,ir.None.__enum__=ir,ir.Nearest=["Nearest",1],ir.Nearest.toString=s,ir.Nearest.__enum__=ir,ir.Linear=["Linear",2],ir.Linear.toString=s,ir.Linear.__enum__=ir,ir.__empty_constructs__=[ir.None,ir.Nearest,ir.Linear];var nr=a["h3d.mat.Filter"]={__ename__:!0,__constructs__:["Nearest","Linear"]};nr.Nearest=["Nearest",0],nr.Nearest.toString=s,nr.Nearest.__enum__=nr,nr.Linear=["Linear",1],nr.Linear.toString=s,nr.Linear.__enum__=nr,nr.__empty_constructs__=[nr.Nearest,nr.Linear];var ar=a["h3d.mat.Wrap"]={__ename__:!0,__constructs__:["Clamp","Repeat"]};ar.Clamp=["Clamp",0],ar.Clamp.toString=s,ar.Clamp.__enum__=ar,ar.Repeat=["Repeat",1],ar.Repeat.toString=s,ar.Repeat.__enum__=ar,ar.__empty_constructs__=[ar.Clamp,ar.Repeat];var sr=a["h3d.mat.Operation"]={__ename__:!0,__constructs__:["Add","Sub","ReverseSub"]};sr.Add=["Add",0],sr.Add.toString=s,sr.Add.__enum__=sr,sr.Sub=["Sub",1],sr.Sub.toString=s,sr.Sub.__enum__=sr,sr.ReverseSub=["ReverseSub",2],sr.ReverseSub.toString=s,sr.ReverseSub.__enum__=sr,sr.__empty_constructs__=[sr.Add,sr.Sub,sr.ReverseSub];var or=a["h3d.mat.TextureFlags"]={__ename__:!0,__constructs__:["Target","Cube","MipMapped","ManualMipMapGen","IsNPOT","NoAlloc","Dynamic","AlphaPremultiplied","WasCleared","Loading","Serialize"]};or.Target=["Target",0],or.Target.toString=s,or.Target.__enum__=or,or.Cube=["Cube",1],or.Cube.toString=s,or.Cube.__enum__=or,or.MipMapped=["MipMapped",2],or.MipMapped.toString=s,or.MipMapped.__enum__=or,or.ManualMipMapGen=["ManualMipMapGen",3],or.ManualMipMapGen.toString=s,or.ManualMipMapGen.__enum__=or,or.IsNPOT=["IsNPOT",4],or.IsNPOT.toString=s,or.IsNPOT.__enum__=or,or.NoAlloc=["NoAlloc",5],or.NoAlloc.toString=s,or.NoAlloc.__enum__=or,or.Dynamic=["Dynamic",6],or.Dynamic.toString=s,or.Dynamic.__enum__=or,or.AlphaPremultiplied=["AlphaPremultiplied",7],or.AlphaPremultiplied.toString=s,or.AlphaPremultiplied.__enum__=or,or.WasCleared=["WasCleared",8],or.WasCleared.toString=s,or.WasCleared.__enum__=or,or.Loading=["Loading",9],or.Loading.toString=s,or.Loading.__enum__=or,or.Serialize=["Serialize",10],or.Serialize.toString=s,or.Serialize.__enum__=or,or.__empty_constructs__=[or.Target,or.Cube,or.MipMapped,or.ManualMipMapGen,or.IsNPOT,or.NoAlloc,or.Dynamic,or.AlphaPremultiplied,or.WasCleared,or.Loading,or.Serialize];var hr=function(){};a["h3d.mat.Defaults"]=hr,hr.__name__=["h3d","mat","Defaults"];var lr=function(t,e){this.width=t,this.height=e,t>=0&&(this.b=ke.CURRENT.driver.allocDepthBuffer(this))};a["h3d.mat.DepthBuffer"]=lr,lr.__name__=["h3d","mat","DepthBuffer"],lr.getDefault=function(){return ke.CURRENT.driver.getDefaultDepthBuffer()},lr.prototype={dispose:function(){null!=this.b&&(ke.CURRENT.driver.disposeDepthBuffer(this),this.b=null)},isDisposed:function(){return null==this.b},__class__:lr};var ur=function(t){this.mshader=new Hr,this.set_blendMode(ne.None),Qe.call(this,this.mshader),this.set_texture(t)};a["h3d.mat.Material"]=ur,ur.__name__=["h3d","mat","Material"],ur.__super__=Qe,ur.prototype=e(Qe.prototype,{set_blendMode:function(t){if(null!=this.passes)switch(this.passes.setBlendMode(t),t[1]){case 0:this.passes.set_depthWrite(!0),this.passes.setPassName("default");break;case 1:this.passes.set_depthWrite(!0),this.passes.setPassName("alpha");break;case 2:this.passes.set_depthWrite(!1),this.passes.setPassName("additive");break;case 3:this.passes.set_depthWrite(!1),this.passes.setPassName("additive");break;case 4:this.passes.set_depthWrite(!1),this.passes.setPassName("additive");break;case 5:this.passes.set_depthWrite(!1),this.passes.setPassName("additive");break;case 6:this.passes.set_depthWrite(!1),this.passes.setPassName("additive")}return this.blendMode=t},set_texture:function(t){return null==t?null!=this.textureShader&&(this.passes.removeShader(this.textureShader),this.textureShader=null):(null==this.textureShader&&(this.textureShader=new ai,this.passes.addShader(this.textureShader)),this.textureShader.texture__=t),t},__class__:ur});var Rr=function(t){this.file=t};a["h3d.mat.MaterialDatabase"]=Rr,Rr.__name__=["h3d","mat","MaterialDatabase"],Rr.prototype={__class__:Rr};var cr=function(t){null==this.database&&(this.database=new Rr("materials.json")),this.name=t};a["h3d.mat.MaterialSetup"]=cr,cr.__name__=["h3d","mat","MaterialSetup"],cr.prototype={createRenderer:function(){return new qr},createLightSystem:function(){return new Mr},__class__:cr};var _r=function(t,e,r){this.bits=0,this.parentPass=r,this.shaders=e,this.setPassName(t),this.set_culling(Je.Back);var i=tr.One,n=tr.Zero;this.set_blendSrc(i),this.set_blendAlphaSrc(i),this.set_blendDst(n),this.set_blendAlphaDst(n),this.depth(!0,er.Less),this.set_blendOp(this.set_blendAlphaOp(sr.Add)),this.set_colorMask(15)};a["h3d.mat.Pass"]=_r,_r.__name__=["h3d","mat","Pass"],_r.__interfaces__=[oe],_r.prototype={setPassName:function(t){this.name=t,this.passId=kn.allocID(t)},setBlendMode:function(t){switch(t[1]){case 0:var e=tr.One,r=tr.Zero;this.set_blendSrc(e),this.set_blendAlphaSrc(e),this.set_blendDst(r),this.set_blendAlphaDst(r);break;case 1:var i=tr.SrcAlpha,n=tr.OneMinusSrcAlpha;this.set_blendSrc(i),this.set_blendAlphaSrc(i),this.set_blendDst(n),this.set_blendAlphaDst(n);break;case 2:var a=tr.SrcAlpha,s=tr.One;this.set_blendSrc(a),this.set_blendAlphaSrc(a),this.set_blendDst(s),this.set_blendAlphaDst(s);break;case 3:var o=tr.OneMinusDstColor,h=tr.One;this.set_blendSrc(o),this.set_blendAlphaSrc(o),this.set_blendDst(h),this.set_blendAlphaDst(h);break;case 4:var l=tr.DstColor,u=tr.Zero;this.set_blendSrc(l),this.set_blendAlphaSrc(l),this.set_blendDst(u),this.set_blendAlphaDst(u);break;case 5:var R=tr.Zero,c=tr.OneMinusSrcColor;this.set_blendSrc(R),this.set_blendAlphaSrc(R),this.set_blendDst(c),this.set_blendAlphaDst(c);break;case 6:var _=tr.One,f=tr.OneMinusSrcColor;this.set_blendSrc(_),this.set_blendAlphaSrc(_),this.set_blendDst(f),this.set_blendAlphaDst(f)}},depth:function(t,e){this.set_depthWrite(t),this.set_depthTest(e)},addShader:function(t){return this.shaders=new Nn(t,this.shaders),t},removeShader:function(t){for(var e=this.shaders,r=null;null!=e;){if(e.s==t)return null==r?this.shaders=e.next:r.next=e.next,!0;r=e,e=e.next}return!1},getShadersRec:function(){if(null==this.parentPass||this.parentShaders==this.parentPass.shaders)return this.shaders;for(var t=this.shaders,e=null;null!=t&&t!=this.parentShaders;)e=t,t=t.next;return this.parentShaders=this.parentPass.shaders,null==e?this.shaders=this.parentShaders:e.next=this.parentShaders,this.shaders},set_culling:function(t){return this.bits=this.bits&-4|t[1],this.culling=t},set_depthWrite:function(t){return this.bits=this.bits&-5|(t?1:0)<<2,this.depthWrite=t},set_depthTest:function(t){return this.bits=this.bits&-57|t[1]<<3,this.depthTest=t},set_blendSrc:function(t){return this.bits=this.bits&-961|t[1]<<6,this.blendSrc=t},set_blendDst:function(t){return this.bits=this.bits&-15361|t[1]<<10,this.blendDst=t},set_blendAlphaSrc:function(t){return this.bits=this.bits&-245761|t[1]<<14,this.blendAlphaSrc=t},set_blendAlphaDst:function(t){return this.bits=this.bits&-3932161|t[1]<<18,this.blendAlphaDst=t},set_blendOp:function(t){return this.bits=this.bits&-12582913|t[1]<<22,this.blendOp=t},set_blendAlphaOp:function(t){return this.bits=this.bits&-50331649|t[1]<<24,this.blendAlphaOp=t},set_colorMask:function(t){return this.bits=this.bits&-1006632961|(15&t)<<26,this.colorMask=t},__class__:_r};var fr=function(){this.opBits=0,this.backRefBits=0,this.frontRefBits=0,this.setFunc(Je.Both,er.Always,0,255),this.setOp(Je.Both,rr.Keep,rr.Keep,rr.Keep),this.setMask(Je.Both,255)};a["h3d.mat.Stencil"]=fr,fr.__name__=["h3d","mat","Stencil"],fr.__interfaces__=[oe],fr.prototype={setOp:function(t,e,r,i){if(null==t&&(t=Je.Both),null==t)throw new Zn("Invalid face ("+g.string(t)+"), should be one of [Front, Back, Both]");switch(t[1]){case 1:this.set_backSTfail(e),this.set_backDPfail(r),this.set_backDPpass(i);break;case 2:this.set_frontSTfail(e),this.set_frontDPfail(r),this.set_frontDPpass(i);break;case 3:this.set_frontSTfail(this.set_backSTfail(e)),this.set_frontDPfail(this.set_backDPfail(r)),this.set_frontDPpass(this.set_backDPpass(i));break;default:throw new Zn("Invalid face ("+g.string(t)+"), should be one of [Front, Back, Both]")}},setMask:function(t,e){if(null==t&&(t=Je.Both),null==t)throw new Zn("Invalid face ("+g.string(t)+"), should be one of [Front, Back, Both]");switch(t[1]){case 1:this.set_backWriteMask(e);break;case 2:this.set_frontWriteMask(e);break;case 3:this.set_frontWriteMask(this.set_backWriteMask(e));break;default:throw new Zn("Invalid face ("+g.string(t)+"), should be one of [Front, Back, Both]")}},setFunc:function(t,e,r,i){if(null==t&&(t=Je.Both),null==t)throw new Zn("Invalid face ("+g.string(t)+"), should be one of [Front, Back, Both]");switch(t[1]){case 1:this.set_backTest(e),this.set_backRef(r),this.set_backReadMask(i);break;case 2:this.set_frontTest(e),this.set_frontRef(r),this.set_frontReadMask(i);break;case 3:this.set_frontTest(this.set_backTest(e)),this.set_frontRef(this.set_backRef(r)),this.set_frontReadMask(this.set_backReadMask(i));break;default:throw new Zn("Invalid face ("+g.string(t)+"), should be one of [Front, Back, Both]")}},set_frontTest:function(t){return this.opBits=this.opBits&-8|t[1],this.frontTest=t},set_frontSTfail:function(t){return this.opBits=this.opBits&-57|t[1]<<3,this.frontSTfail=t},set_frontDPfail:function(t){return this.opBits=this.opBits&-449|t[1]<<6,this.frontDPfail=t},set_frontDPpass:function(t){return this.opBits=this.opBits&-3585|t[1]<<9,this.frontDPpass=t},set_frontRef:function(t){return this.frontRefBits=this.frontRefBits&-256|255&t,this.frontRef=t},set_frontReadMask:function(t){return this.frontRefBits=this.frontRefBits&-65281|(255&t)<<8,this.frontReadMask=t},set_frontWriteMask:function(t){return this.frontRefBits=this.frontRefBits&-16711681|(255&t)<<16,this.frontWriteMask=t},set_backTest:function(t){return this.opBits=this.opBits&-28673|t[1]<<12,this.backTest=t},set_backSTfail:function(t){return this.opBits=this.opBits&-229377|t[1]<<15,this.backSTfail=t},set_backDPfail:function(t){return this.opBits=this.opBits&-1835009|t[1]<<18,this.backDPfail=t},set_backDPpass:function(t){return this.opBits=this.opBits&-14680065|t[1]<<21,this.backDPpass=t},set_backRef:function(t){return this.backRefBits=this.backRefBits&-256|255&t,this.backRef=t},set_backReadMask:function(t){return this.backRefBits=this.backRefBits&-65281|(255&t)<<8,this.backReadMask=t},set_backWriteMask:function(t){return this.backRefBits=this.backRefBits&-16711681|(255&t)<<16,this.backWriteMask=t},__class__:fr};var gr=a["hxd.PixelFormat"]={__ename__:!0,__constructs__:["ARGB","BGRA","RGBA","RGBA16F","RGBA32F","ALPHA8","ALPHA16F","ALPHA32F"]};gr.ARGB=["ARGB",0],gr.ARGB.toString=s,gr.ARGB.__enum__=gr,gr.BGRA=["BGRA",1],gr.BGRA.toString=s,gr.BGRA.__enum__=gr,gr.RGBA=["RGBA",2],gr.RGBA.toString=s,gr.RGBA.__enum__=gr,gr.RGBA16F=["RGBA16F",3],gr.RGBA16F.toString=s,gr.RGBA16F.__enum__=gr,gr.RGBA32F=["RGBA32F",4],gr.RGBA32F.toString=s,gr.RGBA32F.__enum__=gr,gr.ALPHA8=["ALPHA8",5],gr.ALPHA8.toString=s,gr.ALPHA8.__enum__=gr,gr.ALPHA16F=["ALPHA16F",6],gr.ALPHA16F.toString=s,gr.ALPHA16F.__enum__=gr,gr.ALPHA32F=["ALPHA32F",7],gr.ALPHA32F.toString=s,gr.ALPHA32F.__enum__=gr,gr.__empty_constructs__=[gr.ARGB,gr.BGRA,gr.RGBA,gr.RGBA16F,gr.RGBA32F,gr.ALPHA8,gr.ALPHA16F,gr.ALPHA32F];var pr=function(t,e,r,i,n){var a=ke.CURRENT;this.mem=a.mem,null==i&&(i=pr.nativeFormat),this.id=++pr.UID,this.format=i;var s=0;if(this.flags=s,null!=r)for(var o=0;o<r.length;){var h=r[o];++o,this.flags|=1<<h[1]}for(var l=1,u=1;l<t;)l<<=1;for(;u<e;)u<<=1;l==t&&u==e||(this.flags|=1<<or.IsNPOT[1]),0!=(this.flags&1<<or.Target[1])&&(this.realloc=function(){}),this.width=t,this.height=e,this.set_mipMap(0!=(this.flags&1<<or.MipMapped[1])?ir.Nearest:ir.None),this.set_filter(nr.Linear),this.set_wrap(ar.Clamp),this.bits&=32767,0==(this.flags&1<<or.NoAlloc[1])&&this.alloc()};a["h3d.mat.Texture"]=pr,pr.__name__=["h3d","mat","Texture"],pr.fromBitmap=function(t,e){var r=new pr(t.ctx.canvas.width,t.ctx.canvas.height,null,null,e);return r.uploadBitmap(t),r},pr.fromPixels=function(t,e){var r=new pr(t.width,t.height,null,null,e);return r.uploadPixels(t),r},pr.fromColor=function(t,e,r){null==e&&(e=1);var i=ke.CURRENT,n=255*e|0;n<0?n=0:n>255&&(n=255);var a=16777215&t|n<<24,s=i.textureColorCache.h[a];if(null!=s)return s;var o=new pr(1,1,null,null,r);return o.clear(t,e),o.realloc=function(){o.clear(t,e)},i.textureColorCache.h[a]=o,o},pr.defaultCubeTexture=function(){var t=ke.CURRENT,e=t.resCache.h[pr.__id__];return null!=e?e:(e=new pr(1,1,[or.Cube]),e.clear(0),e.realloc=function(){e.clear(0)},t.resCache.set(pr,e),e)},pr.genNoise=function(t){var e=pr.noiseTextures.h[t];if(null!=e&&(null!=e.t||null!=e.realloc))return e;var r=new pr(t,t,[or.NoAlloc]),i=r,n=t;return r.realloc=function(){pr.allocNoise(i,n)},pr.noiseTextures.h[t]=r,r},pr.allocNoise=function(t,e){for(var r=new Vi(e,e),i=0,n=e;i<n;)for(var a=i++,s=0,o=e;s<o;){var h=s++,l=g.random(256);r.setPixel(a,h,-16777216|l|l<<8|l<<16)}t.uploadBitmap(r),r.ctx=null,r.pixel=null},pr.prototype={alloc:function(){null==this.t&&this.mem.allocTexture(this)},setName:function(t){this.name=t},set_mipMap:function(t){return this.bits=this.bits&-4|t[1],this.mipMap=t},set_filter:function(t){return this.bits=this.bits&-25|t[1]<<3,this.filter=t},set_wrap:function(t){return this.bits=this.bits&-193|t[1]<<6,this.wrap=t},clear:function(t,e){null==e&&(e=1),this.alloc();var r=Ui.alloc(this.width,this.height,gr.BGRA),i=0,n=255&t,a=t>>8&255,s=t>>16&255,o=255*e|0;o<0?o=0:o>255&&(o=255);for(var h=0,l=this.width*this.height;h<l;){h++;r.bytes.b[i++]=255&n,r.bytes.b[i++]=255&a,r.bytes.b[i++]=255&s,r.bytes.b[i++]=255&o}this.uploadPixels(r),r.dispose()},checkMipMapGen:function(t,e){0!=t||0==(this.flags&1<<or.MipMapped[1])||0!=(this.flags&1<<or.ManualMipMapGen[1])||0!=(this.flags&1<<or.Cube[1])&&5!=e||this.mem.driver.generateMipMaps(this)},uploadBitmap:function(t,e,r){null==r&&(r=0),null==e&&(e=0),this.alloc();var i=t.ctx.canvas.width,n=t.ctx.canvas.height;if(i!=this.width>>e||n!=this.height>>e)throw new Zn("Invalid upload size : "+i+"x"+n+" should be "+(this.width>>e)+"x"+(this.height>>e));this.mem.driver.uploadTextureBitmap(this,t,e,r),this.flags|=1<<or.WasCleared[1],this.checkMipMapGen(e,r)},uploadPixels:function(t,e,r){null==r&&(r=0),null==e&&(e=0),this.alloc();var i=t.width,n=t.height;if(i!=this.width>>e||n!=this.height>>e)throw new Zn("Invalid upload size : "+i+"x"+n+" should be "+(this.width>>e)+"x"+(this.height>>e));
this.mem.driver.uploadTexturePixels(this,t,e,r),this.flags|=1<<or.WasCleared[1],this.checkMipMapGen(e,r)},dispose:function(){null!=this.t&&this.mem.deleteTexture(this)},__class__:pr};var dr=function(){this.forceProcessing=!1,this.priority=0};a["h3d.pass.Base"]=dr,dr.__name__=["h3d","pass","Base"],dr.prototype={setContext:function(t){this.ctx=t},draw:function(t){return t},__class__:dr};var vr=function(t){this.shader=t,this.shaders=new Nn(t),this.manager=new Ar,this.pass=new _r(g.string(this),new Nn(t)),this.pass.set_culling(Je.None),this.pass.depth(!1,er.Always),this.plan=Pr.get(),this.engine=ke.CURRENT};a["h3d.pass.ScreenFx"]=vr,vr.__name__=["h3d","pass","ScreenFx"],vr.prototype={render:function(){var t=this.manager.compileShaders(this.shaders);if(this.engine.selectMaterial(this.pass),this.engine.selectShader(t),null==this.buffers)this.buffers=new Kr(t);else{var e=this.buffers;e.vertex.grow(t.vertex),e.fragment.grow(t.fragment)}this.manager.fillGlobals(this.buffers,t),this.manager.fillParams(this.buffers,t,this.shaders),this.engine.uploadShaderBuffers(this.buffers,0),this.engine.uploadShaderBuffers(this.buffers,1),this.engine.uploadShaderBuffers(this.buffers,2),this.plan.render(this.engine)},dispose:function(){},__class__:vr};var mr=function(t,e,r){null==r&&(r=1),null==e&&(e=1),null==t&&(t=1),vr.call(this,new Xr),this.set_quality(t),this.passes=e,this.set_sigma(r)};a["h3d.pass.Blur"]=mr,mr.__name__=["h3d","pass","Blur"],mr.__super__=vr,mr.prototype=e(vr.prototype,{set_quality:function(t){return this.values=null,this.quality=t},set_sigma:function(t){return this.values=null,this.sigma=t},gauss:function(t,e){if(e<=0)return 0==t?1:0;var r=e*e,i=Math.pow(2.718281828459,-(t*t)/(2*r));return i/Math.sqrt(2*Math.PI*r)},calcValues:function(){this.values=[];for(var t=0,e=0,r=this.quality+1;e<r;){var i=e++,n=this.gauss(i,this.sigma);this.values[i]=n,t+=n,i>0&&(t+=n)}for(var a=0,s=this.quality+1;a<s;){var o=a++;this.values[o]/=t}},apply:function(t,e,r,i){if(null==i&&(i=!1),!(this.quality<=0||this.passes<=0||this.sigma<=0)||null!=this.shader.fixedColor__){null==r&&(r=t);var n=null==e;n&&(e=new pr(t.width,t.height,[or.Target])),null==this.values&&this.calcValues();var a=this.shader;a.constModified=!0,a.Quality__=this.quality+1,this.shader.values__=this.values;var s=this.shader;s.constModified=!0,s.isDepth__=i,null!=this.depthBlur&&(this.shader.cameraInverseViewProj__=this.depthBlur.camera.getInverseViewProj());var o=r.depthBuffer,h=e.depthBuffer;r.depthBuffer=null,e.depthBuffer=null;for(var l=0,u=this.passes;l<u;){l++;this.shader.texture__=t;var R=this.shader.pixel__;R.x=1/t.width,R.y=0,R.z=0,R.w=1,this.engine.pushTarget(e),this.render(),this.engine.popTarget(),this.shader.texture__=e;var c=this.shader.pixel__;c.x=0,c.y=1/e.height,c.z=0,c.w=1,this.engine.pushTarget(r),this.render(),this.engine.popTarget()}r.depthBuffer=o,e.depthBuffer=h,n&&e.dispose()}},__class__:mr});var yr=function(){this.priority=0,this.initialize()};a["hxsl.Shader"]=yr,yr.__name__=["hxsl","Shader"],yr.prototype={initialize:function(){if(this.constModified=!0,null==this.shader){var t=En.getClass(this);if(this.shader=t._SHADER,null==this.shader){for(var e=t;null!=e&&null==e.SRC;)e=v.getSuperClass(e);if(null==e)throw new Zn(v.getClassName(t)+" has no shader source");this.shader=e._SHADER,null==this.shader&&(this.shader=new Yn(e.SRC),e._SHADER=this.shader)}}},getParamValue:function(t){throw new Zn("assert")},getParamFloatValue:function(t){throw new Zn("assert")},updateConstants:function(t){throw new Zn("assert")},updateConstantsFinal:function(t){for(var e=this.shader.consts;null!=e;)if(0!=e.globalId){var r=t.map.get(e.globalId),i=e.v.type;switch(i[1]){case 1:var n=r;if(n>>>e.bits!=0)throw new Zn("Constant "+e.v.name+" is outside range ("+n+" > "+((1<<e.bits)-1)+")");this.constBits|=n<<e.pos;break;case 2:var a=r;a&&(this.constBits|=1<<e.pos);break;case 15:var s=i[2];if(null==r){e=e.next;continue}var o=r,h=o.channel;if(null==o.texture)h=yn.Unknown;else if(null==h||h==yn.Unknown)switch(s){case 1:if(o.texture.format!=pr.nativeFormat)throw new Zn("Constant "+e.v.name+" does not define channel select value");h=yn.PackedFloat;break;case 3:if(o.texture.format!=pr.nativeFormat)throw new Zn("Constant "+e.v.name+" does not define channel select value");h=yn.PackedNormal;break;default:throw new Zn("Constant "+e.v.name+" does not define channel select value")}this.constBits|=(t.allocChannelID(o.texture)<<3|h[1])<<e.pos;break;default:throw new Zn("assert")}e=e.next}else e=e.next;var l=this.shader,u=this.constBits,R=l.instanceCache.get(u);this.instance=null==R?l.makeInstance(u):R},toString:function(){return v.getClassName(En.getClass(this))},__class__:yr};var xr=function(){this.color__=new Pe,yr.call(this)};a["h3d.pass._Border.BorderShader"]=xr,xr.__name__=["h3d","pass","_Border","BorderShader"],xr.__super__=yr,xr.prototype=e(yr.prototype,{updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){return 0==t?this.color__:null},getParamFloatValue:function(t){return 0},__class__:xr});var br=function(t,e,r){null==r&&(r=1),vr.call(this,new xr);var i=Ni._new(0),n=i;if(n.pos==n.array.length){var a=n.array.length<<1;a<128&&(a=128);var s=new ga(a);s.set(n.array),n.array=s}if(n.array[n.pos++]=0/t*2-1,n.pos==n.array.length){var o=n.array.length<<1;o<128&&(o=128);var h=new ga(o);h.set(n.array),n.array=h}if(n.array[n.pos++]=1-0/e*2,n.pos==n.array.length){var l=n.array.length<<1;l<128&&(l=128);var u=new ga(l);u.set(n.array),n.array=u}if(n.array[n.pos++]=t/t*2-1,n.pos==n.array.length){var R=n.array.length<<1;R<128&&(R=128);var c=new ga(R);c.set(n.array),n.array=c}if(n.array[n.pos++]=1-0/e*2,n.pos==n.array.length){var _=n.array.length<<1;_<128&&(_=128);var f=new ga(_);f.set(n.array),n.array=f}if(n.array[n.pos++]=0/t*2-1,n.pos==n.array.length){var g=n.array.length<<1;g<128&&(g=128);var p=new ga(g);p.set(n.array),n.array=p}if(n.array[n.pos++]=1-r/e*2,n.pos==n.array.length){var d=n.array.length<<1;d<128&&(d=128);var v=new ga(d);v.set(n.array),n.array=v}if(n.array[n.pos++]=t/t*2-1,n.pos==n.array.length){var m=n.array.length<<1;m<128&&(m=128);var y=new ga(m);y.set(n.array),n.array=y}if(n.array[n.pos++]=1-r/e*2,n.pos==n.array.length){var x=n.array.length<<1;x<128&&(x=128);var b=new ga(x);b.set(n.array),n.array=b}if(n.array[n.pos++]=0/t*2-1,n.pos==n.array.length){var w=n.array.length<<1;w<128&&(w=128);var j=new ga(w);j.set(n.array),n.array=j}if(n.array[n.pos++]=1-0/e*2,n.pos==n.array.length){var T=n.array.length<<1;T<128&&(T=128);var S=new ga(T);S.set(n.array),n.array=S}if(n.array[n.pos++]=r/t*2-1,n.pos==n.array.length){var C=n.array.length<<1;C<128&&(C=128);var M=new ga(C);M.set(n.array),n.array=M}if(n.array[n.pos++]=1-0/e*2,n.pos==n.array.length){var k=n.array.length<<1;k<128&&(k=128);var E=new ga(k);E.set(n.array),n.array=E}if(n.array[n.pos++]=0/t*2-1,n.pos==n.array.length){var A=n.array.length<<1;A<128&&(A=128);var I=new ga(A);I.set(n.array),n.array=I}if(n.array[n.pos++]=1-e/e*2,n.pos==n.array.length){var P=n.array.length<<1;P<128&&(P=128);var D=new ga(P);D.set(n.array),n.array=D}if(n.array[n.pos++]=r/t*2-1,n.pos==n.array.length){var B=n.array.length<<1;B<128&&(B=128);var V=new ga(B);V.set(n.array),n.array=V}if(n.array[n.pos++]=1-e/e*2,n.pos==n.array.length){var O=n.array.length<<1;O<128&&(O=128);var F=new ga(O);F.set(n.array),n.array=F}if(n.array[n.pos++]=0/t*2-1,n.pos==n.array.length){var L=n.array.length<<1;L<128&&(L=128);var G=new ga(L);G.set(n.array),n.array=G}if(n.array[n.pos++]=1-(e-r)/e*2,n.pos==n.array.length){var N=n.array.length<<1;N<128&&(N=128);var z=new ga(N);z.set(n.array),n.array=z}if(n.array[n.pos++]=t/t*2-1,n.pos==n.array.length){var q=n.array.length<<1;q<128&&(q=128);var U=new ga(q);U.set(n.array),n.array=U}if(n.array[n.pos++]=1-(e-r)/e*2,n.pos==n.array.length){var Y=n.array.length<<1;Y<128&&(Y=128);var W=new ga(Y);W.set(n.array),n.array=W}if(n.array[n.pos++]=0/t*2-1,n.pos==n.array.length){var H=n.array.length<<1;H<128&&(H=128);var X=new ga(H);X.set(n.array),n.array=X}if(n.array[n.pos++]=1-e/e*2,n.pos==n.array.length){var Z=n.array.length<<1;Z<128&&(Z=128);var K=new ga(Z);K.set(n.array),n.array=K}if(n.array[n.pos++]=t/t*2-1,n.pos==n.array.length){var $=n.array.length<<1;$<128&&($=128);var Q=new ga($);Q.set(n.array),n.array=Q}if(n.array[n.pos++]=1-e/e*2,n.pos==n.array.length){var J=n.array.length<<1;J<128&&(J=128);var tt=new ga(J);tt.set(n.array),n.array=tt}if(n.array[n.pos++]=(t-r)/t*2-1,n.pos==n.array.length){var et=n.array.length<<1;et<128&&(et=128);var rt=new ga(et);rt.set(n.array),n.array=rt}if(n.array[n.pos++]=1-0/e*2,n.pos==n.array.length){var it=n.array.length<<1;it<128&&(it=128);var nt=new ga(it);nt.set(n.array),n.array=nt}if(n.array[n.pos++]=t/t*2-1,n.pos==n.array.length){var at=n.array.length<<1;at<128&&(at=128);var st=new ga(at);st.set(n.array),n.array=st}if(n.array[n.pos++]=1-0/e*2,n.pos==n.array.length){var ot=n.array.length<<1;ot<128&&(ot=128);var ht=new ga(ot);ht.set(n.array),n.array=ht}if(n.array[n.pos++]=(t-r)/t*2-1,n.pos==n.array.length){var lt=n.array.length<<1;lt<128&&(lt=128);var ut=new ga(lt);ut.set(n.array),n.array=ut}if(n.array[n.pos++]=1-e/e*2,n.pos==n.array.length){var Rt=n.array.length<<1;Rt<128&&(Rt=128);var ct=new ga(Rt);ct.set(n.array),n.array=ct}if(n.array[n.pos++]=t/t*2-1,n.pos==n.array.length){var _t=n.array.length<<1;_t<128&&(_t=128);var ft=new ga(_t);ft.set(n.array),n.array=ft}n.array[n.pos++]=1-e/e*2,this.plan=new Dr({vbuf:n,stride:2,quads:!0},!0);var gt=this.shader.color__;gt.x=1,gt.y=1,gt.z=1,gt.w=1};a["h3d.pass.Border"]=br,br.__name__=["h3d","pass","Border"],br.__super__=vr,br.prototype=e(vr.prototype,{__class__:br});var wr=function(){yr.call(this)};a["h3d.shader.ScreenShader"]=wr,wr.__name__=["h3d","shader","ScreenShader"],wr.__super__=yr,wr.prototype=e(yr.prototype,{updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){return null},getParamFloatValue:function(t){return 0},__class__:wr});var jr=function(){wr.call(this)};a["h3d.pass._Copy.CopyShader"]=jr,jr.__name__=["h3d","pass","_Copy","CopyShader"],jr.__super__=wr,jr.prototype=e(wr.prototype,{updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){return 0==t?this.texture__:null},getParamFloatValue:function(t){return 0},__class__:jr});var Tr=function(){this.sortPasses=!0,this.textureCount=1,this.shaderCount=1,dr.call(this),this.manager=new Ar(this.getOutputs()),this.tcache=new $e,this.shaderIdMap=[],this.textureIdMap=[],this.initGlobals()};a["h3d.pass.Default"]=Tr,Tr.__name__=["h3d","pass","Default"],Tr.__super__=dr,Tr.prototype=e(dr.prototype,{getOutputs:function(){return[Bn.Value("output.color")]},processShaders:function(t,e){for(var r=this.ctx.extraShaders;null!=r;)e=this.ctx.allocShaderList(r.s,e),r=r.next;return e},setupShaders:function(t){for(var e=t,r=!1;null!=e;){var i=e.pass.getShadersRec();i=this.processShaders(e,i),e.pass.enableLights&&null!=this.ctx.lightSystem&&(r||(this.ctx.lightSystem.initGlobals(this.manager.globals),r=!0),i=this.ctx.lightSystem.computeLight(e.obj,i)),e.shader=this.manager.compileShaders(i),e.shaders=i;var n=e.shader.fragment.textures2D;if(null==n)e.texture=0;else{var a;if(null!=n.perObjectGlobal){var s=this.manager.globals.map.get(n.perObjectGlobal.gid);if(null==s)throw new Zn("Missing global value "+n.perObjectGlobal.path);var o=n.type;a=15==o[1]?s.texture:s}else{for(var h=i,l=n.instance;--l>0;)h=h.next;var u=h.s.getParamValue(n.index);a=u}e.texture=null==a?0:a.id}e=e.next}},uploadParams:function(){this.manager.fillParams(this.cachedBuffer,this.ctx.drawPass.shader,this.ctx.drawPass.shaders),this.ctx.engine.uploadShaderBuffers(this.cachedBuffer,1),this.ctx.engine.uploadShaderBuffers(this.cachedBuffer,2)},drawObject:function(t){this.ctx.drawPass=t,this.ctx.engine.selectMaterial(t.pass),t.obj.draw(this.ctx)},draw:function(t){for(var e=this,r=0,i=this.ctx.sharedGlobals;r<i.length;){var a=i[r];++r,this.manager.globals.map.set(a.gid,a.value)}this.setGlobals(),this.setupShaders(t);for(var s=t,o=this.shaderCount,h=this.textureCount;null!=s;)this.shaderIdMap[s.shader.id]<o&&(this.shaderIdMap[s.shader.id]=this.shaderCount++),this.textureIdMap[s.texture]<h&&(this.textureIdMap[s.texture]=this.textureCount++),s=s.next;if(this.sortPasses){var l=t;if(null==l)t=null;else{for(var u,R,c,_,f,g=1,p=0,d=0;;){for(R=l,l=null,f=null,u=0;null!=R;){++u,c=R,p=0;for(var v=0,m=g;v<m;){v++;if(++p,c=c.next,null==c)break}for(d=g;p>0||d>0&&null!=c;){if(0==p)_=c,c=c.next,--d;else{var y;if(0!=d&&null!=c){var x=e.shaderIdMap[R.shader.id]-e.shaderIdMap[c.shader.id];y=(0!=x?x:e.textureIdMap[R.texture]-e.textureIdMap[c.texture])<=0}else y=!0;y?(_=R,R=R.next,--p):(_=c,c=c.next,--d)}null!=f?f.next=_:l=_,f=_}R=c}if(f.next=null,u<=1)break;g*=2}t=l}}this.ctx.uploadParams=n(this,this.uploadParams);var b=t,w=this.cachedBuffer,j=null,T=0,S=0,C=0;for(this.ctx.engine.driver.logEnable&&(T=this.ctx.engine.drawTriangles,S=this.ctx.engine.drawCalls,C=this.ctx.engine.shaderSwitches);null!=b;){var M=b.obj.absPos;if(this.manager.globals.map.set(this.globalModelView_id,M),b.shader.globals.exists(this.globalModelViewInverse_id)){var k=b.obj.getInvPos();this.manager.globals.map.set(this.globalModelViewInverse_id,k)}if(j!=b.shader){if(j=b.shader,this.ctx.engine.selectShader(b.shader),null==w)w=this.cachedBuffer=new Kr(b.shader);else{var E=b.shader;w.vertex.grow(E.vertex),w.fragment.grow(E.fragment)}this.manager.fillGlobals(w,b.shader),this.ctx.engine.uploadShaderBuffers(w,0)}b.pass.dynamicParameters||(this.manager.fillParams(w,b.shader,b.shaders),this.ctx.engine.uploadShaderBuffers(w,1),this.ctx.engine.uploadShaderBuffers(w,2)),this.drawObject(b),b=b.next}var A=this.ctx;return A.cachedPos=0,A.drawPass=null,t},initGlobals:function(){var t=kn.allocID("camera.view");this.cameraView_id=t;var e=kn.allocID("camera.zNear");this.cameraNear_id=e;var r=kn.allocID("camera.zFar");this.cameraFar_id=r;var i=kn.allocID("camera.proj");this.cameraProj_id=i;var n=kn.allocID("camera.position");this.cameraPos_id=n;var a=kn.allocID("camera.projDiag");this.cameraProjDiag_id=a;var s=kn.allocID("camera.viewProj");this.cameraViewProj_id=s;var o=kn.allocID("camera.inverseViewProj");this.cameraInverseViewProj_id=o;var h=kn.allocID("global.time");this.globalTime_id=h;var l=kn.allocID("global.pixelSize");this.pixelSize_id=l;var u=kn.allocID("global.modelView");this.globalModelView_id=u;var R=kn.allocID("global.modelViewInverse");this.globalModelViewInverse_id=R},setGlobals:function(){var t=this.ctx.camera.mcam;this.manager.globals.map.set(this.cameraView_id,t);var e=this.ctx.camera.zNear;this.manager.globals.map.set(this.cameraNear_id,e);var r=this.ctx.camera.zFar;this.manager.globals.map.set(this.cameraFar_id,r);var i=this.ctx.camera.mproj;this.manager.globals.map.set(this.cameraProj_id,i);var n=this.ctx.camera.pos;this.manager.globals.map.set(this.cameraPos_id,n);var a=new Pe(this.ctx.camera.mproj._11,this.ctx.camera.mproj._22,this.ctx.camera.mproj._33,this.ctx.camera.mproj._44);this.manager.globals.map.set(this.cameraProjDiag_id,a);var s=this.ctx.camera.m;this.manager.globals.map.set(this.cameraViewProj_id,s);var o=this.ctx.camera.getInverseViewProj();this.manager.globals.map.set(this.cameraInverseViewProj_id,o);var h=this.ctx.time;this.manager.globals.map.set(this.globalTime_id,h);var l=new Pe(2/this.ctx.engine.width,2/this.ctx.engine.height);this.manager.globals.map.set(this.pixelSize_id,l)},__class__:Tr});var Sr=function(){this.reduceSize=0,this.enableSky=!1,Tr.call(this),this.priority=10,this.depthMapId=kn.allocID("depthMap")};a["h3d.pass.Depth"]=Sr,Sr.__name__=["h3d","pass","Depth"],Sr.__super__=Tr,Sr.prototype=e(Tr.prototype,{getOutputs:function(){return[Bn.PackFloat(Bn.Value("output.depth"))]},draw:function(t){var e=this.tcache.allocTarget("depthMap",this.ctx,this.ctx.engine.width>>this.reduceSize,this.ctx.engine.height>>this.reduceSize,!0);return this.ctx.engine.pushTarget(e),this.ctx.engine.clear(this.enableSky?0:16711680,1),t=Tr.prototype.draw.call(this,t),this.ctx.engine.popTarget(),this.ctx.setGlobalID(this.depthMapId,{texture:e}),t},__class__:Sr});var Cr=function(){this.viewport__=new Pe,this.colorID__=new Pe,yr.call(this)};a["h3d.pass._HardwarePick.FixedColor"]=Cr,Cr.__name__=["h3d","pass","_HardwarePick","FixedColor"],Cr.__super__=yr,Cr.prototype=e(yr.prototype,{updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.colorID__;case 1:return this.viewport__}return null},getParamFloatValue:function(t){return 0},__class__:Cr});var Mr=function(){this.perPixelLighting=!0,this.maxLightsPerObject=6,this.ambientLight=new Pe(.5,.5,.5),this.ambientShader=new Yr,this.set_additiveLighting(!0)};a["h3d.pass.LightSystem"]=Mr,Mr.__name__=["h3d","pass","LightSystem"],Mr.prototype={set_additiveLighting:function(t){var e=this.ambientShader,r=e instanceof Yr?e:null;return r.constModified=!0,r.additive__=t},initLights:function(t){this.lightCount=0,this.ctx=t;for(var e=t.lights,r=null,i=new Fe(t.camera.m),a=new Ne;null!=e;)a.x=e.absPos._41,a.y=e.absPos._42,a.z=e.absPos._43,a.r=e.cullingDistance,i.hasSphere(a)?(this.lightCount++,e.objectDistance=0,r=e,e=e.next):(null==r?t.lights=e.next:r.next=e.next,e=e.next);if(this.lightCount<=this.maxLightsPerObject){var s,o=t.lights,h=n(this,this.sortLight);if(null==o)s=null;else{for(var l,u,R,c,_,f=1,g=0,p=0;;){for(u=o,o=null,_=null,l=0;null!=u;){++l,R=u,g=0;for(var d=0,v=f;d<v;){d++;if(++g,R=R.next,null==R)break}for(p=f;g>0||p>0&&null!=R;)0==g?(c=R,R=R.next,--p):0==p||null==R||h(u,R)<=0?(c=u,u=u.next,--g):(c=R,R=R.next,--p),null!=_?_.next=c:o=c,_=c;u=R}if(_.next=null,l<=1)break;f*=2}s=o}t.lights=s}if(null==this.shadowLight||null==this.shadowLight.parent)for(var m=t.lights;null!=m;){var y=m instanceof Or?m:null;if(null!=y){this.shadowLight=y;break}m=m.next}},initGlobals:function(t){t.set("global.ambientLight",this.ambientLight),t.set("global.perPixelLighting",this.perPixelLighting)},sortLight:function(t,e){var r=t.priority-e.priority;return 0!=r?-r:t.objectDistance<e.objectDistance?-1:1},computeLight:function(t,e){var r=this;if(this.lightCount>this.maxLightsPerObject){for(var i=this.ctx.lights;null!=i;){if(0!=(16&t.flags)){var a=i.absPos._41-this.ctx.camera.target.x,s=i.absPos._42-this.ctx.camera.target.y,o=i.absPos._43-this.ctx.camera.target.z;i.objectDistance=a*a+s*s+o*o}else{var h=i.absPos._41-t.absPos._41,l=i.absPos._42-t.absPos._42,u=i.absPos._43-t.absPos._43;i.objectDistance=h*h+l*l+u*u}i=i.next}var R,c=this.ctx.lights,_=n(this,this.sortLight);if(null==c)R=null;else{for(var f,g,p,d,v,m=1,y=0,x=0;;){for(g=c,c=null,v=null,f=0;null!=g;){++f,p=g,y=0;for(var b=0,w=m;b<w;){b++;if(++y,p=p.next,null==p)break}for(x=m;y>0||x>0&&null!=p;)0==y?(d=p,p=p.next,--x):0==x||null==p||_(g,p)<=0?(d=g,g=g.next,--y):(d=p,p=p.next,--x),null!=v?v.next=d:c=d,v=d;g=p}if(v.next=null,f<=1)break;m*=2}R=c}this.ctx.lights=R}e=r.ctx.allocShaderList(this.ambientShader,e);for(var j=this.ctx.lights,T=0;null!=j&&T++!=this.maxLightsPerObject;)e=r.ctx.allocShaderList(j.shader,e),j=j.next;return e},__class__:Mr};var kr=function(){Tr.call(this),this.priority=10,this.normalMapId=kn.allocID("normalMap")};a["h3d.pass.Normal"]=kr,kr.__name__=["h3d","pass","Normal"],kr.__super__=Tr,kr.prototype=e(Tr.prototype,{getOutputs:function(){return[Bn.PackNormal(Bn.Value("output.normal"))]},draw:function(t){var e=this.tcache.allocTarget("normalMal",this.ctx,this.ctx.engine.width,this.ctx.engine.height);return this.ctx.engine.pushTarget(e),this.ctx.engine.clear(8421504,1),t=Tr.prototype.draw.call(this,t),this.ctx.engine.popTarget(),this.ctx.setGlobalID(this.normalMapId,e),t},__class__:kr});var Er=function(){this.texture=0};a["h3d.pass.Object"]=Er,Er.__name__=["h3d","pass","Object"],Er.prototype={__class__:Er};var Ar=function(t){this.shaderCache=mn.get(),this.globals=new kn,this.currentOutput=new Nn(null),this.setOutput(t)};a["h3d.pass.ShaderManager"]=Ar,Ar.__name__=["h3d","pass","ShaderManager"],Ar.prototype={setOutput:function(t){null==t&&(t=[Bn.Value("output.color")]),this.currentOutput.s=this.shaderCache.getLinkShader(t)},fillRec:function(t,e,r,i){switch(e[1]){case 3:return r[i]=t,1;case 5:var n=e[2],a=t;switch(r[i++]=a.x,r[i++]=a.y,n){case 3:r[i++]=a.z;break;case 4:r[i++]=a.z,r[i++]=a.w}return n;case 6:var s=t;return r[i++]=s._11,r[i++]=s._21,r[i++]=s._31,r[i++]=0,r[i++]=s._12,r[i++]=s._22,r[i++]=s._32,r[i++]=0,r[i++]=s._13,r[i++]=s._23,r[i++]=s._33,r[i++]=0,12;case 7:var o=t;return r[i++]=o._11,r[i++]=o._21,r[i++]=o._31,r[i++]=o._41,r[i++]=o._12,r[i++]=o._22,r[i++]=o._32,r[i++]=o._42,r[i++]=o._13,r[i++]=o._23,r[i++]=o._33,r[i++]=o._43,r[i++]=o._14,r[i++]=o._24,r[i++]=o._34,r[i++]=o._44,16;case 8:var h=t;return r[i++]=h._11,r[i++]=h._21,r[i++]=h._31,r[i++]=h._41,r[i++]=h._12,r[i++]=h._22,r[i++]=h._32,r[i++]=h._42,r[i++]=h._13,r[i++]=h._23,r[i++]=h._33,r[i++]=h._43,12;case 12:for(var l=e[2],u=0,R=0;R<l.length;){var c=l[R];++R,u+=this.fillRec(f.field(t,c.name),c.type,r,i+u)}return u;case 14:switch(e[2][1]){case 3:if(0==e[3][1]){for(var _=e[3][2],p=t,d=p.length<_?p.length:_,v=0,m=d;v<m;){var y=v++;r[i++]=p[y]}return _}throw new Zn("assert "+g.string(e));case 5:if(4==e[2][2]){if(1==e[2][3][1]){if(0==e[3][1]){for(var x=e[3][2],b=t,w=0,j=x;w<j;){var T=w++,S=b[T];if(null==S)break;r[i++]=S.x,r[i++]=S.y,r[i++]=S.z,r[i++]=S.w}return 4*x}throw new Zn("assert "+g.string(e))}if(0==e[3][1]){for(var C=e[3][2],M=e[2],k=t,E=0,A=0,I=C;A<I;){var P=A++,D=k[P];if(null==D)break;E=this.fillRec(D,M,r,i),i+=E}return C*E}throw new Zn("assert "+g.string(e))}if(0==e[3][1]){for(var B=e[3][2],V=e[2],O=t,F=0,L=0,G=B;L<G;){var N=L++,z=O[N];if(null==z)break;F=this.fillRec(z,V,r,i),i+=F}return B*F}throw new Zn("assert "+g.string(e));case 8:if(0==e[3][1]){for(var q=e[3][2],U=t,Y=0,W=q;Y<W;){var H=Y++,X=U[H];if(null==X)break;r[i++]=X._11,r[i++]=X._21,r[i++]=X._31,r[i++]=X._41,r[i++]=X._12,r[i++]=X._22,r[i++]=X._32,r[i++]=X._42,r[i++]=X._13,r[i++]=X._23,r[i++]=X._33,r[i++]=X._43}return 12*q}throw new Zn("assert "+g.string(e));default:if(0==e[3][1]){for(var Z=e[3][2],K=e[2],$=t,Q=0,J=0,tt=Z;J<tt;){var et=J++,rt=$[et];if(null==rt)break;Q=this.fillRec(rt,K,r,i),i+=Q}return Z*Q}throw new Zn("assert "+g.string(e))}break;default:throw new Zn("assert "+g.string(e))}},fillGlobals:function(t,e){for(var r=this,i=t.vertex,n=e.vertex,a=n.globals;null!=a;){var s=r.globals.map.get(a.gid);if(null==s){if("__consts__"==a.path){r.fillRec(n.consts,a.type,i.globals,a.pos),a=a.next;continue}throw new Zn("Missing global value "+a.path)}r.fillRec(s,a.type,i.globals,a.pos),a=a.next}for(var o=t.fragment,h=e.fragment,l=h.globals;null!=l;){var u=r.globals.map.get(l.gid);if(null==u){if("__consts__"==l.path){r.fillRec(h.consts,l.type,o.globals,l.pos),l=l.next;continue}throw new Zn("Missing global value "+l.path)}r.fillRec(u,l.type,o.globals,l.pos),l=l.next}},fillParams:function(t,e,r){for(var i=this,n=t.vertex,a=e.vertex,s=a.params;null!=s;)if(s.type!=nn.TFloat||null!=s.perObjectGlobal){var o;if(null!=s.perObjectGlobal){var h=i.globals.map.get(s.perObjectGlobal.gid);if(null==h)throw new Zn("Missing global value "+s.perObjectGlobal.path);var l=s.type;o=15==l[1]?h.texture:h}else{for(var u=r,R=s.instance;--R>0;)u=u.next;var c=u.s.getParamValue(s.index);if(null==c)throw new Zn("Missing param value "+g.string(u.s)+"."+s.name);o=c}var _=o;i.fillRec(_,s.type,n.params,s.pos),s=s.next}else{for(var f=r,p=s.instance;--p>0;)f=f.next;n.params[s.pos]=f.s.getParamFloatValue(s.index),s=s.next}for(var d=0,v=a.textures2D;null!=v;){var m;if(null!=v.perObjectGlobal){var y=i.globals.map.get(v.perObjectGlobal.gid);if(null==y)throw new Zn("Missing global value "+v.perObjectGlobal.path);var x=v.type;m=15==x[1]?y.texture:y}else{for(var b=r,w=v.instance;--w>0;)b=b.next;var j=b.s.getParamValue(v.index);if(null==j)throw new Zn("Missing param value "+g.string(b.s)+"."+v.name);m=j}var T=m;null==T&&(T=pr.fromColor(16711935)),n.tex[d++]=T,v=v.next}for(var S=a.texturesCube;null!=S;){var C;if(null!=S.perObjectGlobal){var M=i.globals.map.get(S.perObjectGlobal.gid);if(null==M)throw new Zn("Missing global value "+S.perObjectGlobal.path);var k=S.type;C=15==k[1]?M.texture:M}else{for(var E=r,A=S.instance;--A>0;)E=E.next;var I=E.s.getParamValue(S.index);if(null==I)throw new Zn("Missing param value "+g.string(E.s)+"."+S.name);C=I}var P=C;null==P&&(P=pr.fromColor(16711935)),n.tex[d++]=P,S=S.next}for(var D=t.fragment,B=e.fragment,V=B.params;null!=V;)if(V.type!=nn.TFloat||null!=V.perObjectGlobal){var O;if(null!=V.perObjectGlobal){var F=i.globals.map.get(V.perObjectGlobal.gid);if(null==F)throw new Zn("Missing global value "+V.perObjectGlobal.path);var L=V.type;O=15==L[1]?F.texture:F}else{for(var G=r,N=V.instance;--N>0;)G=G.next;var z=G.s.getParamValue(V.index);if(null==z)throw new Zn("Missing param value "+g.string(G.s)+"."+V.name);O=z}var q=O;i.fillRec(q,V.type,D.params,V.pos),V=V.next}else{for(var U=r,Y=V.instance;--Y>0;)U=U.next;D.params[V.pos]=U.s.getParamFloatValue(V.index),V=V.next}for(var W=0,H=B.textures2D;null!=H;){var X;if(null!=H.perObjectGlobal){var Z=i.globals.map.get(H.perObjectGlobal.gid);if(null==Z)throw new Zn("Missing global value "+H.perObjectGlobal.path);var K=H.type;X=15==K[1]?Z.texture:Z}else{for(var $=r,Q=H.instance;--Q>0;)$=$.next;var J=$.s.getParamValue(H.index);if(null==J)throw new Zn("Missing param value "+g.string($.s)+"."+H.name);X=J}var tt=X;null==tt&&(tt=pr.fromColor(16711935)),D.tex[W++]=tt,H=H.next}for(var et=B.texturesCube;null!=et;){var rt;if(null!=et.perObjectGlobal){var it=i.globals.map.get(et.perObjectGlobal.gid);if(null==it)throw new Zn("Missing global value "+et.perObjectGlobal.path);var nt=et.type;rt=15==nt[1]?it.texture:it}else{for(var at=r,st=et.instance;--st>0;)at=at.next;var ot=at.s.getParamValue(et.index);if(null==ot)throw new Zn("Missing param value "+g.string(at.s)+"."+et.name);rt=ot}var ht=rt;null==ht&&(ht=pr.fromColor(16711935)),D.tex[W++]=ht,et=et.next}},compileShaders:function(t){this.globals.maxChannels=0;var e,r=t;for(e=null;r!=e;){var i=r.s;r=r.next;var n=i;n.updateConstants(this.globals)}this.currentOutput.next=t;var a=this.shaderCache.link(this.currentOutput);return this.currentOutput.next=null,a},__class__:Ar};var Ir=function(t){this.bias=.01,this.power=10,Tr.call(this),this.set_size(t),this.priority=9,this.lightCamera=new Ce,this.lightCamera.orthoBounds=new Oe,this.shadowMapId=kn.allocID("shadow.map"),this.shadowProjId=kn.allocID("shadow.proj"),this.shadowColorId=kn.allocID("shadow.color"),this.shadowPowerId=kn.allocID("shadow.power"),this.shadowBiasId=kn.allocID("shadow.bias"),this.color=new Pe,this.blur=new mr(2,3),this.border=new br(t,t),this.customDepth=ke.CURRENT.driver.hasFeature(ze.AllocDepthBuffer),this.customDepth||(this.depth=lr.getDefault())};a["h3d.pass.ShadowMap"]=Ir,Ir.__name__=["h3d","pass","ShadowMap"],Ir.__super__=Tr,Ir.prototype=e(Tr.prototype,{set_size:function(t){return null!=this.border&&this.size!=t&&(this.border.dispose(),this.border=new br(t,t)),this.size=t},calcShadowBounds:function(t){var e=t.orthoBounds,r=new Ae;this.ctx.scene.iterVisibleMeshes(function(i){if(null!=i.primitive&&i.material.castShadows){var n=i.primitive.getBounds();if(!(n.xMin>n.xMax)){var a=i.getAbsPos();r.multiply3x4(a,t.mcam);var s,o,h=n.xMin;o=n.yMin,s=n.zMin;var l=h*r._11+o*r._21+s*r._31+r._41,u=h*r._12+o*r._22+s*r._32+r._42,R=h*r._13+o*r._23+s*r._33+r._43;h=l,o=u,s=R,h<e.xMin&&(e.xMin=h),h>e.xMax&&(e.xMax=h),o<e.yMin&&(e.yMin=o),o>e.yMax&&(e.yMax=o),s<e.zMin&&(e.zMin=s),s>e.zMax&&(e.zMax=s);var c,_,f=n.xMin;_=n.yMin,c=n.zMax;var g=f*r._11+_*r._21+c*r._31+r._41,p=f*r._12+_*r._22+c*r._32+r._42,d=f*r._13+_*r._23+c*r._33+r._43;f=g,_=p,c=d,f<e.xMin&&(e.xMin=f),f>e.xMax&&(e.xMax=f),_<e.yMin&&(e.yMin=_),_>e.yMax&&(e.yMax=_),c<e.zMin&&(e.zMin=c),c>e.zMax&&(e.zMax=c);var v,m,y=n.xMin;m=n.yMax,v=n.zMin;var x=y*r._11+m*r._21+v*r._31+r._41,b=y*r._12+m*r._22+v*r._32+r._42,w=y*r._13+m*r._23+v*r._33+r._43;y=x,m=b,v=w,y<e.xMin&&(e.xMin=y),y>e.xMax&&(e.xMax=y),m<e.yMin&&(e.yMin=m),m>e.yMax&&(e.yMax=m),v<e.zMin&&(e.zMin=v),v>e.zMax&&(e.zMax=v);var j,T,S=n.xMin;T=n.yMax,j=n.zMax;var C=S*r._11+T*r._21+j*r._31+r._41,M=S*r._12+T*r._22+j*r._32+r._42,k=S*r._13+T*r._23+j*r._33+r._43;S=C,T=M,j=k,S<e.xMin&&(e.xMin=S),S>e.xMax&&(e.xMax=S),T<e.yMin&&(e.yMin=T),T>e.yMax&&(e.yMax=T),j<e.zMin&&(e.zMin=j),j>e.zMax&&(e.zMax=j);var E,A,I=n.xMax;A=n.yMin,E=n.zMin;var P=I*r._11+A*r._21+E*r._31+r._41,D=I*r._12+A*r._22+E*r._32+r._42,B=I*r._13+A*r._23+E*r._33+r._43;I=P,A=D,E=B,I<e.xMin&&(e.xMin=I),I>e.xMax&&(e.xMax=I),A<e.yMin&&(e.yMin=A),A>e.yMax&&(e.yMax=A),E<e.zMin&&(e.zMin=E),E>e.zMax&&(e.zMax=E);var V,O,F=n.xMax;O=n.yMin,V=n.zMax;var L=F*r._11+O*r._21+V*r._31+r._41,G=F*r._12+O*r._22+V*r._32+r._42,N=F*r._13+O*r._23+V*r._33+r._43;F=L,O=G,V=N,F<e.xMin&&(e.xMin=F),F>e.xMax&&(e.xMax=F),O<e.yMin&&(e.yMin=O),O>e.yMax&&(e.yMax=O),V<e.zMin&&(e.zMin=V),V>e.zMax&&(e.zMax=V);var z,q,U=n.xMax;q=n.yMax,z=n.zMin;var Y=U*r._11+q*r._21+z*r._31+r._41,W=U*r._12+q*r._22+z*r._32+r._42,H=U*r._13+q*r._23+z*r._33+r._43;U=Y,q=W,z=H,U<e.xMin&&(e.xMin=U),U>e.xMax&&(e.xMax=U),q<e.yMin&&(e.yMin=q),q>e.yMax&&(e.yMax=q),z<e.zMin&&(e.zMin=z),z>e.zMax&&(e.zMax=z);var X,Z,K=n.xMax;Z=n.yMax,X=n.zMax;var $=K*r._11+Z*r._21+X*r._31+r._41,Q=K*r._12+Z*r._22+X*r._32+r._42,J=K*r._13+Z*r._23+X*r._33+r._43;K=$,Z=Q,X=J,K<e.xMin&&(e.xMin=K),K>e.xMax&&(e.xMax=K),Z<e.yMin&&(e.yMin=Z),Z>e.yMax&&(e.yMax=Z),X<e.zMin&&(e.zMin=X),X>e.zMax&&(e.zMax=X)}}});for(var i=new Oe,n=0,a=this.ctx.camera.getFrustumCorners();n<a.length;){var s=a[n];++n;var o=t.mcam,h=s.x*o._11+s.y*o._21+s.z*o._31+s.w*o._41,l=s.x*o._12+s.y*o._22+s.z*o._32+s.w*o._42,u=s.x*o._13+s.y*o._23+s.z*o._33+s.w*o._43,R=s.x*o._14+s.y*o._24+s.z*o._34+s.w*o._44;s.x=h,s.y=l,s.z=u,s.w=R;var c=s.x,_=s.y,f=s.z;c<i.xMin&&(i.xMin=c),c>i.xMax&&(i.xMax=c),_<i.yMin&&(i.yMin=_),_>i.yMax&&(i.yMax=_),f<i.zMin&&(i.zMin=f),f>i.zMax&&(i.zMax=f)}e.intersection(e,i),e.scaleCenter(1.01)},getOutputs:function(){return[Bn.PackFloat(Bn.Value("output.depth"))]},setGlobals:function(){Tr.prototype.setGlobals.call(this);var t=this.lightCamera.orthoBounds;t.xMin=1e20,t.xMax=-1e20,t.yMin=1e20,t.yMax=-1e20,t.zMin=1e20,t.zMax=-1e20,this.calcShadowBounds(this.lightCamera),this.lightCamera.update();var e=this.lightCamera.m;this.manager.globals.map.set(this.cameraViewProj_id,e)},draw:function(t){var e=this.tcache.allocTarget("shadowMap",this.ctx,this.size,this.size,!1);this.customDepth&&(null==this.depth||this.depth.width!=this.size||this.depth.height!=this.size||this.depth.isDisposed())&&(null!=this.depth&&this.depth.dispose(),this.depth=new lr(this.size,this.size)),e.depthBuffer=this.depth;var r=this.ctx.camera.target,i=this.ctx.lightSystem.shadowLight;if(null==i){var n=this.lightCamera.target;n.x=0,n.y=0,n.z=-1,n.w=1}else{var a=this.lightCamera.target;a.x=i.direction.x,a.y=i.direction.y,a.z=i.direction.z,a.w=1,this.lightCamera.target.normalize()}this.lightCamera.target.x+=r.x,this.lightCamera.target.y+=r.y,this.lightCamera.target.z+=r.z;var s=this.lightCamera.pos;return s.x=r.x,s.y=r.y,s.z=r.z,s.w=r.w,this.lightCamera.update(),this.ctx.engine.pushTarget(e),this.ctx.engine.clear(16777215,1),t=Tr.prototype.draw.call(this,t),null!=this.border&&this.border.render(),this.ctx.engine.popTarget(),this.blur.quality>0&&this.blur.passes>0&&this.blur.apply(e,this.tcache.allocTarget("tmpBlur",this.ctx,this.size,this.size,!1),null,!0),this.ctx.setGlobalID(this.shadowMapId,{texture:e}),this.ctx.setGlobalID(this.shadowProjId,this.lightCamera.m),this.ctx.setGlobalID(this.shadowColorId,this.color),this.ctx.setGlobalID(this.shadowPowerId,this.power),this.ctx.setGlobalID(this.shadowBiasId,this.bias),t},__class__:Ir});var Pr=function(){};a["h3d.prim.Plan2D"]=Pr,Pr.__name__=["h3d","prim","Plan2D"],Pr.get=function(){return null==Pr.inst&&(Pr.inst=new Pr),Pr.inst},Pr.__super__=he,Pr.prototype=e(he.prototype,{alloc:function(t){var e=Ni._new(0),r=e;if(r.pos==r.array.length){var i=r.array.length<<1;i<128&&(i=128);var n=new ga(i);n.set(r.array),r.array=n}if(r.array[r.pos++]=-1,r.pos==r.array.length){var a=r.array.length<<1;a<128&&(a=128);var s=new ga(a);
s.set(r.array),r.array=s}if(r.array[r.pos++]=-1,r.pos==r.array.length){var o=r.array.length<<1;o<128&&(o=128);var h=new ga(o);h.set(r.array),r.array=h}if(r.array[r.pos++]=0,r.pos==r.array.length){var l=r.array.length<<1;l<128&&(l=128);var u=new ga(l);u.set(r.array),r.array=u}if(r.array[r.pos++]=1,r.pos==r.array.length){var R=r.array.length<<1;R<128&&(R=128);var c=new ga(R);c.set(r.array),r.array=c}if(r.array[r.pos++]=-1,r.pos==r.array.length){var _=r.array.length<<1;_<128&&(_=128);var f=new ga(_);f.set(r.array),r.array=f}if(r.array[r.pos++]=1,r.pos==r.array.length){var g=r.array.length<<1;g<128&&(g=128);var p=new ga(g);p.set(r.array),r.array=p}if(r.array[r.pos++]=0,r.pos==r.array.length){var d=r.array.length<<1;d<128&&(d=128);var v=new ga(d);v.set(r.array),r.array=v}if(r.array[r.pos++]=0,r.pos==r.array.length){var m=r.array.length<<1;m<128&&(m=128);var y=new ga(m);y.set(r.array),r.array=y}if(r.array[r.pos++]=1,r.pos==r.array.length){var x=r.array.length<<1;x<128&&(x=128);var b=new ga(x);b.set(r.array),r.array=b}if(r.array[r.pos++]=-1,r.pos==r.array.length){var w=r.array.length<<1;w<128&&(w=128);var j=new ga(w);j.set(r.array),r.array=j}if(r.array[r.pos++]=1,r.pos==r.array.length){var T=r.array.length<<1;T<128&&(T=128);var S=new ga(T);S.set(r.array),r.array=S}if(r.array[r.pos++]=1,r.pos==r.array.length){var C=r.array.length<<1;C<128&&(C=128);var M=new ga(C);M.set(r.array),r.array=M}if(r.array[r.pos++]=1,r.pos==r.array.length){var k=r.array.length<<1;k<128&&(k=128);var E=new ga(k);E.set(r.array),r.array=E}if(r.array[r.pos++]=1,r.pos==r.array.length){var A=r.array.length<<1;A<128&&(A=128);var I=new ga(A);I.set(r.array),r.array=I}if(r.array[r.pos++]=1,r.pos==r.array.length){var P=r.array.length<<1;P<128&&(P=128);var D=new ga(P);D.set(r.array),r.array=D}r.array[r.pos++]=0,this.buffer=Se.ofFloats(r,4,[Te.Quads,Te.RawFormat])},render:function(t){(null==this.buffer||this.buffer.isDisposed())&&this.alloc(t),t.renderBuffer(this.buffer,t.mem.quadIndexes,2,0,-1)},__class__:Pr});var Dr=function(t,e){null==e&&(e=!1),this.onContextLost=function(){return t},this.bounds=t.bounds,this.alloc(null),e||(this.onContextLost=null)};a["h3d.prim.RawPrimitive"]=Dr,Dr.__name__=["h3d","prim","RawPrimitive"],Dr.__super__=he,Dr.prototype=e(he.prototype,{alloc:function(t){if(null==this.onContextLost)throw new Zn("Cannot realloc "+g.string(this));var e=this.onContextLost(),r=[];null==e.ibuf&&r.push(e.quads?Te.Quads:Te.Triangles),e.stride<8&&r.push(Te.RawFormat),this.buffer=Se.ofFloats(e.vbuf,e.stride,r),this.vcount=this.buffer.vertices,this.tcount=null!=e.ibuf?e.ibuf.length/3|0:e.quads?this.vcount>>1:this.vcount/3|0,null!=e.ibuf?this.indexes=Ee.alloc(e.ibuf):null!=this.indexes&&(this.indexes.dispose(),this.indexes=null)},getBounds:function(){if(null==this.bounds)throw new Zn("Bounds not defined for "+g.string(this));return this.bounds},__class__:Dr});var Br=function(t){var e=0;this.flags=e,this.absPos=new Ae,this.absPos.identity(),this.x=0;var r=1,i=!0;i?this.flags|=r:this.flags&=~r,this.y=0;var n=1,a=!0;a?this.flags|=n:this.flags&=~n,this.z=0;var s=1,o=!0;o?this.flags|=s:this.flags&=~s,this.scaleX=1;var h=1,l=!0;l?this.flags|=h:this.flags&=~h,this.scaleY=1;var u=1,R=!0;R?this.flags|=u:this.flags&=~u,this.scaleZ=1;var c=1,_=!0;_?this.flags|=c:this.flags&=~c,this.qRot=new Ie;var f=1,g=null!=this.follow;g?this.flags|=f:this.flags&=~f;var p=2;this.flags|=p,this.children=[],null!=t&&t.addChild(this)};a["h3d.scene.Object"]=Br,Br.__name__=["h3d","scene","Object"],Br.__interfaces__=[oe],Br.prototype={localToGlobal:function(t){this.syncPos(),null==t&&(t=new Pe);var e=this.absPos,r=t.x*e._11+t.y*e._21+t.z*e._31+t.w*e._41,i=t.x*e._12+t.y*e._22+t.z*e._32+t.w*e._42,n=t.x*e._13+t.y*e._23+t.z*e._33+t.w*e._43;return t.x=r,t.y=i,t.z=n,t},getInvPos:function(){return this.syncPos(),null==this.invPos&&(this.invPos=new Ae,this.invPos._44=0),0==this.invPos._44&&this.invPos.inverse3x4(this.absPos),this.invPos},addChild:function(t){this.addChildAt(t,this.children.length)},addChildAt:function(t,e){e<0&&(e=0),e>this.children.length&&(e=this.children.length);for(var r=this;null!=r;){if(r==t)throw new Zn("Recursive addChild");r=r.parent}if(null!=t.parent){var i=0!=(32&t.flags),n=32;t.flags&=~n,t.parent.removeChild(t);var a=32;i?t.flags|=a:t.flags&=~a}this.children.splice(e,0,t),0==(32&this.flags)&&0!=(32&t.flags)&&t.onRemove(),t.parent=this;var s=1,o=!0;o?t.flags|=s:t.flags&=~s,0!=(32&this.flags)&&(0==(32&t.flags)?t.onAdd():t.onParentChanged())},iterVisibleMeshes:function(t){if(0!=(2&this.flags)&&(0==(4&this.flags)||0==(128&this.flags))){if(0==(4&this.flags)){var e=this instanceof Fr?this:null;null!=e&&t(e)}for(var r=0,i=this.children;r<i.length;){var n=i[r];++r,n.iterVisibleMeshes(t)}}},onParentChanged:function(){for(var t=0,e=this.children;t<e.length;){var r=e[t];++t,r.onParentChanged()}},onAdd:function(){var t=32;this.flags|=t;for(var e=0,r=this.children;e<r.length;){var i=r[e];++e,i.onAdd()}},onRemove:function(){var t=32;this.flags&=~t;for(var e=0,r=this.children;e<r.length;){var i=r[e];++e,i.onRemove()}},removeChild:function(t){if(o.remove(this.children,t)){0!=(32&t.flags)&&t.onRemove(),t.parent=null;var e=1,r=!0;r?t.flags|=e:t.flags&=~e}},getScene:function(){for(var t=this;null!=t.parent;)t=t.parent;return t instanceof Ur?t:null},getAbsPos:function(){return this.syncPos(),this.absPos},draw:function(t){},calcAbsPos:function(){if(this.qRot.saveToMatrix(this.absPos),this.absPos._11*=this.scaleX,this.absPos._12*=this.scaleX,this.absPos._13*=this.scaleX,this.absPos._21*=this.scaleY,this.absPos._22*=this.scaleY,this.absPos._23*=this.scaleY,this.absPos._31*=this.scaleZ,this.absPos._32*=this.scaleZ,this.absPos._33*=this.scaleZ,this.absPos._41=this.x,this.absPos._42=this.y,this.absPos._43=this.z,null!=this.follow)if(this.follow.syncPos(),0!=(8&this.flags)){var t=this.absPos;t._41+=this.follow.absPos._41;var e=this.absPos;e._42+=this.follow.absPos._42;var r=this.absPos;r._43+=this.follow.absPos._43}else this.absPos.multiply3x4(this.absPos,this.follow.absPos);else if(null!=this.parent){var i=this.absPos,n=this.absPos,a=this.parent.absPos,s=n._11,o=n._12,h=n._13,l=n._21,u=n._22,R=n._23,c=n._31,_=n._32,f=n._33,g=n._41,p=n._42,d=n._43,v=a._11,m=a._12,y=a._13,x=a._21,b=a._22,w=a._23,j=a._31,T=a._32,S=a._33,C=a._41,M=a._42,k=a._43;i._11=s*v+o*x+h*j,i._12=s*m+o*b+h*T,i._13=s*y+o*w+h*S,i._14=0,i._21=l*v+u*x+R*j,i._22=l*m+u*b+R*T,i._23=l*y+u*w+R*S,i._24=0,i._31=c*v+_*x+f*j,i._32=c*m+_*b+f*T,i._33=c*y+_*w+f*S,i._34=0,i._41=g*v+p*x+d*j+C,i._42=g*m+p*b+d*T+M,i._43=g*y+p*w+d*S+k,i._44=1}if(null!=this.defaultTransform){var E=this.absPos,A=this.defaultTransform,I=this.absPos,P=A._11,D=A._12,B=A._13,V=A._21,O=A._22,F=A._23,L=A._31,G=A._32,N=A._33,z=A._41,q=A._42,U=A._43,Y=I._11,W=I._12,H=I._13,X=I._21,Z=I._22,K=I._23,$=I._31,Q=I._32,J=I._33,tt=I._41,et=I._42,rt=I._43;E._11=P*Y+D*X+B*$,E._12=P*W+D*Z+B*Q,E._13=P*H+D*K+B*J,E._14=0,E._21=V*Y+O*X+F*$,E._22=V*W+O*Z+F*Q,E._23=V*H+O*K+F*J,E._24=0,E._31=L*Y+G*X+N*$,E._32=L*W+G*Z+N*Q,E._33=L*H+G*K+N*J,E._34=0,E._41=z*Y+q*X+U*$+tt,E._42=z*W+q*Z+U*Q+et,E._43=z*H+q*K+U*J+rt,E._44=1}null!=this.invPos&&(this.invPos._44=0)},sync:function(t){},syncRec:function(t){if(null!=this.currentAnimation){for(var e=this.parent,r=t.elapsedTime;r>0&&null!=this.currentAnimation;)r=this.currentAnimation.update(r);if(null!=this.currentAnimation&&(t.visibleFlag&&0!=(2&this.flags)&&0==(4&this.flags)||0!=(64&this.flags))&&this.currentAnimation.sync(),null==this.parent&&null!=e)return}var i=t.visibleFlag;(0==(2&this.flags)||0!=(4&this.flags)&&0!=(128&this.flags))&&(t.visibleFlag=!1);var n=0!=(1&this.flags);n&&this.calcAbsPos(),this.sync(t);var a=1,s=null!=this.follow;s?this.flags|=a:this.flags&=~a,this.lastFrame=t.frame;for(var o=0,h=this.children.length;o<h;){var l=this.children[o];if(null==l)break;if(l.lastFrame!=t.frame){if(n){var u=1,R=!0;R?l.flags|=u:l.flags&=~u}l.syncRec(t)}this.children[o]!=l?(o=0,h=this.children.length):++o}t.visibleFlag=i},syncPos:function(){if(null!=this.parent&&this.parent.syncPos(),0!=(1&this.flags)){var t=1,e=null!=this.follow;e?this.flags|=t:this.flags&=~t,this.calcAbsPos();for(var r=0,i=this.children;r<i.length;){var n=i[r];++r;var a=1,s=!0;s?n.flags|=a:n.flags&=~a}}},emit:function(t){},emitRec:function(t){if(0!=(2&this.flags)&&(0==(4&this.flags)||0==(128&this.flags))){if(0!=(1&this.flags)){null!=this.currentAnimation&&this.currentAnimation.sync();var e=1,r=null!=this.follow;r?this.flags|=e:this.flags&=~e,this.calcAbsPos();for(var i=0,n=this.children;i<n.length;){var a=n[i];++i;var s=1,o=!0;o?a.flags|=s:a.flags&=~s}}0==(4&this.flags)&&this.emit(t);for(var h=0,l=this.children;h<l.length;){var u=l[h];++h,u.emitRec(t)}}},__class__:Br};var Vr=function(t,e){this.priority=0,this.cullingDistance=1e10,Br.call(this,e),this.shader=t};a["h3d.scene.Light"]=Vr,Vr.__name__=["h3d","scene","Light"],Vr.__super__=Br,Vr.prototype=e(Br.prototype,{emit:function(t){t.emitLight(this)},__class__:Vr});var Or=function(t,e){this.dshader=new ti,this.direction=t,Vr.call(this,this.dshader,e),this.priority=100};a["h3d.scene.DirLight"]=Or,Or.__name__=["h3d","scene","DirLight"],Or.__super__=Vr,Or.prototype=e(Vr.prototype,{emit:function(t){var e=this.dshader.direction__;e.x=this.direction.x,e.y=this.direction.y,e.z=this.direction.z,e.w=1,this.dshader.direction__.normalize(),Vr.prototype.emit.call(this,t)},__class__:Or});var Fr=function(t,e,r){Br.call(this,r),this.primitive=t,null==e&&(e=new ur(null)),this.material=e};a["h3d.scene.Mesh"]=Fr,Fr.__name__=["h3d","scene","Mesh"],Fr.__super__=Br,Fr.prototype=e(Br.prototype,{draw:function(t){this.primitive.render(t.engine)},emit:function(t){for(var e=this.material.passes;null!=e;)t.emitPass(e,this).index=0,e=e.nextPass},__class__:Fr});var Lr=function(t,e){this.hitPoint=new Pe,this.mouseDownButton=-1,this.propagateEvents=!1,this.cancelEvents=!1,Br.call(this,e),this.shape=t,this.set_cursor(Oi.Button)};a["h3d.scene.Interactive"]=Lr,Lr.__name__=["h3d","scene","Interactive"],Lr.__interfaces__=[Re],Lr.__super__=Br,Lr.prototype=e(Br.prototype,{onAdd:function(){this.scene=this.getScene(),null!=this.scene&&this.scene.addEventTarget(this),Br.prototype.onAdd.call(this)},onRemove:function(){null!=this.scene&&(this.scene.removeEventTarget(this),this.scene=null),Br.prototype.onRemove.call(this)},getInteractiveScene:function(){return this.scene},handleEvent:function(t){this.propagateEvents&&(t.propagate=!0),this.cancelEvents&&(t.cancel=!0);var e=t.kind;switch(e[1]){case 0:(this.enableRightButton||0==t.button)&&(this.mouseDownButton=t.button,this.onPush(t));break;case 1:(this.enableRightButton||0==t.button)&&(this.onRelease(t),this.mouseDownButton==t.button&&this.onClick(t)),this.mouseDownButton=-1;break;case 2:this.onMove(t);break;case 3:this.onOver(t),t.cancel||null==this.cursor||Zi.setCursor(this.cursor);break;case 4:this.mouseDownButton=-1,this.onOut(t),t.cancel||Zi.setCursor(Oi.Default);break;case 5:this.onWheel(t);break;case 6:this.onFocus(t);break;case 7:this.onFocusLost(t);break;case 8:this.onKeyDown(t);break;case 9:this.onKeyUp(t);break;case 10:(this.enableRightButton||0==t.button)&&(t.kind=Li.ERelease,this.onRelease(t),t.kind=Li.EReleaseOutside),this.mouseDownButton=-1;break;case 11:this.onTextInput(t);break;case 12:this.onCheck(t)}},set_cursor:function(t){return this.cursor=t,this.isOver()&&null!=this.cursor&&Zi.setCursor(this.cursor),t},isOver:function(){return null!=this.scene&&null!=this.scene.events&&this.scene.events.currentOver==this},onOver:function(t){},onOut:function(t){},onPush:function(t){},onRelease:function(t){},onClick:function(t){},onMove:function(t){},onWheel:function(t){},onFocus:function(t){},onFocusLost:function(t){},onKeyUp:function(t){},onKeyDown:function(t){},onCheck:function(t){},onTextInput:function(t){},__class__:Lr});var Gr=function(t,e){this.gid=t,this.value=e};a["h3d.scene._RenderContext.SharedGlobal"]=Gr,Gr.__name__=["h3d","scene","_RenderContext","SharedGlobal"],Gr.prototype={__class__:Gr};var Nr=function(){ge.call(this),this.cachedShaderList=[]};a["h3d.scene.RenderContext"]=Nr,Nr.__name__=["h3d","scene","RenderContext"],Nr.__super__=ge,Nr.prototype=e(ge.prototype,{start:function(){this.sharedGlobals=[],this.lights=null,this.drawPass=null,this.passes=null,this.lights=null,this.uploadParams=null,this.cachedPos=0,this.visibleFlag=!0,this.time+=this.elapsedTime,this.frame++},setGlobalID:function(t,e){for(var r=0,i=this.sharedGlobals;r<i.length;){var n=i[r];if(++r,n.gid==t)return void(n.value=e)}this.sharedGlobals.push(new Gr(t,e))},emitPass:function(t,e){var r=this.pool;return null==r?(r=new Er,r.nextAlloc=this.firstAlloc,this.firstAlloc=r):this.pool=r.nextAlloc,r.pass=t,r.obj=e,r.next=this.passes,this.passes=r,r},allocShaderList:function(t,e){var r=this.cachedShaderList[this.cachedPos++];return null==r&&(r=new Nn(null),this.cachedShaderList[this.cachedPos-1]=r),r.s=t,r.next=e,r},emitLight:function(t){t.next=this.lights,this.lights=t},done:function(){this.drawPass=null,this.uploadParams=null;for(var t=this.firstAlloc;null!=t;)t.obj=null,t.pass=null,t.shader=null,t.shaders=null,t.next=null,t.index=0,t=t.nextAlloc;this.pool=this.firstAlloc;for(var e=0,r=this.cachedShaderList;e<r.length;){var i=r[e];++e,i.s=null,i.next=null}this.passes=null,this.lights=null},__class__:Nr});var zr=function(t,e){this.name=t,this.passes=e};a["h3d.scene.PassGroup"]=zr,zr.__name__=["h3d","scene","PassGroup"],zr.prototype={__class__:zr};var qr=function(){this.hasSetTarget=!1,this.passes=new Ti,this.allPasses=[],this.tcache=new $e,this.passGroups=new Ti};a["h3d.scene.Renderer"]=qr,qr.__name__=["h3d","scene","Renderer"],qr.prototype={createDefaultPass:function(t){switch(t){case"depth":return null!=this.depth?this.depth:this.depth=new Sr;case"normal":return null!=this.normal?this.normal:this.normal=new kr;case"shadow":return null!=this.shadow?this.shadow:this.shadow=new Ir(1024);default:return null!=this.def?this.def:this.def=new Tr}},getPass:function(t,e){null==e&&(e=!0);var r=this.passes,i=null!=_a[t]?r.getReserved(t):r.h[t];return null==i&&e&&(i=this.createDefaultPass(t),this.setPass(t,i)),i},getPassPriority:function(t){var e=10*t.p.priority,r=t.name;switch(r){case"additive":e-=2;break;case"alpha":--e}return e},setPass:function(t,e){for(var r=this,i=0,n=this.allPasses;i<n.length;){var a=n[i];++i,a.name==t&&o.remove(this.allPasses,a)}var s=this.passes;null!=_a[t]?s.setReserved(t,e):s.h[t]=e,this.allPasses.push({name:t,p:e}),this.allPasses.sort(function(t,e){return r.getPassPriority(e)-r.getPassPriority(t)})},depthSort:function(t,e){null==e&&(e=!1);for(var r=t,i=this.ctx.camera.m;null!=r;){var n=r.obj.absPos._41*i._13+r.obj.absPos._42*i._23+r.obj.absPos._43*i._33+i._43,a=r.obj.absPos._41*i._14+r.obj.absPos._42*i._24+r.obj.absPos._43*i._34+i._44;r.depth=n/a,r=r.next}if(e){var s=t;if(null==s)return null;for(var o,h,l,u,R,c=1,_=0,f=0;;){for(h=s,s=null,R=null,o=0;null!=h;){++o,l=h,_=0;for(var g=0,p=c;g<p;){g++;if(++_,l=l.next,null==l)break}for(f=c;_>0||f>0&&null!=l;)0==_?(u=l,l=l.next,--f):0==f||null==l||(h.depth>l.depth?1:-1)<=0?(u=h,h=h.next,--_):(u=l,l=l.next,--f),null!=R?R.next=u:s=u,R=u;h=l}if(R.next=null,o<=1)break;c*=2}return s}var d=t;if(null==d)return null;for(var v,m,y,x,b,w=1,j=0,T=0;;){for(m=d,d=null,b=null,v=0;null!=m;){++v,y=m,j=0;for(var S=0,C=w;S<C;){S++;if(++j,y=y.next,null==y)break}for(T=w;j>0||T>0&&null!=y;)0==j?(x=y,y=y.next,--T):0==T||null==y||(m.depth>y.depth?-1:1)<=0?(x=m,m=m.next,--j):(x=y,y=y.next,--T),null!=b?b.next=x:d=x,b=x;m=y}if(b.next=null,v<=1)break;w*=2}return d},resetTarget:function(){this.hasSetTarget&&(this.ctx.engine.popTarget(),this.hasSetTarget=!1)},renderPass:function(t,e,r){return e.draw(r)},render:function(){for(var t=0,e=this.allPasses;t<e.length;){var r=e[t];++t;var i=r.name,n=this.passGroups,a=null!=_a[i]?n.getReserved(i):n.h[i];if((null==a||!a.rendered)&&(null!=a||r.p.forceProcessing)){r.p.setContext(this.ctx);var s=null==a?null:a.passes;"alpha"==r.name&&(s=this.depthSort(s)),"default"==r.name&&(s=this.depthSort(s,!0)),s=this.renderPass(r.name,r.p,s),null!=a&&(a.passes=s,a.rendered=!0)}}},process:function(t){this.hasSetTarget=!1;for(var e=0;e<t.length;){var r=t[e];++e,this.getPass(r.name).setContext(this.ctx);var i=r.name,n=this.passGroups;null!=_a[i]?n.setReserved(i,r):n.h[i]=r}this.render(),this.resetTarget();for(var a=0;a<t.length;){var s=t[a];++a;var o=s.name,h=this.passGroups;null!=_a[o]?h.setReserved(o,null):h.h[o]=null}},__class__:qr};var Ur=function(){Br.call(this,null),this.stage=Wi.getInstance(),this.eventListeners=[],this.hitInteractives=[],this.interactives=[],this.camera=new Ce;var t=ke.CURRENT;null!=t&&(this.camera.screenRatio=t.width/t.height),this.ctx=new Nr,this.set_renderer(cr.current.createRenderer()),this.lightSystem=cr.current.createLightSystem()};a["h3d.scene.Scene"]=Ur,Ur.__name__=["h3d","scene","Scene"],Ur.__interfaces__=[ve,A],Ur.__super__=Br,Ur.prototype=e(Br.prototype,{setEvents:function(t){this.events=t},dispatchListeners:function(t){for(var e=0,r=this.eventListeners;e<r.length;){var i=r[e];if(++e,i(t),!t.propagate)break}},set_renderer:function(t){return this.renderer=t,null!=t&&(t.ctx=this.ctx),t},sortHitPointByCameraDistance:function(t,e){var r=t.hitPoint.w,i=e.hitPoint.w;return r>i?-1:1},dispatchEvent:function(t,e){var r=e;r.handleEvent(t)},isInteractiveVisible:function(t){for(var e=t;null!=e;){if(0==(2&e.flags))return!1;e=e.parent}return!0},handleEvent:function(t,e){if(0==this.interactives.length)return null;if(0==this.hitInteractives.length){var r,i,a=2*(t.relX/this.stage.get_width()-.5),s=2*-(t.relY/this.stage.get_height()-.5),o=this.camera.unproject(a,s,0),h=this.camera.unproject(a,s,1),l=o.x;i=o.y,r=o.z;var u,R,c=h.x;R=h.y,u=h.z;var _=new Ge;_.px=l,_.py=i,_.pz=r,_.lx=c-l,_.ly=R-i,_.lz=u-r,_.normalize();var f=_,g=new Ge;g.px=f.px,g.py=f.py,g.pz=f.pz,g.lx=f.lx,g.ly=f.ly,g.lz=f.lz;for(var p=g,d=-2147483648,v=0,m=this.interactives;v<m.length;){var y=m[v];if(++v,!(y.priority<d)){for(var x=y;null!=x&&0!=(2&x.flags);)x=x.parent;if(null==x){var b,w,j,T,S=y.getInvPos();j=f.px,w=f.py,b=f.pz,T=1;var C=j*S._11+w*S._21+b*S._31+T*S._41,M=j*S._12+w*S._22+b*S._32+T*S._42,k=j*S._13+w*S._23+b*S._33+T*S._43;j=C,w=M,b=k,f.px=j,f.py=w,f.pz=b;var E,A,I,P;I=f.lx,A=f.ly,E=f.lz,P=1;var D=I*S._11+A*S._21+E*S._31,B=I*S._12+A*S._22+E*S._32,V=I*S._13+A*S._23+E*S._33;if(I=D,A=B,E=V,f.lx=I,f.ly=A,f.lz=E,f.normalize(),f.lx==f.lx){var O=y.shape.rayIntersection(f,y.bestMatch);if(O<0)f.px=p.px,f.py=p.py,f.pz=p.pz,f.lx=p.lx,f.ly=p.ly,f.lz=p.lz;else{var F,L,G=f.px+O*f.lx;if(L=f.py+O*f.ly,F=f.pz+O*f.lz,f.px=p.px,f.py=p.py,f.pz=p.pz,f.lx=p.lx,f.ly=p.ly,f.lz=p.lz,y.hitPoint.x=G,y.hitPoint.y=L,y.hitPoint.z=F,y.priority>d){for(;this.hitInteractives.length>0;)this.hitInteractives.pop();d=y.priority}this.hitInteractives.push(y)}}else f.px=p.px,f.py=p.py,f.pz=p.pz,f.lx=p.lx,f.ly=p.ly,f.lz=p.lz}}}if(0==this.hitInteractives.length)return null;if(this.hitInteractives.length>1){for(var N=0,z=this.hitInteractives;N<z.length;){var q=z[N];++N;var U=q.invPos,Y=0;if(null!=q.preciseShape){var W,H,X,Z;X=f.px,H=f.py,W=f.pz,Z=1;var K=X*U._11+H*U._21+W*U._31+Z*U._41,$=X*U._12+H*U._22+W*U._32+Z*U._42,Q=X*U._13+H*U._23+W*U._33+Z*U._43;X=K,H=$,W=Q,f.px=X,f.py=H,f.pz=W;var J,tt,et,rt;et=f.lx,tt=f.ly,J=f.lz,rt=1;var it=et*U._11+tt*U._21+J*U._31,nt=et*U._12+tt*U._22+J*U._32,at=et*U._13+tt*U._23+J*U._33;et=it,tt=nt,J=at,f.lx=et,f.ly=tt,f.lz=J,f.normalize();var st=q.preciseShape.rayIntersection(f,q.bestMatch);if(st>0){var ot,ht,lt=f.px+st*f.lx;ht=f.py+st*f.ly,ot=f.pz+st*f.lz,q.hitPoint.x=lt,q.hitPoint.y=ht,q.hitPoint.z=ot}else Y=1;f.px=p.px,f.py=p.py,f.pz=p.pz,f.lx=p.lx,f.ly=p.ly,f.lz=p.lz}var ut,Rt,ct,_t,ft=q.hitPoint;ct=ft.x,Rt=ft.y,ut=ft.z,_t=ft.w,_t=1;var gt=q.absPos,pt=ct*gt._11+Rt*gt._21+ut*gt._31+_t*gt._41,dt=ct*gt._12+Rt*gt._22+ut*gt._32+_t*gt._42,vt=ct*gt._13+Rt*gt._23+ut*gt._33+_t*gt._43;ct=pt,Rt=dt,ut=vt;var mt=this.camera.m,yt=ct*mt._11+Rt*mt._21+ut*mt._31+_t*mt._41,xt=ct*mt._12+Rt*mt._22+ut*mt._32+_t*mt._42,bt=ct*mt._13+Rt*mt._23+ut*mt._33+_t*mt._43,wt=1/(ct*mt._14+Rt*mt._24+ut*mt._34+_t*mt._44);ct=yt*wt,Rt=xt*wt,ut=bt*wt,_t=1,q.hitPoint.w=ut+Y}this.hitInteractives.sort(n(this,this.sortHitPointByCameraDistance))}this.hitInteractives.unshift(null)}for(;this.hitInteractives.length>0;){var jt=this.hitInteractives.pop();if(null==jt)return null;if(t.relX=jt.hitPoint.x,t.relY=jt.hitPoint.y,t.relZ=jt.hitPoint.z,jt.handleEvent(t),!t.cancel)return t.propagate||(this.hitInteractives=[]),jt;t.cancel=!1,t.propagate=!1}return null},addEventTarget:function(t){this.interactives.push(t)},removeEventTarget:function(t){o.remove(this.interactives,t)&&null!=this.events&&this.events.onRemove(t)},setElapsedTime:function(t){this.ctx.elapsedTime=t},render:function(t){0==(32&this.flags)&&this.onAdd();var e=t.getCurrentTarget();null==e?this.camera.screenRatio=t.width/t.height:this.camera.screenRatio=e.width/e.height,this.camera.update(),this.ctx.camera=this.camera,this.ctx.engine=t,this.ctx.scene=this,this.ctx.start(),this.syncRec(this.ctx),this.emitRec(this.ctx);var r,i=this.ctx.passes;if(null==i)r=null;else{for(var n,a,s,o,h,l=1,u=0,R=0;;){for(a=i,i=null,h=null,n=0;null!=a;){++n,s=a,u=0;for(var c=0,_=l;c<_;){c++;if(++u,s=s.next,null==s)break}for(R=l;u>0||R>0&&null!=s;)0==u?(o=s,s=s.next,--R):0==R||null==s||a.pass.passId-s.pass.passId<=0?(o=a,a=a.next,--u):(o=s,s=s.next,--R),null!=h?h.next=o:i=o,h=o;a=s}if(h.next=null,n<=1)break;l*=2}r=i}this.ctx.passes=r;for(var f=this.ctx.passes,g=[];null!=f;){for(var p=f.pass.passId,d=f,v=null;null!=d&&d.pass.passId==p;)v=d,d=d.next;v.next=null,g.push(new zr(f.pass.name,f)),f=d}this.ctx.lightSystem=this.lightSystem,this.lightSystem.initLights(this.ctx),this.renderer.process(g),this.ctx.done(),this.ctx.scene=null,this.ctx.camera=null,this.ctx.engine=null},__class__:Ur});var Yr=function(){yr.call(this)};a["h3d.shader.AmbientLight"]=Yr,Yr.__name__=["h3d","shader","AmbientLight"],Yr.__super__=yr,Yr.prototype=e(yr.prototype,{updateConstants:function(t){this.constBits=0,this.additive__&&(this.constBits|=2),this.updateConstantsFinal(t)},getParamValue:function(t){return 0==t?this.additive__:null},getParamFloatValue:function(t){return 0},__class__:Yr});var Wr=function(){this.viewport__=new Pe,this.halfPixelInverse__=new Pe,this.uvPos__=new Pe,this.filterMatrixB__=new Pe,this.filterMatrixA__=new Pe,this.absoluteMatrixB__=new Pe,this.absoluteMatrixA__=new Pe,this.color__=new Pe,this.zValue__=0,yr.call(this)};a["h3d.shader.Base2d"]=Wr,Wr.__name__=["h3d","shader","Base2d"],Wr.__super__=yr,Wr.prototype=e(yr.prototype,{updateConstants:function(t){this.constBits=0,this.isRelative__&&(this.constBits|=1),this.hasUVPos__&&(this.constBits|=2),this.killAlpha__&&(this.constBits|=4),this.pixelAlign__&&(this.constBits|=8),this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.zValue__;case 1:return this.texture__;case 2:return this.isRelative__;case 3:return this.color__;case 4:return this.absoluteMatrixA__;case 5:return this.absoluteMatrixB__;case 6:return this.filterMatrixA__;case 7:return this.filterMatrixB__;case 8:return this.hasUVPos__;case 9:return this.uvPos__;case 10:return this.killAlpha__;case 11:return this.pixelAlign__;case 12:return this.halfPixelInverse__;case 13:return this.viewport__}return null},getParamFloatValue:function(t){return 0==t?this.zValue__:0},__class__:Wr});var Hr=function(){this.specularColor__=new Pe,this.specularAmount__=0,this.specularPower__=0,this.color__=new Pe,yr.call(this);var t=this.color__;t.x=1,t.y=1,t.z=1,t.w=1;var e=this.specularColor__;e.x=1,e.y=1,e.z=1,e.w=1,this.specularPower__=50,this.specularAmount__=1};a["h3d.shader.BaseMesh"]=Hr,Hr.__name__=["h3d","shader","BaseMesh"],Hr.__super__=yr,Hr.prototype=e(yr.prototype,{updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.color__;case 1:return this.specularPower__;case 2:return this.specularAmount__;case 3:return this.specularColor__}return null},getParamFloatValue:function(t){switch(t){case 1:return this.specularPower__;case 2:return this.specularAmount__}return 0},__class__:Hr});var Xr=function(){this.fixedColor__=new Pe,this.pixel__=new Pe,this.values__=[],this.Quality__=0,this.cameraInverseViewProj__=new Ae,wr.call(this)};a["h3d.shader.Blur"]=Xr,Xr.__name__=["h3d","shader","Blur"],Xr.__super__=wr,Xr.prototype=e(wr.prototype,{updateConstants:function(t){this.constBits=0;var e=this.Quality__;if(e>>>8!=0)throw new Zn("Quality is out of range "+e+">255");this.constBits|=e,this.isDepth__&&(this.constBits|=256),this.hasFixedColor__&&(this.constBits|=512),this.smoothFixedColor__&&(this.constBits|=1024),this.isDepthDependant__&&(this.constBits|=2048),this.hasNormal__&&(this.constBits|=4096),this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.cameraInverseViewProj__;case 1:return this.texture__;case 2:return this.depthTexture__;case 3:return this.Quality__;case 4:return this.isDepth__;case 5:return this.values__;case 6:return this.pixel__;case 7:return this.hasFixedColor__;case 8:return this.smoothFixedColor__;case 9:return this.fixedColor__;case 10:return this.isDepthDependant__;case 11:return this.hasNormal__;case 12:return this.normalTexture__}return null},getParamFloatValue:function(t){return 0},__class__:Xr});var Zr=function(t){this.globals=new ga(t.globalsSize<<2),this.params=new ga(t.paramsSize<<2);var e=t.textures2DCount+t.texturesCubeCount,r=new Array(e);this.tex=r};a["h3d.shader.ShaderBuffers"]=Zr,Zr.__name__=["h3d","shader","ShaderBuffers"],Zr.prototype={grow:function(t){var e=t.globalsSize<<2,r=t.paramsSize<<2,i=t.textures2DCount+t.texturesCubeCount;if(this.globals.length<e&&(this.globals=new ga(e)),this.params.length<r&&(this.params=new ga(r)),this.tex.length<i){var n=new Array(i);this.tex=n}},__class__:Zr};var Kr=function(t){this.vertex=new Zr(t.vertex),this.fragment=new Zr(t.fragment)};a["h3d.shader.Buffers"]=Kr,Kr.__name__=["h3d","shader","Buffers"],Kr.prototype={__class__:Kr};var $r=function(t){null==t&&(t=0),this.color__=new Pe,yr.call(this);var e=this.color__;e.x=(t>>16&255)/255,e.y=(t>>8&255)/255,e.z=(255&t)/255,e.w=(t>>>24)/255};a["h3d.shader.ColorAdd"]=$r,$r.__name__=["h3d","shader","ColorAdd"],$r.__super__=yr,$r.prototype=e(yr.prototype,{updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){return 0==t?this.color__:null},getParamFloatValue:function(t){return 0},__class__:$r});var Qr=function(t){null==t&&(t=0),this.colorKey__=new Pe,yr.call(this);var e=this.colorKey__;e.x=(t>>16&255)/255,e.y=(t>>8&255)/255,e.z=(255&t)/255,e.w=(t>>>24)/255};a["h3d.shader.ColorKey"]=Qr,Qr.__name__=["h3d","shader","ColorKey"],Qr.__super__=yr,Qr.prototype=e(yr.prototype,{updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){return 0==t?this.colorKey__:null},getParamFloatValue:function(t){return 0},__class__:Qr});var Jr=function(t){this.matrix__=new Ae,yr.call(this),null!=t?this.matrix__.load(t):this.matrix__.identity()};a["h3d.shader.ColorMatrix"]=Jr,Jr.__name__=["h3d","shader","ColorMatrix"],Jr.__super__=yr,Jr.prototype=e(yr.prototype,{updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){return 0==t?this.matrix__:null},getParamFloatValue:function(t){return 0},__class__:Jr});var ti=function(){this.direction__=new Pe,this.color__=new Pe,yr.call(this);var t=this.color__;t.x=1,t.y=1,t.z=1,t.w=1};a["h3d.shader.DirLight"]=ti,ti.__name__=["h3d","shader","DirLight"],ti.__super__=yr,ti.prototype=e(yr.prototype,{updateConstants:function(t){this.constBits=0,this.enableSpecular__&&(this.constBits|=1),this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.color__;case 1:return this.direction__;case 2:return this.enableSpecular__}return null},getParamFloatValue:function(t){return 0},__class__:ti});var ei=function(t,e){null==e&&(e=1),null==t&&(t=1.5),this.width__=0,this.lengthScale__=0,yr.call(this),this.width__=t,this.lengthScale__=e};a["h3d.shader.LineShader"]=ei,ei.__name__=["h3d","shader","LineShader"],ei.__super__=yr,ei.prototype=e(yr.prototype,{updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.lengthScale__;case 1:return this.width__}return null},getParamFloatValue:function(t){switch(t){case 0:return this.lengthScale__;case 1:return this.width__}return 0},__class__:ei});var ri=function(){yr.call(this)};a["h3d.shader.Shadow"]=ri,ri.__name__=["h3d","shader","Shadow"],ri.__super__=yr,ri.prototype=e(yr.prototype,{updateConstants:function(t){this.constBits=0,this.perPixel__&&(this.constBits|=64),this.updateConstantsFinal(t)},getParamValue:function(t){return 0==t?this.perPixel__:null},getParamFloatValue:function(t){return 0},__class__:ri});var ii=function(){this.bonesMatrixes__=[],this.MaxBones__=0,yr.call(this),this.constModified=!0,this.MaxBones__=34};a["h3d.shader.Skin"]=ii,ii.__name__=["h3d","shader","Skin"],ii.__super__=yr,ii.prototype=e(yr.prototype,{updateConstants:function(t){this.constBits=0;var e=this.MaxBones__;if(e>>>8!=0)throw new Zn("MaxBones is out of range "+e+">255");this.constBits|=e,this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.MaxBones__;case 1:return this.bonesMatrixes__}return null},getParamFloatValue:function(t){return 0},__class__:ii});var ni=function(t){yr.call(this),this.texture__=t};a["h3d.shader.SpecularTexture"]=ni,ni.__name__=["h3d","shader","SpecularTexture"],ni.__super__=yr,ni.prototype=e(yr.prototype,{updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){return 0==t?this.texture__:null},getParamFloatValue:function(t){return 0},__class__:ni});var ai=function(t){this.killAlphaThreshold__=0,yr.call(this),this.texture__=t,this.killAlphaThreshold__=hr.defaultKillAlphaThreshold};a["h3d.shader.Texture"]=ai,ai.__name__=["h3d","shader","Texture"],ai.__super__=yr,ai.prototype=e(yr.prototype,{updateConstants:function(t){this.constBits=0,this.additive__&&(this.constBits|=1),this.killAlpha__&&(this.constBits|=2),this.specularAlpha__&&(this.constBits|=4),this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.additive__;case 1:return this.killAlpha__;case 2:return this.specularAlpha__;case 3:return this.killAlphaThreshold__;case 4:return this.texture__}return null},getParamFloatValue:function(t){return 3==t?this.killAlphaThreshold__:0},__class__:ai});var si=function(t,e,r,i){null==i&&(i=1),null==r&&(r=1),null==e&&(e=0),null==t&&(t=0),this.uvScale__=new Pe,this.uvDelta__=new Pe,yr.call(this);var n=this.uvDelta__;n.x=t,n.y=e,n.z=0,n.w=1;var a=this.uvScale__;a.x=r,a.y=i,a.z=0,a.w=1};a["h3d.shader.UVDelta"]=si,si.__name__=["h3d","shader","UVDelta"],si.__super__=yr,si.prototype=e(yr.prototype,{updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.uvDelta__;case 1:return this.uvScale__}return null},getParamFloatValue:function(t){return 0},__class__:si});var oi=function(){yr.call(this)};a["h3d.shader.VertexColorAlpha"]=oi,oi.__name__=["h3d","shader","VertexColorAlpha"],oi.__super__=yr,oi.prototype=e(yr.prototype,{updateConstants:function(t){this.constBits=0,this.additive__&&(this.constBits|=1),this.updateConstantsFinal(t)},getParamValue:function(t){return 0==t?this.additive__:null},getParamFloatValue:function(t){return 0},__class__:oi});var hi=function(t,e){this.normal__=new Pe,this.scale__=new Pe,yr.call(this);var r=this.normal__;r.x=0,r.y=0,r.z=1,r.w=1;var i=this.scale__;i.x=1/t,i.y=1/e,i.z=0,i.w=1};a["h3d.shader.VolumeDecal"]=hi,hi.__name__=["h3d","shader","VolumeDecal"],hi.__super__=yr,hi.prototype=e(yr.prototype,{updateConstants:function(t){this.constBits=0,this.updateConstantsFinal(t)},getParamValue:function(t){switch(t){case 0:return this.scale__;case 1:return this.normal__}return null},getParamFloatValue:function(t){return 0},__class__:hi});var li=function(){};a["haxe.IMap"]=li,li.__name__=["haxe","IMap"],li.prototype={__class__:li
};var ui=function(){};a["haxe.EntryPoint"]=ui,ui.__name__=["haxe","EntryPoint"],ui.processEvents=function(){for(;;){var t=ui.pending.shift();if(null==t)break;t()}return null==_i.pending&&0==ui.threadCount?-1:_i.tick()},ui.run=function(){var t=(ui.processEvents(),window),e=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame;e(ui.run)};var Ri=function(){};a["haxe.Log"]=Ri,Ri.__name__=["haxe","Log"],Ri.trace=function(t,e){En.__trace(t,e)};var ci=function(t,e){this.f=t,this.priority=e,this.nextRun=-1};a["haxe.MainEvent"]=ci,ci.__name__=["haxe","MainEvent"],ci.prototype={__class__:ci};var _i=function(){};a["haxe.MainLoop"]=_i,_i.__name__=["haxe","MainLoop"],_i.sortEvents=function(){var t=_i.pending;if(null!=t){for(var e,r,i,n,a,s=1,o=0,h=0;;){for(r=t,t=null,a=null,e=0;null!=r;){++e,i=r,o=0;for(var l=0,u=s;l<u;){l++;if(++o,i=i.next,null==i)break}for(h=s;o>0||h>0&&null!=i;)0==o?(n=i,i=i.next,--h):0==h||null==i||r.priority>i.priority||r.priority==i.priority&&r.nextRun<=i.nextRun?(n=r,r=r.next,--o):(n=i,i=i.next,--h),null!=a?a.next=n:t=n,n.prev=a,a=n;r=i}if(a.next=null,e<=1)break;s*=2}t.prev=null,_i.pending=t}},_i.tick=function(){_i.sortEvents();for(var t=_i.pending,e=(new Date).getTime()/1e3,r=1e9;null!=t;){var i=t.next,n=t.nextRun-e;t.nextRun<0||n<=0?(r=0,null!=t.f&&t.f()):r>n&&(r=n),t=i}return r};var fi=function(t){var e=this;this.id=setInterval(function(){e.run()},t)};a["haxe.Timer"]=fi,fi.__name__=["haxe","Timer"],fi.delay=function(t,e){var r=new fi(e);return r.run=function(){r.stop(),t()},r},fi.prototype={stop:function(){null!=this.id&&(clearInterval(this.id),this.id=null)},run:function(){},__class__:fi};var gi=function(){};a["haxe._Unserializer.DefaultResolver"]=gi,gi.__name__=["haxe","_Unserializer","DefaultResolver"],gi.prototype={resolveClass:function(t){return v.resolveClass(t)},resolveEnum:function(t){return v.resolveEnum(t)},__class__:gi};var pi=function(t){this.buf=t,this.length=t.length,this.pos=0,this.scache=[],this.cache=[];var e=pi.DEFAULT_RESOLVER;null==e&&(e=new gi,pi.DEFAULT_RESOLVER=e),this.resolver=e};a["haxe.Unserializer"]=pi,pi.__name__=["haxe","Unserializer"],pi.initCodes=function(){for(var t=[],e=0,r=pi.BASE64.length;e<r;){var i=e++;t[pi.BASE64.charCodeAt(i)]=i}return t},pi.run=function(t){return new pi(t).unserialize()},pi.prototype={readDigits:function(){for(var t=0,e=!1,r=this.pos;;){var i=this.buf.charCodeAt(this.pos);if(i!=i)break;if(45!=i){if(i<48||i>57)break;t=10*t+(i-48),this.pos++}else{if(this.pos!=r)break;e=!0,this.pos++}}return e&&(t*=-1),t},readFloat:function(){for(var t=this.pos;;){var e=this.buf.charCodeAt(this.pos);if(e!=e)break;if(!(e>=43&&e<58||101==e||69==e))break;this.pos++}return parseFloat(o.substr(this.buf,t,this.pos-t))},unserializeObject:function(t){for(;;){if(this.pos>=this.length)throw new Zn("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var e=this.unserialize();if("string"!=typeof e)throw new Zn("Invalid object key");var r=this.unserialize();t[e]=r}this.pos++},unserializeEnum:function(t,e){if(58!=this.buf.charCodeAt(this.pos++))throw new Zn("Invalid enum format");var r=this.readDigits();if(0==r)return v.createEnum(t,e);for(var i=[];r-- >0;)i.push(this.unserialize());return v.createEnum(t,e,i)},unserialize:function(){var t=this.buf.charCodeAt(this.pos++);switch(t){case 65:var e=this.unserialize(),r=this.resolver.resolveClass(e);if(null==r)throw new Zn("Class not found "+e);return r;case 66:var i=this.unserialize(),n=this.resolver.resolveEnum(i);if(null==n)throw new Zn("Enum not found "+i);return n;case 67:var a=this.unserialize(),s=this.resolver.resolveClass(a);if(null==s)throw new Zn("Class not found "+a);var h=v.createEmptyInstance(s);if(this.cache.push(h),h.hxUnserialize(this),103!=this.buf.charCodeAt(this.pos++))throw new Zn("Invalid custom data");return h;case 77:var u=new wi;this.cache.push(u);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var R=this.unserialize();u.set(R,this.unserialize())}return this.pos++,u;case 82:var c=this.readDigits();if(c<0||c>=this.scache.length)throw new Zn("Invalid string reference");return this.scache[c];case 97:var _=(this.buf,[]);for(this.cache.push(_);;){var f=this.buf.charCodeAt(this.pos);if(104==f){this.pos++;break}if(117==f){this.pos++;var g=this.readDigits();_[_.length+g-1]=null}else _.push(this.unserialize())}return _;case 98:var p=new Ti;this.cache.push(p);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var d=this.unserialize(),m=this.unserialize();null!=_a[d]?p.setReserved(d,m):p.h[d]=m}return this.pos++,p;case 99:var y=this.unserialize(),x=this.resolver.resolveClass(y);if(null==x)throw new Zn("Class not found "+y);var b=v.createEmptyInstance(x);return this.cache.push(b),this.unserializeObject(b),b;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:var w=this.unserialize(),j=this.resolver.resolveEnum(w);if(null==j)throw new Zn("Enum not found "+w);this.pos++;var T=this.readDigits(),S=j.__constructs__.slice()[T];if(null==S)throw new Zn("Unknown enum index "+w+"@"+T);var C=this.unserializeEnum(j,S);return this.cache.push(C),C;case 107:return NaN;case 108:var M=new l;this.cache.push(M);for(this.buf;104!=this.buf.charCodeAt(this.pos);)M.add(this.unserialize());return this.pos++,M;case 109:return-(1/0);case 110:return null;case 111:var k={};return this.cache.push(k),this.unserializeObject(k),k;case 112:return 1/0;case 113:var E=new bi;this.cache.push(E);for(var A=(this.buf,this.buf.charCodeAt(this.pos++));58==A;){var I=this.readDigits(),P=this.unserialize();E.h[I]=P,A=this.buf.charCodeAt(this.pos++)}if(104!=A)throw new Zn("Invalid IntMap format");return E;case 114:var D=this.readDigits();if(D<0||D>=this.cache.length)throw new Zn("Invalid reference");return this.cache[D];case 115:var B=this.readDigits(),V=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<B)throw new Zn("Invalid bytes length");var O=pi.CODES;null==O&&(O=pi.initCodes(),pi.CODES=O);for(var F=this.pos,L=3&B,G=3*(B>>2)+(L>=2?L-1:0),N=F+(B-L),z=new Si(new fa(G)),q=0;F<N;){var U=O[V.charCodeAt(F++)],Y=O[V.charCodeAt(F++)];z.b[q++]=255&(U<<2|Y>>4);var W=O[V.charCodeAt(F++)];z.b[q++]=255&(Y<<4|W>>2);var H=O[V.charCodeAt(F++)];z.b[q++]=255&(W<<6|H)}if(L>=2){var X=O[V.charCodeAt(F++)],Z=O[V.charCodeAt(F++)];if(z.b[q++]=255&(X<<2|Z>>4),3==L){var K=O[V.charCodeAt(F++)];z.b[q++]=255&(Z<<4|K>>2)}}return this.pos+=B,this.cache.push(z),z;case 116:return!0;case 118:var $;if(this.buf.charCodeAt(this.pos)>=48&&this.buf.charCodeAt(this.pos)<=57&&this.buf.charCodeAt(this.pos+1)>=48&&this.buf.charCodeAt(this.pos+1)<=57&&this.buf.charCodeAt(this.pos+2)>=48&&this.buf.charCodeAt(this.pos+2)<=57&&this.buf.charCodeAt(this.pos+3)>=48&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4))$=o.strDate(o.substr(this.buf,this.pos,19)),this.pos+=19;else{var Q=this.readFloat();$=new Date(Q)}return this.cache.push($),$;case 119:var J=this.unserialize(),tt=this.resolver.resolveEnum(J);if(null==tt)throw new Zn("Enum not found "+J);var et=this.unserializeEnum(tt,this.unserialize());return this.cache.push(et),et;case 120:throw Zn.wrap(this.unserialize());case 121:var rt=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<rt)throw new Zn("Invalid string length");var it=o.substr(this.buf,this.pos,rt);return this.pos+=rt,it=decodeURIComponent(it.split("+").join(" ")),this.scache.push(it),it;case 122:return 0}throw this.pos--,new Zn("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:pi};var di=function(){};a["haxe.crypto.Md5"]=di,di.__name__=["haxe","crypto","Md5"],di.encode=function(t){var e=new di,r=e.doEncode(di.str2blks(t));return e.hex(r)},di.str2blks=function(t){for(var e=Si.ofString(t),r=(e.length+8>>6)+1,i=[],n=16*r,a=0,s=n;a<s;){var o=a++;i[o]=0}for(var h=0,l=e.length,u=8*l;h<l;)i[h>>2]|=e.b[h]<<(u+h)%4*8,++h;i[h>>2]|=128<<(u+h)%4*8;var R=16*r-2;return i[R]=255&u,i[R]|=(u>>>8&255)<<8,i[R]|=(u>>>16&255)<<16,i[R]|=(u>>>24&255)<<24,i},di.prototype={bitOR:function(t,e){var r=1&t|1&e,i=t>>>1|e>>>1;return i<<1|r},bitXOR:function(t,e){var r=1&t^1&e,i=t>>>1^e>>>1;return i<<1|r},bitAND:function(t,e){var r=1&t&(1&e),i=t>>>1&e>>>1;return i<<1|r},addme:function(t,e){var r=(65535&t)+(65535&e),i=(t>>16)+(e>>16)+(r>>16);return i<<16|65535&r},hex:function(t){for(var e="",r="0123456789abcdef",i=0;i<t.length;){var n=t[i];++i;for(var a=0;a<4;){var s=a++;e+=r.charAt(n>>8*s+4&15)+r.charAt(n>>8*s&15)}}return e},rol:function(t,e){return t<<e|t>>>32-e},cmn:function(t,e,r,i,n,a){return this.addme(this.rol(this.addme(this.addme(e,t),this.addme(i,a)),n),r)},ff:function(t,e,r,i,n,a,s){return this.cmn(this.bitOR(this.bitAND(e,r),this.bitAND(~e,i)),t,e,n,a,s)},gg:function(t,e,r,i,n,a,s){return this.cmn(this.bitOR(this.bitAND(e,i),this.bitAND(r,~i)),t,e,n,a,s)},hh:function(t,e,r,i,n,a,s){return this.cmn(this.bitXOR(this.bitXOR(e,r),i),t,e,n,a,s)},ii:function(t,e,r,i,n,a,s){return this.cmn(this.bitXOR(r,this.bitOR(e,~i)),t,e,n,a,s)},doEncode:function(t){for(var e,r=1732584193,i=-271733879,n=-1732584194,a=271733878,s=0;s<t.length;){var o=r,h=i,l=n,u=a;e=0,r=this.ff(r,i,n,a,t[s],7,-680876936),a=this.ff(a,r,i,n,t[s+1],12,-389564586),n=this.ff(n,a,r,i,t[s+2],17,606105819),i=this.ff(i,n,a,r,t[s+3],22,-1044525330),r=this.ff(r,i,n,a,t[s+4],7,-176418897),a=this.ff(a,r,i,n,t[s+5],12,1200080426),n=this.ff(n,a,r,i,t[s+6],17,-1473231341),i=this.ff(i,n,a,r,t[s+7],22,-45705983),r=this.ff(r,i,n,a,t[s+8],7,1770035416),a=this.ff(a,r,i,n,t[s+9],12,-1958414417),n=this.ff(n,a,r,i,t[s+10],17,-42063),i=this.ff(i,n,a,r,t[s+11],22,-1990404162),r=this.ff(r,i,n,a,t[s+12],7,1804603682),a=this.ff(a,r,i,n,t[s+13],12,-40341101),n=this.ff(n,a,r,i,t[s+14],17,-1502002290),i=this.ff(i,n,a,r,t[s+15],22,1236535329),r=this.gg(r,i,n,a,t[s+1],5,-165796510),a=this.gg(a,r,i,n,t[s+6],9,-1069501632),n=this.gg(n,a,r,i,t[s+11],14,643717713),i=this.gg(i,n,a,r,t[s],20,-373897302),r=this.gg(r,i,n,a,t[s+5],5,-701558691),a=this.gg(a,r,i,n,t[s+10],9,38016083),n=this.gg(n,a,r,i,t[s+15],14,-660478335),i=this.gg(i,n,a,r,t[s+4],20,-405537848),r=this.gg(r,i,n,a,t[s+9],5,568446438),a=this.gg(a,r,i,n,t[s+14],9,-1019803690),n=this.gg(n,a,r,i,t[s+3],14,-187363961),i=this.gg(i,n,a,r,t[s+8],20,1163531501),r=this.gg(r,i,n,a,t[s+13],5,-1444681467),a=this.gg(a,r,i,n,t[s+2],9,-51403784),n=this.gg(n,a,r,i,t[s+7],14,1735328473),i=this.gg(i,n,a,r,t[s+12],20,-1926607734),r=this.hh(r,i,n,a,t[s+5],4,-378558),a=this.hh(a,r,i,n,t[s+8],11,-2022574463),n=this.hh(n,a,r,i,t[s+11],16,1839030562),i=this.hh(i,n,a,r,t[s+14],23,-35309556),r=this.hh(r,i,n,a,t[s+1],4,-1530992060),a=this.hh(a,r,i,n,t[s+4],11,1272893353),n=this.hh(n,a,r,i,t[s+7],16,-155497632),i=this.hh(i,n,a,r,t[s+10],23,-1094730640),r=this.hh(r,i,n,a,t[s+13],4,681279174),a=this.hh(a,r,i,n,t[s],11,-358537222),n=this.hh(n,a,r,i,t[s+3],16,-722521979),i=this.hh(i,n,a,r,t[s+6],23,76029189),r=this.hh(r,i,n,a,t[s+9],4,-640364487),a=this.hh(a,r,i,n,t[s+12],11,-421815835),n=this.hh(n,a,r,i,t[s+15],16,530742520),i=this.hh(i,n,a,r,t[s+2],23,-995338651),r=this.ii(r,i,n,a,t[s],6,-198630844),a=this.ii(a,r,i,n,t[s+7],10,1126891415),n=this.ii(n,a,r,i,t[s+14],15,-1416354905),i=this.ii(i,n,a,r,t[s+5],21,-57434055),r=this.ii(r,i,n,a,t[s+12],6,1700485571),a=this.ii(a,r,i,n,t[s+3],10,-1894986606),n=this.ii(n,a,r,i,t[s+10],15,-1051523),i=this.ii(i,n,a,r,t[s+1],21,-2054922799),r=this.ii(r,i,n,a,t[s+8],6,1873313359),a=this.ii(a,r,i,n,t[s+15],10,-30611744),n=this.ii(n,a,r,i,t[s+6],15,-1560198380),i=this.ii(i,n,a,r,t[s+13],21,1309151649),r=this.ii(r,i,n,a,t[s+4],6,-145523070),a=this.ii(a,r,i,n,t[s+11],10,-1120210379),n=this.ii(n,a,r,i,t[s+2],15,718787259),i=this.ii(i,n,a,r,t[s+9],21,-343485551),r=this.addme(r,o),i=this.addme(i,h),n=this.addme(n,l),a=this.addme(a,u),s+=16}return[r,i,n,a]},__class__:di};var vi=function(){};a["haxe.ds.ArraySort"]=vi,vi.__name__=["haxe","ds","ArraySort"],vi.sort=function(t,e){vi.rec(t,e,0,t.length)},vi.rec=function(t,e,r,i){var n=r+i>>1;if(i-r<12){if(i<=r)return;for(var a=r+1,s=i;a<s;)for(var o=a++,h=o;h>r&&e(t[h],t[h-1])<0;)vi.swap(t,h-1,h),--h}else vi.rec(t,e,r,n),vi.rec(t,e,n,i),vi.doMerge(t,e,r,n,i,n-r,i-n)},vi.doMerge=function(t,e,r,i,n,a,s){var o,h,l,u,R;if(0!=a&&0!=s){if(a+s==2)return void(e(t[i],t[r])<0&&vi.swap(t,i,r));a>s?(l=a>>1,o=r+l,h=vi.lower(t,e,i,n,o),u=h-i):(u=s>>1,h=i+u,o=vi.upper(t,e,r,i,h),l=o-r),vi.rotate(t,e,o,i,h),R=o+u,vi.doMerge(t,e,r,o,R,l,u),vi.doMerge(t,e,R,h,n,a-l,s-u)}},vi.rotate=function(t,e,r,i,n){var a;if(r!=i&&i!=n)for(a=vi.gcd(n-r,i-r);0!=a--;){for(var s=t[r+a],o=i-r,h=r+a,l=r+a+o;l!=r+a;)t[h]=t[l],h=l,n-l>o?l+=o:l=r+(o-(n-l));t[h]=s}},vi.gcd=function(t,e){for(;0!=e;){var r=t%e;t=e,e=r}return t},vi.upper=function(t,e,r,i,n){for(var a,s,o=i-r;o>0;)a=o>>1,s=r+a,e(t[n],t[s])<0?o=a:(r=s+1,o=o-a-1);return r},vi.lower=function(t,e,r,i,n){for(var a,s,o=i-r;o>0;)a=o>>1,s=r+a,e(t[s],t[n])<0?(r=s+1,o=o-a-1):o=a;return r},vi.swap=function(t,e,r){var i=t[e];t[e]=t[r],t[r]=i};var mi=function(){};a["haxe.ds.BalancedTree"]=mi,mi.__name__=["haxe","ds","BalancedTree"],mi.prototype={set:function(t,e){this.root=this.setLoop(t,e,this.root)},get:function(t){for(var e=this.root;null!=e;){var r=this.compare(t,e.key);if(0==r)return e.value;e=r<0?e.left:e.right}return null},remove:function(t){try{return this.root=this.removeLoop(t,this.root),!0}catch(t){if(t instanceof Zn&&(t=t.val),En.__instanceof(t,String))return!1;throw t}},exists:function(t){for(var e=this.root;null!=e;){var r=this.compare(t,e.key);if(0==r)return!0;e=r<0?e.left:e.right}return!1},iterator:function(){var t=[];return this.iteratorLoop(this.root,t),o.iter(t)},setLoop:function(t,e,r){if(null==r)return new yi(null,t,e,null);var i=this.compare(t,r.key);if(0==i)return new yi(r.left,t,e,r.right,null==r?0:r._height);if(i<0){var n=this.setLoop(t,e,r.left);return this.balance(n,r.key,r.value,r.right)}var a=this.setLoop(t,e,r.right);return this.balance(r.left,r.key,r.value,a)},removeLoop:function(t,e){if(null==e)throw new Zn("Not_found");var r=this.compare(t,e.key);return 0==r?this.merge(e.left,e.right):r<0?this.balance(this.removeLoop(t,e.left),e.key,e.value,e.right):this.balance(e.left,e.key,e.value,this.removeLoop(t,e.right))},iteratorLoop:function(t,e){null!=t&&(this.iteratorLoop(t.left,e),e.push(t.value),this.iteratorLoop(t.right,e))},merge:function(t,e){if(null==t)return e;if(null==e)return t;var r=this.minBinding(e);return this.balance(t,r.key,r.value,this.removeMinBinding(e))},minBinding:function(t){if(null==t)throw new Zn("Not_found");return null==t.left?t:this.minBinding(t.left)},removeMinBinding:function(t){return null==t.left?t.right:this.balance(this.removeMinBinding(t.left),t.key,t.value,t.right)},balance:function(t,e,r,i){var n=null==t?0:t._height,a=null==i?0:i._height;if(n>a+2){var s=t.left,o=t.right;return(null==s?0:s._height)>=(null==o?0:o._height)?new yi(t.left,t.key,t.value,new yi(t.right,e,r,i)):new yi(new yi(t.left,t.key,t.value,t.right.left),t.right.key,t.right.value,new yi(t.right.right,e,r,i))}if(a>n+2){var h=i.right,l=i.left;return(null==h?0:h._height)>(null==l?0:l._height)?new yi(new yi(t,e,r,i.left),i.key,i.value,i.right):new yi(new yi(t,e,r,i.left.left),i.left.key,i.left.value,new yi(i.left.right,i.key,i.value,i.right))}return new yi(t,e,r,i,(n>a?n:a)+1)},compare:function(t,e){return f.compare(t,e)},__class__:mi};var yi=function(t,e,r,i,n){if(null==n&&(n=-1),this.left=t,this.key=e,this.value=r,this.right=i,n==-1){var a,s=this.left,o=this.right;if((null==s?0:s._height)>(null==o?0:o._height)){var h=this.left;a=null==h?0:h._height}else{var l=this.right;a=null==l?0:l._height}this._height=a+1}else this._height=n};a["haxe.ds.TreeNode"]=yi,yi.__name__=["haxe","ds","TreeNode"],yi.prototype={__class__:yi};var xi=function(){mi.call(this)};a["haxe.ds.EnumValueMap"]=xi,xi.__name__=["haxe","ds","EnumValueMap"],xi.__interfaces__=[li],xi.__super__=mi,xi.prototype=e(mi.prototype,{compare:function(t,e){var r=t[1]-e[1];if(0!=r)return r;var i=t.slice(2),n=e.slice(2);return 0==i.length&&0==n.length?0:this.compareArgs(i,n)},compareArgs:function(t,e){var r=t.length-e.length;if(0!=r)return r;for(var i=0,n=t.length;i<n;){var a=i++,s=this.compareArg(t[a],e[a]);if(0!=s)return s}return 0},compareArg:function(t,e){return f.isEnumValue(t)&&f.isEnumValue(e)?this.compare(t,e):t instanceof Array&&null==t.__enum__&&e instanceof Array&&null==e.__enum__?this.compareArgs(t,e):f.compare(t,e)},__class__:xi});var bi=function(){this.h={}};a["haxe.ds.IntMap"]=bi,bi.__name__=["haxe","ds","IntMap"],bi.__interfaces__=[li],bi.prototype={set:function(t,e){this.h[t]=e},get:function(t){return this.h[t]},exists:function(t){return this.h.hasOwnProperty(t)},remove:function(t){return!!this.h.hasOwnProperty(t)&&(delete this.h[t],!0)},keys:function(){var t=[];for(var e in this.h)this.h.hasOwnProperty(e)&&t.push(0|e);return o.iter(t)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var t=this.it.next();return this.ref[t]}}},__class__:bi};var wi=function(){this.h={__keys__:{}}};a["haxe.ds.ObjectMap"]=wi,wi.__name__=["haxe","ds","ObjectMap"],wi.__interfaces__=[li],wi.prototype={set:function(t,e){var r=t.__id__||(t.__id__=++wi.count);this.h[r]=e,this.h.__keys__[r]=t},get:function(t){return this.h[t.__id__]},exists:function(t){return null!=this.h.__keys__[t.__id__]},remove:function(t){var e=t.__id__;return null!=this.h.__keys__[e]&&(delete this.h[e],delete this.h.__keys__[e],!0)},keys:function(){var t=[];for(var e in this.h.__keys__)this.h.hasOwnProperty(e)&&t.push(this.h.__keys__[e]);return o.iter(t)},__class__:wi};var ji=function(t,e){this.map=t,this.keys=e,this.index=0,this.count=e.length};a["haxe.ds._StringMap.StringMapIterator"]=ji,ji.__name__=["haxe","ds","_StringMap","StringMapIterator"],ji.prototype={hasNext:function(){return this.index<this.count},next:function(){var t=this.map,e=this.keys[this.index++];return null!=_a[e]?t.getReserved(e):t.h[e]},__class__:ji};var Ti=function(){this.h={}};a["haxe.ds.StringMap"]=Ti,Ti.__name__=["haxe","ds","StringMap"],Ti.__interfaces__=[li],Ti.prototype={set:function(t,e){null!=_a[t]?this.setReserved(t,e):this.h[t]=e},get:function(t){return null!=_a[t]?this.getReserved(t):this.h[t]},exists:function(t){return null!=_a[t]?this.existsReserved(t):this.h.hasOwnProperty(t)},setReserved:function(t,e){null==this.rh&&(this.rh={}),this.rh["$"+t]=e},getReserved:function(t){return null==this.rh?null:this.rh["$"+t]},existsReserved:function(t){return null!=this.rh&&this.rh.hasOwnProperty("$"+t)},remove:function(t){return null!=_a[t]?(t="$"+t,!(null==this.rh||!this.rh.hasOwnProperty(t))&&(delete this.rh[t],!0)):!!this.h.hasOwnProperty(t)&&(delete this.h[t],!0)},keys:function(){return o.iter(this.arrayKeys())},arrayKeys:function(){var t=[];for(var e in this.h)this.h.hasOwnProperty(e)&&t.push(e);if(null!=this.rh)for(var e in this.rh)36==e.charCodeAt(0)&&t.push(e.substr(1));return t},iterator:function(){return new ji(this,this.arrayKeys())},__class__:Ti};var Si=function(t){this.length=t.byteLength,this.b=new pa(t),this.b.bufferValue=t,t.hxBytes=this,t.bytes=this.b};a["haxe.io.Bytes"]=Si,Si.__name__=["haxe","io","Bytes"],Si.ofString=function(t){for(var e=[],r=0;r<t.length;){var i=t.charCodeAt(r++);55296<=i&&i<=56319&&(i=i-55232<<10|1023&t.charCodeAt(r++)),i<=127?e.push(i):i<=2047?(e.push(192|i>>6),e.push(128|63&i)):i<=65535?(e.push(224|i>>12),e.push(128|i>>6&63),e.push(128|63&i)):(e.push(240|i>>18),e.push(128|i>>12&63),e.push(128|i>>6&63),e.push(128|63&i))}return new Si(new pa(e).buffer)},Si.ofData=function(t){var e=t.hxBytes;return null!=e?e:new Si(t)},Si.prototype={blit:function(t,e,r,i){if(t<0||r<0||i<0||t+i>this.length||r+i>e.length)throw new Zn(Mi.OutsideBounds);0==r&&i==e.b.byteLength?this.b.set(e.b,t):this.b.set(e.b.subarray(r,r+i),t)},__class__:Si};var Ci=function(){};a["haxe.io.Eof"]=Ci,Ci.__name__=["haxe","io","Eof"],Ci.prototype={toString:function(){return"Eof"},__class__:Ci};var Mi=a["haxe.io.Error"]={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"]};Mi.Blocked=["Blocked",0],Mi.Blocked.toString=s,Mi.Blocked.__enum__=Mi,Mi.Overflow=["Overflow",1],Mi.Overflow.toString=s,Mi.Overflow.__enum__=Mi,Mi.OutsideBounds=["OutsideBounds",2],Mi.OutsideBounds.toString=s,Mi.OutsideBounds.__enum__=Mi,Mi.Custom=function(t){var e=["Custom",3,t];return e.__enum__=Mi,e.toString=s,e},Mi.__empty_constructs__=[Mi.Blocked,Mi.Overflow,Mi.OutsideBounds];var ki=function(){};a["haxe.io.FPHelper"]=ki,ki.__name__=["haxe","io","FPHelper"],ki.i32ToFloat=function(t){var e=1-(t>>>31<<1),r=t>>>23&255,i=8388607&t;return 0==i&&0==r?0:e*(1+Math.pow(2,-23)*i)*Math.pow(2,r-127)},ki.floatToI32=function(t){if(0==t)return 0;var e=t<0?-t:t,r=Math.floor(Math.log(e)/.6931471805599453);r<-127?r=-127:r>128&&(r=128);var i=Math.round(8388608*(e/Math.pow(2,r)-1));return 8388608==i&&r<128&&(i=0,++r),(t<0?-2147483648:0)|r+127<<23|i};var Ei=a["haxe.macro.Binop"]={__ename__:!0,__constructs__:["OpAdd","OpMult","OpDiv","OpSub","OpAssign","OpEq","OpNotEq","OpGt","OpGte","OpLt","OpLte","OpAnd","OpOr","OpXor","OpBoolAnd","OpBoolOr","OpShl","OpShr","OpUShr","OpMod","OpAssignOp","OpInterval","OpArrow"]};Ei.OpAdd=["OpAdd",0],Ei.OpAdd.toString=s,Ei.OpAdd.__enum__=Ei,Ei.OpMult=["OpMult",1],Ei.OpMult.toString=s,Ei.OpMult.__enum__=Ei,Ei.OpDiv=["OpDiv",2],Ei.OpDiv.toString=s,Ei.OpDiv.__enum__=Ei,Ei.OpSub=["OpSub",3],Ei.OpSub.toString=s,Ei.OpSub.__enum__=Ei,Ei.OpAssign=["OpAssign",4],Ei.OpAssign.toString=s,Ei.OpAssign.__enum__=Ei,Ei.OpEq=["OpEq",5],Ei.OpEq.toString=s,Ei.OpEq.__enum__=Ei,Ei.OpNotEq=["OpNotEq",6],Ei.OpNotEq.toString=s,Ei.OpNotEq.__enum__=Ei,Ei.OpGt=["OpGt",7],Ei.OpGt.toString=s,Ei.OpGt.__enum__=Ei,Ei.OpGte=["OpGte",8],Ei.OpGte.toString=s,Ei.OpGte.__enum__=Ei,Ei.OpLt=["OpLt",9],Ei.OpLt.toString=s,Ei.OpLt.__enum__=Ei,Ei.OpLte=["OpLte",10],Ei.OpLte.toString=s,Ei.OpLte.__enum__=Ei,Ei.OpAnd=["OpAnd",11],Ei.OpAnd.toString=s,Ei.OpAnd.__enum__=Ei,Ei.OpOr=["OpOr",12],Ei.OpOr.toString=s,Ei.OpOr.__enum__=Ei,Ei.OpXor=["OpXor",13],Ei.OpXor.toString=s,Ei.OpXor.__enum__=Ei,Ei.OpBoolAnd=["OpBoolAnd",14],Ei.OpBoolAnd.toString=s,Ei.OpBoolAnd.__enum__=Ei,Ei.OpBoolOr=["OpBoolOr",15],Ei.OpBoolOr.toString=s,Ei.OpBoolOr.__enum__=Ei,Ei.OpShl=["OpShl",16],Ei.OpShl.toString=s,Ei.OpShl.__enum__=Ei,Ei.OpShr=["OpShr",17],Ei.OpShr.toString=s,Ei.OpShr.__enum__=Ei,Ei.OpUShr=["OpUShr",18],Ei.OpUShr.toString=s,Ei.OpUShr.__enum__=Ei,Ei.OpMod=["OpMod",19],Ei.OpMod.toString=s,Ei.OpMod.__enum__=Ei,Ei.OpAssignOp=function(t){var e=["OpAssignOp",20,t];return e.__enum__=Ei,e.toString=s,e},Ei.OpInterval=["OpInterval",21],Ei.OpInterval.toString=s,Ei.OpInterval.__enum__=Ei,Ei.OpArrow=["OpArrow",22],Ei.OpArrow.toString=s,Ei.OpArrow.__enum__=Ei,Ei.__empty_constructs__=[Ei.OpAdd,Ei.OpMult,Ei.OpDiv,Ei.OpSub,Ei.OpAssign,Ei.OpEq,Ei.OpNotEq,Ei.OpGt,Ei.OpGte,Ei.OpLt,Ei.OpLte,Ei.OpAnd,Ei.OpOr,Ei.OpXor,Ei.OpBoolAnd,Ei.OpBoolOr,Ei.OpShl,Ei.OpShr,Ei.OpUShr,Ei.OpMod,Ei.OpInterval,Ei.OpArrow];var Ai=a["haxe.macro.Unop"]={__ename__:!0,__constructs__:["OpIncrement","OpDecrement","OpNot","OpNeg","OpNegBits"]};Ai.OpIncrement=["OpIncrement",0],Ai.OpIncrement.toString=s,Ai.OpIncrement.__enum__=Ai,Ai.OpDecrement=["OpDecrement",1],Ai.OpDecrement.toString=s,Ai.OpDecrement.__enum__=Ai,Ai.OpNot=["OpNot",2],Ai.OpNot.toString=s,Ai.OpNot.__enum__=Ai,Ai.OpNeg=["OpNeg",3],Ai.OpNeg.toString=s,Ai.OpNeg.__enum__=Ai,Ai.OpNegBits=["OpNegBits",4],Ai.OpNegBits.toString=s,Ai.OpNegBits.__enum__=Ai,Ai.__empty_constructs__=[Ai.OpIncrement,Ai.OpDecrement,Ai.OpNot,Ai.OpNeg,Ai.OpNegBits];var Ii=function(){};a["haxevx.vuex.core.NoneT"]=Ii,Ii.__name__=["haxevx","vuex","core","NoneT"];var Pi=function(){};a["haxevx.vuex.core.VxBoot"]=Pi,Pi.__name__=["haxevx","vuex","core","VxBoot"],Pi.clearModuleInjStack=function(t){for(var e=t.getters,r=Di.stack,i=r.length;--i>-1;)r[i]._InjNative(e);Di.stack=[]},Pi.notifyStarted=function(){},Pi.getRenderComponentMethod=function(t){return function(e){return e(t,null,null)}},Pi.prototype={startStore:function(t){if(null!=this.STORE)throw new Zn("Vuex store already started! Only 1 store is allowed");for(var e,r,i=new Vuex.Store(t),n=i.getters,a=Di.stack,s=a.length;--s>-1;)a[s]._InjNative(n);if(a=[],null!=t.modules){var o=0;r=t.modules;for(var h=f.fields(r);o<h.length;){var l=h[o];++o;f.field(r,l);e=t[l],i[l]=e}}return this.STORE=i,i},startVueWithRootComponent:function(t,e){var r={};r.el=t,null!=this.STORE&&(r.store=this.STORE),r.render=Pi.getRenderComponentMethod(e);var i=new Vue(r);return Pi.notifyStarted(),i},__class__:Pi};var Di=function(){};a["haxevx.vuex.core.ModuleStack"]=Di,Di.__name__=["haxevx","vuex","core","ModuleStack"];var Bi=function(){};a["haxevx.vuex.core.VxMacroUtil"]=Bi,Bi.__name__=["haxevx","vuex","core","VxMacroUtil"],Bi.dynamicSetOverwrite=function(t,e){for(var r=0,i=f.fields(e);r<i.length;){var n=i[r];++r,t[n]=f.field(e,n)}};var Vi=function(t,e){if(t!=-101||e!=-102){var r=window.document.createElement("canvas");r.width=t,r.height=e,this.ctx=r.getContext("2d",null)}};a["hxd.BitmapData"]=Vi,Vi.__name__=["hxd","BitmapData"],Vi.prototype={setPixel:function(t,e,r){var i=this.lockImage;if(null!=i){var n=t+e*i.width<<2;return i.data[n]=r>>16&255,i.data[1|n]=r>>8&255,i.data[2|n]=255&r,void(i.data[3|n]=r>>>24&255)}var a=this.pixel;null==a&&(a=this.ctx.createImageData(1,1),this.pixel=a),a.data[0]=r>>16&255,a.data[1]=r>>8&255,a.data[2]=255&r,a.data[3]=r>>>24&255,this.ctx.putImageData(a,t,e)},getPixels:function(){var t=this.ctx.canvas.width,e=this.ctx.canvas.height,r=this.ctx.getImageData(0,0,t,e).data,i=r.buffer;return new Ui(t,e,Si.ofData(i),gr.RGBA)},__class__:Vi};var Oi=a["hxd.Cursor"]={__ename__:!0,__constructs__:["Default","Button","Move","TextInput","Hide","Custom"]};Oi.Default=["Default",0],Oi.Default.toString=s,Oi.Default.__enum__=Oi,Oi.Button=["Button",1],Oi.Button.toString=s,Oi.Button.__enum__=Oi,Oi.Move=["Move",2],Oi.Move.toString=s,Oi.Move.__enum__=Oi,Oi.TextInput=["TextInput",3],Oi.TextInput.toString=s,Oi.TextInput.__enum__=Oi,Oi.Hide=["Hide",4],Oi.Hide.toString=s,Oi.Hide.__enum__=Oi,Oi.Custom=function(t){var e=["Custom",5,t];return e.__enum__=Oi,e.toString=s,e},Oi.__empty_constructs__=[Oi.Default,Oi.Button,Oi.Move,Oi.TextInput,Oi.Hide];var Fi=function(){};a["hxd.CustomCursor"]=Fi,Fi.__name__=["hxd","CustomCursor"];var Li=a["hxd.EventKind"]={__ename__:!0,__constructs__:["EPush","ERelease","EMove","EOver","EOut","EWheel","EFocus","EFocusLost","EKeyDown","EKeyUp","EReleaseOutside","ETextInput","ECheck"]};Li.EPush=["EPush",0],Li.EPush.toString=s,Li.EPush.__enum__=Li,Li.ERelease=["ERelease",1],Li.ERelease.toString=s,Li.ERelease.__enum__=Li,Li.EMove=["EMove",2],Li.EMove.toString=s,Li.EMove.__enum__=Li,Li.EOver=["EOver",3],Li.EOver.toString=s,Li.EOver.__enum__=Li,Li.EOut=["EOut",4],Li.EOut.toString=s,Li.EOut.__enum__=Li,Li.EWheel=["EWheel",5],Li.EWheel.toString=s,Li.EWheel.__enum__=Li,Li.EFocus=["EFocus",6],Li.EFocus.toString=s,Li.EFocus.__enum__=Li,Li.EFocusLost=["EFocusLost",7],Li.EFocusLost.toString=s,Li.EFocusLost.__enum__=Li,Li.EKeyDown=["EKeyDown",8],Li.EKeyDown.toString=s,Li.EKeyDown.__enum__=Li,Li.EKeyUp=["EKeyUp",9],Li.EKeyUp.toString=s,Li.EKeyUp.__enum__=Li,Li.EReleaseOutside=["EReleaseOutside",10],Li.EReleaseOutside.toString=s,Li.EReleaseOutside.__enum__=Li,Li.ETextInput=["ETextInput",11],Li.ETextInput.toString=s,Li.ETextInput.__enum__=Li,Li.ECheck=["ECheck",12],Li.ECheck.toString=s,Li.ECheck.__enum__=Li,Li.__empty_constructs__=[Li.EPush,Li.ERelease,Li.EMove,Li.EOver,Li.EOut,Li.EWheel,Li.EFocus,Li.EFocusLost,Li.EKeyDown,Li.EKeyUp,Li.EReleaseOutside,Li.ETextInput,Li.ECheck];var Gi=function(t,e,r){null==r&&(r=0),null==e&&(e=0),this.button=0,this.kind=t,this.relX=e,this.relY=r};a["hxd.Event"]=Gi,Gi.__name__=["hxd","Event"],Gi.prototype={__class__:Gi};var Ni={};a["hxd._FloatBuffer.Float32Expand_Impl_"]=Ni,Ni.__name__=["hxd","_FloatBuffer","Float32Expand_Impl_"],Ni._new=function(t){var e={pos:0,array:new ga(new fa(t))};return e};var zi=function(){};a["hxd.Key"]=zi,zi.__name__=["hxd","Key"],zi.isPressed=function(t){return zi.keyPressed[t]==ke.CURRENT.frameCount+1},zi.initialize=function(){zi.initDone&&zi.dispose(),zi.initDone=!0,zi.keyPressed=[],Wi.getInstance().addEventTarget(zi.onEvent)},zi.dispose=function(){zi.initDone&&(Wi.getInstance().removeEventTarget(zi.onEvent),zi.initDone=!1,zi.keyPressed=[])},zi.onEvent=function(t){var e=t.kind;switch(e[1]){case 0:t.button<5&&(zi.keyPressed[t.button]=ke.CURRENT.frameCount+1);break;case 1:t.button<5&&(zi.keyPressed[t.button]=-(ke.CURRENT.frameCount+1));break;case 5:zi.keyPressed[t.wheelDelta>0?6:5]=ke.CURRENT.frameCount+1;break;case 8:if(!zi.ALLOW_KEY_REPEAT&&zi.keyPressed[t.keyCode]>0)return;zi.keyPressed[t.keyCode]=ke.CURRENT.frameCount+1;break;case 9:zi.keyPressed[t.keyCode]=-(ke.CURRENT.frameCount+1)}};var qi=a["hxd.Flags"]={__ename__:!0,__constructs__:["ReadOnly","AlphaPremultiplied","FlipY"]};qi.ReadOnly=["ReadOnly",0],qi.ReadOnly.toString=s,qi.ReadOnly.__enum__=qi,qi.AlphaPremultiplied=["AlphaPremultiplied",1],qi.AlphaPremultiplied.toString=s,qi.AlphaPremultiplied.__enum__=qi,qi.FlipY=["FlipY",2],qi.FlipY.toString=s,qi.FlipY.__enum__=qi,qi.__empty_constructs__=[qi.ReadOnly,qi.AlphaPremultiplied,qi.FlipY];var Ui=function(t,e,r,i,n){null==n&&(n=0),this.width=t,this.height=e,this.bytes=r,this.set_innerFormat(i),this.offset=n};a["hxd.Pixels"]=Ui,Ui.__name__=["hxd","Pixels"],Ui.bytesPerPixel=function(t){switch(t[1]){case 0:case 1:case 2:return 4;case 3:return 8;case 4:return 16;case 5:return 1;case 6:return 2;case 7:return 4}},Ui.alloc=function(t,e,r){return new Ui(t,e,rn.getBytes(t*e*Ui.bytesPerPixel(r)),r)},Ui.prototype={set_innerFormat:function(t){return this.innerFormat=t,this.bpp=Ui.bytesPerPixel(t),t},copyInner:function(){var t=this.bytes;this.bytes=rn.getBytes(this.width*this.height*4),this.bytes.blit(0,t,this.offset,this.width*this.height*4),this.offset=0,this.flags&=-1-(1<<qi.ReadOnly[1])},convert:function(t){if(this.innerFormat!=t){0!=(this.flags&1<<qi.ReadOnly[1])&&this.copyInner();var e=this.innerFormat;switch(e[1]){case 0:switch(t[1]){case 1:for(var r=(en.select(this.bytes),0),i=this.width*this.height;r<i;){var n=r++,a=(n<<2)+this.offset,s=en.current.b[a],o=en.current.b[a+1],h=en.current.b[a+2],l=en.current.b[a+3];en.current.b[a]=255&l,en.current.b[a+1]=255&h,en.current.b[a+2]=255&o,en.current.b[a+3]=255&s}en.end();break;case 2:for(var u=(en.select(this.bytes),0),R=this.width*this.height;u<R;){var c=u++,_=(c<<2)+this.offset,f=en.current.b[_];en.current.b[_]=255&en.current.b[_+1],en.current.b[_+1]=255&en.current.b[_+2],en.current.b[_+2]=255&en.current.b[_+3],en.current.b[_+3]=255&f}en.end();break;default:throw new Zn("Cannot convert from "+g.string(this.innerFormat)+" to "+g.string(t))}break;case 1:switch(t[1]){case 0:for(var p=(en.select(this.bytes),0),d=this.width*this.height;p<d;){var v=p++,m=(v<<2)+this.offset,y=en.current.b[m],x=en.current.b[m+1],b=en.current.b[m+2],w=en.current.b[m+3];en.current.b[m]=255&w,en.current.b[m+1]=255&b,en.current.b[m+2]=255&x,en.current.b[m+3]=255&y}en.end();break;case 2:for(var j=(en.select(this.bytes),0),T=this.width*this.height;j<T;){var S=j++,C=(S<<2)+this.offset,M=en.current.b[C],k=en.current.b[C+2];en.current.b[C]=255&k,en.current.b[C+2]=255&M}en.end();break;default:throw new Zn("Cannot convert from "+g.string(this.innerFormat)+" to "+g.string(t))}break;case 2:switch(t[1]){case 0:for(var E=(en.select(this.bytes),0),A=this.width*this.height;E<A;){var I=E++,P=(I<<2)+this.offset,D=en.current.b[P+3];en.current.b[P+3]=255&en.current.b[P+2],en.current.b[P+2]=255&en.current.b[P+1],en.current.b[P+1]=255&en.current.b[P],en.current.b[P]=255&D}en.end();break;case 1:for(var B=(en.select(this.bytes),0),V=this.width*this.height;B<V;){var O=B++,F=(O<<2)+this.offset,L=en.current.b[F],G=en.current.b[F+2];en.current.b[F]=255&G,en.current.b[F+2]=255&L}en.end();break;default:throw new Zn("Cannot convert from "+g.string(this.innerFormat)+" to "+g.string(t))}break;default:throw new Zn("Cannot convert from "+g.string(this.innerFormat)+" to "+g.string(t))}this.set_innerFormat(t)}},dispose:function(){null!=this.bytes&&(0==(this.flags&1<<qi.ReadOnly[1])&&rn.saveBytes(this.bytes),
this.bytes=null)},__class__:Ui};var Yi=function(t){this.onOut=new Gi(Li.EOut),this.checkPos=new Gi(Li.ECheck),this.focusLost=new Gi(Li.EFocusLost),this.lastTouch=0,this.mouseY=-1,this.mouseX=-1,this.scenes=[],this.pendingEvents=[],this.pushList=[],null==t&&(t=Wi.getInstance()),this.stage=t,t.addEventTarget(n(this,this.onEvent))};a["hxd.SceneEvents"]=Yi,Yi.__name__=["hxd","SceneEvents"],Yi.prototype={onRemove:function(t){t==this.currentFocus&&(this.currentFocus=null),t==this.currentOver&&(this.currentOver=null,Zi.setCursor(Oi.Default)),o.remove(this.pushList,t)},addScene:function(t,e){t.setEvents(this),null==e?this.scenes.push(t):this.scenes.splice(e,0,t)},blur:function(){null!=this.currentFocus&&(this.focusLost.cancel=!1,this.currentFocus.handleEvent(this.focusLost),this.focusLost.cancel||(this.currentFocus=null))},checkFocus:function(){if(null!=this.currentFocus){var t=this.currentFocus.getInteractiveScene();return null==t?void(this.currentFocus=null):void(t.isInteractiveVisible(this.currentFocus)||this.blur())}},emitEvent:function(t){var e=t.relX,r=t.relY,i=!1,n=!1,a=!1,s=!1,h=t.kind;switch(h[1]){case 0:s=!0,a=!0;break;case 1:a=!0;break;case 2:case 12:n=!0;break;case 5:case 8:case 9:case 11:if(null!=this.currentFocus&&(t.relX=t.relY=0,this.currentFocus.handleEvent(t),t.relX=e,t.relY=r,!t.propagate))return}for(var l=0,u=this.scenes;l<u.length;){var R=u[l];++l;for(var c=null;;){var _=R.handleEvent(t,c);if(null==_){t.relX=e,t.relY=r;break}if(n)if(this.currentOver!=_){if(this.onOut.cancel=!1,null!=this.currentOver&&this.currentOver.handleEvent(this.onOut),!this.onOut.cancel){var f=t.propagate,g=t.kind;t.kind=Li.EOver,t.cancel=!1,_.handleEvent(t),t.cancel?this.currentOver=null:(this.currentOver=_,n=!1),t.kind=g,t.cancel=!1,t.propagate=f}}else n=!1;else a&&(t.kind==Li.EPush?this.pushList.push(_):o.remove(this.pushList,_)),s&&_==this.currentFocus&&(s=!1);if(t.relX=e,t.relY=r,!t.propagate){i=!0;break}c=_,t.propagate=!1}if(i)break}if(s&&null!=this.currentFocus&&this.blur(),n&&null!=this.currentOver&&(this.onOut.cancel=!1,this.currentOver.handleEvent(this.onOut),this.onOut.cancel||(this.currentOver=null)),i||t==this.checkPos||(t.kind==Li.EPush?this.pushList.push(null):t.kind==Li.ERelease&&o.remove(this.pushList,null),this.dispatchListeners(t)),t.kind==Li.ERelease&&this.pushList.length>0){for(var p=0,d=this.pushList;p<d.length;){var v=d[p];if(++p,null==v)this.dispatchListeners(t);else{var m=v.getInteractiveScene();if(null==m)continue;t.kind=Li.EReleaseOutside,m.dispatchEvent(t,v),t.kind=Li.ERelease,t.relX=e,t.relY=r}}this.pushList=[]}},checkEvents:function(){var t=this.pendingEvents,e=!1,r=null==this.currentFocus;if(t.length>0){this.pendingEvents=[];for(var i=0;i<t.length;){var n=t[i];++i;var a=n.relX,s=n.relY,o=n.kind;switch(o[1]){case 0:case 1:this.mouseX=n.relX,this.mouseY=n.relY,this.lastTouch=n.touchId;break;case 2:e=!0,this.mouseX=n.relX,this.mouseY=n.relY,this.lastTouch=n.touchId;break;case 5:case 8:case 9:case 11:r||(r=!0,this.checkFocus())}null==this.currentDrag||null!=this.currentDrag.ref&&this.currentDrag.ref!=n.touchId||(n.propagate=!1,n.cancel=!1,this.currentDrag.f(n),n.relX=a,n.relY=s,!n.cancel&&!n.propagate)?this.emitEvent(n):(n.cancel=!1,n.propagate=!1)}}r||this.checkFocus(),e||null!=this.currentDrag||(this.checkPos.relX=this.mouseX,this.checkPos.relY=this.mouseY,this.checkPos.touchId=this.lastTouch,this.checkPos.cancel=!1,this.checkPos.propagate=!1,this.emitEvent(this.checkPos))},onEvent:function(t){this.pendingEvents.push(t)},dispatchListeners:function(t){var e=t.relX,r=t.relY;t.propagate=!0;for(var i=0,n=this.scenes;i<n.length;){var a=n[i];if(++i,t.cancel=!1,a.dispatchListeners(t),t.relX=e,t.relY=r,!t.propagate)break}},__class__:Yi};var Wi=function(t){this.curMouseY=0,this.curMouseX=0;var e=this;if(this.eventTargets=new l,this.resizeEvents=new l,this.element=null==t?window:t,null==t&&(t=window.document.getElementById("webgl"),null==t))throw new Zn("Missing canvas #webgl");this.canvas=t,this.canvasPos=t.getBoundingClientRect(),this.element.addEventListener("mousedown",n(this,this.onMouseDown)),this.element.addEventListener("mousemove",n(this,this.onMouseMove)),this.element.addEventListener("mouseup",n(this,this.onMouseUp)),this.element.addEventListener("mousewheel",n(this,this.onMouseWheel)),this.element.addEventListener("touchstart",n(this,this.onTouchStart)),this.element.addEventListener("touchmove",n(this,this.onTouchMove)),this.element.addEventListener("touchend",n(this,this.onTouchEnd)),this.element.addEventListener("keydown",n(this,this.onKeyDown)),this.element.addEventListener("keyup",n(this,this.onKeyUp)),this.element.addEventListener("keypress",n(this,this.onKeyPress)),this.element==t?(t.setAttribute("tabindex","1"),t.style.outline="none"):(t.addEventListener("mousedown",function(t){e.onMouseDown(t),t.stopPropagation(),t.preventDefault()}),t.oncontextmenu=function(t){return t.stopPropagation(),t.preventDefault(),!1}),this.curW=this.get_width(),this.curH=this.get_height(),this.timer=new fi(100),this.timer.run=n(this,this.checkResize)};a["hxd.Stage"]=Wi,Wi.__name__=["hxd","Stage"],Wi.getInstance=function(){return null==Wi.inst&&(Wi.inst=new Wi),Wi.inst},Wi.prototype={checkResize:function(){this.canvasPos=this.canvas.getBoundingClientRect();var t=this.get_width(),e=this.get_height();this.curW==t&&this.curH==e||(this.curW=t,this.curH=e,this.onResize(null))},event:function(t){for(var e=this.eventTargets.h;null!=e;){var r=e.item;e=e.next;var i=r;i(t)}},addEventTarget:function(t){this.eventTargets.add(t)},removeEventTarget:function(t){for(var e=this.eventTargets.h;null!=e;){var r=e.item;e=e.next;var i=r;if(f.compareMethods(i,t)){this.eventTargets.remove(i);break}}},addResizeEvent:function(t){this.resizeEvents.push(t)},onResize:function(t){for(var e=this.resizeEvents.h;null!=e;){var r=e.item;e=e.next;var i=r;i()}},setFullScreen:function(t){},get_width:function(){return Math.round(this.canvasPos.width*window.devicePixelRatio)},get_height:function(){return Math.round(this.canvasPos.height*window.devicePixelRatio)},get_mouseX:function(){return Math.round((this.curMouseX-this.canvasPos.left)*window.devicePixelRatio)},get_mouseY:function(){return Math.round((this.curMouseY-this.canvasPos.top)*window.devicePixelRatio)},onMouseDown:function(t){var e,r=new Gi(Li.EPush,this.get_mouseX(),this.get_mouseY()),i=t.button;switch(i){case 1:e=2;break;case 2:e=1;break;default:var n=i;e=n}r.button=e,this.event(r)},onMouseUp:function(t){var e,r=new Gi(Li.ERelease,this.get_mouseX(),this.get_mouseY()),i=t.button;switch(i){case 1:e=2;break;case 2:e=1;break;default:var n=i;e=n}r.button=e,this.event(r)},onMouseMove:function(t){this.curMouseX=t.clientX,this.curMouseY=t.clientY,this.event(new Gi(Li.EMove,this.get_mouseX(),this.get_mouseY()))},onMouseWheel:function(t){var e=new Gi(Li.EWheel,this.get_mouseX(),this.get_mouseY());e.wheelDelta=-t.wheelDelta/30,this.event(e)},onTouchStart:function(t){t.preventDefault();for(var e,r,i,n=0,a=t.changedTouches;n<a.length;){var s=a[n];++n,e=Math.round((s.clientX-this.canvasPos.left)*window.devicePixelRatio),r=Math.round((s.clientY-this.canvasPos.top)*window.devicePixelRatio),i=new Gi(Li.EPush,e,r),i.touchId=s.identifier,this.event(i)}},onTouchMove:function(t){t.preventDefault();for(var e,r,i,n=0,a=t.changedTouches;n<a.length;){var s=a[n];++n,e=Math.round((s.clientX-this.canvasPos.left)*window.devicePixelRatio),r=Math.round((s.clientY-this.canvasPos.top)*window.devicePixelRatio),i=new Gi(Li.EMove,e,r),i.touchId=s.identifier,this.event(i)}},onTouchEnd:function(t){t.preventDefault();for(var e,r,i,n=0,a=t.changedTouches;n<a.length;){var s=a[n];++n,e=Math.round((s.clientX-this.canvasPos.left)*window.devicePixelRatio),r=Math.round((s.clientY-this.canvasPos.top)*window.devicePixelRatio),i=new Gi(Li.ERelease,e,r),i.touchId=s.identifier,this.event(i)}},onKeyUp:function(t){var e=new Gi(Li.EKeyUp,this.get_mouseX(),this.get_mouseY());e.keyCode=t.keyCode,this.event(e)},onKeyDown:function(t){var e=new Gi(Li.EKeyDown,this.get_mouseX(),this.get_mouseY());e.keyCode=t.keyCode,this.event(e)},onKeyPress:function(t){var e=new Gi(Li.ETextInput,this.get_mouseX(),this.get_mouseY());e.charCode=t.charCode,this.event(e)},__class__:Wi};var Hi=a["hxd.Platform"]={__ename__:!0,__constructs__:["IOS","Android","WebGL","PC","Console","FlashPlayer"]};Hi.IOS=["IOS",0],Hi.IOS.toString=s,Hi.IOS.__enum__=Hi,Hi.Android=["Android",1],Hi.Android.toString=s,Hi.Android.__enum__=Hi,Hi.WebGL=["WebGL",2],Hi.WebGL.toString=s,Hi.WebGL.__enum__=Hi,Hi.PC=["PC",3],Hi.PC.toString=s,Hi.PC.__enum__=Hi,Hi.Console=["Console",4],Hi.Console.toString=s,Hi.Console.__enum__=Hi,Hi.FlashPlayer=["FlashPlayer",5],Hi.FlashPlayer.toString=s,Hi.FlashPlayer.__enum__=Hi,Hi.__empty_constructs__=[Hi.IOS,Hi.Android,Hi.WebGL,Hi.PC,Hi.Console,Hi.FlashPlayer];var Xi=a["hxd.SystemValue"]={__ename__:!0,__constructs__:["IsTouch","IsWindowed","IsMobile"]};Xi.IsTouch=["IsTouch",0],Xi.IsTouch.toString=s,Xi.IsTouch.__enum__=Xi,Xi.IsWindowed=["IsWindowed",1],Xi.IsWindowed.toString=s,Xi.IsWindowed.__enum__=Xi,Xi.IsMobile=["IsMobile",2],Xi.IsMobile.toString=s,Xi.IsMobile.__enum__=Xi,Xi.__empty_constructs__=[Xi.IsTouch,Xi.IsWindowed,Xi.IsMobile];var Zi=function(){};a["hxd.System"]=Zi,Zi.__name__=["hxd","System"],Zi.setLoop=function(t){Zi.loopInit||(Zi.loopInit=!0,Zi.browserLoop()),Zi.loopFunc=t},Zi.browserLoop=function(){var t=window,e=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame;e(Zi.browserLoop),null!=Zi.loopFunc&&Zi.loopFunc()},Zi.start=function(t){t()},Zi.setNativeCursor=function(t){var e=Wi.getInstance().canvas;if(null!=e){var r;switch(t[1]){case 0:r="default";break;case 1:r="pointer";break;case 2:r="move";break;case 3:r="text";break;case 4:r="none";break;case 5:throw new Zn("Custom cursor not supported")}e.style.cursor=r}},Zi.getDefaultFrameRate=function(){return 60},Zi.getValue=function(t){return!1};var Ki=function(){};a["hxd.Timer"]=Ki,Ki.__name__=["hxd","Timer"],Ki.update=function(){Ki.frameCount++;var t=(new Date).getTime()/1e3;Ki.deltaT=t-Ki.oldTime,Ki.oldTime=t,Ki.deltaT<Ki.maxDeltaTime?Ki.calc_tmod=Ki.calc_tmod*Ki.tmod_factor+(1-Ki.tmod_factor)*Ki.deltaT*Ki.wantedFPS:Ki.deltaT=1/Ki.wantedFPS,Ki.tmod=Ki.calc_tmod},Ki.skip=function(){Ki.oldTime=(new Date).getTime()/1e3};var $i=function(){};a["hxd.earcut.EarNode"]=$i,$i.__name__=["hxd","earcut","EarNode"],$i.prototype={__class__:$i};var Qi=function(){};a["hxd.earcut.Earcut"]=Qi,Qi.__name__=["hxd","earcut","Earcut"],Qi.prototype={triangulate_h2d__Graphics_GPoint:function(t,e){var r=null!=e&&e.length>0,i=r?e[0]:t.length;if(i<3)return[];var n=this.setLinkedList_triangulate_T(t,0,i,!0);return null!=e&&(n=this.eliminateHoles_triangulate_T(t,e,n)),this.triangulateNode(n,t.length>80)},eliminateHoles_triangulate_T:function(t,e,r){for(var i=[],a=0,s=e.length;a<s;){var o=a++,h=e[o],l=o==e.length-1?t.length:e[o+1],u=this.setLinkedList_eliminateHoles_T(t,h,l,!1);u==u.next&&(u.steiner=!0),i.push(this.getLeftmost(u))}i.sort(n(this,this.compareX));for(var R=0;R<i.length;){var c=i[R];++R,this.eliminateHole(c,r),r=this.filterPoints(r,r.next)}return r},setLinkedList_eliminateHoles_T:function(t,e,r,i){for(var n=0,a=r-1,s=e,o=r;s<o;){var h=s++;n+=(t[a].x-t[h].x)*(t[h].y+t[a].y),a=h}var l=this.cache;null==l?(l=new $i,l.allocNext=this.allocated,this.allocated=l):this.cache=l.next,l.i=-1,l.z=-1,l.x=0,l.y=0,l.next=null,l.prev=null,l.steiner=!1,l.prevZ=null,l.nextZ=null;var u=l,R=u;if(i==n>0)for(var c=e,_=r;c<_;){var f=c++,g=t[f],p=g.x,d=g.y,v=this.cache;null==v?(v=new $i,v.allocNext=this.allocated,this.allocated=v):this.cache=v.next,v.i=f,v.z=-1,v.x=p,v.y=d,v.next=null,v.prev=u,v.steiner=!1,v.prevZ=null,v.nextZ=null,null!=u&&(u.next=v),u=v}else for(var m=r-1;m>=e;){var y=t[m],x=y.x,b=y.y,w=this.cache;null==w?(w=new $i,w.allocNext=this.allocated,this.allocated=w):this.cache=w.next,w.i=m,w.z=-1,w.x=x,w.y=b,w.next=null,w.prev=u,w.steiner=!1,w.prevZ=null,w.nextZ=null,null!=u&&(u.next=w),u=w,--m}return u.next=R.next,u.next.prev=u,u},setLinkedList_triangulate_T:function(t,e,r,i){for(var n=0,a=r-1,s=e,o=r;s<o;){var h=s++;n+=(t[a].x-t[h].x)*(t[h].y+t[a].y),a=h}var l=this.cache;null==l?(l=new $i,l.allocNext=this.allocated,this.allocated=l):this.cache=l.next,l.i=-1,l.z=-1,l.x=0,l.y=0,l.next=null,l.prev=null,l.steiner=!1,l.prevZ=null,l.nextZ=null;var u=l,R=u;if(i==n>0)for(var c=e,_=r;c<_;){var f=c++,g=t[f],p=g.x,d=g.y,v=this.cache;null==v?(v=new $i,v.allocNext=this.allocated,this.allocated=v):this.cache=v.next,v.i=f,v.z=-1,v.x=p,v.y=d,v.next=null,v.prev=u,v.steiner=!1,v.prevZ=null,v.nextZ=null,null!=u&&(u.next=v),u=v}else for(var m=r-1;m>=e;){var y=t[m],x=y.x,b=y.y,w=this.cache;null==w?(w=new $i,w.allocNext=this.allocated,this.allocated=w):this.cache=w.next,w.i=m,w.z=-1,w.x=x,w.y=b,w.next=null,w.prev=u,w.steiner=!1,w.prevZ=null,w.nextZ=null,null!=u&&(u.next=w),u=w,--m}return u.next=R.next,u.next.prev=u,u},triangulateNode:function(t,e){if(this.triangles=[],t=this.filterPoints(t),e&&null!=t){var r,i;r=t.x,this.minX=r,i=t.y,this.minY=i;for(var n=t.next;n!=t;){var a=n.x,s=n.y;a<this.minX&&(this.minX=a),s<this.minY&&(this.minY=s),a>r&&(r=a),s>i&&(i=s),n=n.next}var o=r-this.minX,h=i-this.minY;this.size=o<h?h:o,this.hasSize=!0}else this.hasSize=!1;this.earcutLinked(t);var l=this.triangles;this.triangles=null;var u=this.allocated;if(null!=this.cache){for(;u!=this.cache;)u=u.allocNext;u=u.allocNext}for(;null!=u;)u.next=this.cache,this.cache=u,u=u.allocNext;return l},eliminateHole:function(t,e){if(e=this.findHoleBridge(t,e),null!=e){var r=this.splitPolygon(e,t);this.filterPoints(r,r.next)}},findHoleBridge:function(t,e){for(var r=e,i=t.x,n=t.y,a=-(1/0),s=null;;){if(n<=r.y&&n>=r.next.y){var o=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);o<=i&&o>a&&(a=o,s=r.x<r.next.x?r:r.next)}if(r=r.next,r==e)break}if(null==s)return null;var h,l=s,u=1/0;for(r=s.next;r!=l;){var R;if(i>=r.x&&r.x>=s.x){var c=n<s.y?i:a,_=s.x,f=s.y,g=n<s.y?a:i,p=r.x,d=r.y;R=(g-p)*(n-d)-(c-p)*(n-d)>=0&&(c-p)*(f-d)-(_-p)*(n-d)>=0&&(_-p)*(n-d)-(g-p)*(f-d)>=0}else R=!1;if(R){var v=n-r.y;h=(v<0?-v:v)/(i-r.x);var m;if(h<u||h==u&&r.x>s.x){var y=r.prev,x=r.next;if((r.y-y.y)*(x.x-r.x)-(r.x-y.x)*(x.y-r.y)<0){var b=r.next;if((t.y-r.y)*(b.x-t.x)-(t.x-r.x)*(b.y-t.y)>=0){var w=r.prev;m=(w.y-r.y)*(t.x-w.x)-(w.x-r.x)*(t.y-w.y)>=0}else m=!1}else{var j=r.prev;if((t.y-r.y)*(j.x-t.x)-(t.x-r.x)*(j.y-t.y)<0)m=!0;else{var T=r.next;m=(T.y-r.y)*(t.x-T.x)-(T.x-r.x)*(t.y-T.y)<0}}}else m=!1;m&&(s=r,u=h)}r=r.next}return s},getLeftmost:function(t){for(var e=t,r=t;;)if(e.x<r.x&&(r=e),e=e.next,e==t)break;return r},compareX:function(t,e){return t.x-e.x>0?1:-1},filterPoints:function(t,e){if(null==t)return t;null==e&&(e=t);for(var r,i=t;;){r=!1;var n;if(i.steiner)n=!1;else{var a=i.next;if(i.x!=a.x||i.y!=a.y){var s=i.prev,o=i.next;n=(i.y-s.y)*(o.x-i.x)-(i.x-s.x)*(o.y-i.y)==0}else n=!0}if(n){if(i.next.prev=i.prev,i.prev.next=i.next,null!=i.prevZ&&(i.prevZ.nextZ=i.nextZ),null!=i.nextZ&&(i.nextZ.prevZ=i.prevZ),e=i.prev,i=e,i==i.next)return null;r=!0}else i=i.next;if(!r&&i==e)break}return e},earcutLinked:function(t,e){if(null==e&&(e=0),null!=t){0==e&&this.hasSize&&this.indexCurve(t);for(var r,i,n=t;t.prev!=t.next;)if(r=t.prev,i=t.next,this.hasSize?this.isEarHashed(t):this.isEar(t))this.triangles.push(r.i),this.triangles.push(t.i),this.triangles.push(i.i),t.next.prev=t.prev,t.prev.next=t.next,null!=t.prevZ&&(t.prevZ.nextZ=t.nextZ),null!=t.nextZ&&(t.nextZ.prevZ=t.prevZ),t=i.next,n=i.next;else if(t=i,t==n){switch(e){case 0:this.earcutLinked(this.filterPoints(t),1);break;case 1:t=this.cureLocalIntersections(t),this.earcutLinked(t,2);break;case 2:this.splitEarcut(t)}break}}},isEar:function(t){var e=t.prev,r=t,i=t.next;if((r.y-e.y)*(i.x-r.x)-(r.x-e.x)*(i.y-r.y)>=0)return!1;for(var n=t.next.next;n!=t.prev;){var a,s=e.x,o=e.y,h=r.x,l=r.y,u=i.x,R=i.y,c=n.x,_=n.y;if((u-c)*(o-_)-(s-c)*(R-_)>=0&&(s-c)*(l-_)-(h-c)*(o-_)>=0&&(h-c)*(R-_)-(u-c)*(l-_)>=0){var f=n.prev,g=n.next;a=(n.y-f.y)*(g.x-n.x)-(n.x-f.x)*(g.y-n.y)>=0}else a=!1;if(a)return!1;n=n.next}return!0},isEarHashed:function(t){var e=t.prev,r=t,i=t.next;if((r.y-e.y)*(i.x-r.x)-(r.x-e.x)*(i.y-r.y)>=0)return!1;var n=e.x<r.x?e.x<i.x?e.x:i.x:r.x<i.x?r.x:i.x,a=e.y<r.y?e.y<i.y?e.y:i.y:r.y<i.y?r.y:i.y,s=e.x>r.x?e.x>i.x?e.x:i.x:r.x>i.x?r.x:i.x,o=e.y>r.y?e.y>i.y?e.y:i.y:r.y>i.y?r.y:i.y,h=32767*(n-this.minX)/this.size|0,l=32767*(a-this.minY)/this.size|0;h=16711935&(h|h<<8),h=252645135&(h|h<<4),h=858993459&(h|h<<2),h=1431655765&(h|h<<1),l=16711935&(l|l<<8),l=252645135&(l|l<<4),l=858993459&(l|l<<2),l=1431655765&(l|l<<1);var u=h|l<<1,R=32767*(s-this.minX)/this.size|0,c=32767*(o-this.minY)/this.size|0;R=16711935&(R|R<<8),R=252645135&(R|R<<4),R=858993459&(R|R<<2),R=1431655765&(R|R<<1),c=16711935&(c|c<<8),c=252645135&(c|c<<4),c=858993459&(c|c<<2),c=1431655765&(c|c<<1);for(var _=R|c<<1,f=t.nextZ;null!=f&&f.z<=_;){var g,p;if(f!=t.prev&&f!=t.next){var d=e.x,v=e.y,m=r.x,y=r.y,x=i.x,b=i.y,w=f.x,j=f.y;p=(x-w)*(v-j)-(d-w)*(b-j)>=0&&(d-w)*(y-j)-(m-w)*(v-j)>=0&&(m-w)*(b-j)-(x-w)*(y-j)>=0}else p=!1;if(p){var T=f.prev,S=f.next;g=(f.y-T.y)*(S.x-f.x)-(f.x-T.x)*(S.y-f.y)>=0}else g=!1;if(g)return!1;f=f.nextZ}for(f=t.prevZ;null!=f&&f.z>=u;){var C,M;if(f!=t.prev&&f!=t.next){var k=e.x,E=e.y,A=r.x,I=r.y,P=i.x,D=i.y,B=f.x,V=f.y;M=(P-B)*(E-V)-(k-B)*(D-V)>=0&&(k-B)*(I-V)-(A-B)*(E-V)>=0&&(A-B)*(D-V)-(P-B)*(I-V)>=0}else M=!1;if(M){var O=f.prev,F=f.next;C=(f.y-O.y)*(F.x-f.x)-(f.x-O.x)*(F.y-f.y)>=0}else C=!1;if(C)return!1;f=f.prevZ}return!0},cureLocalIntersections:function(t){for(var e=t;;){var r,i,n=e.prev,a=e.next.next,s=e.next;if((e.y-n.y)*(s.x-e.x)-(e.x-n.x)*(s.y-e.y)>0!=(e.y-n.y)*(a.x-e.x)-(e.x-n.x)*(a.y-e.y)>0&&(a.y-s.y)*(n.x-a.x)-(a.x-s.x)*(n.y-a.y)>0!=(a.y-s.y)*(e.x-a.x)-(a.x-s.x)*(e.y-a.y)>0){var o=n.prev,h=n.next;if((n.y-o.y)*(h.x-n.x)-(n.x-o.x)*(h.y-n.y)<0){var l=n.next;if((a.y-n.y)*(l.x-a.x)-(a.x-n.x)*(l.y-a.y)>=0){var u=n.prev;i=(u.y-n.y)*(a.x-u.x)-(u.x-n.x)*(a.y-u.y)>=0}else i=!1}else{var R=n.prev;if((a.y-n.y)*(R.x-a.x)-(a.x-n.x)*(R.y-a.y)<0)i=!0;else{var c=n.next;i=(c.y-n.y)*(a.x-c.x)-(c.x-n.x)*(a.y-c.y)<0}}}else i=!1;if(i){var _=a.prev,f=a.next;if((a.y-_.y)*(f.x-a.x)-(a.x-_.x)*(f.y-a.y)<0){var g=a.next;if((n.y-a.y)*(g.x-n.x)-(n.x-a.x)*(g.y-n.y)>=0){var p=a.prev;r=(p.y-a.y)*(n.x-p.x)-(p.x-a.x)*(n.y-p.y)>=0}else r=!1}else{var d=a.prev;if((n.y-a.y)*(d.x-n.x)-(n.x-a.x)*(d.y-n.y)<0)r=!0;else{var v=a.next;r=(v.y-a.y)*(n.x-v.x)-(v.x-a.x)*(n.y-v.y)<0}}}else r=!1;if(r){this.triangles.push(n.i),this.triangles.push(e.i),this.triangles.push(a.i),e.next.prev=e.prev,e.prev.next=e.next,null!=e.prevZ&&(e.prevZ.nextZ=e.nextZ),null!=e.nextZ&&(e.nextZ.prevZ=e.prevZ);var m=e.next;m.next.prev=m.prev,m.prev.next=m.next,null!=m.prevZ&&(m.prevZ.nextZ=m.nextZ),null!=m.nextZ&&(m.nextZ.prevZ=m.prevZ),t=a,e=t}if(e=e.next,e==t)break}return e},splitEarcut:function(t){for(var e=t;;){for(var r=e.next.next;r!=e.prev;){if(e.i!=r.i&&this.isValidDiagonal(e,r)){var i=this.splitPolygon(e,r);return e=this.filterPoints(e,e.next),i=this.filterPoints(i,i.next),this.earcutLinked(e),void this.earcutLinked(i)}r=r.next}if(e=e.next,e==t)break}},splitPolygon:function(t,e){var r=t.i,i=t.x,n=t.y,a=this.cache;null==a?(a=new $i,a.allocNext=this.allocated,this.allocated=a):this.cache=a.next,a.i=r,a.z=-1,a.x=i,a.y=n,a.next=null,a.prev=null,a.steiner=!1,a.prevZ=null,a.nextZ=null;var s=a,o=e.i,h=e.x,l=e.y,u=this.cache;null==u?(u=new $i,u.allocNext=this.allocated,this.allocated=u):this.cache=u.next,u.i=o,u.z=-1,u.x=h,u.y=l,u.next=null,u.prev=null,u.steiner=!1,u.prevZ=null,u.nextZ=null;var R=u,c=t.next,_=e.prev;return t.next=e,e.prev=t,s.next=c,c.prev=s,R.next=s,s.prev=R,_.next=R,R.prev=_,R},isValidDiagonal:function(t,e){if(t.x!=e.x||t.y!=e.y){var r,i;if(t.next.i==e.i||t.prev.i==e.i||this.intersectsPolygon(t,e))i=!1;else{var n=t.prev,a=t.next;if((t.y-n.y)*(a.x-t.x)-(t.x-n.x)*(a.y-t.y)<0){var s=t.next;if((e.y-t.y)*(s.x-e.x)-(e.x-t.x)*(s.y-e.y)>=0){var o=t.prev;i=(o.y-t.y)*(e.x-o.x)-(o.x-t.x)*(e.y-o.y)>=0}else i=!1}else{var h=t.prev;if((e.y-t.y)*(h.x-e.x)-(e.x-t.x)*(h.y-e.y)<0)i=!0;else{var l=t.next;i=(l.y-t.y)*(e.x-l.x)-(l.x-t.x)*(e.y-l.y)<0}}}if(i){var u=e.prev,R=e.next;if((e.y-u.y)*(R.x-e.x)-(e.x-u.x)*(R.y-e.y)<0){var c=e.next;if((t.y-e.y)*(c.x-t.x)-(t.x-e.x)*(c.y-t.y)>=0){var _=e.prev;r=(_.y-e.y)*(t.x-_.x)-(_.x-e.x)*(t.y-_.y)>=0}else r=!1}else{var f=e.prev;if((t.y-e.y)*(f.x-t.x)-(t.x-e.x)*(f.y-t.y)<0)r=!0;else{var g=e.next;r=(g.y-e.y)*(t.x-g.x)-(g.x-e.x)*(t.y-g.y)<0}}}else r=!1;return!!r&&this.middleInside(t,e)}return!0},middleInside:function(t,e){for(var r=t,i=!1,n=(t.x+e.x)/2,a=(t.y+e.y)/2;;)if(r.y>a!=r.next.y>a&&n<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next,r==t)break;return i},intersectsPolygon:function(t,e){for(var r=t;;){var i;if(r.i!=t.i&&r.next.i!=t.i&&r.i!=e.i&&r.next.i!=e.i){var n=r.next;i=(n.y-r.y)*(t.x-n.x)-(n.x-r.x)*(t.y-n.y)>0!=(n.y-r.y)*(e.x-n.x)-(n.x-r.x)*(e.y-n.y)>0&&(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)>0!=(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)>0}else i=!1;if(i)return!0;if(r=r.next,r==t)break}return!1},indexCurve:function(t){for(var e=t;;){if(e.z<0){var r=32767*(e.x-this.minX)/this.size|0,i=32767*(e.y-this.minY)/this.size|0;r=16711935&(r|r<<8),r=252645135&(r|r<<4),r=858993459&(r|r<<2),r=1431655765&(r|r<<1),i=16711935&(i|i<<8),i=252645135&(i|i<<4),i=858993459&(i|i<<2),i=1431655765&(i|i<<1),e.z=r|i<<1}if(e.prevZ=e.prev,e.nextZ=e.next,e=e.next,e==t)break}e.prevZ.nextZ=null,e.prevZ=null,this.sortLinked(e)},sortLinked:function(t){for(var e,r,i,n,a,s,o,h=1;;){for(e=t,t=null,n=null,a=0;null!=e;){++a,r=e,s=0;for(var l=0,u=h;l<u;){l++;if(++s,r=r.nextZ,null==r)break}for(o=h;s>0||o>0&&null!=r;)0==s?(i=r,r=r.nextZ,--o):0==o||null==r?(i=e,e=e.nextZ,--s):e.z<=r.z?(i=e,e=e.nextZ,--s):(i=r,r=r.nextZ,--o),null!=n?n.nextZ=i:t=i,i.prevZ=n,n=i;e=r}if(n.nextZ=null,h*=2,!(a>1))break}return t},__class__:Qi};var Ji=function(t){this.path=t};a["hxd.fs.NotFound"]=Ji,Ji.__name__=["hxd","fs","NotFound"],Ji.prototype={toString:function(){return"Resource file not found '"+this.path+"'"},__class__:Ji};var tn=function(){};a["hxd.impl.MemoryReader"]=tn,tn.__name__=["hxd","impl","MemoryReader"],tn.prototype={__class__:tn};var en=function(){};a["hxd.impl.Memory"]=en,en.__name__=["hxd","impl","Memory"],en.select=function(t){return null!=en.current&&en.stack.push(en.current),en.current=t,en.inst},en.end=function(){en.current=en.stack.pop()};var rn=function(){};a["hxd.impl.Tmp"]=rn,rn.__name__=["hxd","impl","Tmp"],rn.outOfMemory=function(){},rn.getBytes=function(t){for(var e=-1,r=0,i=rn.bytes.length;r<i;){var n=r++,a=rn.bytes[n];a.length>=t&&(e=n)}if(e>=0){var s=rn.bytes[e];return rn.bytes.splice(e,1),s}for(var o=1024;o<t;)o=3*o>>1;return rn.allocBytes(o)},rn.freeMemory=function(){rn.bytes=[],rn.outOfMemory()},rn.allocBytes=function(t){try{return new Si(new fa(t))}catch(e){return rn.freeMemory(),new Si(new fa(t))}},rn.saveBytes=function(t){for(var e=0,r=rn.bytes.length;e<r;){var i=e++;if(rn.bytes[i].length<=t.length)return rn.bytes.splice(i,0,t),void(rn.bytes.length>8&&rn.bytes.pop())}rn.bytes.push(t)};var nn=a["hxsl.Type"]={__ename__:!0,__constructs__:["TVoid","TInt","TBool","TFloat","TString","TVec","TMat3","TMat4","TMat3x4","TBytes","TSampler2D","TSamplerCube","TStruct","TFun","TArray","TChannel"]};nn.TVoid=["TVoid",0],nn.TVoid.toString=s,nn.TVoid.__enum__=nn,nn.TInt=["TInt",1],nn.TInt.toString=s,nn.TInt.__enum__=nn,nn.TBool=["TBool",2],nn.TBool.toString=s,nn.TBool.__enum__=nn,nn.TFloat=["TFloat",3],nn.TFloat.toString=s,nn.TFloat.__enum__=nn,nn.TString=["TString",4],nn.TString.toString=s,nn.TString.__enum__=nn,nn.TVec=function(t,e){var r=["TVec",5,t,e];return r.__enum__=nn,r.toString=s,r},nn.TMat3=["TMat3",6],nn.TMat3.toString=s,nn.TMat3.__enum__=nn,nn.TMat4=["TMat4",7],nn.TMat4.toString=s,nn.TMat4.__enum__=nn,nn.TMat3x4=["TMat3x4",8],nn.TMat3x4.toString=s,nn.TMat3x4.__enum__=nn,nn.TBytes=function(t){var e=["TBytes",9,t];return e.__enum__=nn,e.toString=s,e},nn.TSampler2D=["TSampler2D",10],nn.TSampler2D.toString=s,nn.TSampler2D.__enum__=nn,nn.TSamplerCube=["TSamplerCube",11],nn.TSamplerCube.toString=s,nn.TSamplerCube.__enum__=nn,nn.TStruct=function(t){var e=["TStruct",12,t];return e.__enum__=nn,e.toString=s,e},nn.TFun=function(t){var e=["TFun",13,t];return e.__enum__=nn,e.toString=s,e},nn.TArray=function(t,e){var r=["TArray",14,t,e];return r.__enum__=nn,r.toString=s,r},nn.TChannel=function(t){var e=["TChannel",15,t];return e.__enum__=nn,e.toString=s,e},nn.__empty_constructs__=[nn.TVoid,nn.TInt,nn.TBool,nn.TFloat,nn.TString,nn.TMat3,nn.TMat4,nn.TMat3x4,nn.TSampler2D,nn.TSamplerCube];var an=a["hxsl.VecType"]={__ename__:!0,__constructs__:["VInt","VFloat","VBool"]};an.VInt=["VInt",0],an.VInt.toString=s,an.VInt.__enum__=an,an.VFloat=["VFloat",1],an.VFloat.toString=s,an.VFloat.__enum__=an,an.VBool=["VBool",2],an.VBool.toString=s,an.VBool.__enum__=an,an.__empty_constructs__=[an.VInt,an.VFloat,an.VBool];var sn=a["hxsl.SizeDecl"]={__ename__:!0,__constructs__:["SConst","SVar"]};sn.SConst=function(t){var e=["SConst",0,t];return e.__enum__=sn,e.toString=s,e},sn.SVar=function(t){var e=["SVar",1,t];return e.__enum__=sn,e.toString=s,e},sn.__empty_constructs__=[];var on=function(t,e){this.msg=t,this.pos=e};a["hxsl.Error"]=on,on.__name__=["hxsl","Error"],on.t=function(t,e){throw new Zn(new on(t,e))},on.prototype={toString:function(){return"Error("+this.msg+")@"+g.string(this.pos)},__class__:on};var hn=a["hxsl.VarKind"]={__ename__:!0,__constructs__:["Global","Input","Param","Var","Local","Output","Function"]};hn.Global=["Global",0],hn.Global.toString=s,hn.Global.__enum__=hn,hn.Input=["Input",1],hn.Input.toString=s,hn.Input.__enum__=hn,hn.Param=["Param",2],hn.Param.toString=s,hn.Param.__enum__=hn,hn.Var=["Var",3],hn.Var.toString=s,hn.Var.__enum__=hn,hn.Local=["Local",4],hn.Local.toString=s,hn.Local.__enum__=hn,hn.Output=["Output",5],hn.Output.toString=s,hn.Output.__enum__=hn,hn.Function=["Function",6],hn.Function.toString=s,hn.Function.__enum__=hn,hn.__empty_constructs__=[hn.Global,hn.Input,hn.Param,hn.Var,hn.Local,hn.Output,hn.Function];var ln=a["hxsl.VarQualifier"]={__ename__:!0,__constructs__:["Const","Private","Nullable","PerObject","Name","Shared","Precision","Range","Ignore"]};ln.Const=function(t){var e=["Const",0,t];return e.__enum__=ln,e.toString=s,e},ln.Private=["Private",1],ln.Private.toString=s,ln.Private.__enum__=ln,ln.Nullable=["Nullable",2],ln.Nullable.toString=s,ln.Nullable.__enum__=ln,ln.PerObject=["PerObject",3],ln.PerObject.toString=s,ln.PerObject.__enum__=ln,ln.Name=function(t){var e=["Name",4,t];return e.__enum__=ln,e.toString=s,e},ln.Shared=["Shared",5],ln.Shared.toString=s,ln.Shared.__enum__=ln,ln.Precision=function(t){var e=["Precision",6,t];return e.__enum__=ln,e.toString=s,e},ln.Range=function(t,e){var r=["Range",7,t,e];return r.__enum__=ln,r.toString=s,r},ln.Ignore=["Ignore",8],ln.Ignore.toString=s,ln.Ignore.__enum__=ln,ln.__empty_constructs__=[ln.Private,ln.Nullable,ln.PerObject,ln.Shared,ln.Ignore];var un=a["hxsl.Prec"]={__ename__:!0,__constructs__:["Low","Medium","High"]};un.Low=["Low",0],un.Low.toString=s,un.Low.__enum__=un,un.Medium=["Medium",1],un.Medium.toString=s,un.Medium.__enum__=un,un.High=["High",2],un.High.toString=s,un.High.__enum__=un,un.__empty_constructs__=[un.Low,un.Medium,un.High];var Rn=a["hxsl.Const"]={__ename__:!0,__constructs__:["CNull","CBool","CInt","CFloat","CString"]};Rn.CNull=["CNull",0],Rn.CNull.toString=s,Rn.CNull.__enum__=Rn,Rn.CBool=function(t){var e=["CBool",1,t];return e.__enum__=Rn,e.toString=s,e},Rn.CInt=function(t){var e=["CInt",2,t];return e.__enum__=Rn,e.toString=s,e},Rn.CFloat=function(t){var e=["CFloat",3,t];return e.__enum__=Rn,e.toString=s,e},Rn.CString=function(t){var e=["CString",4,t];return e.__enum__=Rn,e.toString=s,e},Rn.__empty_constructs__=[Rn.CNull];var cn=a["hxsl.FunctionKind"]={__ename__:!0,__constructs__:["Vertex","Fragment","Init","Helper"]};cn.Vertex=["Vertex",0],cn.Vertex.toString=s,cn.Vertex.__enum__=cn,cn.Fragment=["Fragment",1],cn.Fragment.toString=s,cn.Fragment.__enum__=cn,cn.Init=["Init",2],cn.Init.toString=s,cn.Init.__enum__=cn,cn.Helper=["Helper",3],cn.Helper.toString=s,cn.Helper.__enum__=cn,cn.__empty_constructs__=[cn.Vertex,cn.Fragment,cn.Init,cn.Helper];var _n=a["hxsl.TGlobal"]={__ename__:!0,__constructs__:["Radians","Degrees","Sin","Cos","Tan","Asin","Acos","Atan","Pow","Exp","Log","Exp2","Log2","Sqrt","Inversesqrt","Abs","Sign","Floor","Ceil","Fract","Mod","Min","Max","Clamp","Mix","Step","SmoothStep","Length","Distance","Dot","Cross","Normalize","LReflect","Texture2D","TextureCube","ToInt","ToFloat","ToBool","Vec2","Vec3","Vec4","IVec2","IVec3","IVec4","BVec2","BVec3","BVec4","Mat2","Mat3","Mat4","Mat3x4","Saturate","Pack","Unpack","PackNormal","UnpackNormal","DFdx","DFdy","Fwidth","TextureCubeLod","Texture2DLod","ChannelRead","Trace"]};_n.Radians=["Radians",0],_n.Radians.toString=s,_n.Radians.__enum__=_n,_n.Degrees=["Degrees",1],_n.Degrees.toString=s,_n.Degrees.__enum__=_n,_n.Sin=["Sin",2],_n.Sin.toString=s,_n.Sin.__enum__=_n,_n.Cos=["Cos",3],_n.Cos.toString=s,_n.Cos.__enum__=_n,_n.Tan=["Tan",4],_n.Tan.toString=s,_n.Tan.__enum__=_n,_n.Asin=["Asin",5],_n.Asin.toString=s,_n.Asin.__enum__=_n,_n.Acos=["Acos",6],_n.Acos.toString=s,_n.Acos.__enum__=_n,_n.Atan=["Atan",7],_n.Atan.toString=s,_n.Atan.__enum__=_n,_n.Pow=["Pow",8],_n.Pow.toString=s,_n.Pow.__enum__=_n,_n.Exp=["Exp",9],_n.Exp.toString=s,_n.Exp.__enum__=_n,_n.Log=["Log",10],_n.Log.toString=s,_n.Log.__enum__=_n,_n.Exp2=["Exp2",11],_n.Exp2.toString=s,_n.Exp2.__enum__=_n,_n.Log2=["Log2",12],_n.Log2.toString=s,_n.Log2.__enum__=_n,_n.Sqrt=["Sqrt",13],_n.Sqrt.toString=s,_n.Sqrt.__enum__=_n,_n.Inversesqrt=["Inversesqrt",14],_n.Inversesqrt.toString=s,_n.Inversesqrt.__enum__=_n,_n.Abs=["Abs",15],_n.Abs.toString=s,_n.Abs.__enum__=_n,_n.Sign=["Sign",16],_n.Sign.toString=s,_n.Sign.__enum__=_n,_n.Floor=["Floor",17],_n.Floor.toString=s,_n.Floor.__enum__=_n,_n.Ceil=["Ceil",18],_n.Ceil.toString=s,_n.Ceil.__enum__=_n,_n.Fract=["Fract",19],_n.Fract.toString=s,_n.Fract.__enum__=_n,_n.Mod=["Mod",20],_n.Mod.toString=s,_n.Mod.__enum__=_n,_n.Min=["Min",21],_n.Min.toString=s,_n.Min.__enum__=_n,_n.Max=["Max",22],_n.Max.toString=s,_n.Max.__enum__=_n,_n.Clamp=["Clamp",23],_n.Clamp.toString=s,_n.Clamp.__enum__=_n,_n.Mix=["Mix",24],_n.Mix.toString=s,_n.Mix.__enum__=_n,_n.Step=["Step",25],_n.Step.toString=s,_n.Step.__enum__=_n,_n.SmoothStep=["SmoothStep",26],_n.SmoothStep.toString=s,_n.SmoothStep.__enum__=_n,_n.Length=["Length",27],_n.Length.toString=s,_n.Length.__enum__=_n,_n.Distance=["Distance",28],_n.Distance.toString=s,_n.Distance.__enum__=_n,_n.Dot=["Dot",29],_n.Dot.toString=s,_n.Dot.__enum__=_n,_n.Cross=["Cross",30],_n.Cross.toString=s,_n.Cross.__enum__=_n,_n.Normalize=["Normalize",31],_n.Normalize.toString=s,_n.Normalize.__enum__=_n,_n.LReflect=["LReflect",32],_n.LReflect.toString=s,_n.LReflect.__enum__=_n,_n.Texture2D=["Texture2D",33],_n.Texture2D.toString=s,_n.Texture2D.__enum__=_n,_n.TextureCube=["TextureCube",34],_n.TextureCube.toString=s,_n.TextureCube.__enum__=_n,_n.ToInt=["ToInt",35],_n.ToInt.toString=s,_n.ToInt.__enum__=_n,_n.ToFloat=["ToFloat",36],_n.ToFloat.toString=s,_n.ToFloat.__enum__=_n,_n.ToBool=["ToBool",37],_n.ToBool.toString=s,_n.ToBool.__enum__=_n,_n.Vec2=["Vec2",38],_n.Vec2.toString=s,_n.Vec2.__enum__=_n,_n.Vec3=["Vec3",39],_n.Vec3.toString=s,_n.Vec3.__enum__=_n,_n.Vec4=["Vec4",40],_n.Vec4.toString=s,_n.Vec4.__enum__=_n,_n.IVec2=["IVec2",41],_n.IVec2.toString=s,_n.IVec2.__enum__=_n,_n.IVec3=["IVec3",42],_n.IVec3.toString=s,_n.IVec3.__enum__=_n,_n.IVec4=["IVec4",43],_n.IVec4.toString=s,_n.IVec4.__enum__=_n,_n.BVec2=["BVec2",44],_n.BVec2.toString=s,_n.BVec2.__enum__=_n,_n.BVec3=["BVec3",45],_n.BVec3.toString=s,_n.BVec3.__enum__=_n,_n.BVec4=["BVec4",46],_n.BVec4.toString=s,_n.BVec4.__enum__=_n,_n.Mat2=["Mat2",47],_n.Mat2.toString=s,_n.Mat2.__enum__=_n,_n.Mat3=["Mat3",48],_n.Mat3.toString=s,_n.Mat3.__enum__=_n,_n.Mat4=["Mat4",49],_n.Mat4.toString=s,_n.Mat4.__enum__=_n,_n.Mat3x4=["Mat3x4",50],_n.Mat3x4.toString=s,_n.Mat3x4.__enum__=_n,_n.Saturate=["Saturate",51],_n.Saturate.toString=s,_n.Saturate.__enum__=_n,_n.Pack=["Pack",52],_n.Pack.toString=s,_n.Pack.__enum__=_n,_n.Unpack=["Unpack",53],
_n.Unpack.toString=s,_n.Unpack.__enum__=_n,_n.PackNormal=["PackNormal",54],_n.PackNormal.toString=s,_n.PackNormal.__enum__=_n,_n.UnpackNormal=["UnpackNormal",55],_n.UnpackNormal.toString=s,_n.UnpackNormal.__enum__=_n,_n.DFdx=["DFdx",56],_n.DFdx.toString=s,_n.DFdx.__enum__=_n,_n.DFdy=["DFdy",57],_n.DFdy.toString=s,_n.DFdy.__enum__=_n,_n.Fwidth=["Fwidth",58],_n.Fwidth.toString=s,_n.Fwidth.__enum__=_n,_n.TextureCubeLod=["TextureCubeLod",59],_n.TextureCubeLod.toString=s,_n.TextureCubeLod.__enum__=_n,_n.Texture2DLod=["Texture2DLod",60],_n.Texture2DLod.toString=s,_n.Texture2DLod.__enum__=_n,_n.ChannelRead=["ChannelRead",61],_n.ChannelRead.toString=s,_n.ChannelRead.__enum__=_n,_n.Trace=["Trace",62],_n.Trace.toString=s,_n.Trace.__enum__=_n,_n.__empty_constructs__=[_n.Radians,_n.Degrees,_n.Sin,_n.Cos,_n.Tan,_n.Asin,_n.Acos,_n.Atan,_n.Pow,_n.Exp,_n.Log,_n.Exp2,_n.Log2,_n.Sqrt,_n.Inversesqrt,_n.Abs,_n.Sign,_n.Floor,_n.Ceil,_n.Fract,_n.Mod,_n.Min,_n.Max,_n.Clamp,_n.Mix,_n.Step,_n.SmoothStep,_n.Length,_n.Distance,_n.Dot,_n.Cross,_n.Normalize,_n.LReflect,_n.Texture2D,_n.TextureCube,_n.ToInt,_n.ToFloat,_n.ToBool,_n.Vec2,_n.Vec3,_n.Vec4,_n.IVec2,_n.IVec3,_n.IVec4,_n.BVec2,_n.BVec3,_n.BVec4,_n.Mat2,_n.Mat3,_n.Mat4,_n.Mat3x4,_n.Saturate,_n.Pack,_n.Unpack,_n.PackNormal,_n.UnpackNormal,_n.DFdx,_n.DFdy,_n.Fwidth,_n.TextureCubeLod,_n.Texture2DLod,_n.ChannelRead,_n.Trace];var fn=a["hxsl.Component"]={__ename__:!0,__constructs__:["X","Y","Z","W"]};fn.X=["X",0],fn.X.toString=s,fn.X.__enum__=fn,fn.Y=["Y",1],fn.Y.toString=s,fn.Y.__enum__=fn,fn.Z=["Z",2],fn.Z.toString=s,fn.Z.__enum__=fn,fn.W=["W",3],fn.W.toString=s,fn.W.__enum__=fn,fn.__empty_constructs__=[fn.X,fn.Y,fn.Z,fn.W];var gn=a["hxsl.TExprDef"]={__ename__:!0,__constructs__:["TConst","TVar","TGlobal","TParenthesis","TBlock","TBinop","TUnop","TVarDecl","TCall","TSwiz","TIf","TDiscard","TReturn","TFor","TContinue","TBreak","TArray","TArrayDecl","TSwitch","TWhile","TMeta"]};gn.TConst=function(t){var e=["TConst",0,t];return e.__enum__=gn,e.toString=s,e},gn.TVar=function(t){var e=["TVar",1,t];return e.__enum__=gn,e.toString=s,e},gn.TGlobal=function(t){var e=["TGlobal",2,t];return e.__enum__=gn,e.toString=s,e},gn.TParenthesis=function(t){var e=["TParenthesis",3,t];return e.__enum__=gn,e.toString=s,e},gn.TBlock=function(t){var e=["TBlock",4,t];return e.__enum__=gn,e.toString=s,e},gn.TBinop=function(t,e,r){var i=["TBinop",5,t,e,r];return i.__enum__=gn,i.toString=s,i},gn.TUnop=function(t,e){var r=["TUnop",6,t,e];return r.__enum__=gn,r.toString=s,r},gn.TVarDecl=function(t,e){var r=["TVarDecl",7,t,e];return r.__enum__=gn,r.toString=s,r},gn.TCall=function(t,e){var r=["TCall",8,t,e];return r.__enum__=gn,r.toString=s,r},gn.TSwiz=function(t,e){var r=["TSwiz",9,t,e];return r.__enum__=gn,r.toString=s,r},gn.TIf=function(t,e,r){var i=["TIf",10,t,e,r];return i.__enum__=gn,i.toString=s,i},gn.TDiscard=["TDiscard",11],gn.TDiscard.toString=s,gn.TDiscard.__enum__=gn,gn.TReturn=function(t){var e=["TReturn",12,t];return e.__enum__=gn,e.toString=s,e},gn.TFor=function(t,e,r){var i=["TFor",13,t,e,r];return i.__enum__=gn,i.toString=s,i},gn.TContinue=["TContinue",14],gn.TContinue.toString=s,gn.TContinue.__enum__=gn,gn.TBreak=["TBreak",15],gn.TBreak.toString=s,gn.TBreak.__enum__=gn,gn.TArray=function(t,e){var r=["TArray",16,t,e];return r.__enum__=gn,r.toString=s,r},gn.TArrayDecl=function(t){var e=["TArrayDecl",17,t];return e.__enum__=gn,e.toString=s,e},gn.TSwitch=function(t,e,r){var i=["TSwitch",18,t,e,r];return i.__enum__=gn,i.toString=s,i},gn.TWhile=function(t,e,r){var i=["TWhile",19,t,e,r];return i.__enum__=gn,i.toString=s,i},gn.TMeta=function(t,e,r){var i=["TMeta",20,t,e,r];return i.__enum__=gn,i.toString=s,i},gn.__empty_constructs__=[gn.TDiscard,gn.TContinue,gn.TBreak];var pn=function(){};a["hxsl.Tools"]=pn,pn.__name__=["hxsl","Tools"],pn.allocVarId=function(){return++pn.UID},pn.getName=function(t){if(null==t.qualifiers)return t.name;for(var e=0,r=t.qualifiers;e<r.length;){var i=r[e];if(++e,4==i[1]){var n=i[2];return n}}return t.name},pn.getConstBits=function(t){var e=t.type;switch(e[1]){case 1:for(var r=0,i=t.qualifiers;r<i.length;){var n=i[r];if(++r,0==n[1]){var a=n[2];if(null!=a){for(var s=0;a>=1<<s;)++s;return s}return 8}}break;case 2:return 1;case 15:return 3+pn.MAX_CHANNELS_BITS}return 0},pn.isConst=function(t){var e=t.type;if(15==e[1])return!0;if(null!=t.qualifiers)for(var r=0,i=t.qualifiers;r<i.length;){var n=i[r];if(++r,0==n[1])return!0}return!1},pn.hasQualifier=function(t,e){if(null!=t.qualifiers)for(var r=0,i=t.qualifiers;r<i.length;){var n=i[r];if(++r,n==e)return!0}return!1},pn.toString=function(t){switch(t[1]){case 5:var e,r=t[3],i=t[2];switch(r[1]){case 0:e="I";break;case 1:e="";break;case 2:e="B"}return e+"Vec"+i;case 9:var n=t[2];return"Bytes"+n;case 12:for(var a=t[2],s=[],h=0;h<a.length;){var l=a[h];++h,s.push(l.name+" : "+pn.toString(l.type))}return"{"+s.join(",")+"}";case 14:var u,R=t[3],c=t[2],_=pn.toString(c)+"[";switch(R[1]){case 0:var f=R[2];u=""+f;break;case 1:var g=R[2];u=g.name}return _+u+"]";default:return o.substr(t[0],1,null)}},pn.hasSideEffect=function(t){var e=t.e;switch(e[1]){case 0:case 1:case 2:return!1;case 3:var r=e[2];return pn.hasSideEffect(r);case 4:for(var i=e[2],n=0;n<i.length;){var a=i[n];if(++n,pn.hasSideEffect(a))return!0}return!1;case 5:switch(e[2][1]){case 4:case 20:return!0;default:var s=e[4],o=e[3];return!!pn.hasSideEffect(o)||pn.hasSideEffect(s)}break;case 6:var h=e[3];return pn.hasSideEffect(h);case 9:var l=e[2];return pn.hasSideEffect(l);case 10:var u=e[4],R=e[3],c=e[2];return!(!pn.hasSideEffect(c)&&!pn.hasSideEffect(R))||null!=u&&pn.hasSideEffect(u);case 13:var _=e[4],f=e[3];return!!pn.hasSideEffect(f)||pn.hasSideEffect(_);case 7:case 8:case 11:case 12:case 14:case 15:return!0;case 16:var g=e[3],p=e[2];return!!pn.hasSideEffect(p)||pn.hasSideEffect(g);case 17:for(var d=e[2],v=0;v<d.length;){var m=d[v];if(++v,pn.hasSideEffect(m))return!0}return!1;case 18:for(var y=e[4],x=e[3],b=e[2],w=0;w<x.length;){var j=x[w];++w;for(var T=0,S=j.values;T<S.length;){var C=S[T];if(++T,pn.hasSideEffect(C))return!0}if(pn.hasSideEffect(j.expr))return!0}return!!pn.hasSideEffect(b)||null!=y&&pn.hasSideEffect(y);case 19:var M=e[3],k=e[2];return!!pn.hasSideEffect(k)||pn.hasSideEffect(M);case 20:var E=e[4];return pn.hasSideEffect(E)}},pn.iter=function(t,e){var r=t.e;switch(r[1]){case 3:var i=r[2];e(i);break;case 4:for(var n=r[2],a=0;a<n.length;){var s=n[a];++a,e(s)}break;case 5:var o=r[4],h=r[3];e(h),e(o);break;case 6:var l=r[3];e(l);break;case 7:var u=r[3];null!=u&&e(u);break;case 8:var R=r[3],c=r[2];e(c);for(var _=0;_<R.length;){var f=R[_];++_,e(f)}break;case 9:var g=r[2];e(g);break;case 10:var p=r[4],d=r[3],v=r[2];e(v),e(d),null!=p&&e(p);break;case 12:var m=r[2];null!=m&&e(m);break;case 13:var y=r[4],x=r[3];e(x),e(y);break;case 0:case 1:case 2:case 11:case 14:case 15:break;case 16:var b=r[3],w=r[2];e(w),e(b);break;case 17:for(var j=r[2],T=0;T<j.length;){var S=j[T];++T,e(S)}break;case 18:var C=r[4],M=r[3],k=r[2];e(k);for(var E=0;E<M.length;){var A=M[E];++E;for(var I=0,P=A.values;I<P.length;){var D=P[I];++I,e(D)}e(A.expr)}null!=C&&e(C);break;case 19:var B=r[3],V=r[2];e(V),e(B);break;case 20:var O=r[4];e(O)}},pn.map=function(t,e){var r,i=t.e;switch(i[1]){case 3:var n=i[2];r=gn.TParenthesis(e(n));break;case 4:for(var a=i[2],s=[],o=0;o<a.length;){var h=a[o];++o,s.push(e(h))}r=gn.TBlock(s);break;case 5:var l=i[4],u=i[3],R=i[2];r=gn.TBinop(R,e(u),e(l));break;case 6:var c=i[3],_=i[2];r=gn.TUnop(_,e(c));break;case 7:var f=i[3],g=i[2];r=gn.TVarDecl(g,null!=f?e(f):null);break;case 8:for(var p=i[3],d=i[2],v=e(d),m=[],y=0;y<p.length;){var x=p[y];++y,m.push(e(x))}r=gn.TCall(v,m);break;case 9:var b=i[3],w=i[2];r=gn.TSwiz(e(w),b);break;case 10:var j=i[4],T=i[3],S=i[2];r=gn.TIf(e(S),e(T),null!=j?e(j):null);break;case 12:var C=i[2];r=gn.TReturn(null!=C?e(C):null);break;case 13:var M=i[4],k=i[3],E=i[2];r=gn.TFor(E,e(k),e(M));break;case 0:case 1:case 2:case 11:case 14:case 15:r=t.e;break;case 16:var A=i[3],I=i[2];r=gn.TArray(e(I),e(A));break;case 17:for(var P=i[2],D=[],B=0;B<P.length;){var V=P[B];++B,D.push(e(V))}r=gn.TArrayDecl(D);break;case 18:for(var O=i[4],F=i[3],L=i[2],G=e(L),N=[],z=0;z<F.length;){var q=F[z];++z;for(var U=[],Y=0,W=q.values;Y<W.length;){var H=W[Y];++Y,U.push(e(H))}N.push({values:U,expr:e(q.expr)})}r=gn.TSwitch(G,N,null==O?null:e(O));break;case 19:var X=i[4],Z=i[3],K=i[2];r=gn.TWhile(e(K),e(Z),X);break;case 20:var $=i[4],Q=i[3],J=i[2];r=gn.TMeta(J,Q,e($))}return{e:r,t:t.t,p:t.p}},pn.size=function(t){switch(t[1]){case 0:return 0;case 1:case 3:return 1;case 5:var e=t[2];return e;case 6:return 9;case 7:return 16;case 8:return 12;case 9:var r=t[2];return r;case 2:case 4:case 10:case 11:case 13:return 0;case 12:for(var i=t[2],n=0,a=0;a<i.length;){var s=i[a];++a,n+=pn.size(s.type)}return n;case 14:switch(t[3][1]){case 0:var o=t[2],h=t[3][2];return pn.size(o)*h;case 1:return 0}break;case 15:var l=t[2];return l}};var dn=function(){};a["hxsl.Tools2"]=dn,dn.__name__=["hxsl","Tools2"],dn.toString=function(t){var e=t[0];return e.charAt(0).toLowerCase()+o.substr(e,1,null)};var vn=function(){};a["hxsl.SearchMap"]=vn,vn.__name__=["hxsl","SearchMap"],vn.prototype={__class__:vn};var mn=function(){this.constsToGlobal=!1,this.linkCache=new vn,this.linkShaders=new Ti,this.byID=new Ti};a["hxsl.Cache"]=mn,mn.__name__=["hxsl","Cache"],mn.get=function(){var t=mn.INST;return null==t&&(t=new mn,mn.INST=t),t},mn.prototype={getLinkShader:function(t){var e=t.join(","),r=this.linkShaders,i=null!=_a[e]?r.getReserved(e):r.h[e];if(null!=i)return i;var n=new Yn("");t.slice();n.data={name:"shaderLinker",vars:[],funs:[]};var a=null,s=new Ti,o=0,h=nn.TVec(4,an.VFloat),l=function(t,e,r,i){for(var n=[],s=e,o=0,h=r.length;o<h;){var l=o++,u=i(r[r.length-1-l],s-(r.length-1-l));s-=pn.size(u.t),n.unshift(u)}return{e:gn.TCall({e:gn.TGlobal(t),t:nn.TVoid,p:a},n),t:nn.TVec(e,an.VFloat),p:a}},u=function(t,e,r){var i=null==r?t:pn.getName(r)+"."+t,a=null!=_a[i]?s.getReserved(i):s.h[i];if(null!=a)return a;if(a={id:pn.allocVarId(),name:t,type:e,kind:hn.Var,parent:r},null==r)n.data.vars.push(a);else{var o=r.type;if(12!=o[1])throw new Zn("assert");var h=o[2];h.push(a)}return null!=_a[i]?s.setReserved(i,a):s.h[i]=a,a},R=null;R=function(t,e){switch(t[1]){case 0:var r=t[2];return{e:gn.TConst(Rn.CFloat(r)),t:nn.TFloat,p:a};case 1:var i=t[2],n=null!=_a[i]?s.getReserved(i):s.h[i];if(null!=n)return{e:gn.TVar(n),t:n.type,p:a};for(var o=i.split("."),c=null;o.length>1;){var _=o.shift();c=u(_,nn.TStruct([]),c)}var f=o.shift();return n=u(f,1==e?nn.TFloat:nn.TVec(e,an.VFloat),c),{e:gn.TVar(n),t:n.type,p:a};case 2:var g=t[2];return{e:gn.TCall({e:gn.TGlobal(_n.PackNormal),t:nn.TVoid,p:a},[R(g,3)]),t:h,p:a};case 3:var p=t[2];return{e:gn.TCall({e:gn.TGlobal(_n.Pack),t:nn.TVoid,p:a},[R(p,1)]),t:h,p:a};case 4:var d=t[2];return l(_n.Vec2,2,d,R);case 5:var v=t[2];return l(_n.Vec3,3,v,R);case 6:var m=t[2];return l(_n.Vec4,4,m,R)}};var c=R,_=function(t){o+=1;var e={id:pn.allocVarId(),type:h,name:"OUTPUT"+(o-1),kind:hn.Output};return n.data.vars.push(e),{e:gn.TBinop(Ei.OpAssign,{e:gn.TVar(e),t:h,p:a},c(t,4)),t:nn.TVoid,p:a}},f=function(t,e){for(var r={id:pn.allocVarId(),type:nn.TFun([]),name:(""+g.string(t)).toLowerCase(),kind:hn.Function},i=[],s=0;s<e.length;){var o=e[s];++s,i.push(_(o))}var h={kind:t,ref:r,args:[],ret:nn.TVoid,expr:{e:gn.TBlock(i),p:a,t:nn.TVoid}};n.data.funs.push(h)};f(cn.Vertex,[Bn.Value("output.position")]),f(cn.Fragment,t),i=v.createEmptyInstance(yr),i.shader=n;var p=this.linkShaders;return null!=_a[e]?p.setReserved(e,i):p.h[e]=i,i.updateConstantsFinal(null),i},link:function(t){var e,r=this.linkCache,i=t;for(e=null;i!=e;){var n=i.s;i=i.next;var a=n,s=a.instance;null==r.next&&(r.next=new bi);var o=r.next.h[s.id];null==o&&(o=new vn,r.next.h[s.id]=o),r=o}return null==r.linked&&(r.linked=this.compileRuntimeShader(t)),r.linked},compileRuntimeShader:function(t){var e,r=[],i=0,n=t;for(e=null;n!=e;){var a=n.s;n=n.next;var s=a,o=s.instance;r.push({inst:o,p:s.priority,index:i++})}r.reverse(),vi.sort(r,function(t,e){return e.p-t.p});for(var h=new Dn,l=[],u=0;u<r.length;){var R=r[u];++u,l.push(R.inst.shader)}for(var c=h.link(l),_=new bi,f=0,g=h.allVars;f<g.length;){var p=g[f];if(++f,p.v.kind==hn.Param){var d=p.v.type;if(12==d[1])continue;var v=r[p.instanceIndex];_.h[p.id]={instance:v.index,index:v.inst.params.h[p.merged[0].id]}}}var m=(new Hn).split(c),y=(new jn).dce(m.vertex,m.fragment),x=new Gn;x.vertex=this.flattenShader(y.vertex,cn.Vertex,_),x.vertex.vertex=!0,x.fragment=this.flattenShader(y.fragment,cn.Fragment,_),x.globals=new bi,this.initGlobals(x,x.vertex),this.initGlobals(x,x.fragment),x.signature=di.encode(Vn.shaderToString(x.vertex.data)+Vn.shaderToString(x.fragment.data));var b=x.signature,w=this.byID,j=null!=_a[b]?w.getReserved(b):w.h[b];if(null!=j)x.id=j.id;else{var T=x.signature,S=this.byID;null!=_a[T]?S.setReserved(T,x):S.h[T]=x}return x},initGlobals:function(t,e){for(var r=e.globals;null!=r;)t.globals.h[r.gid]=!0,r=r.next;for(var i=e.params;null!=i;)null!=i.perObjectGlobal&&(t.globals.h[i.perObjectGlobal.gid]=!0),i=i.next},getPath:function(t){return null==t.parent?t.name:this.getPath(t.parent)+"."+t.name},flattenShader:function(t,e,r){var i=new Mn,n=new Ln,a=i.flatten(t,e,this.constsToGlobal);n.consts=i.consts;for(var s=i.allocData.keys();s.hasNext();){var o=s.next(),h=i.allocData.h[o.__id__],l=o.kind;switch(l[1]){case 0:for(var u=[],R=0;R<h.length;){var c=h[R];++R,null!=c.v&&u.push(new Fn(c.pos,this.getPath(c.v),c.v.type))}for(var _=u,f=0,g=_.length-1;f<g;){var p=f++;_[p].next=_[p+1]}var d=o.type;if(14!=d[1])throw new Zn("assert");if(5!=d[2][1])throw new Zn("assert");if(4!=d[2][2])throw new Zn("assert");if(1!=d[2][3][1])throw new Zn("assert");if(0!=d[3][1])throw new Zn("assert");var v=d[3][2];n.globals=_[0],n.globalsSize=v;break;case 2:for(var m=[],y=0;y<h.length;){var x=h[y];if(++y,null!=x.v){var b=r.h[x.v.id];if(null!=b)m.push(new On(x.v.name,x.pos,b.instance,b.index,x.v.type));else{var w=new On(x.v.name,x.pos,-1,-1,x.v.type);w.perObjectGlobal=new Fn(-1,this.getPath(x.v),x.v.type),m.push(w)}}}for(var j=0,T=m.length-1;j<T;){var S=j++;m[S].next=m[S+1]}var C=o.type;if(14!=C[1])throw new Zn("assert");switch(C[2][1]){case 5:if(4!=C[2][2])throw new Zn("assert");if(1!=C[2][3][1])throw new Zn("assert");if(0!=C[3][1])throw new Zn("assert");var M=C[3][2];n.params=m[0],n.paramsSize=M;break;case 10:n.textures2D=m[0],n.textures2DCount=m.length;break;case 11:n.texturesCube=m[0],n.texturesCubeCount=m.length;break;default:throw new Zn("assert")}break;default:throw new Zn("assert")}}return null==n.globals&&(n.globalsSize=0),null==n.params&&(n.paramsSize=0),null==n.textures2D&&(n.textures2DCount=0),null==n.texturesCube&&(n.texturesCubeCount=0),n.data=a,n},__class__:mn};var yn=a["hxsl.Channel"]={__ename__:!0,__constructs__:["Unknown","R","G","B","A","PackedFloat","PackedNormal"]};yn.Unknown=["Unknown",0],yn.Unknown.toString=s,yn.Unknown.__enum__=yn,yn.R=["R",1],yn.R.toString=s,yn.R.__enum__=yn,yn.G=["G",2],yn.G.toString=s,yn.G.__enum__=yn,yn.B=["B",3],yn.B.toString=s,yn.B.__enum__=yn,yn.A=["A",4],yn.A.toString=s,yn.A.__enum__=yn,yn.PackedFloat=["PackedFloat",5],yn.PackedFloat.toString=s,yn.PackedFloat.__enum__=yn,yn.PackedNormal=["PackedNormal",6],yn.PackedNormal.toString=s,yn.PackedNormal.__enum__=yn,yn.__empty_constructs__=[yn.Unknown,yn.R,yn.G,yn.B,yn.A,yn.PackedFloat,yn.PackedNormal];var xn=function(){this.varMap=new bi};a["hxsl.Clone"]=xn,xn.__name__=["hxsl","Clone"],xn.shaderData=function(t){return(new xn).shader(t)},xn.prototype={tvar:function(t){var e=this.varMap.h[t.id];return null!=e?e:(e={id:pn.allocVarId(),type:t.type,name:t.name,kind:t.kind},this.varMap.h[t.id]=e,null!=t.parent&&(e.parent=this.tvar(t.parent)),null!=t.qualifiers&&(e.qualifiers=t.qualifiers.slice()),e.type=this.ttype(t.type),e)},tfun:function(t){for(var e=this.ttype(t.ret),r=t.kind,i=this.tvar(t.ref),n=[],a=0,s=t.args;a<s.length;){var o=s[a];++a,n.push(this.tvar(o))}return{ret:e,kind:r,ref:i,args:n,expr:this.texpr(t.expr)}},ttype:function(t){switch(t[1]){case 12:for(var e=t[2],r=[],i=0;i<e.length;){var n=e[i];++i,r.push(this.tvar(n))}return nn.TStruct(r);case 13:for(var a=t[2],s=[],o=0;o<a.length;){var h=a[o];++o;for(var l=[],u=0,R=h.args;u<R.length;){var c=R[u];++u,l.push({name:c.name,type:this.ttype(c.type)})}s.push({args:l,ret:this.ttype(h.ret)})}return nn.TFun(s);case 14:var _,f=t[3],g=t[2],p=this.ttype(g);switch(f[1]){case 0:_=f;break;case 1:var d=f[2];_=sn.SVar(this.tvar(d))}return nn.TArray(p,_);default:return t}},texpr:function(t){var e=pn.map(t,n(this,this.texpr));e.t=this.ttype(t.t);var r,i=e.e;switch(i[1]){case 1:var a=i[2];r=gn.TVar(this.tvar(a));break;case 7:var s=i[3],o=i[2];r=gn.TVarDecl(this.tvar(o),s);break;case 13:var h=i[4],l=i[3],u=i[2];r=gn.TFor(this.tvar(u),l,h);break;default:r=e.e}return e.e=r,e},shader:function(t){for(var e=t.name,r=[],i=0,n=t.vars;i<n.length;){var a=n[i];++i,r.push(this.tvar(a))}for(var s=r,o=[],h=0,l=t.funs;h<l.length;){var u=l[h];++h,o.push(this.tfun(u))}return{name:e,vars:s,funs:o}},__class__:xn};var bn=function(){};a["hxsl._Dce.Exit"]=bn,bn.__name__=["hxsl","_Dce","Exit"],bn.prototype={__class__:bn};var wn=function(t){this.v=t,this.used=!1,this.deps=new bi};a["hxsl._Dce.VarDeps"]=wn,wn.__name__=["hxsl","_Dce","VarDeps"],wn.prototype={__class__:wn};var jn=function(){};a["hxsl.Dce"]=jn,jn.__name__=["hxsl","Dce"],jn.prototype={dce:function(t,e){this.used=new bi,this.channelVars=[];for(var r=[],i=0,n=t.vars;i<n.length;){var a=n[i];++i;var s=this.get(a);a.kind==hn.Input&&r.push(s),a.kind==hn.Output&&(s.keep=!0)}for(var h=0,l=e.vars;h<l.length;){var u=l[h];++h;var R=this.get(u);u.kind==hn.Output&&(R.keep=!0)}for(var c=0,_=t.funs;c<_.length;){var f=_[c];++c,this.check(f.expr,[])}for(var g=0,p=e.funs;g<p.length;){var d=p[g];++g,this.check(d.expr,[])}for(var v=this.used.iterator();v.hasNext();){var m=v.next();m.keep&&this.markRec(m)}for(;r.length>1&&!r[r.length-1].used;)r.pop();for(var y=0;y<r.length;){var x=r[y];++y,this.markRec(x)}for(var b=this.used.iterator();b.hasNext();){var w=b.next();w.used||(o.remove(t.vars,w.v),o.remove(e.vars,w.v))}for(var j=0,T=t.funs;j<T.length;){var S=T[j];++j,S.expr=this.mapExpr(S.expr,!1)}for(var C=0,M=e.funs;C<M.length;){var k=M[C];++C,k.expr=this.mapExpr(k.expr,!1)}return{fragment:e,vertex:t}},get:function(t){var e=this.used.h[t.id];return null==e&&(e=new wn(t),this.used.h[t.id]=e),e},markRec:function(t){if(!t.used){t.used=!0;for(var e=t.deps.iterator();e.hasNext();){var r=e.next();this.markRec(r)}}},link:function(t,e){for(var r=this.get(t),i=0;i<e.length;){var n=e[i];++i,null!=n?n.deps.h[t.id]=r:r.keep=!0}},hasDiscardRec:function(t){var e=t.e;if(11==e[1])throw new Zn(new bn);pn.iter(t,n(this,this.hasDiscardRec))},hasDiscard:function(t){try{return this.hasDiscardRec(t),!1}catch(t){if(t instanceof Zn&&(t=t.val),En.__instanceof(t,bn))return!0;throw t}},check:function(t,e){var r=t.e;switch(r[1]){case 1:var i=r[2];this.link(i,e);break;case 5:switch(r[2][1]){case 4:switch(r[3].e[1]){case 1:var a=r[4],s=r[3].e[2];e.push(this.get(s)),this.check(a,e),e.pop();break;case 9:if(1==r[3].e[2].e[1]){var o=r[4],h=r[3].e[2].e[2];e.push(this.get(h)),this.check(o,e),e.pop()}else{var l=n(this,this.check),u=e;pn.iter(t,function(t){l(t,u)})}break;default:var R=n(this,this.check),c=e;pn.iter(t,function(t){R(t,c)})}break;case 20:switch(r[3].e[1]){case 1:var _=r[4],f=r[3].e[2];e.push(this.get(f)),this.check(_,e),e.pop();break;case 9:if(1==r[3].e[2].e[1]){var g=r[4],p=r[3].e[2].e[2];e.push(this.get(p)),this.check(g,e),e.pop()}else{var d=n(this,this.check),v=e;pn.iter(t,function(t){d(t,v)})}break;default:var m=n(this,this.check),y=e;pn.iter(t,function(t){m(t,y)})}break;default:var x=n(this,this.check),b=e;pn.iter(t,function(t){x(t,b)})}break;case 7:var w=r[3],j=r[2];if(null!=w)e.push(this.get(j)),this.check(w,e),e.pop();else{var T=n(this,this.check),S=e;pn.iter(t,function(t){T(t,S)})}break;case 8:if(2==r[2].e[1])if(61==r[2].e[2][1])if(3==r[3].length)if(1==r[3][0].e[1])if(0==r[3][2].e[1])if(2==r[3][2].e[2][1]){var C=r[3][0].e[2],M=r[3][1],k=r[3][2].e[2][2];this.check(M,e),null==this.channelVars[k]?(this.channelVars[k]=C,this.link(C,e)):this.link(this.channelVars[k],e)}else{var E=n(this,this.check),A=e;pn.iter(t,function(t){E(t,A)})}else{var I=n(this,this.check),P=e;pn.iter(t,function(t){I(t,P)})}else{var D=n(this,this.check),B=e;pn.iter(t,function(t){D(t,B)})}else{var V=n(this,this.check),O=e;pn.iter(t,function(t){V(t,O)})}else{var F=n(this,this.check),L=e;pn.iter(t,function(t){F(t,L)})}else{var G=n(this,this.check),N=e;pn.iter(t,function(t){G(t,N)})}break;case 10:var z=r[4],q=r[3],U=r[2];if(this.hasDiscard(q)||null!=z&&this.hasDiscard(z))e.push(null),this.check(U,e),e.pop(),this.check(q,e),null!=z&&this.check(z,e);else{var Y=n(this,this.check),W=e;pn.iter(t,function(t){Y(t,W)})}break;case 13:var H=r[4],X=r[3];r[2];e.push(null),this.check(X,e),this.check(H,e),e.pop();break;default:var Z=n(this,this.check),K=e;pn.iter(t,function(t){Z(t,K)})}},mapExpr:function(t,e){var r=this,i=t.e;switch(i[1]){case 4:for(var n=i[2],a=[],s=0,o=0;o<n.length;){var h=n[o];++o;var l=e&&s==n.length-1,u=this.mapExpr(h,l);(pn.hasSideEffect(u)||l)&&a.push(u),++s}return{e:gn.TBlock(a),p:t.p,t:t.t};case 5:switch(i[2][1]){case 4:switch(i[3].e[1]){case 1:var R=i[3].e[2];return this.get(R).used?pn.map(t,function(t){return r.mapExpr(t,!0)}):{e:gn.TConst(Rn.CNull),t:t.t,p:t.p};case 9:if(1==i[3].e[2].e[1]){var c=i[3].e[2].e[2];return this.get(c).used?pn.map(t,function(t){return r.mapExpr(t,!0)}):{e:gn.TConst(Rn.CNull),t:t.t,p:t.p}}return pn.map(t,function(t){return r.mapExpr(t,!0)});default:return pn.map(t,function(t){return r.mapExpr(t,!0)})}break;case 20:switch(i[3].e[1]){case 1:var _=i[3].e[2];return this.get(_).used?pn.map(t,function(t){return r.mapExpr(t,!0)}):{e:gn.TConst(Rn.CNull),t:t.t,p:t.p};case 9:if(1==i[3].e[2].e[1]){var f=i[3].e[2].e[2];return this.get(f).used?pn.map(t,function(t){return r.mapExpr(t,!0)}):{e:gn.TConst(Rn.CNull),t:t.t,p:t.p}}return pn.map(t,function(t){return r.mapExpr(t,!0)});default:return pn.map(t,function(t){return r.mapExpr(t,!0)})}break;default:return pn.map(t,function(t){return r.mapExpr(t,!0)})}break;case 7:var g=i[2];return this.get(g).used?pn.map(t,function(t){return r.mapExpr(t,!0)}):{e:gn.TConst(Rn.CNull),t:t.t,p:t.p};case 8:if(2==i[2].e[1]){if(61==i[2].e[2][1]){if(3==i[3].length){if(0==i[3][2].e[1]){if(2==i[3][2].e[2][1]){var p=i[3][1],d=i[3][2].e[2][2],v=this.channelVars[d];return{e:gn.TCall({e:gn.TGlobal(_n.Texture2D),p:t.p,t:nn.TVoid},[{e:gn.TVar(v),t:v.type,p:t.p},p]),t:nn.TVoid,p:t.p}}return pn.map(t,function(t){return r.mapExpr(t,!0)})}return pn.map(t,function(t){return r.mapExpr(t,!0)})}return pn.map(t,function(t){return r.mapExpr(t,!0)})}return pn.map(t,function(t){return r.mapExpr(t,!0)})}return pn.map(t,function(t){return r.mapExpr(t,!0)});case 10:var m=i[4],y=i[3],x=i[2],b=this.mapExpr(x,!0),w=this.mapExpr(y,e),j=null==m?null:this.mapExpr(m,e);return e||pn.hasSideEffect(w)||null!=j&&pn.hasSideEffect(j)?{e:gn.TIf(b,w,j),p:b.p,t:b.t}:{e:gn.TConst(Rn.CNull),t:b.t,p:b.p};case 13:var T=i[4],S=i[3],C=i[2],M=this.mapExpr(S,!0),k=this.mapExpr(T,!1);return pn.hasSideEffect(k)?{e:gn.TFor(C,M,k),p:t.p,t:t.t}:{e:gn.TConst(Rn.CNull),t:t.t,p:t.p};default:return pn.map(t,function(t){return r.mapExpr(t,!0)})}},__class__:jn};var Tn=function(){this.varMap=new wi,this.funMap=new wi,this.constants=new bi};a["hxsl.Eval"]=Tn,Tn.__name__=["hxsl","Eval"],Tn.prototype={setConstant:function(t,e){this.constants.h[t.id]=gn.TConst(e)},mapVar:function(t){var e=this.varMap.h[t.__id__];if(null!=e)return t==e?e:this.mapVar(e);if(null!=t.parent&&(this.mapVar(t.parent),e=this.varMap.h[t.__id__],null!=e))return t==e?e:this.mapVar(e);var r,i=t.type;r=15==i[1]?t.id:pn.allocVarId(),e={id:r,name:t.name,type:t.type,kind:t.kind},null!=t.parent&&(e.parent=this.mapVar(t.parent)),null!=t.qualifiers&&(e.qualifiers=t.qualifiers.slice()),this.varMap.set(t,e),this.varMap.set(e,e);var n=e.type;switch(n[1]){case 12:for(var a=n[2],s=[],o=0;o<a.length;){var h=a[o];++o,s.push(this.mapVar(h))}e.type=nn.TStruct(s);break;case 14:if(1==n[3][1]){var l=n[2],u=n[3][2],R=this.constants.get(u.id);if(null!=R)if(0==R[1])if(2==R[2][1]){var c=R[2][2];e.type=nn.TArray(l,sn.SConst(c))}else on.t("Integer value expected for array size constant "+u.name,null);else on.t("Integer value expected for array size constant "+u.name,null);else{var _=this.mapVar(u);e.type=nn.TArray(l,sn.SVar(_))}}}return e},eval:function(t){for(var e=[],r=0,i=t.funs;r<i.length;){var n=i[r];++r;for(var a=n.kind,s=this.mapVar(n.ref),o=[],h=0,l=n.args;h<l.length;){var u=l[h];++h,o.push(this.mapVar(u))}var R={kind:a,ref:s,args:o,ret:n.ret,expr:n.expr};this.inlineCalls&&n.kind==cn.Helper||e.push(R),this.funMap.set(R.ref,n)}for(var c=0,_=e.length;c<_;){var f=c++;this.curFun=e[f],this.curFun.expr=this.evalExpr(this.curFun.expr,!1)}for(var g=t.name,p=[],d=0,v=t.vars;d<v.length;){var m=v[d];++d,p.push(this.mapVar(m))}return{name:g,vars:p,funs:e}},hasReturn:function(t){return this.markReturn=!1,this.hasReturnLoop(t),this.markReturn},hasReturnLoop:function(t){var e=t.e;12==e[1]?this.markReturn=!0:this.markReturn||pn.iter(t,n(this,this.hasReturnLoop))},handleReturn:function(t,e){null==e&&(e=!1);var r=t.e;switch(r[1]){case 3:var i=r[2],a=this.handleReturn(i,e);return{e:gn.TParenthesis(a),t:a.t,p:t.p};case 4:var s=r[2],o=0,h=s.length,l=[];try{for(;o<h;){var u=s[o++];if(o==h)l.push(this.handleReturn(u,e));else{var R=u.e;switch(R[1]){case 10:if(null==R[4]){var c=R[2],_=R[3];if(e&&this.hasReturn(_))throw l.push(this.handleReturn({e:gn.TIf(c,_,{e:gn.TBlock(s.slice(o)),t:u.t,p:u.p}),t:u.t,p:u.p})),"__break__";l.push(this.handleReturn(u))}else l.push(this.handleReturn(u));break;case 12:var f=R[2];throw l.push(this.handleReturn(f,e)),"__break__";default:l.push(this.handleReturn(u))}}}}catch(t){if("__break__"!=t)throw t}var g=e?l[l.length-1].t:t.t;return{e:gn.TBlock(l),t:g,p:t.p};case 10:var p=r[4],d=r[3],v=r[2];if(null!=p&&e){var m=this.handleReturn(v),y=this.handleReturn(d,e);return{e:gn.TIf(m,y,this.handleReturn(p,e)),t:y.t,p:t.p}}return pn.map(t,n(this,this.handleReturnDef));case 12:var x=r[2];return e||on.t("Cannot inline not final return",t.p),null==x?{e:gn.TBlock([]),t:nn.TVoid,p:t.p}:this.handleReturn(x,!0);default:return pn.map(t,n(this,this.handleReturnDef))}},handleReturnDef:function(t){return this.handleReturn(t)},evalCall:function(t,e,r,i){switch(t[1]){case 36:if(1==e.length){if(0==e[0].e[1]){if(2==e[0].e[2][1]){var n=e[0].e[2][2];return gn.TConst(Rn.CFloat(n))}return null}return null}return null;case 61:if(2!=e.length)return null;if(0!=e[0].e[1]){var a=e[0];return on.t("Cannot eval complex channel "+Vn.toString(a,!0)+" "+this.constantsToString(),i)}if(2!=e[0].e[2][1]){var s=e[0];return on.t("Cannot eval complex channel "+Vn.toString(s,!0)+" "+this.constantsToString(),i)}var o,h=e[1],l=e[0].e[2][2],u=r[0],R=u.e;if(1!=R[1])throw new Zn("assert");var c=R[2];o=gn.TVar(this.mapVar(c)),u.e=o;var _,f=u.t;if(15!=f[1])throw new Zn("assert");var g=f[2];_=g;var p=v.createEnumIndex(yn,7&l,null),d={e:gn.TCall({e:gn.TGlobal(_n.ChannelRead),t:nn.TVoid,p:i},[u,h,{e:gn.TConst(Rn.CInt(l>>3)),t:nn.TInt,p:i}]),t:nn.TVoid,p:i};switch(p[1]){case 0:var m={e:gn.TConst(Rn.CFloat(0)),t:nn.TFloat,p:i};return 1==_?m.e:gn.TCall({e:gn.TGlobal([_n.Vec2,_n.Vec3,_n.Vec4][_-2]),t:nn.TVoid,p:i},[m]);case 1:case 2:case 3:case 4:var y;switch(p[1]){case 1:y=fn.X;break;case 2:y=fn.Y;break;case 3:y=fn.Z;break;default:y=fn.W}return gn.TSwiz(d,[y]);case 5:return gn.TCall({e:gn.TGlobal(_n.Unpack),t:nn.TVoid,p:i},[d]);case 6:return gn.TCall({e:gn.TGlobal(_n.UnpackNormal),t:nn.TVoid,p:i},[d])}break;case 62:for(var x=e,b=0;b<x.length;){var w=x[b];++b,Ri.trace(Vn.toString(w),{fileName:w.p.file,lineNumber:0,className:null,methodName:null})}return gn.TBlock([]);default:return null}},constantsToString:function(){for(var t=[],e=this.constants.keys();e.hasNext();){var r=e.next();t.push(r+" => "+Vn.toString({e:this.constants.h[r],t:nn.TVoid,p:null},!0))}return t.toString()},evalExpr:function(t,e){null==e&&(e=!0);var r,i=this,n=t.e;switch(n[1]){case 1:var a=n[2],s=this.constants.get(a.id);if(null!=s)r=s;else{var o=this.mapVar(a);r=gn.TVar(o)}break;case 0:case 2:r=t.e;break;case 3:var h=n[2],l=this.evalExpr(h,e),u=l.e;r=0==u[1]?l.e:gn.TParenthesis(l);break;case 4:for(var R=n[2],c=[],_=R.length-1,f=0,p=R.length;f<p;){var d=f++,v=e&&d==_,m=this.evalExpr(R[d],v),y=m.e;switch(y[1]){case 0:case 1:v&&c.push(m);break;default:c.push(m)}}r=1==c.length&&this.curFun.kind!=cn.Init?c[0].e:gn.TBlock(c);break;case 5:var x=n[4],b=n[3],w=n[2],j=this.evalExpr(b),T=this.evalExpr(x);switch(w[1]){case 0:var S=T.e,C=j.e;if(0==C[1])switch(C[2][1]){case 2:if(0==S[1])if(2==S[2][1]){var M=C[2][2],k=S[2][2];r=gn.TConst(Rn.CInt(M+k|0))}else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);break;case 3:if(0==S[1])if(3==S[2][1]){var E=C[2][2],A=S[2][2];r=gn.TConst(Rn.CFloat(E+A))}else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 1:var I=T.e,P=j.e;if(0==P[1])switch(P[2][1]){case 2:if(0==I[1])if(2==I[2][1]){var D=P[2][2],B=I[2][2];r=gn.TConst(Rn.CInt(D*B|0))}else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);break;case 3:if(0==I[1])if(3==I[2][1]){var V=P[2][2],O=I[2][2];r=gn.TConst(Rn.CFloat(V*O))}else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 2:var F=T.e,L=j.e;if(0==L[1])switch(L[2][1]){case 2:if(0==F[1])if(2==F[2][1]){var G=L[2][2],N=F[2][2];r=gn.TConst(Rn.CInt(G/N|0))}else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);break;case 3:if(0==F[1])if(3==F[2][1]){var z=L[2][2],q=F[2][2];r=gn.TConst(Rn.CFloat(z/q))}else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 3:var U=T.e,Y=j.e;if(0==Y[1])switch(Y[2][1]){case 2:if(0==U[1])if(2==U[2][1]){var W=Y[2][2],H=U[2][2];r=gn.TConst(Rn.CInt(W-H|0))}else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);break;case 3:if(0==U[1])if(3==U[2][1]){var X=Y[2][2],Z=U[2][2];r=gn.TConst(Rn.CFloat(X-Z))}else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 5:var K=T.e,$=j.e;if(0==$[1])switch($[2][1]){case 0:r=0==K[1]?0==K[2][1]?gn.TConst(Rn.CBool(!0)):gn.TConst(Rn.CBool(!1)):gn.TBinop(w,j,T);break;case 1:if(0==K[1])switch(K[2][1]){case 0:r=gn.TConst(Rn.CBool(!1));break;case 1:var Q=$[2][2],J=K[2][2];r=gn.TConst(Rn.CBool(0==(Q==J?0:1)));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 2:if(0==K[1])switch(K[2][1]){case 0:r=gn.TConst(Rn.CBool(!1));break;case 2:var tt=$[2][2],et=K[2][2];r=gn.TConst(Rn.CBool(tt-et==0));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 3:if(0==K[1])switch(K[2][1]){case 0:r=gn.TConst(Rn.CBool(!1));break;case 3:var rt=$[2][2],it=K[2][2];r=gn.TConst(Rn.CBool(0==(rt>it?1:rt==it?0:-1)));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 4:if(0==K[1])switch(K[2][1]){case 0:r=gn.TConst(Rn.CBool(!1));break;case 4:var nt=$[2][2],at=K[2][2];r=gn.TConst(Rn.CBool(0==(nt>at?1:nt==at?0:-1)));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 6:var st=T.e,ot=j.e;if(0==ot[1])switch(ot[2][1]){case 0:r=0==st[1]?0==st[2][1]?gn.TConst(Rn.CBool(!1)):gn.TConst(Rn.CBool(!0)):gn.TBinop(w,j,T);break;case 1:if(0==st[1])switch(st[2][1]){case 0:r=gn.TConst(Rn.CBool(!0));break;case 1:var ht=ot[2][2],lt=st[2][2];r=gn.TConst(Rn.CBool(0!=(ht==lt?0:1)));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 2:if(0==st[1])switch(st[2][1]){case 0:r=gn.TConst(Rn.CBool(!0));break;case 2:var ut=ot[2][2],Rt=st[2][2];r=gn.TConst(Rn.CBool(ut-Rt!=0));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 3:if(0==st[1])switch(st[2][1]){case 0:r=gn.TConst(Rn.CBool(!0));break;case 3:var ct=ot[2][2],_t=st[2][2];r=gn.TConst(Rn.CBool(0!=(ct>_t?1:ct==_t?0:-1)));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 4:if(0==st[1])switch(st[2][1]){case 0:r=gn.TConst(Rn.CBool(!0));break;case 4:
var ft=ot[2][2],gt=st[2][2];r=gn.TConst(Rn.CBool(0!=(ft>gt?1:ft==gt?0:-1)));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 7:var pt=T.e,dt=j.e;if(0==dt[1])switch(dt[2][1]){case 0:r=0==pt[1]?0==pt[2][1]?gn.TConst(Rn.CBool(!1)):gn.TConst(Rn.CBool(!1)):gn.TBinop(w,j,T);break;case 1:if(0==pt[1])switch(pt[2][1]){case 0:r=gn.TConst(Rn.CBool(!0));break;case 1:var vt=dt[2][2],mt=pt[2][2];r=gn.TConst(Rn.CBool((vt==mt?0:1)>0));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 2:if(0==pt[1])switch(pt[2][1]){case 0:r=gn.TConst(Rn.CBool(!0));break;case 2:var yt=dt[2][2],xt=pt[2][2];r=gn.TConst(Rn.CBool(yt-xt>0));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 3:if(0==pt[1])switch(pt[2][1]){case 0:r=gn.TConst(Rn.CBool(!0));break;case 3:var bt=dt[2][2],wt=pt[2][2];r=gn.TConst(Rn.CBool((bt>wt?1:bt==wt?0:-1)>0));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 4:if(0==pt[1])switch(pt[2][1]){case 0:r=gn.TConst(Rn.CBool(!0));break;case 4:var jt=dt[2][2],Tt=pt[2][2];r=gn.TConst(Rn.CBool((jt>Tt?1:jt==Tt?0:-1)>0));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 8:var St=T.e,Ct=j.e;if(0==Ct[1])switch(Ct[2][1]){case 0:r=0==St[1]?0==St[2][1]?gn.TConst(Rn.CBool(!0)):gn.TConst(Rn.CBool(!1)):gn.TBinop(w,j,T);break;case 1:if(0==St[1])switch(St[2][1]){case 0:r=gn.TConst(Rn.CBool(!0));break;case 1:var Mt=Ct[2][2],kt=St[2][2];r=gn.TConst(Rn.CBool((Mt==kt?0:1)>=0));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 2:if(0==St[1])switch(St[2][1]){case 0:r=gn.TConst(Rn.CBool(!0));break;case 2:var Et=Ct[2][2],At=St[2][2];r=gn.TConst(Rn.CBool(Et-At>=0));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 3:if(0==St[1])switch(St[2][1]){case 0:r=gn.TConst(Rn.CBool(!0));break;case 3:var It=Ct[2][2],Pt=St[2][2];r=gn.TConst(Rn.CBool((It>Pt?1:It==Pt?0:-1)>=0));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 4:if(0==St[1])switch(St[2][1]){case 0:r=gn.TConst(Rn.CBool(!0));break;case 4:var Dt=Ct[2][2],Bt=St[2][2];r=gn.TConst(Rn.CBool((Dt>Bt?1:Dt==Bt?0:-1)>=0));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 9:var Vt=T.e,Ot=j.e;if(0==Ot[1])switch(Ot[2][1]){case 0:r=0==Vt[1]?0==Vt[2][1]?gn.TConst(Rn.CBool(!1)):gn.TConst(Rn.CBool(!0)):gn.TBinop(w,j,T);break;case 1:if(0==Vt[1])switch(Vt[2][1]){case 0:r=gn.TConst(Rn.CBool(!1));break;case 1:var Ft=Ot[2][2],Lt=Vt[2][2];r=gn.TConst(Rn.CBool((Ft==Lt?0:1)<0));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 2:if(0==Vt[1])switch(Vt[2][1]){case 0:r=gn.TConst(Rn.CBool(!1));break;case 2:var Gt=Ot[2][2],Nt=Vt[2][2];r=gn.TConst(Rn.CBool(Gt-Nt<0));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 3:if(0==Vt[1])switch(Vt[2][1]){case 0:r=gn.TConst(Rn.CBool(!1));break;case 3:var zt=Ot[2][2],qt=Vt[2][2];r=gn.TConst(Rn.CBool((zt>qt?1:zt==qt?0:-1)<0));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 4:if(0==Vt[1])switch(Vt[2][1]){case 0:r=gn.TConst(Rn.CBool(!1));break;case 4:var Ut=Ot[2][2],Yt=Vt[2][2];r=gn.TConst(Rn.CBool((Ut>Yt?1:Ut==Yt?0:-1)<0));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 10:var Wt=T.e,Ht=j.e;if(0==Ht[1])switch(Ht[2][1]){case 0:r=0==Wt[1]?0==Wt[2][1]?gn.TConst(Rn.CBool(!0)):gn.TConst(Rn.CBool(!0)):gn.TBinop(w,j,T);break;case 1:if(0==Wt[1])switch(Wt[2][1]){case 0:r=gn.TConst(Rn.CBool(!1));break;case 1:var Xt=Ht[2][2],Zt=Wt[2][2];r=gn.TConst(Rn.CBool((Xt==Zt?0:1)<=0));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 2:if(0==Wt[1])switch(Wt[2][1]){case 0:r=gn.TConst(Rn.CBool(!1));break;case 2:var Kt=Ht[2][2],$t=Wt[2][2];r=gn.TConst(Rn.CBool(Kt-$t<=0));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 3:if(0==Wt[1])switch(Wt[2][1]){case 0:r=gn.TConst(Rn.CBool(!1));break;case 3:var Qt=Ht[2][2],Jt=Wt[2][2];r=gn.TConst(Rn.CBool((Qt>Jt?1:Qt==Jt?0:-1)<=0));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 4:if(0==Wt[1])switch(Wt[2][1]){case 0:r=gn.TConst(Rn.CBool(!1));break;case 4:var te=Ht[2][2],ee=Wt[2][2];r=gn.TConst(Rn.CBool((te>ee?1:te==ee?0:-1)<=0));break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 11:var re=T.e,ie=j.e;if(0==ie[1])if(2==ie[2][1])if(0==re[1])if(2==re[2][1]){var ne=ie[2][2],ae=re[2][2];r=gn.TConst(Rn.CInt(ne&ae))}else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);break;case 12:var se=T.e,oe=j.e;if(0==oe[1])if(2==oe[2][1])if(0==se[1])if(2==se[2][1]){var he=oe[2][2],le=se[2][2];r=gn.TConst(Rn.CInt(he|le))}else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);break;case 13:var ue=T.e,Re=j.e;if(0==Re[1])if(2==Re[2][1])if(0==ue[1])if(2==ue[2][1]){var ce=Re[2][2],_e=ue[2][2];r=gn.TConst(Rn.CInt(ce^_e))}else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);break;case 14:var fe=T.e,ge=j.e;if(0==ge[1])if(1==ge[2][1])if(0==fe[1])if(1==fe[2][1]){var pe=ge[2][2],de=fe[2][2];r=gn.TConst(Rn.CBool(pe&&de))}else{var ve=ge[2][2];r=0==ve?gn.TConst(Rn.CBool(ve)):T.e}else{var me=ge[2][2];r=0==me?gn.TConst(Rn.CBool(me)):T.e}else if(0==fe[1])if(1==fe[2][1]){var ye=fe[2][2];r=0==ye?gn.TConst(Rn.CBool(ye)):j.e}else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);else if(0==fe[1])if(1==fe[2][1]){var xe=fe[2][2];r=0==xe?gn.TConst(Rn.CBool(xe)):j.e}else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);break;case 15:var be=T.e,we=j.e;if(0==we[1])if(1==we[2][1])if(0==be[1])if(1==be[2][1]){var je=we[2][2],Te=be[2][2];r=gn.TConst(Rn.CBool(je||Te))}else{var Se=we[2][2];r=1==Se?gn.TConst(Rn.CBool(Se)):T.e}else{var Ce=we[2][2];r=1==Ce?gn.TConst(Rn.CBool(Ce)):T.e}else if(0==be[1])if(1==be[2][1]){var Me=be[2][2];r=1==Me?gn.TConst(Rn.CBool(Me)):j.e}else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);else if(0==be[1])if(1==be[2][1]){var ke=be[2][2];r=1==ke?gn.TConst(Rn.CBool(ke)):j.e}else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);break;case 16:var Ee=T.e,Ae=j.e;if(0==Ae[1])if(2==Ae[2][1])if(0==Ee[1])if(2==Ee[2][1]){var Ie=Ae[2][2],Pe=Ee[2][2];r=gn.TConst(Rn.CInt(Ie<<Pe))}else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);break;case 17:var De=T.e,Be=j.e;if(0==Be[1])if(2==Be[2][1])if(0==De[1])if(2==De[2][1]){var Ve=Be[2][2],Oe=De[2][2];r=gn.TConst(Rn.CInt(Ve>>Oe))}else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);break;case 18:var Fe=T.e,Le=j.e;if(0==Le[1])if(2==Le[2][1])if(0==Fe[1])if(2==Fe[2][1]){var Ge=Le[2][2],Ne=Fe[2][2];r=gn.TConst(Rn.CInt(Ge>>>Ne))}else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);break;case 19:var ze=T.e,qe=j.e;if(0==qe[1])switch(qe[2][1]){case 2:if(0==ze[1])if(2==ze[2][1]){var Ue=qe[2][2],Ye=ze[2][2];r=gn.TConst(Rn.CInt(Ue%Ye|0))}else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);break;case 3:if(0==ze[1])if(3==ze[2][1]){var We=qe[2][2],He=ze[2][2];r=gn.TConst(Rn.CFloat(We%He))}else r=gn.TBinop(w,j,T);else r=gn.TBinop(w,j,T);break;default:r=gn.TBinop(w,j,T)}else r=gn.TBinop(w,j,T);break;case 4:case 20:case 21:r=gn.TBinop(w,j,T);break;case 22:throw new Zn("assert")}break;case 6:var Xe=n[3],Ze=n[2],Ke=this.evalExpr(Xe),$e=Ke.e;if(0==$e[1]){var Qe=$e[2];switch(Ze[1]){case 2:if(1==Qe[1]){var Je=Qe[2];r=gn.TConst(Rn.CBool(!Je))}else r=gn.TUnop(Ze,Ke);break;case 3:switch(Qe[1]){case 2:var tr=Qe[2];r=gn.TConst(Rn.CInt(-tr));break;case 3:var er=Qe[2];r=gn.TConst(Rn.CFloat(-er));break;default:r=gn.TUnop(Ze,Ke)}break;default:r=gn.TUnop(Ze,Ke)}}else r=gn.TUnop(Ze,Ke);break;case 7:var rr=n[3],ir=n[2];r=gn.TVarDecl(this.mapVar(ir),null==rr?null:this.evalExpr(rr));break;case 8:for(var nr=n[3],ar=n[2],sr=this.evalExpr(ar),or=[],hr=0;hr<nr.length;){var lr=nr[hr];++hr,or.push(this.evalExpr(lr))}var ur=or,Rr=sr.e;switch(Rr[1]){case 1:if(this.inlineCalls){var cr=Rr[2];if(this.funMap.exists(cr)){for(var _r=this.funMap.get(cr),fr=[],gr=[],pr=0,dr=_r.args.length;pr<dr;){var vr=pr++,mr=[_r.args[vr]],yr=ur[vr],xr=yr.e;switch(xr[1]){case 0:var br=[this.constants.get(mr[0].id)];gr.push(function(t,e){return function(){null==t[0]?i.constants.remove(e[0].id):i.constants.set(e[0].id,t[0])}}(br,mr)),this.constants.set(mr[0].id,yr.e);break;case 1:switch(xr[2].kind[1]){case 0:case 1:case 2:var wr=[this.constants.get(mr[0].id)];gr.push(function(t,e){return function(){null==t[0]?i.constants.remove(e[0].id):i.constants.set(e[0].id,t[0])}}(wr,mr)),this.constants.set(mr[0].id,yr.e);break;default:var jr=[this.varMap.get(mr[0])];null==jr[0]?gr.push(function(t){return function(){i.varMap.remove(t[0])}}(mr)):(this.varMap.remove(mr[0]),gr.push(function(t,e){return function(){i.varMap.set(e[0],t[0])}}(jr,mr)));var Tr=this.mapVar(mr[0]);fr.push({e:gn.TVarDecl(Tr,yr),t:nn.TVoid,p:yr.p})}break;default:var Sr=[this.varMap.get(mr[0])];null==Sr[0]?gr.push(function(t){return function(){i.varMap.remove(t[0])}}(mr)):(this.varMap.remove(mr[0]),gr.push(function(t,e){return function(){i.varMap.set(e[0],t[0])}}(Sr,mr)));var Cr=this.mapVar(mr[0]);fr.push({e:gn.TVarDecl(Cr,yr),t:nn.TVoid,p:yr.p})}}for(var Mr=this.handleReturn(this.evalExpr(_r.expr,!1),!0),kr=0;kr<gr.length;){var Er=gr[kr];++kr,Er()}var Ar=Mr.e;if(4==Ar[1])for(var Ir=Ar[2],Pr=0;Pr<Ir.length;){var Dr=Ir[Pr];++Pr,fr.push(Dr)}else fr.push(Mr);r=gn.TBlock(fr)}else r=on.t("Cannot eval non-static call expresssion '"+(new Vn).exprString(sr)+"'",sr.p)}else r=gn.TCall(sr,ur);break;case 2:var Br=Rr[2],Vr=this.evalCall(Br,ur,nr,t.p);r=null!=Vr?Vr:gn.TCall(sr,ur);break;default:r=on.t("Cannot eval non-static call expresssion '"+(new Vn).exprString(sr)+"'",sr.p)}break;case 9:var Or=n[3],Fr=n[2];r=gn.TSwiz(this.evalExpr(Fr),Or.slice());break;case 10:var Lr=n[4],Gr=n[3],Nr=n[2],zr=this.evalExpr(Nr),qr=zr.e;if(0==qr[1])if(1==qr[2][1]){var Ur=qr[2][2];r=Ur?this.evalExpr(Gr,e).e:null==Lr?gn.TConst(Rn.CNull):this.evalExpr(Lr,e).e}else r=e&&null!=Lr&&this.eliminateConditionals?gn.TCall({e:gn.TGlobal(_n.Mix),t:t.t,p:t.p},[this.evalExpr(Lr,!0),this.evalExpr(Gr,!0),{e:gn.TCall({e:gn.TGlobal(_n.ToFloat),t:nn.TFun([]),p:zr.p},[zr]),t:nn.TFloat,p:t.p}]):gn.TIf(zr,this.evalExpr(Gr,e),null==Lr?null:this.evalExpr(Lr,e));else r=e&&null!=Lr&&this.eliminateConditionals?gn.TCall({e:gn.TGlobal(_n.Mix),t:t.t,p:t.p},[this.evalExpr(Lr,!0),this.evalExpr(Gr,!0),{e:gn.TCall({e:gn.TGlobal(_n.ToFloat),t:nn.TFun([]),p:zr.p},[zr]),t:nn.TFloat,p:t.p}]):gn.TIf(zr,this.evalExpr(Gr,e),null==Lr?null:this.evalExpr(Lr,e));break;case 11:r=gn.TDiscard;break;case 12:var Yr=n[2];r=gn.TReturn(null==Yr?null:this.evalExpr(Yr));break;case 13:var Wr,Hr=n[4],Xr=n[3],Zr=n[2],Kr=this.mapVar(Zr),$r=this.evalExpr(Xr),Qr=$r.e;if(5==Qr[1])if(21==Qr[2][1])if(0==Qr[3].e[1])if(2==Qr[3].e[2][1])if(0==Qr[4].e[1])if(2==Qr[4].e[2][1]){var Jr=Qr[3].e[2][2],ti=Qr[4].e[2][2];if(this.unrollLoops){for(var ei=[],ri=Jr,ii=ti;ri<ii;){var ni=ri++;this.constants.set(Zr.id,gn.TConst(Rn.CInt(ni))),ei.push(this.evalExpr(Hr,!1))}this.constants.remove(Zr.id),Wr=gn.TBlock(ei)}else Wr=gn.TFor(Kr,$r,this.evalExpr(Hr,!1))}else Wr=gn.TFor(Kr,$r,this.evalExpr(Hr,!1));else Wr=gn.TFor(Kr,$r,this.evalExpr(Hr,!1));else Wr=gn.TFor(Kr,$r,this.evalExpr(Hr,!1));else Wr=gn.TFor(Kr,$r,this.evalExpr(Hr,!1));else Wr=gn.TFor(Kr,$r,this.evalExpr(Hr,!1));else Wr=gn.TFor(Kr,$r,this.evalExpr(Hr,!1));this.varMap.remove(Zr),r=Wr;break;case 14:r=gn.TContinue;break;case 15:r=gn.TBreak;break;case 16:var ai=n[3],si=n[2],oi=this.evalExpr(si),hi=this.evalExpr(ai),li=hi.e,ui=oi.e;if(17==ui[1])if(0==li[1])if(2==li[2][1]){var Ri=ui[2],ci=li[2][2];r=ci>=0&&ci<Ri.length?Ri[ci].e:gn.TArray(oi,hi)}else r=gn.TArray(oi,hi);else r=gn.TArray(oi,hi);else r=gn.TArray(oi,hi);break;case 17:for(var _i=n[2],fi=[],gi=0;gi<_i.length;){var pi=_i[gi];++gi,fi.push(this.evalExpr(pi))}r=gn.TArrayDecl(fi);break;case 18:for(var di=n[4],vi=n[3],mi=n[2],yi=this.evalExpr(mi),xi=[],bi=0;bi<vi.length;){var wi=vi[bi];++bi;for(var ji=[],Ti=0,Si=wi.values;Ti<Si.length;){var Ci=Si[Ti];++Ti,ji.push(this.evalExpr(Ci))}xi.push({values:ji,expr:this.evalExpr(wi.expr,e)})}var Mi=xi,ki=null==di?null:this.evalExpr(di,e),Ei=!1,Ai=yi.e;if(0==Ai[1]){var Ii=Ai[2];if(2!=Ii[1])throw new Zn("Unsupported switch constant "+g.string(Ii));for(var Pi=Ii[2],Di=0;Di<Mi.length;){var Bi=Mi[Di];++Di;for(var Vi=0,Oi=Bi.values;Vi<Oi.length;){var Fi=Oi[Vi];++Vi;var Li=Fi.e;if(0==Li[1]){var Gi=Li[2];switch(Gi[1]){case 2:var Ni=Gi[2];if(Ni==Pi)return Bi.expr;break;case 3:var zi=Gi[2];if(zi==Pi)return Bi.expr}}else Ei=!0}}}else Ei=!0;r=Ei?gn.TSwitch(yi,Mi,ki):null==ki?gn.TBlock([]):ki.e;break;case 19:var qi=n[4],Ui=n[3],Yi=n[2],Wi=this.evalExpr(Yi),Hi=this.evalExpr(Ui,!1);r=gn.TWhile(Wi,Hi,qi);break;case 20:var Xi,Zi=n[4],Ki=n[3],$i=n[2];if("unroll"==$i){this.unrollLoops;this.unrollLoops=!0,Xi=this.evalExpr(Zi,e),this.unrollLoops=!1}else Xi=this.evalExpr(Zi,e);r=gn.TMeta($i,Ki,Xi)}return{e:r,t:t.t,p:t.p}},__class__:Tn};var Sn=function(t,e,r,i){this.g=t,this.t=e,this.pos=r,this.size=i};a["hxsl._Flatten.Alloc"]=Sn,Sn.__name__=["hxsl","_Flatten","Alloc"],Sn.prototype={__class__:Sn};var Cn=a["hxsl.ARead"]={__ename__:!0,__constructs__:["AIndex","AOffset"]};Cn.AIndex=function(t){var e=["AIndex",0,t];return e.__enum__=Cn,e.toString=s,e},Cn.AOffset=function(t,e,r){var i=["AOffset",1,t,e,r];return i.__enum__=Cn,i.toString=s,i},Cn.__empty_constructs__=[];var Mn=function(){};a["hxsl.Flatten"]=Mn,Mn.__name__=["hxsl","Flatten"],Mn.prototype={flatten:function(t,e,r){if(this.globals=[],this.params=[],this.outVars=[],r){this.consts=[];var i=t.funs[0].expr.p,a={id:pn.allocVarId(),name:"__consts__",kind:hn.Global,type:null};this.econsts={e:gn.TVar(a),t:null,p:i};for(var s=t.name,o=t.vars.slice(),h=[],l=0,u=t.funs;l<u.length;){var R=u[l];++l,h.push(this.mapFun(R,n(this,this.mapConsts)))}t={name:s,vars:o,funs:h};for(var c=0,_=t.vars;c<_.length;){var f=_[c];++c;var g=f.type;9==g[1]&&this.allocConst(255,i)}this.consts.length>0&&(a.type=this.econsts.t=nn.TArray(nn.TFloat,sn.SConst(this.consts.length)),t.vars.push(a))}this.varMap=new wi,this.allocData=new wi;for(var p=0,d=t.vars;p<d.length;){var v=d[p];++p,this.gatherVar(v)}var m;switch(e[1]){case 0:m="vertex";break;case 1:m="fragment";break;default:throw new Zn("assert")}this.pack(m+"Globals",hn.Global,this.globals,an.VFloat),this.pack(m+"Params",hn.Param,this.params,an.VFloat);for(var y=this.globals.concat(this.params),x=this.packTextures(m+"Textures",y,nn.TSampler2D).concat(this.packTextures(m+"TexturesCube",y,nn.TSamplerCube)),b=[],w=0,j=t.funs;w<j.length;){var T=j[w];++w,b.push(this.mapFun(T,n(this,this.mapExpr)))}for(var S=b,C=0;C<x.length;){var M=x[C];++C,M.pos>>=2}return{name:t.name,vars:this.outVars,funs:S}},mapFun:function(t,e){return{kind:t.kind,ret:t.ret,args:t.args,ref:t.ref,expr:e(t.expr)}},mapExpr:function(t){var e=t.e;switch(e[1]){case 1:var r=e[2],i=this.varMap.get(r);t=null==i?t:this.access(i,r.type,t.p,Cn.AIndex(i));break;case 16:if(1==e[2].e[1]){var a=e[3],s=e[2].p,o=e[2].e[2],h=a.e;if(0!=h[1]||2!=h[2][1]){var l=this.varMap.get(o);if(null==l)t=t;else{var u=o.type;if(14!=u[1])throw new Zn("assert");var R=u[2],c=this.varSize(R,l.t);if(0==c||0!=(3&c))throw new Zn(new on("Dynamic access to an Array which size is not 4 components-aligned is not allowed",t.p));c>>=2,a=this.mapExpr(a);var _={e:gn.TCall({e:gn.TGlobal(_n.ToInt),t:nn.TFun([]),p:s},[a]),t:nn.TInt,p:s};t=this.access(l,R,s,Cn.AOffset(l,c,1==c?_:{e:gn.TBinop(Ei.OpMult,_,{e:gn.TConst(Rn.CInt(c)),t:nn.TInt,p:s}),t:nn.TInt,p:s}))}}else t=pn.map(t,n(this,this.mapExpr))}else t=pn.map(t,n(this,this.mapExpr));break;default:t=pn.map(t,n(this,this.mapExpr))}return this.optimize(t)},mapConsts:function(t){var e=t.e;switch(e[1]){case 0:var r=e[2];switch(r[1]){case 2:var i=r[2];return this.allocConst(i,t.p);case 3:var a=r[2];return this.allocConst(a,t.p);default:return t}break;case 2:var s=e[2];switch(s[1]){case 0:this.allocConst(Math.PI/180,t.p);break;case 1:this.allocConst(180/Math.PI,t.p);break;case 9:this.allocConst(1.4426950408889634,t.p);break;case 10:this.allocConst(.6931471805599453,t.p);break;case 24:this.allocConst(1,t.p);break;case 52:this.allocConsts([1,255,65025,16581375],t.p),this.allocConsts([.00392156862745098,.00392156862745098,.00392156862745098,0],t.p);break;case 53:this.allocConsts([1,.00392156862745098,15378700499807768e-21,6.030862941101084e-8],t.p);break;case 54:this.allocConst(1,t.p),this.allocConst(.5,t.p);break;case 55:this.allocConst(.5,t.p)}break;case 5:1==e[2][1]&&8==e[4].t[1]&&this.allocConst(1,t.p);break;case 8:if(2==e[2].e[1]&&40==e[2].e[2][1]&&2==e[3].length&&1==e[3][0].e[1])switch(e[3][0].e[2].kind[1]){case 0:if(5==e[3][0].t[1]&&3==e[3][0].t[2]&&1==e[3][0].t[3][1]&&0==e[3][1].e[1]&&2==e[3][1].e[2][1]&&1==e[3][1].e[2][2])return t;break;case 1:if(5==e[3][0].t[1]&&3==e[3][0].t[2]&&1==e[3][0].t[3][1]&&0==e[3][1].e[1]&&2==e[3][1].e[2][1]&&1==e[3][1].e[2][2])return t;break;case 2:if(5==e[3][0].t[1]&&3==e[3][0].t[2]&&1==e[3][0].t[3][1]&&0==e[3][1].e[1]&&2==e[3][1].e[2][1]&&1==e[3][1].e[2][2])return t;break;case 3:if(5==e[3][0].t[1]&&3==e[3][0].t[2]&&1==e[3][0].t[3][1]&&0==e[3][1].e[1]&&2==e[3][1].e[2][1]&&1==e[3][1].e[2][2])return t}break;case 16:if(0==e[3].e[1]){if(2==e[3].e[2][1]){var o=e[2],h=e[3];return{e:gn.TArray(this.mapConsts(o),h),t:t.t,p:t.p}}var l=e[2],u=(e[3],l.t);if(14==u[1]){var R=u[2],c=this.varSize(R,an.VFloat)>>2;this.allocConst(c,t.p)}}else{var _=e[2],f=(e[3],_.t);if(14==f[1]){var g=f[2],p=this.varSize(g,an.VFloat)>>2;this.allocConst(p,t.p)}}}return pn.map(t,n(this,this.mapConsts))},allocConst:function(t,e){var r=this.consts.indexOf(t);return r<0&&(r=this.consts.length,this.consts.push(t)),{e:gn.TArray(this.econsts,{e:gn.TConst(Rn.CInt(r)),t:nn.TInt,p:e}),t:nn.TFloat,p:e}},allocConsts:function(t,e){for(var r=this,i=t.length-1&3,n=-1,a=0,s=this.consts.length-(t.length-1);a<s;){var o=a++;if(o>>2==o+i>>2){for(var h=!0,l=0,u=t.length;l<u;){var R=l++;if(this.consts[o+R]!=t[R]){h=!1;break}}if(h){n=o;break}}}if(n<0){for(;this.consts.length>>2!=this.consts.length+i>>2;)this.consts.push(0);n=this.consts.length;for(var c=0;c<t.length;){var _=t[c];++c,this.consts.push(_)}}var f=t.length;switch(f){case 1:return{e:gn.TArray(r.econsts,{e:gn.TConst(Rn.CInt(n)),t:nn.TInt,p:e}),t:nn.TFloat,p:e};case 2:return{e:gn.TCall({e:gn.TGlobal(_n.Vec2),t:nn.TVoid,p:e},[{e:gn.TArray(r.econsts,{e:gn.TConst(Rn.CInt(n)),t:nn.TInt,p:e}),t:nn.TFloat,p:e},{e:gn.TArray(r.econsts,{e:gn.TConst(Rn.CInt(n+1)),t:nn.TInt,p:e}),t:nn.TFloat,p:e}]),t:nn.TVec(2,an.VFloat),p:e};case 3:return{e:gn.TCall({e:gn.TGlobal(_n.Vec3),t:nn.TVoid,p:e},[{e:gn.TArray(r.econsts,{e:gn.TConst(Rn.CInt(n)),t:nn.TInt,p:e}),t:nn.TFloat,p:e},{e:gn.TArray(r.econsts,{e:gn.TConst(Rn.CInt(n+1)),t:nn.TInt,p:e}),t:nn.TFloat,p:e},{e:gn.TArray(r.econsts,{e:gn.TConst(Rn.CInt(n+2)),t:nn.TInt,p:e}),t:nn.TFloat,p:e}]),t:nn.TVec(3,an.VFloat),p:e};case 4:return{e:gn.TCall({e:gn.TGlobal(_n.Vec4),t:nn.TVoid,p:e},[{e:gn.TArray(r.econsts,{e:gn.TConst(Rn.CInt(n)),t:nn.TInt,p:e}),t:nn.TFloat,p:e},{e:gn.TArray(r.econsts,{e:gn.TConst(Rn.CInt(n+1)),t:nn.TInt,p:e}),t:nn.TFloat,p:e},{e:gn.TArray(r.econsts,{e:gn.TConst(Rn.CInt(n+3)),t:nn.TInt,p:e}),t:nn.TFloat,p:e},{e:gn.TArray(r.econsts,{e:gn.TConst(Rn.CInt(n+4)),t:nn.TInt,p:e}),t:nn.TFloat,p:e}]),t:nn.TVec(4,an.VFloat),p:e};default:throw new Zn("assert")}},access:function(t,e,r,i){switch(e[1]){case 6:var n=this.access(t,nn.TMat3x4,r,i);return{e:gn.TCall({e:gn.TGlobal(_n.Mat3),t:nn.TFun([]),p:r},[n]),t:nn.TMat3,p:r};case 7:var a,s=gn.TGlobal(_n.Mat4),o=nn.TFun([]);switch(i[1]){case 0:var h=i[2];a={e:gn.TArray({e:gn.TVar(h.g),t:h.g.type,p:r},{e:gn.TConst(Rn.CInt(h.pos>>2)),t:nn.TInt,p:r}),t:nn.TVec(4,h.t),p:r};break;case 1:var l=i[4],u=(i[3],i[2]),R=u.pos>>2,c=0==R?l:{e:gn.TBinop(Ei.OpAdd,l,{e:gn.TConst(Rn.CInt(R)),t:nn.TInt,p:r}),t:nn.TInt,p:r};a={e:gn.TArray({e:gn.TVar(u.g),t:u.g.type,p:r},c),t:nn.TVec(4,u.t),p:r}}var _;switch(i[1]){case 0:var f=i[2];_={e:gn.TArray({e:gn.TVar(f.g),t:f.g.type,p:r},{e:gn.TConst(Rn.CInt((f.pos>>2)+1)),t:nn.TInt,p:r}),t:nn.TVec(4,f.t),p:r};break;case 1:var g=i[4],p=(i[3],i[2]),d=(p.pos>>2)+1,v=0==d?g:{e:gn.TBinop(Ei.OpAdd,g,{e:gn.TConst(Rn.CInt(d)),t:nn.TInt,p:r}),t:nn.TInt,p:r};_={e:gn.TArray({e:gn.TVar(p.g),t:p.g.type,p:r},v),t:nn.TVec(4,p.t),p:r}}var m;switch(i[1]){case 0:var y=i[2];m={e:gn.TArray({e:gn.TVar(y.g),t:y.g.type,p:r},{e:gn.TConst(Rn.CInt((y.pos>>2)+2)),t:nn.TInt,p:r}),t:nn.TVec(4,y.t),p:r};break;case 1:var x=i[4],b=(i[3],i[2]),w=(b.pos>>2)+2,j=0==w?x:{e:gn.TBinop(Ei.OpAdd,x,{e:gn.TConst(Rn.CInt(w)),t:nn.TInt,p:r}),t:nn.TInt,p:r};m={e:gn.TArray({e:gn.TVar(b.g),t:b.g.type,p:r},j),t:nn.TVec(4,b.t),p:r}}var T;switch(i[1]){case 0:var S=i[2];T={e:gn.TArray({e:gn.TVar(S.g),t:S.g.type,p:r},{e:gn.TConst(Rn.CInt((S.pos>>2)+3)),t:nn.TInt,p:r}),t:nn.TVec(4,S.t),p:r};break;case 1:var C=i[4],M=(i[3],i[2]),k=(M.pos>>2)+3,E=0==k?C:{e:gn.TBinop(Ei.OpAdd,C,{e:gn.TConst(Rn.CInt(k)),t:nn.TInt,p:r}),t:nn.TInt,p:r};T={e:gn.TArray({e:gn.TVar(M.g),t:M.g.type,p:r},E),t:nn.TVec(4,M.t),p:r}}return{e:gn.TCall({e:s,t:o,p:r},[a,_,m,T]),t:nn.TMat4,p:r};case 8:var A,I=gn.TGlobal(_n.Mat3x4),P=nn.TFun([]);switch(i[1]){case 0:var D=i[2];A={e:gn.TArray({e:gn.TVar(D.g),t:D.g.type,p:r},{e:gn.TConst(Rn.CInt(D.pos>>2)),t:nn.TInt,p:r}),t:nn.TVec(4,D.t),p:r};break;case 1:var B=i[4],V=(i[3],i[2]),O=V.pos>>2,F=0==O?B:{e:gn.TBinop(Ei.OpAdd,B,{e:gn.TConst(Rn.CInt(O)),t:nn.TInt,p:r}),t:nn.TInt,p:r};A={e:gn.TArray({e:gn.TVar(V.g),t:V.g.type,p:r},F),t:nn.TVec(4,V.t),p:r}}var L;switch(i[1]){case 0:var G=i[2];L={e:gn.TArray({e:gn.TVar(G.g),t:G.g.type,p:r},{e:gn.TConst(Rn.CInt((G.pos>>2)+1)),t:nn.TInt,p:r}),t:nn.TVec(4,G.t),p:r};break;case 1:var N=i[4],z=(i[3],i[2]),q=(z.pos>>2)+1,U=0==q?N:{e:gn.TBinop(Ei.OpAdd,N,{e:gn.TConst(Rn.CInt(q)),t:nn.TInt,p:r}),t:nn.TInt,p:r};L={e:gn.TArray({e:gn.TVar(z.g),t:z.g.type,p:r},U),t:nn.TVec(4,z.t),p:r}}var Y;switch(i[1]){case 0:var W=i[2];Y={e:gn.TArray({e:gn.TVar(W.g),t:W.g.type,p:r},{e:gn.TConst(Rn.CInt((W.pos>>2)+2)),t:nn.TInt,p:r}),t:nn.TVec(4,W.t),p:r};break;case 1:var H=i[4],X=(i[3],i[2]),Z=(X.pos>>2)+2,K=0==Z?H:{e:gn.TBinop(Ei.OpAdd,H,{e:gn.TConst(Rn.CInt(Z)),t:nn.TInt,p:r}),t:nn.TInt,p:r};Y={e:gn.TArray({e:gn.TVar(X.g),t:X.g.type,p:r},K),t:nn.TVec(4,X.t),p:r}}return{e:gn.TCall({e:I,t:P,p:r},[A,L,Y]),t:nn.TMat3x4,p:r};case 10:case 11:case 15:switch(i[1]){case 0:var $=i[2];return{e:gn.TArray({e:gn.TVar($.g),t:$.g.type,p:r},{e:gn.TConst(Rn.CInt($.pos>>2)),t:nn.TInt,p:r}),t:nn.TVec(4,$.t),p:r};case 1:var Q=i[4],J=(i[3],i[2]),tt=J.pos>>2,et=0==tt?Q:{e:gn.TBinop(Ei.OpAdd,Q,{e:gn.TConst(Rn.CInt(tt)),t:nn.TInt,p:r}),t:nn.TInt,p:r};return{e:gn.TArray({e:gn.TVar(J.g),t:J.g.type,p:r},et),t:nn.TVec(4,J.t),p:r}}break;case 14:if(0==e[3][1]){for(var rt=e[2],it=e[3][2],nt=t.size/it|0,at=[],st=0,ot=it;st<ot;){var ht=st++,lt=new Sn(t.g,t.t,t.pos+nt*ht,nt);at.push(this.access(lt,rt,r,Cn.AIndex(lt)))}var ut=at;return{e:gn.TArrayDecl(ut),t:rt,p:r}}var Rt=this.varSize(e,t.t);if(Rt<=4){var ct;switch(i[1]){case 0:var _t=i[2];ct={e:gn.TArray({e:gn.TVar(_t.g),t:_t.g.type,p:r},{e:gn.TConst(Rn.CInt(_t.pos>>2)),t:nn.TInt,p:r}),t:nn.TVec(4,_t.t),p:r};break;case 1:var ft=i[4],gt=(i[3],i[2]),pt=gt.pos>>2,dt=0==pt?ft:{e:gn.TBinop(Ei.OpAdd,ft,{e:gn.TConst(Rn.CInt(pt)),t:nn.TInt,p:r}),t:nn.TInt,p:r};ct={e:gn.TArray({e:gn.TVar(gt.g),t:gt.g.type,p:r},dt),t:nn.TVec(4,gt.t),p:r}}if(4==Rt){if(0!=(3&t.pos))throw new Zn("assert");return ct}for(var vt=[],mt=0,yt=Rt;mt<yt;){var xt=mt++;vt.push(pn.SWIZ[xt+(3&t.pos)])}return{e:gn.TSwiz(ct,vt),t:e,p:r}}return on.t("Access not supported for "+pn.toString(e),null);default:var bt=this.varSize(e,t.t);if(bt<=4){var wt;switch(i[1]){case 0:var jt=i[2];wt={e:gn.TArray({e:gn.TVar(jt.g),t:jt.g.type,p:r},{e:gn.TConst(Rn.CInt(jt.pos>>2)),t:nn.TInt,p:r}),t:nn.TVec(4,jt.t),p:r};break;case 1:var Tt=i[4],St=(i[3],i[2]),Ct=St.pos>>2,Mt=0==Ct?Tt:{e:gn.TBinop(Ei.OpAdd,Tt,{e:gn.TConst(Rn.CInt(Ct)),t:nn.TInt,p:r}),t:nn.TInt,p:r};wt={e:gn.TArray({e:gn.TVar(St.g),t:St.g.type,p:r},Mt),t:nn.TVec(4,St.t),p:r}}if(4==bt){if(0!=(3&t.pos))throw new Zn("assert");return wt}for(var kt=[],Et=0,At=bt;Et<At;){var It=Et++;kt.push(pn.SWIZ[It+(3&t.pos)])}return{e:gn.TSwiz(wt,kt),t:e,p:r}}return on.t("Access not supported for "+pn.toString(e),null)}},optimize:function(t){var e=t.e;switch(e[1]){case 8:if(2==e[2].e[1]&&50==e[2].e[2][1]&&1==e[3].length&&8==e[3][0].e[1]&&2==e[3][0].e[2].e[1]&&49==e[3][0].e[2].e[2][1]){for(var r=e[3][0].e[3],i=0,n=0;n<4;){var a=r[r.length-1-i].t;n+=this.varSize(a,an.VFloat),++i}if(4==n){for(var s=0,o=i;s<o;){s++;r.pop()}var h,l=t.e;if(8!=l[1])throw new Zn("assert");var u=l[2];return h=u,{e:gn.TCall(h,r),t:t.t,p:t.p}}}break;case 16:if(17==e[2].e[1]&&0==e[3].e[1]&&2==e[3].e[2][1]){var R=e[2].e[2],c=e[3].e[2][2];if(c>=0&&c<R.length)return R[c];on.t("Reading outside array bounds",t.p)}}return t},packTextures:function(t,e,r){for(var i=[],n={id:pn.allocVarId(),name:t,type:r,kind:hn.Param},a=0;a<e.length;){var s=e[a];if(++a,s.type!=r){var o;if(r==nn.TSampler2D){var h=s.type;o=15==h[1]}else o=!1;if(!o)continue}var l=new Sn(n,null,i.length<<2,1);l.v=s,this.varMap.set(s,l),i.push(l)}return n.type=nn.TArray(r,sn.SConst(i.length)),i.length>0&&(this.outVars.push(n),this.allocData.set(n,i)),i},pack:function(t,e,r,i){for(var n=[],a=0,s={id:pn.allocVarId(),name:t,type:nn.TVec(0,i),kind:e},o=0;o<r.length;){var l=r[o];++o;var u=l.type;switch(u[1]){case 10:case 11:case 15:continue}for(var R=this.varSize(l.type,i),c=null,_=0;_<n.length;){var f=n[_];++_,null==f.v&&f.size>=R&&(null==c||c.size>f.size)&&(c=f)}if(null!=c){var g=c.size-R;if(g>0){var p=h.indexOf(n,c),d=new Sn(s,i,c.pos+R,g);n.splice(p+1,0,d),c.size=R}c.v=l,this.varMap.set(l,c)}else{var v=new Sn(s,i,a,R);a+=R,v.v=l,this.varMap.set(l,v),n.push(v);var m=(4-R%4)%4;if(m>0){var y=new Sn(s,i,a,m);a+=m,n.push(y)}}}return s.type=nn.TArray(nn.TVec(4,i),sn.SConst(a>>2)),a>0&&(this.outVars.push(s),this.allocData.set(s,n)),s},varSize:function(t,e){switch(t[1]){case 3:if(e==an.VFloat)return 1;throw new Zn(pn.toString(t)+" size unknown for type "+g.string(e));case 5:var r=t[3],i=t[2];if(e==r)return i;throw new Zn(pn.toString(t)+" size unknown for type "+g.string(e));case 7:if(e==an.VFloat)return 16;throw new Zn(pn.toString(t)+" size unknown for type "+g.string(e));case 6:case 8:if(e==an.VFloat)return 12;throw new Zn(pn.toString(t)+" size unknown for type "+g.string(e));case 14:if(0==t[3][1]){var n=t[2],a=t[3][2];return this.varSize(n,e)*a}throw new Zn(pn.toString(t)+" size unknown for type "+g.string(e));default:throw new Zn(pn.toString(t)+" size unknown for type "+g.string(e))}},gatherVar:function(t){var e=t.type;if(12==e[1])for(var r=e[2],i=0;i<r.length;){var n=r[i];++i,this.gatherVar(n)}else{var a=t.kind;switch(a[1]){case 0:pn.hasQualifier(t,ln.PerObject)?this.params.push(t):this.globals.push(t);break;case 2:this.params.push(t);break;default:this.outVars.push(t)}}},__class__:Mn};var kn=function(){this.channels=[],this.map=new bi};a["hxsl.Globals"]=kn,kn.__name__=["hxsl","Globals"],kn.allocID=function(t){null==kn.MAP&&(kn.MAP=new Ti,kn.ALL=[]);var e=kn.MAP,r=null!=_a[t]?e.getReserved(t):e.h[t];if(null==r){r=kn.ALL.length,kn.ALL.push(t);var i=kn.MAP;null!=_a[t]?i.setReserved(t,r):i.h[t]=r}return r},kn.prototype={set:function(t,e){var r=this.map,i=kn.allocID(t);r.h[i]=e},allocChannelID:function(t){for(var e=0,r=this.maxChannels;e<r;){var i=e++;if(this.channels[i]==t)return i}if(this.maxChannels==1<<pn.MAX_CHANNELS_BITS)throw new Zn("Too many unique channels");var n=this.maxChannels++;return this.channels[n]=t,n},__class__:kn};var En=function(){};a["js.Boot"]=En,En.__name__=["js","Boot"],En.__unhtml=function(t){return t.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;")},En.__trace=function(t,e){var r=null!=e?e.fileName+":"+e.lineNumber+": ":"";if(r+=En.__string_rec(t,""),null!=e&&null!=e.customParams)for(var i=0,n=e.customParams;i<n.length;){var a=n[i];++i,r+=","+En.__string_rec(a,"")}var s,o;"undefined"!=typeof document?(s=document.getElementById("haxe:trace"),o=null!=s):o=!1,o?s.innerHTML+=En.__unhtml(r)+"<br/>":"undefined"!=typeof console&&null!=console.log&&console.log(r)},En.getClass=function(t){if(t instanceof Array&&null==t.__enum__)return Array;var e=t.__class__;if(null!=e)return e;var r=En.__nativeClassName(t);return null!=r?En.__resolveNativeClass(r):null},En.__string_rec=function(t,e){if(null==t)return"null";if(e.length>=5)return"<...>";var r=typeof t;switch("function"==r&&(t.__name__||t.__ename__)&&(r="object"),r){case"function":return"<function>";case"object":if(t instanceof Array){if(t.__enum__){if(2==t.length)return t[0];var i=t[0]+"(";e+="\t";for(var n=2,a=t.length;n<a;){var s=n++;i+=2!=s?","+En.__string_rec(t[s],e):En.__string_rec(t[s],e)}return i+")"}var o=t.length,h="[";e+="\t";for(var l=0,u=o;l<u;){var R=l++;h+=(R>0?",":"")+En.__string_rec(t[R],e)}return h+="]"}var c;try{c=t.toString}catch(t){return"???"}if(null!=c&&c!=Object.toString&&"function"==typeof c){var _=t.toString();if("[object Object]"!=_)return _}var f=null,g="{\n";e+="\t";var p=null!=t.hasOwnProperty;for(var f in t)p&&!t.hasOwnProperty(f)||"prototype"!=f&&"__class__"!=f&&"__super__"!=f&&"__interfaces__"!=f&&"__properties__"!=f&&(2!=g.length&&(g+=", \n"),g+=e+f+" : "+En.__string_rec(t[f],e));return e=e.substring(1),g+="\n"+e+"}";case"string":return t;default:return String(t)}},En.__interfLoop=function(t,e){if(null==t)return!1;if(t==e)return!0;var r=t.__interfaces__;if(null!=r)for(var i=0,n=r.length;i<n;){var a=i++,s=r[a];if(s==e||En.__interfLoop(s,e))return!0}return En.__interfLoop(t.__super__,e)},En.__instanceof=function(t,e){if(null==e)return!1;switch(e){case Array:return t instanceof Array&&null==t.__enum__;case ua:return"boolean"==typeof t;case ha:return!0;case la:return"number"==typeof t;case oa:return"number"==typeof t&&(0|t)===t;case String:return"string"==typeof t;default:if(null==t)return!1;if("function"==typeof e){if(t instanceof e)return!0;if(En.__interfLoop(En.getClass(t),e))return!0}else if("object"==typeof e&&En.__isNativeObj(e)&&t instanceof e)return!0;return e==Ra&&null!=t.__name__||(e==ca&&null!=t.__ename__||t.__enum__==e)}},En.__nativeClassName=function(t){var e=En.__toStr.call(t).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},En.__isNativeObj=function(t){return null!=En.__nativeClassName(t)},En.__resolveNativeClass=function(e){return t[e]};var An=function(){this.exprIds=0,this.varNames=new bi,this.allNames=new Ti,this.flipY=!0};a["hxsl.GlslOut"]=An,An.__name__=["hxsl","GlslOut"],An.prototype={decl:function(t){for(var e=0,r=this.decls;e<r.length;){var i=r[e];if(++e,i==t)return}35==o.cca(t,0)?this.decls.unshift(t):this.decls.push(t)},addType:function(t){switch(t[1]){case 0:this.buf.b+="void";break;case 1:this.buf.b+="int";break;case 2:this.buf.b+="bool";break;case 3:this.buf.b+="float";break;case 4:this.buf.b+="string";break;case 5:var e=t[3],r=t[2];switch(e[1]){case 0:this.buf.b+="i";break;case 1:break;case 2:this.buf.b+="b"}this.buf.b+="vec",this.buf.b+=g.string(r);break;case 6:this.buf.b+="mat3";break;case 7:this.buf.b+="mat4";break;case 8:this.decl(An.MAT34),this.buf.b+="_mat3x4";break;case 9:var i=t[2];this.buf.b+="vec",this.buf.b+=g.string(i);break;case 10:this.buf.b+="sampler2D";break;case 11:this.buf.b+="samplerCube";break;case 12:var n=t[2];this.buf.b+="struct { ";for(var a=0;a<n.length;){var s=n[a];++a,this.addVar(s),this.buf.b+=";"}this.buf.b+=" }";break;case 13:this.buf.b+="function";break;case 14:var o=t[3],h=t[2];switch(this.addType(h),this.buf.b+="[",o[1]){case 0:if(1==o[2])this.buf.b+="2";else{var l=o[2];this.buf.b+=g.string(l)}break;case 1:var u=o[2],R=this.varName(u);this.buf.b+=g.string(R)}this.buf.b+="]";break;case 15:var c=t[2];this.buf.b+=g.string("channel"+c)}},addVar:function(t){var e=t.type;if(14==e[1]){var r=e[3],i=e[2],n=t.type;switch(t.type=i,this.addVar(t),t.type=n,this.buf.b+="[",r[1]){case 0:if(1==r[2])this.buf.b+="2";else{var a=r[2];this.buf.b+=g.string(a)}break;case 1:var s=r[2],o=this.varName(s);this.buf.b+=g.string(o)}this.buf.b+="]"}else{this.addType(t.type),
this.buf.b+=" ";var h=this.varName(t);this.buf.b+=g.string(h)}},addValue:function(t,e){var r=t.e;switch(r[1]){case 4:var i=r[2],n="val"+this.exprIds++,a=this.buf;this.buf=new p,this.addType(t.t),this.buf.b+=" ",this.buf.b+=g.string(n),this.buf.b+="(void)";var s=i.slice(),o=s[s.length-1];s[s.length-1]={e:gn.TReturn(o),t:t.t,p:o.p};var h={t:nn.TVoid,e:gn.TBlock(s),p:t.p};this.addExpr(h,""),this.exprValues.push(this.buf.b),this.buf=a,this.buf.b+=g.string(n),this.buf.b+="()";break;case 10:var l=r[4],u=r[3],R=r[2];this.buf.b+="( ",this.addValue(R,e),this.buf.b+=" ) ? ",this.addValue(u,e),this.buf.b+=" : ",this.addValue(l,e);break;case 20:var c=r[4];this.addValue(c,e);break;default:this.addExpr(t,e)}},addBlock:function(t,e){this.addExpr(t,e)},addExpr:function(t,e){var r=t.e;switch(r[1]){case 0:var i=r[2];switch(i[1]){case 0:this.buf.b+="null";break;case 1:var n=i[2];this.buf.b+=g.string(n);break;case 2:var a=i[2];this.buf.b+=g.string(a);break;case 3:var s=i[2],o=""+s;this.buf.b+=g.string(o),o.indexOf(".")==-1&&o.indexOf("e")==-1&&(this.buf.b+=".");break;case 4:var h=i[2];this.buf.b+=g.string('"'+h+'"')}break;case 1:var l=r[2],u=this.varName(l);this.buf.b+=g.string(u);break;case 2:var R=r[2];switch(R[1]){case 33:this.decl("vec4 _texture2D( sampler2D t, vec2 v ) { return "+(this.glES?"texture2D":"texture")+"(t,vec2(v.x,"+(this.flipY?"0.999999-v.y":"v.y")+")); }");break;case 34:if(!this.glES)return void(this.buf.b+="texture");break;case 50:this.decl(An.MAT34);break;case 52:this.decl("vec4 pack( float v ) { vec4 color = fract(v * vec4(1, 255, 255.*255., 255.*255.*255.)); return color - color.yzww * vec4(1. / 255., 1. / 255., 1. / 255., 0.); }");break;case 53:this.decl("float unpack( vec4 color ) { return dot(color,vec4(1., 1. / 255., 1. / (255. * 255.), 1. / (255. * 255. * 255.))); }");break;case 54:this.decl("vec4 packNormal( vec3 v ) { return vec4((v + vec3(1.)) * vec3(0.5),1.); }");break;case 55:this.decl("vec3 unpackNormal( vec4 v ) { return normalize((v.xyz - vec3(0.5)) * vec3(2.)); }");break;case 56:case 57:case 58:this.decl("#extension GL_OES_standard_derivatives:enable");break;case 59:if(!this.glES)return void(this.buf.b+="textureLod")}var c=An.GLOBALS.get(R);this.buf.b+=g.string(c);break;case 3:var _=r[2];this.buf.b+="(",this.addValue(_,e),this.buf.b+=")";break;case 4:var f=r[2];this.buf.b+="{\n";for(var p=e+"\t",d=0;d<f.length;){var v=f[d];++d,this.buf.b+=g.string(p),this.addExpr(v,p),this.newLine(v)}this.buf.b+=g.string(e),this.buf.b+="}";break;case 5:var m=r[4],y=r[3],x=r[2],b=m.t,w=y.t;switch(x[1]){case 1:if(5==w[1])if(3==w[2])if(1==w[3][1])if(8==b[1])this.decl(An.MAT34),this.decl("vec3 m3x4mult( vec3 v, _mat3x4 m) { vec4 ve = vec4(v,1.0); return vec3(dot(m.a,ve),dot(m.b,ve),dot(m.c,ve)); }"),20==x[1]&&(this.addValue(y,e),this.buf.b+=" = "),this.buf.b+="m3x4mult(",this.addValue(y,e),this.buf.b+=",",this.addValue(m,e),this.buf.b+=")";else{this.addValue(y,e),this.buf.b+=" ";var j=Vn.opStr(x);this.buf.b+=g.string(j),this.buf.b+=" ",this.addValue(m,e)}else{this.addValue(y,e),this.buf.b+=" ";var T=Vn.opStr(x);this.buf.b+=g.string(T),this.buf.b+=" ",this.addValue(m,e)}else{this.addValue(y,e),this.buf.b+=" ";var S=Vn.opStr(x);this.buf.b+=g.string(S),this.buf.b+=" ",this.addValue(m,e)}else{this.addValue(y,e),this.buf.b+=" ";var C=Vn.opStr(x);this.buf.b+=g.string(C),this.buf.b+=" ",this.addValue(m,e)}break;case 5:if(5==w[1])if(5==b[1]){var M=w[2];this.buf.b+=g.string("vec"+M+"(");var k;switch(x[1]){case 5:k="equal";break;case 6:k="notEqual";break;case 7:k="greaterThan";break;case 8:k="greaterThanEqual";break;case 9:k="lessThan";break;case 10:k="lessThanEqual";break;default:throw new Zn("assert")}this.buf.b+=g.string(k),this.buf.b+="(",this.addValue(y,e),this.buf.b+=",",this.addValue(m,e),this.buf.b+="))"}else{this.addValue(y,e),this.buf.b+=" ";var E=Vn.opStr(x);this.buf.b+=g.string(E),this.buf.b+=" ",this.addValue(m,e)}else{this.addValue(y,e),this.buf.b+=" ";var A=Vn.opStr(x);this.buf.b+=g.string(A),this.buf.b+=" ",this.addValue(m,e)}break;case 6:if(5==w[1])if(5==b[1]){var I=w[2];this.buf.b+=g.string("vec"+I+"(");var P;switch(x[1]){case 5:P="equal";break;case 6:P="notEqual";break;case 7:P="greaterThan";break;case 8:P="greaterThanEqual";break;case 9:P="lessThan";break;case 10:P="lessThanEqual";break;default:throw new Zn("assert")}this.buf.b+=g.string(P),this.buf.b+="(",this.addValue(y,e),this.buf.b+=",",this.addValue(m,e),this.buf.b+="))"}else{this.addValue(y,e),this.buf.b+=" ";var D=Vn.opStr(x);this.buf.b+=g.string(D),this.buf.b+=" ",this.addValue(m,e)}else{this.addValue(y,e),this.buf.b+=" ";var B=Vn.opStr(x);this.buf.b+=g.string(B),this.buf.b+=" ",this.addValue(m,e)}break;case 7:if(5==w[1])if(5==b[1]){var V=w[2];this.buf.b+=g.string("vec"+V+"(");var O;switch(x[1]){case 5:O="equal";break;case 6:O="notEqual";break;case 7:O="greaterThan";break;case 8:O="greaterThanEqual";break;case 9:O="lessThan";break;case 10:O="lessThanEqual";break;default:throw new Zn("assert")}this.buf.b+=g.string(O),this.buf.b+="(",this.addValue(y,e),this.buf.b+=",",this.addValue(m,e),this.buf.b+="))"}else{this.addValue(y,e),this.buf.b+=" ";var F=Vn.opStr(x);this.buf.b+=g.string(F),this.buf.b+=" ",this.addValue(m,e)}else{this.addValue(y,e),this.buf.b+=" ";var L=Vn.opStr(x);this.buf.b+=g.string(L),this.buf.b+=" ",this.addValue(m,e)}break;case 8:if(5==w[1])if(5==b[1]){var G=w[2];this.buf.b+=g.string("vec"+G+"(");var N;switch(x[1]){case 5:N="equal";break;case 6:N="notEqual";break;case 7:N="greaterThan";break;case 8:N="greaterThanEqual";break;case 9:N="lessThan";break;case 10:N="lessThanEqual";break;default:throw new Zn("assert")}this.buf.b+=g.string(N),this.buf.b+="(",this.addValue(y,e),this.buf.b+=",",this.addValue(m,e),this.buf.b+="))"}else{this.addValue(y,e),this.buf.b+=" ";var z=Vn.opStr(x);this.buf.b+=g.string(z),this.buf.b+=" ",this.addValue(m,e)}else{this.addValue(y,e),this.buf.b+=" ";var q=Vn.opStr(x);this.buf.b+=g.string(q),this.buf.b+=" ",this.addValue(m,e)}break;case 9:if(5==w[1])if(5==b[1]){var U=w[2];this.buf.b+=g.string("vec"+U+"(");var Y;switch(x[1]){case 5:Y="equal";break;case 6:Y="notEqual";break;case 7:Y="greaterThan";break;case 8:Y="greaterThanEqual";break;case 9:Y="lessThan";break;case 10:Y="lessThanEqual";break;default:throw new Zn("assert")}this.buf.b+=g.string(Y),this.buf.b+="(",this.addValue(y,e),this.buf.b+=",",this.addValue(m,e),this.buf.b+="))"}else{this.addValue(y,e),this.buf.b+=" ";var W=Vn.opStr(x);this.buf.b+=g.string(W),this.buf.b+=" ",this.addValue(m,e)}else{this.addValue(y,e),this.buf.b+=" ";var H=Vn.opStr(x);this.buf.b+=g.string(H),this.buf.b+=" ",this.addValue(m,e)}break;case 10:if(5==w[1])if(5==b[1]){var X=w[2];this.buf.b+=g.string("vec"+X+"(");var Z;switch(x[1]){case 5:Z="equal";break;case 6:Z="notEqual";break;case 7:Z="greaterThan";break;case 8:Z="greaterThanEqual";break;case 9:Z="lessThan";break;case 10:Z="lessThanEqual";break;default:throw new Zn("assert")}this.buf.b+=g.string(Z),this.buf.b+="(",this.addValue(y,e),this.buf.b+=",",this.addValue(m,e),this.buf.b+="))"}else{this.addValue(y,e),this.buf.b+=" ";var K=Vn.opStr(x);this.buf.b+=g.string(K),this.buf.b+=" ",this.addValue(m,e)}else{this.addValue(y,e),this.buf.b+=" ";var $=Vn.opStr(x);this.buf.b+=g.string($),this.buf.b+=" ",this.addValue(m,e)}break;case 18:this.decl("int _ushr( int i, int j ) { return int(uint(i) >> uint(j)); }"),this.buf.b+="_ushr(",this.addValue(y,e),this.buf.b+=",",this.addValue(m,e),this.buf.b+=")";break;case 19:20==x[1]&&(this.addValue(y,e),this.buf.b+=" = "),this.buf.b+="mod(",this.addValue(y,e),this.buf.b+=",",this.addValue(m,e),this.buf.b+=")";break;case 20:switch(x[2][1]){case 1:if(5==w[1])if(3==w[2])if(1==w[3][1])if(8==b[1])this.decl(An.MAT34),this.decl("vec3 m3x4mult( vec3 v, _mat3x4 m) { vec4 ve = vec4(v,1.0); return vec3(dot(m.a,ve),dot(m.b,ve),dot(m.c,ve)); }"),20==x[1]&&(this.addValue(y,e),this.buf.b+=" = "),this.buf.b+="m3x4mult(",this.addValue(y,e),this.buf.b+=",",this.addValue(m,e),this.buf.b+=")";else{this.addValue(y,e),this.buf.b+=" ";var Q=Vn.opStr(x);this.buf.b+=g.string(Q),this.buf.b+=" ",this.addValue(m,e)}else{this.addValue(y,e),this.buf.b+=" ";var J=Vn.opStr(x);this.buf.b+=g.string(J),this.buf.b+=" ",this.addValue(m,e)}else{this.addValue(y,e),this.buf.b+=" ";var tt=Vn.opStr(x);this.buf.b+=g.string(tt),this.buf.b+=" ",this.addValue(m,e)}else{this.addValue(y,e),this.buf.b+=" ";var et=Vn.opStr(x);this.buf.b+=g.string(et),this.buf.b+=" ",this.addValue(m,e)}break;case 19:20==x[1]&&(this.addValue(y,e),this.buf.b+=" = "),this.buf.b+="mod(",this.addValue(y,e),this.buf.b+=",",this.addValue(m,e),this.buf.b+=")";break;default:this.addValue(y,e),this.buf.b+=" ";var rt=Vn.opStr(x);this.buf.b+=g.string(rt),this.buf.b+=" ",this.addValue(m,e)}break;default:this.addValue(y,e),this.buf.b+=" ";var it=Vn.opStr(x);this.buf.b+=g.string(it),this.buf.b+=" ",this.addValue(m,e)}break;case 6:var nt,at=r[3],st=r[2],ot=this.buf,ht=ot.b;switch(st[1]){case 0:nt="++";break;case 1:nt="--";break;case 2:nt="!";break;case 3:nt="-";break;case 4:nt="~"}ot.b=ht+g.string(nt),this.addValue(at,e);break;case 7:var lt=r[3],ut=r[2];if(this.locals.set(ut.id,ut),null!=lt){var Rt=this.varName(ut);this.buf.b+=g.string(Rt),this.buf.b+=" = ",this.addValue(lt,e)}else this.buf.b+="/*var*/";break;case 8:if(2==r[2].e[1])switch(r[2].e[2][1]){case 48:if(1==r[3].length){var ct=r[3][0];if(ct.t==nn.TMat3x4)this.decl(An.MAT34),this.decl("mat3 _mat3( _mat3x4 v ) { return mat3(v.a.xyz,v.b.xyz,v.c.xyz); }"),this.buf.b+="_mat3(",this.addValue(ct,e),this.buf.b+=")";else{var _t=r[2],ft=r[3];this.addValue(_t,e),this.buf.b+="(";for(var gt=!0,pt=0;pt<ft.length;){var dt=ft[pt];++pt,gt?gt=!1:this.buf.b+=", ",this.addValue(dt,e)}this.buf.b+=")"}}else{var vt=r[2],mt=r[3];this.addValue(vt,e),this.buf.b+="(";for(var yt=!0,xt=0;xt<mt.length;){var bt=mt[xt];++xt,yt?yt=!1:this.buf.b+=", ",this.addValue(bt,e)}this.buf.b+=")"}break;case 51:if(1==r[3].length){var wt=r[3][0];this.buf.b+="clamp(",this.addValue(wt,e),this.buf.b+=", 0., 1.)"}else{var jt=r[2],Tt=r[3];this.addValue(jt,e),this.buf.b+="(";for(var St=!0,Ct=0;Ct<Tt.length;){var Mt=Tt[Ct];++Ct,St?St=!1:this.buf.b+=", ",this.addValue(Mt,e)}this.buf.b+=")"}break;default:var kt=r[3],Et=r[2];this.addValue(Et,e),this.buf.b+="(";for(var At=!0,It=0;It<kt.length;){var Pt=kt[It];++It,At?At=!1:this.buf.b+=", ",this.addValue(Pt,e)}this.buf.b+=")"}else{var Dt=r[3],Bt=r[2];this.addValue(Bt,e),this.buf.b+="(";for(var Vt=!0,Ot=0;Ot<Dt.length;){var Ft=Dt[Ot];++Ot,Vt?Vt=!1:this.buf.b+=", ",this.addValue(Ft,e)}this.buf.b+=")"}break;case 9:var Lt=r[3],Gt=r[2],Nt=Gt.t;if(3==Nt[1]){for(var zt=0;zt<Lt.length;){var qt=Lt[zt];if(++zt,qt!=fn.X)throw new Zn("assert")}var Ut=Lt.length;switch(Ut){case 1:this.addValue(Gt,e);break;case 2:this.decl("vec2 _vec2( float v ) { return vec2(v,v); }"),this.buf.b+="_vec2(",this.addValue(Gt,e),this.buf.b+=")";break;case 3:this.decl("vec3 _vec3( float v ) { return vec3(v,v,v); }"),this.buf.b+="_vec3(",this.addValue(Gt,e),this.buf.b+=")";break;case 4:this.decl("vec4 _vec4( float v ) { return vec4(v,v,v,v); }"),this.buf.b+="_vec4(",this.addValue(Gt,e),this.buf.b+=")";break;default:throw new Zn("assert")}}else{this.addValue(Gt,e),this.buf.b+=".";for(var Yt=0;Yt<Lt.length;){var Wt=Lt[Yt];++Yt;var Ht,Xt=this.buf,Zt=Xt.b;switch(Wt[1]){case 0:Ht="x";break;case 1:Ht="y";break;case 2:Ht="z";break;case 3:Ht="w"}Xt.b=Zt+g.string(Ht)}}break;case 10:var Kt=r[4],$t=r[3],Qt=r[2];this.buf.b+="if( ",this.addValue(Qt,e),this.buf.b+=") ",this.addExpr($t,e),null!=Kt&&(this.isBlock($t)||(this.buf.b+=";"),this.buf.b+=" else ",this.addExpr(Kt,e));break;case 11:this.buf.b+="discard";break;case 12:var Jt=r[2];null==Jt?this.buf.b+="return":(this.buf.b+="return ",this.addValue(Jt,e));break;case 13:var te=r[4],ee=r[3],re=r[2];this.locals.set(re.id,re);var ie=ee.e;if(5!=ie[1])throw new Zn("assert");if(21!=ie[2][1])throw new Zn("assert");var ne=ie[4],ae=ie[3];this.buf.b+="for(",this.buf.b+=g.string(re.name+"="),this.addValue(ae,e),this.buf.b+=g.string(";"+re.name+"<"),this.addValue(ne,e),this.buf.b+=g.string(";"+re.name+"++) "),this.addBlock(te,e);break;case 14:this.buf.b+="continue";break;case 15:this.buf.b+="break";break;case 16:var se=r[3],oe=r[2];this.addValue(oe,e),this.buf.b+="[",this.addValue(se,e),this.buf.b+="]";break;case 17:var he=r[2];this.buf.b+="[";for(var le=!0,ue=0;ue<he.length;){var Re=he[ue];++ue,le?le=!1:this.buf.b+=", ",this.addValue(Re,e)}this.buf.b+="]";break;case 18:this.buf.b+="switch(...)";break;case 19:if(0==r[4]){var ce=r[2],_e=r[3];e+="\t",this.buf.b+="do ",this.addBlock(_e,e),this.buf.b+=" while( ",this.addValue(ce,e),this.buf.b+=" )"}else{var fe=r[2],ge=r[3];this.buf.b+="while( ",this.addValue(fe,e),this.buf.b+=" ) ",this.addBlock(ge,e)}break;case 20:var pe=r[4];this.addExpr(pe,e)}},varName:function(t){if(t.kind==hn.Output){if(this.isVertex)return"gl_Position";if(this.glES)return null==this.outIndexes?"gl_FragColor":"gl_FragData["+this.outIndexes.h[t.id]+"]"}var e=this.varNames.h[t.id];if(null!=e)return e;e=t.name;var r=An.KWDS;(null!=_a[e]?r.existsReserved(e):r.h.hasOwnProperty(e))&&(e="_"+e);var i=this.allNames;if(null!=_a[e]?i.existsReserved(e):i.h.hasOwnProperty(e)){var n=2;for(e+="_";;){var a=this.allNames,s=e+n;if(!(null!=_a[s]?a.existsReserved(s):a.h.hasOwnProperty(s)))break;++n}e+=n}this.varNames.h[t.id]=e;var o=t.id,h=this.allNames;return null!=_a[e]?h.setReserved(e,o):h.h[e]=o,e},newLine:function(t){this.isBlock(t)?this.buf.b+="\n":this.buf.b+=";\n"},isBlock:function(t){var e=t.e;switch(e[1]){case 4:return!0;case 13:var r=e[4];return this.isBlock(r);case 19:if(1==e[4]){var i=e[3];return this.isBlock(i)}return!1;default:return!1}},run:function(t){if(this.locals=new bi,this.decls=[],this.buf=new p,this.exprValues=[],this.decl("precision mediump float;"),1!=t.funs.length)throw new Zn("assert");var e=t.funs[0];this.isVertex=e.kind==cn.Vertex;var r=0;this.outIndexes=new bi;for(var i=0,n=t.vars;i<n.length;){var a=n[i];++i;var s=a.kind;switch(s[1]){case 0:case 2:this.buf.b+="uniform ";break;case 1:this.buf.b+=g.string(this.glES?"attribute ":"in ");break;case 3:this.buf.b+=g.string(this.glES?"varying ":this.isVertex?"out ":"in ");break;case 4:break;case 5:if(this.glES){this.outIndexes.set(a.id,r++);continue}if(this.isVertex)continue;this.buf.b+="out ";break;case 6:continue}if(null!=a.qualifiers)for(var o=0,h=a.qualifiers;o<h.length;){var l=h[o];if(++o,6==l[1]){var u=l[2];switch(u[1]){case 0:this.buf.b+="lowp ";break;case 1:this.buf.b+="mediump ";break;case 2:this.buf.b+="highp "}}}this.addVar(a),this.buf.b+=";\n"}this.buf.b+="\n",r<2?this.outIndexes=null:!this.isVertex&&this.glES&&this.decl("#extension GL_EXT_draw_buffers : enable");var R=this.buf;this.buf=new p,this.buf.b+="void main(void) {\n";var c=e.expr.e;if(4==c[1])for(var _=c[2],f=0;f<_.length;){var d=_[f];++f,this.buf.b+="\t",this.addExpr(d,"\t"),this.newLine(d)}else this.addExpr(e.expr,"");this.buf.b+="}",this.exprValues.push(this.buf.b),this.buf=R;for(var v=this.locals.iterator();v.hasNext();){var m=v.next();this.addVar(m),this.buf.b+=";\n"}this.buf.b+="\n";for(var y=0,x=this.exprValues;y<x.length;){var b=x[y];++y,this.buf.b+=g.string(b),this.buf.b+="\n\n"}return null!=this.version?this.decl("#version "+this.version):this.glES?this.decl("#version 100"):this.decl("#version 130"),this.decls.push(this.buf.b),this.buf=null,this.decls.join("\n")},__class__:An};var In=function(){};a["hxsl._Linker.AllocatedVar"]=In,In.__name__=["hxsl","_Linker","AllocatedVar"],In.prototype={__class__:In};var Pn=function(t,e){this.name=t,this.vertex=e,this.processed=new bi,this.usedFunctions=[],this.read=new bi,this.write=new bi};a["hxsl._Linker.ShaderInfos"]=Pn,Pn.__name__=["hxsl","_Linker","ShaderInfos"],Pn.prototype={__class__:Pn};var Dn=function(){this.debugDepth=0};a["hxsl.Linker"]=Dn,Dn.__name__=["hxsl","Linker"],Dn.prototype={error:function(t,e){return on.t(t,e)},mergeVar:function(t,e,r,i){var n=e.kind;switch(n[1]){case 2:case 6:throw new Zn("assert");case 0:case 1:case 3:case 4:case 5:}e.kind!=r.kind&&e.kind!=hn.Local&&r.kind!=hn.Local&&this.error("'"+t+"' kind does not match : "+g.string(e.kind)+" should be "+g.string(r.kind),i);var a=r.type,s=e.type;if(12==s[1])if(12==a[1])for(var o=s[2],h=a[2],l=0;l<o.length;){var u=o[l];++l;for(var R=null,c=0;c<h.length;){var _=h[c];if(++c,u.name==_.name){R=_;break}}null==R?h.push(this.allocVar(u,i).v):this.mergeVar(t+"."+R.name,u,R,i)}else v.enumEq(e.type,r.type)||this.error("'"+t+"' type does not match : "+pn.toString(e.type)+" should be "+pn.toString(r.type),i);else v.enumEq(e.type,r.type)||this.error("'"+t+"' type does not match : "+pn.toString(e.type)+" should be "+pn.toString(r.type),i)},allocVar:function(t,e,r,i){if(null!=t.parent&&null==i){i=this.allocVar(t.parent,e);var n=i.v;for(r=n.name,n=n.parent;null!=n;)r=n.name+"."+r,n=n.parent}var a=null==r?t.name:r+"."+t.name;if(null!=t.qualifiers)for(var s=0,o=t.qualifiers;s<o.length;){var h=o[s];if(++s,4==h[1]){var l=h[2];a=l}}var u=this.varMap,R=null!=_a[a]?u.getReserved(a):u.h[a],c=t.name;if(null!=R){for(var _=0,f=R.merged;_<f.length;){var g=f[_];if(++_,g==t)return R}var p,d;if(t.kind==hn.Param&&!pn.hasQualifier(t,ln.Shared)||t.kind==hn.Function||t.kind==hn.Var&&pn.hasQualifier(t,ln.Private))d=!0;else{var v=R.v;d=v.kind==hn.Param&&!pn.hasQualifier(v,ln.Shared)||v.kind==hn.Function||v.kind==hn.Var&&pn.hasQualifier(v,ln.Private)}if(p=!!d||t.kind==hn.Param&&R.v.kind==hn.Param,!p)return R.merged.push(t),this.mergeVar(a,t,R.v,e),this.varIdMap.h[t.id]=R.id,R;for(var m=2;;){var y=this.varMap,x=a+m,b=null!=_a[x]?y.getReserved(x):y.h[x];if(null==b)break;for(var w=0,j=b.merged;w<j.length;){var T=j[w];if(++w,T==t)return b}++m}c+=m,a+=m}var S=this.allVars.length+1,C={id:S,name:c,type:t.type,kind:t.kind,qualifiers:t.qualifiers,parent:null==i?null:i.v},M=new In;M.v=C,M.merged=[t],M.path=a,M.id=S,M.parent=i,M.instanceIndex=this.curInstance,this.allVars.push(M);var k=this.varMap;null!=_a[a]?k.setReserved(a,M):k.h[a]=M;var E=C.type;if(12==E[1]){for(var A=E[2],I=[],P=0;P<A.length;){var D=A[P];++P,I.push(this.allocVar(D,e,a,M).v)}C.type=nn.TStruct(I)}return M},mapExprVar:function(t){var e=t.e;switch(e[1]){case 1:var r=e[2];if(!this.locals.exists(r.id)){var i=this.allocVar(r,t.p);if(null!=this.curShader&&!this.curShader.write.exists(i.id)){this.curShader.name+" read "+i.path;if(this.curShader.read.set(i.id,i),null==this.curShader.vertex&&i.v.kind==hn.Var){"Force "+this.curShader.name+" into fragment (use varying)";this.curShader.vertex=!1}}return{e:gn.TVar(i.v),t:i.v.type,p:t.p}}break;case 5:var a=e[4],s=e[3],o=e[2],h=s.e;switch(o[1]){case 4:switch(h[1]){case 1:var l=h[2];if(!this.locals.exists(l.id)){var u=this.mapExprVar(a),R=this.allocVar(l,s.p);if(null!=this.curShader){this.curShader.name+" write "+R.path;this.curShader.write.set(R.id,R)}return{e:gn.TBinop(o,{e:gn.TVar(R.v),t:R.v.type,p:t.p},u),t:t.t,p:t.p}}var c=h[2];if(!this.locals.exists(c.id)){var _=this.mapExprVar(s),f=this.mapExprVar(a),g=this.allocVar(c,_.p);if(null!=this.curShader){this.curShader.name+" write "+g.path;this.curShader.write.set(g.id,g)}return{e:gn.TBinop(o,_,f),t:t.t,p:t.p}}break;case 9:if(1==h[2].e[1]){var p=h[2].e[2];if(!this.locals.exists(p.id)){var d=this.mapExprVar(s),v=this.mapExprVar(a),m=this.allocVar(p,d.p);if(null!=this.curShader){this.curShader.name+" write "+m.path;this.curShader.write.set(m.id,m)}return{e:gn.TBinop(o,d,v),t:t.t,p:t.p}}}}break;case 20:switch(h[1]){case 1:var y=h[2];if(!this.locals.exists(y.id)){var x=this.mapExprVar(s),b=this.mapExprVar(a),w=this.allocVar(y,x.p);if(null!=this.curShader){this.curShader.name+" write "+w.path;this.curShader.write.set(w.id,w)}return{e:gn.TBinop(o,x,b),t:t.t,p:t.p}}break;case 9:if(1==h[2].e[1]){var j=h[2].e[2];if(!this.locals.exists(j.id)){var T=this.mapExprVar(s),S=this.mapExprVar(a),C=this.allocVar(j,T.p);if(null!=this.curShader){this.curShader.name+" write "+C.path;this.curShader.write.set(C.id,C)}return{e:gn.TBinop(o,T,S),t:t.t,p:t.p}}}}}break;case 7:var M=e[2];this.locals.set(M.id,!0);break;case 11:null!=this.curShader&&(this.curShader.vertex=!1,this.curShader.hasDiscard=!0);break;case 13:var k=e[2];this.locals.set(k.id,!0)}return pn.map(t,n(this,this.mapExprVar))},addShader:function(t,e,r,i){var n=new Pn(t,e);return this.curShader=n,n.priority=i,n.body=this.mapExprVar(r),this.shaders.push(n),this.curShader=null,n},sortByPriorityDesc:function(t,e){return e.priority-t.priority},buildDependency:function(t,e,r){for(var i=!r,n=0,a=this.shaders;n<a.length;){var s=a[n];if(++n,s!=t){if(i&&s.write.h.hasOwnProperty(e.id)&&(!t.vertex||0!=s.vertex)){t.name+" => "+s.name+" ("+e.path+")";if(t.deps.set(s,!0),this.debugDepth++,this.initDependencies(s),this.debugDepth--,!s.read.h.hasOwnProperty(e.id))return}}else i=!0}e.v.kind==hn.Var&&this.error("Variable "+e.path+" required by "+t.name+" is missing initializer",null)},initDependencies:function(t){if(null==t.deps){t.deps=new wi;for(var e=t.read.iterator();e.hasNext();){var r=e.next();this.buildDependency(t,r,t.write.h.hasOwnProperty(r.id))}if(null==t.vertex)for(var i=t.deps.keys();i.hasNext();){var n=i.next();if(0==n.vertex){t.name+" marked as fragment because of "+n.name;t.vertex=!1;break}}if(t.vertex)for(var a=t.deps.keys();a.hasNext();){var s=a.next();if(null==s.vertex){s.name+" marked as vertex because of "+t.name;s.vertex=!0}}}},collect:function(t,e,r){if(t.onStack&&this.error("Loop in shader dependencies ("+t.name+")",null),t.marked!=r){t.marked=r,t.onStack=!0;for(var i=[],a=t.deps.keys();a.hasNext();){var s=a.next();i.push(s)}var o=i;o.sort(n(this,this.sortByPriorityDesc));for(var h=0;h<o.length;){var l=o[h];++h,this.collect(l,e,r)}if(null==t.vertex){"MARK "+t.name+" "+(r?"vertex":"fragment");t.vertex=r}if(t.vertex==r){"COLLECT "+t.name+" "+(r?"vertex":"fragment");e.push(t)}t.onStack=!1}},uniqueLocals:function(t,e){var r=t.e;switch(r[1]){case 4:for(var i=r[2],a=new Ti,s=e.keys();s.hasNext();){var o=s.next();null!=_a[o]?a.setReserved(o,!0):a.h[o]=!0}for(var h=a,l=0;l<i.length;){var u=i[l];++l,this.uniqueLocals(u,h)}break;case 7:var R=r[2],c=R.name;if(null!=_a[c]?e.existsReserved(c):e.h.hasOwnProperty(c)){for(var _=2;;){var f=R.name+_;if(!(null!=_a[f]?e.existsReserved(f):e.h.hasOwnProperty(f)))break;++_}R.name+=_}var g=R.name;null!=_a[g]?e.setReserved(g,!0):e.h[g]=!0;break;default:var p=n(this,this.uniqueLocals),d=e;pn.iter(t,function(t){p(t,d)})}},link:function(t){var e=this;this.varMap=new Ti,this.varIdMap=new bi,this.allVars=[],this.shaders=[],this.locals=new bi;for(var r=new wi,i=[],a=0;a<t.length;){var s=t[a];++a;var o=s,h=o;null!=r.h.__keys__[o.__id__]&&(o=xn.shaderData(o)),r.set(o,h),i.push(o)}t=i,this.curInstance=0;for(var l=[],u=0;u<t.length;){var R=t[u];++u;for(var c=0,_=R.vars;c<_.length;){var f=_[c];++c,this.allocVar(f,null),f.kind==hn.Output&&l.push(f)}for(var g=0,p=R.funs;g<p.length;){var d=p[g];++g;var v=this.allocVar(d.ref,d.expr.p);v.kind=d.kind}this.curInstance++}for(var m=0,y=0;y<t.length;){var x=t[y];++y;for(var b=0,w=x.funs;b<w.length;){var j=w[b];++b;var T=this.allocVar(j.ref,j.expr.p);if(null==T.kind)throw new Zn("assert");var S=T.kind;switch(S[1]){case 0:case 1:this.addShader(x.name+"."+(T.kind==cn.Vertex?"vertex":"fragment"),T.kind==cn.Vertex,j.expr,m);break;case 2:var C,M=j.ref.name;switch(M){case"__init__fragment":C=!1;break;case"__init__vertex":C=!0;break;default:C=null}var k=j.expr.e;if(4==k[1])for(var E=k[2],A=0,I=-E.length,P=0;P<E.length;){var D=E[P];++P,this.addShader(x.name+"."+j.ref.name+A++,C,D,I++)}else this.addShader(x.name+"."+j.ref.name,C,j.expr,-1);break;case 3:throw new Zn("Unexpected helper function in linker "+T.v.name)}}++m}this.shaders.sort(n(this,this.sortByPriorityDesc));var B=new Pn("<entry>",!1);B.deps=new wi;for(var V=0;V<l.length;){var O=l[V];++V,this.buildDependency(B,this.allocVar(O,null),!1)}for(var F=0,L=this.shaders;F<L.length;){var G=L[F];++F,G.hasDiscard&&(this.initDependencies(G),B.deps.set(G,!0))}for(var N=0,z=this.shaders;N<z.length;){var q=z[N];if(++N,null==q.vertex){for(var U=!0,Y=q.read.iterator();Y.hasNext();){var W=Y.next();if(W.v.kind!=hn.Param){U=!1;break}}if(U){"Force "+q.name+" into fragment since it only reads params";q.vertex=!1}}}var H=[],X=[];if(this.collect(B,H,!0),this.collect(B,X,!1),X.pop()!=B)throw new Zn("assert");for(var Z=0,K=this.shaders;Z<K.length;){var $=K[Z];++Z,$.marked=null}for(var Q=0,J=H.concat(X);Q<J.length;){var tt=J[Q];++Q;for(var et=tt.deps.keys();et.hasNext();){var rt=et.next();null==rt.marked&&this.error(rt.name+" needed by "+tt.name+" is unreachable",null)}tt.marked=!0}var it=[],nt=new bi,at=null;at=function(t){nt.h.hasOwnProperty(t.id)||(nt.h[t.id]=!0,null!=t.v.parent?at(t.parent):it.push(t.v))};for(var st=at,ot=0,ht=H.concat(X);ot<ht.length;){var lt=ht[ot];++ot;for(var ut=lt.read.iterator();ut.hasNext();){var Rt=ut.next();st(Rt)}for(var ct=lt.write.iterator();ct.hasNext();){var _t=ct.next();st(_t)}}var ft=null;ft=function(t){var e=t.type;if(12==e[1]){var r=e[2];if(t.kind!=hn.Input){for(var i=[],n=0;n<r.length;){var a=r[n];++n,nt.h.hasOwnProperty(a.id)&&(ft(a),i.push(a))}t.type=nn.TStruct(i)}}};for(var gt=ft,pt=0;pt<it.length;){var dt=it[pt];++pt,gt(dt)}for(var vt=function(t,r,i){var n={id:pn.allocVarId(),name:r,type:nn.TFun([{ret:nn.TVoid,args:[]}]),kind:hn.Function};it.push(n);for(var a=[],s=0;s<i.length;){var o=i[s];++s;var h=o.body.e;if(4==h[1])for(var l=h[2],u=0;u<l.length;){var R=l[u];++u,a.push(R)}else a.push(o.body)}var c={e:gn.TBlock(a),t:nn.TVoid,p:0==a.length?null:a[0].p};return e.uniqueLocals(c,new Ti),{kind:t,ref:n,ret:nn.TVoid,args:[],expr:c}},mt=[vt(cn.Vertex,"vertex",H),vt(cn.Fragment,"fragment",X)],yt=r.keys();yt.hasNext();){var xt=yt.next(),bt=r.h[xt.__id__];if(xt!=bt)for(var wt=0,jt=xt.vars.length;wt<jt;){var Tt=wt++;this.allocVar(xt.vars[Tt],null).merged.unshift(bt.vars[Tt])}}return{name:"out",vars:it,funs:mt}},__class__:Dn};var Bn=a["hxsl.Output"]={__ename__:!0,__constructs__:["Const","Value","PackNormal","PackFloat","Vec2","Vec3","Vec4"]};Bn.Const=function(t){var e=["Const",0,t];return e.__enum__=Bn,e.toString=s,e},Bn.Value=function(t){var e=["Value",1,t];return e.__enum__=Bn,e.toString=s,e},Bn.PackNormal=function(t){var e=["PackNormal",2,t];return e.__enum__=Bn,e.toString=s,e},Bn.PackFloat=function(t){var e=["PackFloat",3,t];return e.__enum__=Bn,e.toString=s,e},Bn.Vec2=function(t){var e=["Vec2",4,t];return e.__enum__=Bn,e.toString=s,e},Bn.Vec3=function(t){var e=["Vec3",5,t];return e.__enum__=Bn,e.toString=s,e},Bn.Vec4=function(t){var e=["Vec4",6,t];return e.__enum__=Bn,e.toString=s,e},Bn.__empty_constructs__=[];var Vn=function(t){null==t&&(t=!1),this.varId=t};a["hxsl.Printer"]=Vn,Vn.__name__=["hxsl","Printer"],Vn.opStr=function(t){switch(t[1]){case 0:return"+";case 1:return"*";case 2:return"/";case 3:return"-";case 4:return"=";case 5:return"==";case 6:return"!=";case 7:return">";case 8:return">=";case 9:return"<";case 10:return"<=";case 11:return"&";case 12:return"|";case 13:return"^";case 14:return"&&";case 15:return"||";case 16:return"<<";case 17:return">>";case 18:return">>>";case 19:return"%";case 20:var e=t[2];return Vn.opStr(e)+"=";case 21:return"...";case 22:return"=>"}},Vn.toString=function(t,e){return null==e&&(e=!1),new Vn(e).exprString(t)},Vn.shaderToString=function(t,e){return null==e&&(e=!1),new Vn(e).shaderString(t)},Vn.prototype={shaderString:function(t){this.buffer=new p;for(var e=0,r=t.vars;e<r.length;){var i=r[e];++e,this.addVar(i,hn.Var),this.buffer.b+=";\n"}t.vars.length>0&&(this.buffer.b+="\n");for(var n=0,a=t.funs;n<a.length;){var s=a[n];++n,this.addFun(s),this.buffer.b+="\n\n"}return this.buffer.b},exprString:function(t){return this.buffer=new p,this.addExpr(t,""),this.buffer.b},addVar:function(t,e,r,i){if(null==r&&(r=""),null!=t.qualifiers)for(var n=0,a=t.qualifiers;n<a.length;){var s=a[n];++n;var o;switch(s[1]){case 0:var h=s[2];o="const"+(null==h?"":"("+h+")");break;case 1:o="private";break;case 2:o="nullable";break;case 3:o="perObject";break;case 4:var l=s[2];o="name('"+l+"')";break;case 5:o="shared";break;case 6:var u=s[2];o=u[0].toLowerCase()+"p";break;case 7:var R=s[3],c=s[2];o="range("+c+","+R+")";break;case 8:o="ignore"}this.buffer.b+=g.string("@"+o+" ")}if(t.kind!=e){var _=t.kind;switch(_[1]){case 0:this.buffer.b+="@global ";break;case 1:this.buffer.b+="@input ";break;case 2:this.buffer.b+="@param ";break;case 3:this.buffer.b+="@var ";break;case 4:this.buffer.b+="@local ";break;case 5:this.buffer.b+="@output ";break;case 6:this.buffer.b+="@function "}}this.buffer.b+="var ",t.parent==i?this.buffer.b+=g.string(t.name+(this.varId?"@"+t.id:"")):this.addVarName(t),this.buffer.b+=" : ";var f=t.type;if(12==f[1]){var p=f[2];this.buffer.b+="{";for(var d=!0,v=0;v<p.length;){var m=p[v];++v,d?d=!1:this.buffer.b+=", ",this.addVar(m,m.kind,r,m)}this.buffer.b+="}"}else{var y=pn.toString(t.type);this.buffer.b+=g.string(y)}},addFun:function(t){this.buffer.b+=g.string("function "+t.ref.name+"(");for(var e=!0,r=0,i=t.args;r<i.length;){var n=i[r];++r,e?(this.buffer.b+=" ",e=!1):this.buffer.b+=", ",this.addVar(n,hn.Local)}t.args.length>0&&(this.buffer.b+=" ");var a=") : "+pn.toString(t.ret)+" ";this.buffer.b+=g.string(a),this.addExpr(t.expr,"")},addVarName:function(t){null!=t.parent&&(this.addVarName(t.parent),this.buffer.b+="."),this.buffer.b+=g.string(t.name),this.varId&&(this.buffer.b+=g.string("@"+t.id))},addConst:function(t){var e,r=this.buffer,i=r.b;switch(t[1]){case 0:e="null";break;case 1:var n=t[2];e=n;break;case 2:var a=t[2];e=a;break;case 3:var s=t[2];e=s;break;case 4:var o=t[2];e='"'+o+'"'}r.b=i+g.string(e)},addExpr:function(t,e){var r=t.e;switch(r[1]){case 0:var i=r[2];this.addConst(i);break;case 1:var n=r[2];this.addVarName(n);break;case 2:var a=r[2],s=dn.toString(a);this.buffer.b+=g.string(s);break;case 3:var h=r[2];this.buffer.b+="(",this.addExpr(h,e),this.buffer.b+=")";break;case 4:var l=r[2];this.buffer.b+="{",e+="\t";for(var u=0;u<l.length;){var R=l[u];++u,this.buffer.b+=g.string("\n"+e),this.addExpr(R,e),this.buffer.b+=";"}e=o.substr(e,1,null),l.length>0&&(this.buffer.b+=g.string("\n"+e)),this.buffer.b+="}";break;case 5:var c=r[4],_=r[3],f=r[2];this.addExpr(_,e);var p=" "+Vn.opStr(f)+" ";this.buffer.b+=g.string(p),this.addExpr(c,e);break;case 6:var d,v=r[3],m=r[2],y=this.buffer,x=y.b;switch(m[1]){case 0:d="++";break;case 1:d="--";break;case 2:d="!";break;case 3:d="-";break;case 4:d="~"}y.b=x+g.string(d),this.addExpr(v,e);break;case 7:var b=r[3],w=r[2];this.addVar(w,hn.Local,e),null!=b&&(this.buffer.b+=" = ",this.addExpr(b,e));break;case 8:var j=r[3],T=r[2];this.addExpr(T,e),this.buffer.b+="(";for(var S=!0,C=0;C<j.length;){var M=j[C];++C,S?S=!1:this.buffer.b+=", ",this.addExpr(M,e)}this.buffer.b+=")";break;case 9:var k=r[3],E=r[2];this.addExpr(E,e),this.buffer.b+=".";for(var A=0;A<k.length;){var I=k[A];++A,this.buffer.b+=g.string(Vn.SWIZ[I[1]])}break;case 10:var P=r[4],D=r[3],B=r[2];this.buffer.b+="if( ",this.addExpr(B,e),this.buffer.b+=" ) ",this.addExpr(D,e),null!=P&&(this.buffer.b+=" else ",this.addExpr(P,e));break;case 11:this.buffer.b+="discard";break;case 12:var V=r[2];this.buffer.b+="return",null!=V&&(this.buffer.b+=" ",this.addExpr(V,e));break;case 13:var O=r[4],F=r[3],L=r[2];this.buffer.b+="for( ",this.addVarName(L),this.buffer.b+=" in ",this.addExpr(F,e),this.buffer.b+=" ) ",this.addExpr(O,e);break;case 14:this.buffer.b+="continue";break;case 15:this.buffer.b+="break";break;case 16:var G=r[3],N=r[2];this.addExpr(N,e),this.buffer.b+="[",this.addExpr(G,e),this.buffer.b+="]";break;case 17:var z=r[2];this.buffer.b+="[";for(var q=!0,U=0;U<z.length;){var Y=z[U];++U,q?q=!1:this.buffer.b+=", ",this.addExpr(Y,e)}this.buffer.b+="]";break;case 18:var W=r[4],H=r[3],X=r[2];this.buffer.b+="switch( ",this.addExpr(X,e),this.buffer.b+=") {";for(var Z=e,K=0;K<H.length;){var $=H[K];++K,this.buffer.b+=g.string("\n"+e),this.buffer.b+="case ";for(var Q=!0,J=0,tt=$.values;J<tt.length;){var et=tt[J];++J,Q?Q=!1:this.buffer.b+=", ",this.addExpr(et,e)}e+="\t",this.buffer.b+=g.string(":\n"+e),this.addExpr($.expr,e),e=Z}null!=W&&(this.buffer.b+=g.string("\n"+e),e+="\t",this.buffer.b+=g.string("default:\n"+e),this.addExpr(W,e),e=Z),this.buffer.b+=g.string("\n"+e+"}");break;case 19:
if(0==r[4]){var rt=r[2],it=r[3],nt=e;e+="\t",this.buffer.b+=g.string("do {\n"+e),this.addExpr(it,e),e=nt,this.buffer.b+=g.string("\n"+e+"} while( "),this.addExpr(rt,e),this.buffer.b+=" )"}else{var at=r[2],st=r[3];this.buffer.b+="while( ",this.addExpr(at,e);var ot=e;e+="\t",this.buffer.b+=g.string(" ) {\n"+e),this.addExpr(st,e),e=ot,this.buffer.b+=g.string("\n"+e+"}")}break;case 20:var ht=r[4],lt=r[3],ut=r[2];if(this.buffer.b+=g.string(ut),lt.length>0){this.buffer.b+="(";for(var Rt=!0,ct=0;ct<lt.length;){var _t=lt[ct];++ct,Rt?Rt=!1:this.buffer.b+=", ",this.addConst(_t)}this.buffer.b+=")"}this.buffer.b+=" ",this.addExpr(ht,e)}},__class__:Vn};var On=function(t,e,r,i,n){this.name=t,this.pos=e,this.instance=r,this.index=i,this.type=n};a["hxsl.AllocParam"]=On,On.__name__=["hxsl","AllocParam"],On.prototype={__class__:On};var Fn=function(t,e,r){this.pos=t,this.path=e,this.gid=kn.allocID(e),this.type=r};a["hxsl.AllocGlobal"]=Fn,Fn.__name__=["hxsl","AllocGlobal"],Fn.prototype={__class__:Fn};var Ln=function(){};a["hxsl.RuntimeShaderData"]=Ln,Ln.__name__=["hxsl","RuntimeShaderData"],Ln.prototype={__class__:Ln};var Gn=function(){this.id=Gn.UID++};a["hxsl.RuntimeShader"]=Gn,Gn.__name__=["hxsl","RuntimeShader"],Gn.prototype={__class__:Gn};var Nn=function(t,e){this.s=t,this.next=e};a["hxsl.ShaderList"]=Nn,Nn.__name__=["hxsl","ShaderList"],Nn.prototype={__class__:Nn};var zn=function(t){this.id=pn.allocVarId(),this.shader=t,this.params=new bi};a["hxsl.ShaderInstance"]=zn,zn.__name__=["hxsl","ShaderInstance"],zn.prototype={__class__:zn};var qn=function(t,e){this.v=t,this.globalId=e};a["hxsl.ShaderGlobal"]=qn,qn.__name__=["hxsl","ShaderGlobal"],qn.prototype={__class__:qn};var Un=function(t,e,r){this.v=t,this.pos=e,this.bits=r};a["hxsl.ShaderConst"]=Un,Un.__name__=["hxsl","ShaderConst"],Un.prototype={__class__:Un};var Yn=function(t){this.instanceCache=new bi,this.consts=null,this.globals=[],""!=t&&(this.data=pi.run(t),this.initialize())};a["hxsl.SharedShader"]=Yn,Yn.__name__=["hxsl","SharedShader"],Yn.prototype={initialize:function(){for(var t=0,e=this.data.vars;t<e.length;){var r=e[t];++t,this.browseVar(r)}},makeInstance:function(t){for(var e=new Tn,r=this.consts;null!=r;){var i,n=r.v,a=r.v.type;switch(a[1]){case 1:case 15:i=Rn.CInt(t>>>r.pos&(1<<r.bits)-1);break;case 2:i=Rn.CBool(0!=(t>>>r.pos&1));break;default:throw new Zn("assert")}e.setConstant(n,i),r=r.next}e.inlineCalls=!0,e.unrollLoops=!0;var s=new zn(e.eval(this.data));this.paramsCount=0;for(var o=0,h=this.data.vars;o<h.length;){var l=h[o];++o,this.addParam(e,s,l)}return this.instanceCache.h[t]=s,s},addParam:function(t,e,r){var i=r.type;if(12==i[1])for(var n=i[2],a=0;a<n.length;){var s=n[a];++a,this.addParam(t,e,s)}else r.kind==hn.Param&&(e.params.set(t.varMap.get(r).id,this.paramsCount),this.paramsCount++)},browseVar:function(t,e){t.id=pn.allocVarId(),null==e?e=pn.getName(t):e+="."+t.name;var r=t.type;if(12==r[1])for(var i=r[2],n=0;n<i.length;){var a=i[n];++n,this.browseVar(a,e)}else{var s=0;if(t.kind==hn.Global&&(s=kn.allocID(e),this.globals.push(new qn(t,s))),!pn.isConst(t))return;var o=pn.getConstBits(t);if(o>0){var h=null==this.consts?0:this.consts.pos+this.consts.bits,l=new Un(t,h,o);l.globalId=s,l.next=this.consts,this.consts=l}}},__class__:Yn};var Wn=function(t){this.v=t,this.read=0,this.write=0};a["hxsl._Splitter.VarProps"]=Wn,Wn.__name__=["hxsl","_Splitter","VarProps"],Wn.prototype={__class__:Wn};var Hn=function(){};a["hxsl.Splitter"]=Hn,Hn.__name__=["hxsl","Splitter"],Hn.prototype={split:function(t){var e=null,r=new bi,i=null,n=new bi;this.varNames=new Ti;for(var a=0,s=t.funs;a<s.length;){var o=s[a];++a;var l=o.kind;switch(l[1]){case 0:this.vars=r,e=o,this.checkExpr(o.expr);break;case 1:this.vars=n,i=o,this.checkExpr(o.expr);break;default:throw new Zn("assert")}}this.varMap=new wi;for(var u=0,R=h.array(r);u<R.length;){var c=R[u];++u;var _=c.v,f=_.kind;switch(f[1]){case 3:case 4:_.kind=n.h.hasOwnProperty(_.id)?hn.Var:hn.Local}var g=_.kind;switch(g[1]){case 3:case 5:if(c.read>0||c.write>1){var p={id:pn.allocVarId(),name:_.name,kind:_.kind,type:_.type};this.vars=r;this.get(p);_.kind=hn.Local;var d=e.expr.p,v={e:gn.TBinop(Ei.OpAssign,{e:gn.TVar(p),t:p.type,p:d},{e:gn.TVar(_),t:_.type,p:d}),t:p.type,p:d};if(this.addExpr(e,v),this.checkExpr(v),p.kind==hn.Var){var m=n.h[_.id];this.varMap.set(_,p),n.remove(_.id);var y=new Wn(p);y.read=m.read,y.write=m.write,n.h[p.id]=y}}}}for(var x=[],b=[],w=n.iterator();w.hasNext();){var j=w.next(),T=j.v,S=T.kind;switch(S[1]){case 1:var C={id:pn.allocVarId(),name:T.name,kind:hn.Var,type:T.type};this.uniqueName(C);var M=r.h[T.id];null==M&&(M=new Wn(T),r.h[T.id]=M),M.read++;var k=new Wn(C);k.write=1,r.h[C.id]=k;var E=new Wn(C);E.read=1,b.push(E),this.addExpr(e,{e:gn.TBinop(Ei.OpAssign,{e:gn.TVar(C),t:T.type,p:e.expr.p},{e:gn.TVar(T),t:T.type,p:e.expr.p}),t:T.type,p:e.expr.p}),this.varMap.set(T,C),j.local=!0;break;case 3:if(j.write>0){var A={id:pn.allocVarId(),name:T.name,kind:hn.Local,type:T.type};this.uniqueName(A),x.push({e:gn.TVarDecl(A,{e:gn.TVar(T),t:T.type,p:i.expr.p}),t:nn.TVoid,p:i.expr.p}),this.varMap.set(T,A)}}}for(var I=0;I<b.length;){var P=b[I];++I,n.h[P.v.id]=P}for(var D=r.iterator();D.hasNext();){var B=D.next();this.checkVar(B,!0,r)}for(var V=n.iterator();V.hasNext();){var O=V.next();this.checkVar(O,!1,r)}for(var F=this.varMap.keys();F.hasNext();){var L=F.next(),G=this.varMap.h[this.varMap.h[L.__id__].__id__];null!=G&&this.varMap.set(L,G)}i={ret:i.ret,ref:i.ref,kind:i.kind,args:i.args,expr:this.mapVars(i.expr)};var N=i.expr.e;if(4==N[1])for(var z=N[2],q=0;q<x.length;){var U=x[q];++q,z.unshift(U)}else x.push(i.expr),i.expr={e:gn.TBlock(x),t:nn.TVoid,p:i.expr.p};for(var Y=[],W=r.iterator();W.hasNext();){var H=W.next();H.local||Y.push(H.v)}for(var X=Y,Z=[],K=n.iterator();K.hasNext();){var $=K.next();$.local||Z.push($.v)}var Q=Z;return X.sort(function(t,e){return t.id-e.id}),Q.sort(function(t,e){return t.id-e.id}),{vertex:{name:"vertex",vars:X,funs:[e]},fragment:{name:"fragment",vars:Q,funs:[i]}}},addExpr:function(t,e){var r=t.expr.e;if(4==r[1]){var i=r[2];i.push(e)}else t.expr={e:gn.TBlock([t.expr,e]),t:nn.TVoid,p:t.expr.p}},checkVar:function(t,e,r){var i=t.v.kind;switch(i[1]){case 3:if(!e){var n=r.h[t.v.id];if(null==n||0==n.write)throw new Zn("Varying "+t.v.name+" is not written by vertex shader")}break;case 4:if(t.requireInit)throw new Zn("Variable "+t.v.name+" is written without being initialized")}},mapVars:function(t){var e=t.e;if(1==e[1]){var r=e[2],i=this.varMap.get(r);return null==i?t:{e:gn.TVar(i),t:t.t,p:t.p}}return pn.map(t,n(this,this.mapVars))},get:function(t){var e=this.vars.h[t.id];return null==e&&(e=new Wn(t),this.vars.h[t.id]=e,this.uniqueName(t)),e},uniqueName:function(t){if(t.kind!=hn.Global&&t.kind!=hn.Output&&t.kind!=hn.Input){t.parent=null;var e=t.name,r=this.varNames,i=null!=_a[e]?r.getReserved(e):r.h[e];if(null!=i&&i!=t){for(var n=2;;){var a=t.name+n,s=this.varNames;if(!(null!=_a[a]?s.existsReserved(a):s.h.hasOwnProperty(a)))break;++n}t.name+=n}var o=t.name,h=this.varNames;null!=_a[o]?h.setReserved(o,t):h.h[o]=t}},checkExpr:function(t){var e=t.e;switch(e[1]){case 1:var r=e[2],i=this.get(r);0==i.write&&(i.requireInit=!0),i.read++;break;case 5:switch(e[2][1]){case 4:switch(e[3].e[1]){case 1:var a=e[4],s=e[3].e[2],o=this.get(s);o.write++,this.checkExpr(a);break;case 9:if(1==e[3].e[2].e[1]){var h=e[4],l=e[3].e[2].e[2],u=this.get(l);u.write++,this.checkExpr(h)}else pn.iter(t,n(this,this.checkExpr));break;default:pn.iter(t,n(this,this.checkExpr))}break;case 20:switch(e[3].e[1]){case 1:var R=e[4],c=e[3].e[2],_=this.get(c);0==_.write&&(_.requireInit=!0),_.read++,_.write++,this.checkExpr(R);break;case 9:if(1==e[3].e[2].e[1]){var f=e[4],g=e[3].e[2].e[2],p=this.get(g);0==p.write&&(p.requireInit=!0),p.read++,p.write++,this.checkExpr(f)}else pn.iter(t,n(this,this.checkExpr));break;default:pn.iter(t,n(this,this.checkExpr))}break;default:pn.iter(t,n(this,this.checkExpr))}break;case 7:var d=e[3],v=e[2],m=this.get(v);m.local=!0,null!=d&&(this.checkExpr(d),m.write++);break;case 13:var y=e[4],x=e[3],b=e[2];this.checkExpr(x);var w=this.get(b);w.local=!0,w.write++,this.checkExpr(y);break;default:pn.iter(t,n(this,this.checkExpr))}},__class__:Hn};var Xn=function(){};a["hxutil.math.PowerOfTwo"]=Xn,Xn.__name__=["hxutil","math","PowerOfTwo"],Xn.require=function(t){return 0==t?1:(--t,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t+1)};var Zn=function(t){Error.call(this),this.val=t,this.message=String(t),Error.captureStackTrace&&Error.captureStackTrace(this,Zn)};a["js._Boot.HaxeError"]=Zn,Zn.__name__=["js","_Boot","HaxeError"],Zn.wrap=function(t){return t instanceof Error?t:new Zn(t)},Zn.__super__=Error,Zn.prototype=e(Error.prototype,{__class__:Zn});var Kn=function(){};a["js.html._CanvasElement.CanvasUtil"]=Kn,Kn.__name__=["js","html","_CanvasElement","CanvasUtil"],Kn.getContextWebGL=function(t,e){for(var r=0,i=["webgl","experimental-webgl"];r<i.length;){var n=i[r];++r;var a=t.getContext(n,e);if(null!=a)return a}return null};var $n=function(t){if(t instanceof Array&&null==t.__enum__)this.a=t,this.byteLength=t.length;else{var e=t;this.a=[];for(var r=0,i=e;r<i;){var n=r++;this.a[n]=0}this.byteLength=e}};a["js.html.compat.ArrayBuffer"]=$n,$n.__name__=["js","html","compat","ArrayBuffer"],$n.sliceImpl=function(t,e){var r=new pa(this,t,null==e?null:e-t),i=new fa(r.byteLength),n=new pa(i);return n.set(r),i},$n.prototype={slice:function(t,e){return new $n(this.a.slice(t,e))},__class__:$n};var Qn=function(){};a["js.html.compat.Float32Array"]=Qn,Qn.__name__=["js","html","compat","Float32Array"],Qn._new=function(t,e,r){var i;if("number"==typeof t){i=[];for(var n=0,a=t;n<a;){var s=n++;i[s]=0}i.byteLength=i.length<<2,i.byteOffset=0;for(var o=[],h=0,l=i.length<<2;h<l;){h++;o.push(0)}i.buffer=new $n(o)}else if(En.__instanceof(t,$n)){var u=t;null==e&&(e=0),null==r&&(r=u.byteLength-e>>2),i=[];for(var R=0,c=r;R<c;){var _=(R++,u.a[e++]|u.a[e++]<<8|u.a[e++]<<16|u.a[e++]<<24);i.push(ki.i32ToFloat(_))}i.byteLength=i.length<<2,i.byteOffset=e,i.buffer=u}else{if(!(t instanceof Array&&null==t.__enum__))throw new Zn("TODO "+g.string(t));i=t.slice();for(var f=[],p=0;p<i.length;){var d=i[p];++p;var v=ki.floatToI32(d);f.push(255&v),f.push(v>>8&255),f.push(v>>16&255),f.push(v>>>24)}i.byteLength=i.length<<2,i.byteOffset=0,i.buffer=new $n(f)}return i.subarray=Qn._subarray,i.set=Qn._set,i},Qn._set=function(t,e){if(En.__instanceof(t.buffer,$n)){var r=t;if(t.byteLength+e>this.byteLength)throw new Zn("set() outside of range");for(var i=0,n=t.byteLength;i<n;){var a=i++;this[a+e]=r[a]}}else{if(!(t instanceof Array&&null==t.__enum__))throw new Zn("TODO");var s=t;if(s.length+e>this.byteLength)throw new Zn("set() outside of range");for(var o=0,h=s.length;o<h;){var l=o++;this[l+e]=s[l]}}},Qn._subarray=function(t,e){var r=Qn._new(this.slice(t,e));return r.byteOffset=4*t,r};var Jn=function(){};a["js.html.compat.Uint8Array"]=Jn,Jn.__name__=["js","html","compat","Uint8Array"],Jn._new=function(t,e,r){var i;if("number"==typeof t){i=[];for(var n=0,a=t;n<a;){var s=n++;i[s]=0}i.byteLength=i.length,i.byteOffset=0,i.buffer=new $n(i)}else if(En.__instanceof(t,$n)){var o=t;null==e&&(e=0),null==r&&(r=o.byteLength-e),i=0==e?o.a:o.a.slice(e,e+r),i.byteLength=i.length,i.byteOffset=e,i.buffer=o}else{if(!(t instanceof Array&&null==t.__enum__))throw new Zn("TODO "+g.string(t));i=t.slice(),i.byteLength=i.length,i.byteOffset=0,i.buffer=new $n(i)}return i.subarray=Jn._subarray,i.set=Jn._set,i},Jn._set=function(t,e){if(En.__instanceof(t.buffer,$n)){var r=t;if(t.byteLength+e>this.byteLength)throw new Zn("set() outside of range");for(var i=0,n=t.byteLength;i<n;){var a=i++;this[a+e]=r[a]}}else{if(!(t instanceof Array&&null==t.__enum__))throw new Zn("TODO");var s=t;if(s.length+e>this.byteLength)throw new Zn("set() outside of range");for(var o=0,h=s.length;o<h;){var l=o++;this[l+e]=s[l]}}},Jn._subarray=function(t,e){var r=Jn._new(this.slice(t,e));return r.byteOffset=t,r};var ta=function(t,e){P.call(this,[t,e])};a["msignal.Signal2"]=ta,ta.__name__=["msignal","Signal2"],ta.__super__=P,ta.prototype=e(P.prototype,{dispatch:function(t,e){for(var r=this.slots;r.nonEmpty;)r.head.execute(t,e),r=r.tail},createSlot:function(t,e,r){return null==r&&(r=0),null==e&&(e=!1),new na(this,t,e,r)},__class__:ta});var ea=function(t,e,r,i){null==i&&(i=0),null==r&&(r=!1),this.signal=t,this.set_listener(e),this.once=r,this.priority=i,this.enabled=!0};a["msignal.Slot"]=ea,ea.__name__=["msignal","Slot"],ea.prototype={remove:function(){this.signal.remove(this.listener)},set_listener:function(t){return this.listener=t},__class__:ea};var ra=function(t,e,r,i){null==i&&(i=0),null==r&&(r=!1),ea.call(this,t,e,r,i)};a["msignal.Slot0"]=ra,ra.__name__=["msignal","Slot0"],ra.__super__=ea,ra.prototype=e(ea.prototype,{execute:function(){this.enabled&&(this.once&&this.remove(),this.listener())},__class__:ra});var ia=function(t,e,r,i){null==i&&(i=0),null==r&&(r=!1),ea.call(this,t,e,r,i)};a["msignal.Slot1"]=ia,ia.__name__=["msignal","Slot1"],ia.__super__=ea,ia.prototype=e(ea.prototype,{execute:function(t){this.enabled&&(this.once&&this.remove(),null!=this.param&&(t=this.param),this.listener(t))},__class__:ia});var na=function(t,e,r,i){null==i&&(i=0),null==r&&(r=!1),ea.call(this,t,e,r,i)};a["msignal.Slot2"]=na,na.__name__=["msignal","Slot2"],na.__super__=ea,na.prototype=e(ea.prototype,{execute:function(t,e){this.enabled&&(this.once&&this.remove(),null!=this.param1&&(t=this.param1),null!=this.param2&&(e=this.param2),this.listener(t,e))},__class__:na});var aa,sa=0;a.Math=Math,String.prototype.__class__=a.String=String,String.__name__=["String"],a.Array=Array,Array.__name__=["Array"],Date.prototype.__class__=a.Date=Date,Date.__name__=["Date"];var oa=a.Int={__name__:["Int"]},ha=a.Dynamic={__name__:["Dynamic"]},la=a.Float=Number;la.__name__=["Float"];var ua=a.Bool=Boolean;ua.__ename__=["Bool"];var Ra=a.Class={__name__:["Class"]},ca={};B.NIL=new B(null,null);var _a={},fa=t.ArrayBuffer||$n;null==fa.prototype.slice&&(fa.prototype.slice=$n.sliceImpl);var ga=t.Float32Array||Qn._new,pa=t.Uint8Array||Jn._new;j.HASHIDS=new w("this is my salt",0,"abcdefghijkmnopqrstuvwxyz1234567890"),O.signalUpdate=new V,O.signalInited=new D,U.EMPTY_ARRAY=[],ct.STYLE={content:"BaseCardView_linyx_content",_ns:"BaseCardView_linyx_",shown:"BaseCardView_linyx_shown",delayPopup:"BaseCardView_linyx_delay-popup",uniqueid:"BaseCardView_linyx_uniqueid",cardview:"BaseCardView_linyx_cardview",hudIndicators:"BaseCardView_linyx_hud-indicators",popupCardview:"BaseCardView_linyx_popup-cardview",cardstack:"BaseCardView_linyx_cardstack"},_t.IS_TOUCH_BASED=!1,ft.CompName="CardV",ft.STYLE={polynomial:"CardV_8jvq7_polynomial",_ns:"CardV_8jvq7_",card:"CardV_8jvq7_card"},gt.BELT_AMOUNT=7,gt.STYLE=ct.STYLE,gt.mySTYLE={stopIcon:"CardView_nmvbm_stop-icon",_ns:"CardView_nmvbm_",ready:"CardView_nmvbm_ready",icon:"CardView_nmvbm_icon"},pt.TAG="GameMenu",pt.STYLE={gameOpts:"GameMenu_1hijr_game-opts",gameMenu:"GameMenu_1hijr_game-menu",gametitle:"GameMenu_1hijr_gametitle",_ns:"GameMenu_1hijr_",btnZone:"GameMenu_1hijr_btn-zone"},dt.Comp_CardView="CardView",dt.Comp_PopupCardView="PopupCardView",dt.TAG="GameView",dt.STYLE={healthLabel:"GameView_4wc11_health-label",active:"GameView_4wc11_active",showInstruct:"GameView_4wc11_showInstruct",meter:"GameView_4wc11_meter",_ns:"GameView_4wc11_",quitbtn:"GameView_4wc11_quitbtn",xpression:"GameView_4wc11_xpression",gameview:"GameView_4wc11_gameview",gameover:"GameView_4wc11_gameover",blocker:"GameView_4wc11_blocker",healthBar:"GameView_4wc11_health-bar",anim:"GameView_4wc11_anim",helpbtn:"GameView_4wc11_helpbtn"},mt.BELT_AMOUNT=7,mt.STYLE=ct.STYLE,yt.NAME="TrainProgressBarView",yt.STYLE={marker:"TrainProgressBarView_1887h_marker",enemyScrub:"TrainProgressBarView_1887h_enemy-scrub",trainprogressBar:"TrainProgressBarView_1887h_trainprogress-bar",_ns:"TrainProgressBarView_1887h_",scrubber:"TrainProgressBarView_1887h_scrubber",scrub:"TrainProgressBarView_1887h_scrub"},Ot._worlds=[],te.__meta__={obj:{systems:["ecx.common.systems.FpsMeter","ecx.common.systems.FpsMeter",7,7,"ecx.common.components.Fsm","ecx.common.components.Fsm",10,10,"cstrain.rules.systems.MonsterChasePlayerSystem","cstrain.rules.systems.MonsterChasePlayerSystem",0,0,"ecx.common.systems.FsmSystem","ecx.common.systems.FsmSystem",6,6,"cstrain.rules.world.HealthComp","cstrain.rules.world.HealthComp",11,11,"cstrain.rules.world.MonsterModelComp","cstrain.rules.world.MonsterModelComp",3,3,"cstrain.rules.world.UpdateService","cstrain.rules.world.UpdateService",1,1,"cstrain.rules.world.IBGTrainComp","cstrain.rules.world.IBGTrainComp",2,2,"cstrain.rules.systems.GameVueDataSystem","cstrain.rules.systems.GameVueDataSystem",9,9,"ecx.common.systems.TimeSystem","ecx.common.systems.TimeSystem",4,4,"ecx.common.systems.SystemRunner","ecx.common.systems.SystemRunner",5,5,"ecx.common.components.Name","ecx.common.components.Name",8,8]}},Se.GUID=0,He.TFILTERS=[[[9728,9728],[9729,9729]],[[9728,9984],[9729,9985]],[[9728,9986],[9729,9987]]],He.TWRAP=[33071,10497],He.FACES=[0,1028,1029,1032],He.BLEND=[1,0,770,768,772,774,771,769,773,775,32769,32771,32770,32772,776],He.COMPARE=[519,512,514,517,516,518,513,515],He.STENCIL_OP=[7680,0,7681,7682,34055,7683,34056,5386],He.OP=[32774,32778,32779],He.CUBE_FACES=[34069,34070,34071,34072,34073,34074],Ke.ALL_FLAGS=Te.__empty_constructs__,hr.defaultKillAlphaThreshold=.5,hr.loadingTextureColor=-65281,cr.current=new cr("Default"),pr.UID=0,pr.nativeFormat=gr.RGBA,pr.nativeFlip=!1,pr.noiseTextures=new bi,mr.__meta__={obj:{ignore:["shader"]},fields:{quality:{range:[1,4,1],inspect:null},sigma:{range:[0,2],inspect:null},passes:{range:[0,5,1],inspect:null}}},xr.SRC="oy4:funsaoy4:argsahy4:exproy1:ejy13:hxsl.TExprDef:4:1aoR3jR4:5:3jy16:haxe.macro.Binop:4:0oR3jR4:1:1oy4:kindjy12:hxsl.VarKind:4:0y4:namey8:positiony4:typejy9:hxsl.Type:5:2i4jy12:hxsl.VecType:1:0y6:parentoR6r10R8y6:outputR10jR11:12:1ar9oR6r10R8y5:colorR10jR11:5:2i4r11R13r13y2:idi-262ghR16i-260gR16i-261gy1:poy4:filey79:C%3A%5CHaxeToolkit_34%5Chaxe%5Clib%5Cheaps%2F1%2C0%2C0%2Fh3d%2Fpass%2FBorder.hxy3:maxi295y3:mini280gy1:tr12goR3jR4:8:2oR3jR4:2:1jy12:hxsl.TGlobal:40:0R17oR18R19R20i302R21i298gR22jR11:13:1ahgaoR3jR4:1:1oR6jR7:1:0R8R9R10jR11:5:2i2r11R13oR6r30R8y5:inputR10jR11:12:1ar29hR16i-258gR16i-259gR17oR18R19R20i317R21i303gR22r31goR3jR4:0:1jy10:hxsl.Const:3:1zR17oR18R19R20i320R21i319gR22jR11:3:0goR3jR4:0:1jR25:3:1i1R17oR18R19R20i323R21i322gR22r41ghR17oR18R19R20i324R21i298gR22jR11:5:2i4r11gR17oR18R19R20i324R21i280gR22r12ghR17oR18R19R20i330R21i274gR22jR11:0:0gR6jy17:hxsl.FunctionKind:0:0y3:refoR6jR7:6:0R8y6:vertexR10jR11:13:1aoR1ahy3:retr53ghR16i-263gR29r53goR1ahR2oR3jR4:4:1aoR3jR4:5:3r7oR3jR4:1:1r15R17oR18R19R20i374R21i362gR22r16goR3jR4:1:1oR6jR7:2:0R8R15R10jR11:5:2i4r11R16i-257gR17oR18R19R20i382R21i377gR22r72gR17oR18R19R20i382R21i362gR22r16ghR17oR18R19R20i388R21i356gR22r53gR6jR26:1:0R27oR6r56R8y8:fragmentR10jR11:13:1aoR1ahR29r53ghR16i-264gR29r53ghR8y29:h3d.pass._Border.BorderShadery4:varsar70r32r13r55r80hg",wr.SRC="oy4:funsaoy4:argsahy4:exproy1:ejy13:hxsl.TExprDef:4:1aoR3jR4:5:3jy16:haxe.macro.Binop:4:0oR3jR4:1:1oy4:kindjy12:hxsl.VarKind:4:0y4:namey8:positiony4:typejy9:hxsl.Type:5:2i4jy12:hxsl.VecType:1:0y6:parentoR6r10R8y6:outputR10jR11:12:1ar9oR6r10R8y5:colorR10jR11:5:2i4r11R13r13y2:idi-153ghR16i-151gR16i-152gy1:poy4:filey87:C%3A%5CHaxeToolkit_34%5Chaxe%5Clib%5Cheaps%2F1%2C0%2C0%2Fh3d%2Fshader%2FScreenShader.hxy3:maxi262y3:mini247gy1:tr12goR3jR4:8:2oR3jR4:2:1jy12:hxsl.TGlobal:40:0R17oR18R19R20i269R21i265gR22jR11:13:1ahgaoR3jR4:1:1oR6jR7:1:0R8R9R10jR11:5:2i2r11R13oR6r30R8y5:inputR10jR11:12:1ar29oR6r30R8y2:uvR10jR11:5:2i2r11R13r32R16i-150ghR16i-148gR16i-149gR17oR18R19R20i284R21i270gR22r31goR3jR4:0:1jy10:hxsl.Const:3:1zR17oR18R19R20i287R21i286gR22jR11:3:0goR3jR4:0:1jR26:3:1i1R17oR18R19R20i290R21i289gR22r43ghR17oR18R19R20i291R21i265gR22jR11:5:2i4r11gR17oR18R19R20i291R21i247gR22r12ghR17oR18R19R20i297R21i241gR22jR11:0:0gR6jy17:hxsl.FunctionKind:0:0y3:refoR6jR7:6:0R8y6:vertexR10jR11:13:1aoR1ahy3:retr55ghR16i-154gR30r55ghR8y23:h3d.shader.ScreenShadery4:varsar32r13r57hg",jr.SRC="oy4:funsaoy4:argsahy4:exproy1:ejy13:hxsl.TExprDef:4:1aoR3jR4:5:3jy16:haxe.macro.Binop:4:0oR3jR4:1:1oy4:kindjy12:hxsl.VarKind:4:0y4:namey8:positiony4:typejy9:hxsl.Type:5:2i4jy12:hxsl.VecType:1:0y6:parentoR6r10R8y6:outputR10jR11:12:1ar9oR6r10R8y5:colorR10jR11:5:2i4r11R13r13y2:idi-160ghR16i-158gR16i-159gy1:poy4:filey87:C%3A%5CHaxeToolkit_34%5Chaxe%5Clib%5Cheaps%2F1%2C0%2C0%2Fh3d%2Fshader%2FScreenShader.hxy3:maxi262y3:mini247gy1:tr12goR3jR4:8:2oR3jR4:2:1jy12:hxsl.TGlobal:40:0R17oR18R19R20i269R21i265gR22jR11:13:1ahgaoR3jR4:1:1oR6jR7:1:0R8R9R10jR11:5:2i2r11R13oR6r30R8y5:inputR10jR11:12:1ar29oR6r30R8y2:uvR10jR11:5:2i2r11R13r32R16i-157ghR16i-155gR16i-156gR17oR18R19R20i284R21i270gR22r31goR3jR4:0:1jy10:hxsl.Const:3:1zR17oR18R19R20i287R21i286gR22jR11:3:0goR3jR4:0:1jR26:3:1i1R17oR18R19R20i290R21i289gR22r43ghR17oR18R19R20i291R21i265gR22jR11:5:2i4r11gR17oR18R19R20i291R21i247gR22r12ghR17oR18R19R20i297R21i241gR22jR11:0:0gR6jy17:hxsl.FunctionKind:0:0y3:refoR6jR7:6:0R8y6:vertexR10jR11:13:1aoR1ahy3:retr55ghR16i-164gR30r55goR1ahR2oR3jR4:4:1aoR3jR4:5:3r7oR3jR4:1:1oR6r10R8y12:calculatedUVR10jR11:5:2i2r11R16i-163gR17oR18y77:C%3A%5CHaxeToolkit_34%5Chaxe%5Clib%5Cheaps%2F1%2C0%2C0%2Fh3d%2Fpass%2FCopy.hxR20i237R21i225gR22r70goR3jR4:1:1r34R17oR18R32R20i248R21i240gR22r35gR17oR18R32R20i248R21i225gR22r70ghR17oR18R32R20i254R21i219gR22r55gR6jR27:2:0R28oR6r58R8y8:__init__R10jR11:13:1aoR1ahR30r55ghR16i-165gR30r55goR1ahR2oR3jR4:4:1aoR3jR4:5:3r7oR3jR4:1:1oR6r10R8y10:pixelColorR10jR11:5:2i4r11R16i-162gR17oR18R32R20i304R21i294gR22r93goR3jR4:8:2oR3jR4:2:1jR23:33:0R17oR18R32R20i314R21i307gR22jR11:13:1aoR1aoR8y1:_R10jR11:10:0goR8R25R10jR11:5:2i2r11ghR30jR11:5:2i4r11ghgaoR3jR4:1:1oR6jR7:2:0R8y7:textureR10r105R16i-161gR17oR18R32R20i314R21i307gR22r105goR3jR4:1:1r69R17oR18R32R20i331R21i319gR22r70ghR17oR18R32R20i332R21i307gR22r108gR17oR18R32R20i332R21i294gR22r93ghR17oR18R32R20i338R21i288gR22r55gR6r80R28oR6r58R8y16:__init__fragmentR10jR11:13:1aoR1ahR30r55ghR16i-166gR30r55goR1ahR2oR3jR4:4:1aoR3jR4:5:3r7oR3jR4:1:1r15R17oR18R32R20i382R21i370gR22r16goR3jR4:1:1r92R17oR18R32R20i395R21i385gR22r93gR17oR18R32R20i395R21i370gR22r16ghR17oR18R32R20i401R21i364gR22r55gR6jR27:1:0R28oR6r58R8y8:fragmentR10jR11:13:1aoR1ahR30r55ghR16i-167gR30r55ghR8y25:h3d.pass._Copy.CopyShadery4:varsar32r13r112r92r69r57r81r125r146hg",Tr.__meta__={fields:{cameraView:{global:["camera.view"]},cameraNear:{global:["camera.zNear"]},cameraFar:{global:["camera.zFar"]},cameraProj:{global:["camera.proj"]},cameraPos:{global:["camera.position"]},cameraProjDiag:{global:["camera.projDiag"]},cameraViewProj:{global:["camera.viewProj"]},cameraInverseViewProj:{global:["camera.inverseViewProj"]},globalTime:{global:["global.time"]},pixelSize:{global:["global.pixelSize"]},globalModelView:{global:["global.modelView"]},globalModelViewInverse:{global:["global.modelViewInverse"]}}},Cr.SRC="oy4:funsaoy4:argsahy4:exproy1:ejy13:hxsl.TExprDef:4:1aoR3jR4:5:3jy16:haxe.macro.Binop:4:0oR3jR4:1:1oy4:kindjy12:hxsl.VarKind:4:0y4:namey8:positiony4:typejy9:hxsl.Type:5:2i4jy12:hxsl.VecType:1:0y6:parentoR6r10R8y6:outputR10jR11:12:1ar9oR6r10R8y7:colorIDR10jR11:5:2i4r11R13r13y2:idi-37ghR16i-35gR16i-36gy1:poy4:filey85:C%3A%5CHaxeToolkit_34%5Chaxe%5Clib%5Cheaps%2F1%2C0%2C0%2Fh3d%2Fpass%2FHardwarePick.hxy3:maxi246y3:mini231gy1:tr12goR3jR4:5:3jR5:1:0oR3jR4:3:1oR3jR4:5:3jR5:0:0oR3jR4:1:1r9R17oR18R19R20i265R21i250gR22r12goR3jR4:5:3r21oR3jR4:8:2oR3jR4:2:1jy12:hxsl.TGlobal:40:0R17oR18R19R20i272R21i268gR22jR11:13:1ahgaoR3jR4:9:2oR3jR4:1:1oR6jR7:2:0R8y8:viewportR10jR11:5:2i4r11R16i-34gR17oR18R19R20i281R21i273gR22r41gajy14:hxsl.Component:0:0jR25:1:0hR17oR18R19R20i284R21i273gR22jR11:5:2i2r11goR3jR4:0:1jy10:hxsl.Const:3:1d0R17oR18R19R20i288R21i286gR22jR11:3:0goR3jR4:0:1jR26:3:1d0R17oR18R19R20i292R21i290gR22r54ghR17oR18R19R20i293R21i268gR22jR11:5:2i4r11goR3jR4:9:2oR3jR4:1:1r9R17oR18R19R20i311R21i296gR22r12gajR25:3:0hR17oR18R19R20i313R21i296gR22r54gR17oR18R19R20i313R21i268gR22r61gR17oR18R19R20i313R21i250gR22jR11:5:2i4r11gR17oR18R19R20i314R21i249gR22r74goR3jR4:8:2oR3jR4:2:1r31R17oR18R19R20i321R21i317gR22r35gaoR3jR4:9:2oR3jR4:1:1r39R17oR18R19R20i330R21i322gR22r41gajR25:2:0r67hR17oR18R19R20i333R21i322gR22jR11:5:2i2r11goR3jR4:0:1jR26:3:1d1R17oR18R19R20i337R21i335gR22r54goR3jR4:0:1jR26:3:1d1R17oR18R19R20i341R21i339gR22r54ghR17oR18R19R20i342R21i317gR22jR11:5:2i4r11gR17oR18R19R20i342R21i249gR22jR11:5:2i4r11gR17oR18R19R20i342R21i231gR22r12ghR17oR18R19R20i347R21i226gR22jR11:0:0gR6jy17:hxsl.FunctionKind:0:0y3:refoR6jR7:6:0R8y6:vertexR10jR11:13:1aoR1ahy3:retr109ghR16i-38gR30r109goR1ahR2oR3jR4:4:1aoR3jR4:5:3r7oR3jR4:1:1r15R17oR18R19R20i389R21i375gR22r16goR3jR4:1:1oR6r40R8R15R10jR11:5:2i4r11R16i-33gR17oR18R19R20i399R21i392gR22r127gR17oR18R19R20i399R21i375gR22r16ghR17oR18R19R20i404R21i370gR22r109gR6jR27:1:0R28oR6r112R8y8:fragmentR10jR11:13:1aoR1ahR30r109ghR16i-39gR30r109ghR8y33:h3d.pass._HardwarePick.FixedColory4:varsar126r39r13r111r135hg",Ir.__meta__={fields:{border:{ignore:null}}},Yr.SRC="oy4:funsaoy4:argsahy4:exproy1:ejy13:hxsl.TExprDef:4:1aoR3jR4:5:3jy16:haxe.macro.Binop:4:0oR3jR4:1:1oy4:kindjy12:hxsl.VarKind:4:0y4:namey10:lightColory4:typejy9:hxsl.Type:5:2i3jy12:hxsl.VecType:1:0y2:idi-249gy1:poy4:filey87:C%3A%5CHaxeToolkit_34%5Chaxe%5Clib%5Cheaps%2F1%2C0%2C0%2Fh3d%2Fshader%2FAmbientLight.hxy3:maxi349y3:mini339gy1:tr12goR3jR4:10:3oR3jR4:1:1oR6jR7:2:0R8y8:additiveR10jR11:2:0y10:qualifiersajy17:hxsl.VarQualifier:0:1nhR13i-250gR14oR15R16R17i360R18i352gR19r19goR3jR4:1:1oR6jR7:0:0R8y12:ambientLightR10jR11:5:2i3r11y6:parentoR6r26R8y6:globalR10jR11:12:1ar25oR6r26R8y16:perPixelLightingR10r19R24r28R21ajR22:0:1nhR13i-246ghR13i-244gR13i-245gR14oR15R16R17i382R18i363gR19r27goR3jR4:8:2oR3jR4:2:1jy12:hxsl.TGlobal:39:0R14oR15R16R17i389R18i385gR19jR11:13:1ahgaoR3jR4:0:1jy10:hxsl.Const:3:1d0R14oR15R16R17i392R18i390gR19jR11:3:0ghR14oR15R16R17i393R18i385gR19jR11:5:2i3r11gR14oR15R16R17i393R18i352gR19r27gR14oR15R16R17i393R18i339gR19r12ghR14oR15R16R17i399R18i333gR19jR11:0:0gR6jy17:hxsl.FunctionKind:2:0y3:refoR6jR7:6:0R8y8:__init__R10jR11:13:1aoR1ahy3:retr58ghR13i-251gR32r58goR1ahR2oR3jR4:4:1aoR3jR4:5:3r7oR3jR4:1:1oR6r10R8y15:lightPixelColorR10jR11:5:2i3r11R13i-248gR14oR15R16R17i454R18i439gR19r73goR3jR4:10:3oR3jR4:1:1r17R14oR15R16R17i465R18i457gR19r19goR3jR4:1:1r25R14oR15R16R17i487R18i468gR19r27goR3jR4:8:2oR3jR4:2:1r38R14oR15R16R17i494R18i490gR19r42gaoR3jR4:0:1jR28:3:1d0R14oR15R16R17i497R18i495gR19r48ghR14oR15R16R17i498R18i490gR19jR11:5:2i3r11gR14oR15R16R17i498R18i457gR19r27gR14oR15R16R17i498R18i439gR19r73ghR14oR15R16R17i504R18i433gR19r58gR6r59R30oR6r61R8y16:__init__fragmentR10jR11:13:1aoR1ahR32r58ghR13i-252gR32r58goR1aoR6r10R8R9R10jR11:5:2i3r11R13i-253ghR2oR3jR4:4:1aoR3jR4:12:1oR3jR4:10:3oR3jR4:1:1r17R14oR15R16R17i578R18i570gR19r19goR3jR4:1:1r108R14oR15R16R17i591R18i581gR19r109goR3jR4:3:1oR3jR4:5:3jR5:0:0oR3jR4:1:1r25R14oR15R16R17i614R18i595gR19r27goR3jR4:5:3jR5:1:0oR3jR4:8:2oR3jR4:2:1jR27:22:0R14oR15R16R17i642R18i617gR19jR11:13:1aoR1aoR8y1:_R10r27goR8y1:bR10r48ghR32jR11:5:2i3r11ghgaoR3jR4:3:1oR3jR4:5:3jR5:3:0oR3jR4:0:1jR28:3:1i1R14oR15R16R17i619R18i618gR19r48goR3jR4:1:1r25R14oR15R16R17i641R18i622gR19r27gR14oR15R16R17i641R18i618gR19r27gR14oR15R16R17i642R18i617gR19r27goR3jR4:0:1jR28:3:1d0R14oR15R16R17i649R18i647gR19r48ghR14oR15R16R17i650R18i617gR19r138goR3jR4:1:1r108R14oR15R16R17i663R18i653gR19r109gR14oR15R16R17i663R18i617gR19jR11:5:2i3r11gR14oR15R16R17i663R18i595gR19jR11:5:2i3r11gR14oR15R16R17i664R18i594gR19r169gR14oR15R16R17i664R18i570gR19r109gR14oR15R16R17i664R18i563gR19r58ghR14oR15R16R17i670R18i557gR19r58gR6jR29:3:0R30oR6r61R8y9:calcLightR10jR11:13:1aoR1aoR8R9R10r109ghR32jR11:5:2i3r11ghR13i-254gR32r184goR1ahR2oR3jR4:4:1aoR3jR4:10:3oR3jR4:6:2jy15:haxe.macro.Unop:2:0oR3jR4:1:1r30R14oR15R16R17i728R18i705gR19r19gR14oR15R16R17i728R18i704gR19r19goR3jR4:5:3jR5:20:1r127oR3jR4:9:2oR3jR4:1:1oR6r10R8y10:pixelColorR10jR11:5:2i4r11R13i-247gR14oR15R16R17i741R18i731gR19r203gajy14:hxsl.Component:0:0jR40:1:0jR40:2:0hR14oR15R16R17i745R18i731gR19jR11:5:2i3r11goR3jR4:8:2oR3jR4:1:1r179R14oR15R16R17i758R18i749gR19r185gaoR3jR4:1:1r9R14oR15R16R17i769R18i759gR19r12ghR14oR15R16R17i770R18i749gR19r184gR14oR15R16R17i770R18i731gR19r212gnR14oR15R16R17i770R18i700gR19r58ghR14oR15R16R17i776R18i694gR19r58gR6jR29:0:0R30oR6r61R8y6:vertexR10jR11:13:1aoR1ahR32r58ghR13i-255gR32r58goR1ahR2oR3jR4:4:1aoR3jR4:10:3oR3jR4:1:1r30R14oR15R16R17i835R18i812gR19r19goR3jR4:5:3jR5:20:1r127oR3jR4:9:2oR3jR4:1:1r202R14oR15R16R17i848R18i838gR19r203gar207r208r209hR14oR15R16R17i852R18i838gR19jR11:5:2i3r11goR3jR4:8:2oR3jR4:1:1r179R14oR15R16R17i865R18i856gR19r185gaoR3jR4:1:1r72R14oR15R16R17i881R18i866gR19r73ghR14oR15R16R17i882R18i856gR19r184gR14oR15R16R17i882R18i838gR19r252gnR14oR15R16R17i882R18i808gR19r58ghR14oR15R16R17i888R18i802gR19r58gR6jR29:1:0R30oR6r61R8y8:fragmentR10jR11:13:1aoR1ahR32r58ghR13i-256gR32r58ghR8y23:h3d.shader.AmbientLighty4:varsar28r202r72r9r17r60r101r179r230r270hg",Wr.SRC="oy4:funsaoy4:argsahy4:exproy1:ejy13:hxsl.TExprDef:4:1aoR3jR4:5:3jy16:haxe.macro.Binop:4:0oR3jR4:1:1oy4:kindjy12:hxsl.VarKind:4:0y4:namey14:spritePositiony4:typejy9:hxsl.Type:5:2i4jy12:hxsl.VecType:1:0y2:idi-11gy1:poy4:filey81:C%3A%5CHaxeToolkit_34%5Chaxe%5Clib%5Cheaps%2F1%2C0%2C0%2Fh3d%2Fshader%2FBase2d.hxy3:maxi983y3:mini969gy1:tr12goR3jR4:8:2oR3jR4:2:1jy12:hxsl.TGlobal:40:0R14oR15R16R17i990R18i986gR19jR11:13:1ahgaoR3jR4:1:1oR6jR7:1:0R8y8:positionR10jR11:5:2i2r11y6:parentoR6r25R8y5:inputR10jR11:12:1ar24oR6r25R8y2:uvR10jR11:5:2i2r11R22r27R13i-3goR6r25R8y5:colorR10jR11:5:2i4r11R22r27R13i-4ghR13i-1gR13i-2gR14oR15R16R17i1005R18i991gR19r26goR3jR4:1:1oR6jR7:2:0R8y6:zValueR10jR11:3:0R13i-9gR14oR15R16R17i1013R18i1007gR19r39goR3jR4:0:1jy10:hxsl.Const:3:1i1R14oR15R16R17i1016R18i1015gR19r39ghR14oR15R16R17i1017R18i986gR19jR11:5:2i4r11gR14oR15R16R17i1017R18i969gR19r12goR3jR4:10:3oR3jR4:1:1oR6r38R8y10:isRelativeR10jR11:2:0y10:qualifiersajy17:hxsl.VarQualifier:0:1nhR13i-16gR14oR15R16R17i1037R18i1027gR19r54goR3jR4:4:1aoR3jR4:5:3r7oR3jR4:9:2oR3jR4:1:1oR6r10R8y16:absolutePositionR10jR11:5:2i4r11R13i-12gR14oR15R16R17i1063R18i1047gR19r65gajy14:hxsl.Component:0:0hR14oR15R16R17i1065R18i1047gR19r39goR3jR4:8:2oR3jR4:2:1jR20:29:0R14oR15R16R17i1093R18i1068gR19jR11:13:1aoR1aoR8y1:_R10jR11:5:2i3r11goR8y1:bR10jR11:5:2i3r11ghy3:retr39ghgaoR3jR4:8:2oR3jR4:2:1jR20:39:0R14oR15R16R17i1072R18i1068gR19jR11:13:1ahgaoR3jR4:9:2oR3jR4:1:1r9R14oR15R16R17i1087R18i1073gR19r12gar69jR32:1:0hR14oR15R16R17i1090R18i1073gR19jR11:5:2i2r11goR3jR4:0:1jR27:3:1i1R14oR15R16R17i1092R18i1091gR19r39ghR14oR15R16R17i1093R18i1068gR19r81goR3jR4:1:1oR6r38R8y15:absoluteMatrixAR10jR11:5:2i3r11R13i-18gR14oR15R16R17i1113R18i1098gR19r111ghR14oR15R16R17i1114R18i1068gR19r39gR14oR15R16R17i1114R18i1047gR19r39goR3jR4:5:3r7oR3jR4:9:2oR3jR4:1:1r64R14oR15R16R17i1137R18i1121gR19r65gar99hR14oR15R16R17i1139R18i1121gR19r39goR3jR4:8:2oR3jR4:2:1r74R14oR15R16R17i1167R18i1142gR19jR11:13:1aoR1aoR8R33R10jR11:5:2i3r11gr82hR35r39ghgaoR3jR4:8:2oR3jR4:2:1r88R14oR15R16R17i1146R18i1142gR19r92gaoR3jR4:9:2oR3jR4:1:1r9R14oR15R16R17i1161R18i1147gR19r12gar69r99hR14oR15R16R17i1164R18i1147gR19jR11:5:2i2r11goR3jR4:0:1jR27:3:1i1R14oR15R16R17i1166R18i1165gR19r39ghR14oR15R16R17i1167R18i1142gR19r134goR3jR4:1:1oR6r38R8y15:absoluteMatrixBR10jR11:5:2i3r11R13i-19gR14oR15R16R17i1187R18i1172gR19r158ghR14oR15R16R17i1188R18i1142gR19r39gR14oR15R16R17i1188R18i1121gR19r39goR3jR4:5:3r7oR3jR4:9:2oR3jR4:1:1r64R14oR15R16R17i1211R18i1195gR19r65gajR32:2:0jR32:3:0hR14oR15R16R17i1214R18i1195gR19jR11:5:2i2r11goR3jR4:9:2oR3jR4:1:1r9R14oR15R16R17i1231R18i1217gR19r12gar171r172hR14oR15R16R17i1234R18i1217gR19jR11:5:2i2r11gR14oR15R16R17i1234R18i1195gR19r175ghR14oR15R16R17i1241R18i1040gR19jR11:0:0goR3jR4:5:3r7oR3jR4:1:1r64R14oR15R16R17i1268R18i1252gR19r65goR3jR4:1:1r9R14oR15R16R17i1285R18i1271gR19r12gR14oR15R16R17i1285R18i1252gR19r65gR14oR15R16R17i1285R18i1023gR19r188goR3jR4:5:3r7oR3jR4:1:1oR6jR7:3:0R8y12:calculatedUVR10jR11:5:2i2r11R13i-15gR14oR15R16R17i1303R18i1291gR19r204goR3jR4:10:3oR3jR4:1:1oR6r38R8y8:hasUVPosR10r54R29ajR30:0:1nhR13i-22gR14oR15R16R17i1314R18i1306gR19r54goR3jR4:5:3jR5:0:0oR3jR4:5:3jR5:1:0oR3jR4:1:1r29R14oR15R16R17i1325R18i1317gR19r30goR3jR4:9:2oR3jR4:1:1oR6r38R8y5:uvPosR10jR11:5:2i4r11R13i-23gR14oR15R16R17i1333R18i1328gR19r224gar171r172hR14oR15R16R17i1336R18i1328gR19jR11:5:2i2r11gR14oR15R16R17i1336R18i1317gR19jR11:5:2i2r11goR3jR4:9:2oR3jR4:1:1r223R14oR15R16R17i1344R18i1339gR19r224gar69r99hR14oR15R16R17i1347R18i1339gR19jR11:5:2i2r11gR14oR15R16R17i1347R18i1317gR19jR11:5:2i2r11goR3jR4:1:1r29R14oR15R16R17i1358R18i1350gR19r30gR14oR15R16R17i1358R18i1306gR19r244gR14oR15R16R17i1358R18i1291gR19r204goR3jR4:5:3r7oR3jR4:1:1oR6r10R8y10:pixelColorR10jR11:5:2i4r11R13i-13gR14oR15R16R17i1374R18i1364gR19r255goR3jR4:10:3oR3jR4:1:1r53R14oR15R16R17i1387R18i1377gR19r54goR3jR4:5:3r217oR3jR4:1:1oR6r38R8R25R10jR11:5:2i4r11R13i-17gR14oR15R16R17i1395R18i1390gR19r265goR3jR4:1:1r31R14oR15R16R17i1409R18i1398gR19r32gR14oR15R16R17i1409R18i1390gR19jR11:5:2i4r11goR3jR4:1:1r31R14oR15R16R17i1423R18i1412gR19r32gR14oR15R16R17i1423R18i1377gR19r273gR14oR15R16R17i1423R18i1364gR19r255goR3jR4:5:3r7oR3jR4:1:1oR6r10R8y12:textureColorR10jR11:5:2i4r11R13i-14gR14oR15R16R17i1441R18i1429gR19r284goR3jR4:8:2oR3jR4:2:1jR20:33:0R14oR15R16R17i1451R18i1444gR19jR11:13:1aoR1aoR8R33R10jR11:10:0goR8R24R10jR11:5:2i2r11ghR35jR11:5:2i4r11ghgaoR3jR4:1:1oR6r38R8y7:textureR10r296R13i-10gR14oR15R16R17i1451R18i1444gR19r296goR3jR4:1:1r202R14oR15R16R17i1468R18i1456gR19r204ghR14oR15R16R17i1469R18i1444gR19r299gR14oR15R16R17i1469R18i1429gR19r284goR3jR4:5:3jR5:20:1r217oR3jR4:1:1r254R14oR15R16R17i1485R18i1475gR19r255goR3jR4:1:1r283R14oR15R16R17i1501R18i1489gR19r284gR14oR15R16R17i1501R18i1475gR19r255ghR14oR15R16R17i1507R18i963gR19r188gR6jy17:hxsl.FunctionKind:2:0y3:refoR6jR7:6:0R8y8:__init__R10jR11:13:1aoR1ahR35r188ghR13i-29gR35r188goR1ahR2oR3jR4:4:1aoR3jR4:7:2oR6r10R8y3:tmpR10jR11:5:2i3r11R13i-32goR3jR4:8:2oR3jR4:2:1r88R14oR15R16R17i1610R18i1606gR19r92gaoR3jR4:9:2oR3jR4:1:1r64R14oR15R16R17i1627R18i1611gR19r65gar69r99hR14oR15R16R17i1630R18i1611gR19jR11:5:2i2r11goR3jR4:0:1jR27:3:1i1R14oR15R16R17i1633R18i1632gR19r39ghR14oR15R16R17i1634R18i1606gR19r338gR14oR15R16R17i1635R18i1596gR19r188goR3jR4:5:3r7oR3jR4:1:1oR6r10R8y14:outputPositionR10jR11:5:2i4r11R13i-28gR14oR15R16R17i1654R18i1640gR19r363goR3jR4:8:2oR3jR4:2:1r17R14oR15R16R17i1661R18i1657gR19r21gaoR3jR4:8:2oR3jR4:2:1r74R14oR15R16R17i1671R18i1668gR19jR11:13:1aoR1aoR8R33R10r338gr82hR35r39ghgaoR3jR4:1:1r337R14oR15R16R17i1671R18i1668gR19r338goR3jR4:1:1oR6r38R8y13:filterMatrixAR10jR11:5:2i3r11R13i-20gR14oR15R16R17i1689R18i1676gR19r386ghR14oR15R16R17i1690R18i1668gR19r39goR3jR4:8:2oR3jR4:2:1r74R14oR15R16R17i1700R18i1697gR19jR11:13:1aoR1aoR8R33R10r338gr82hR35r39ghgaoR3jR4:1:1r337R14oR15R16R17i1700R18i1697gR19r338goR3jR4:1:1oR6r38R8y13:filterMatrixBR10jR11:5:2i3r11R13i-21gR14oR15R16R17i1718R18i1705gR19r406ghR14oR15R16R17i1719R18i1697gR19r39goR3jR4:9:2oR3jR4:1:1r64R14oR15R16R17i1742R18i1726gR19r65gar171r172hR14oR15R16R17i1745R18i1726gR19jR11:5:2i2r11ghR14oR15R16R17i1751R18i1657gR19jR11:5:2i4r11gR14oR15R16R17i1751R18i1640gR19r363goR3jR4:5:3r7oR3jR4:9:2oR3jR4:1:1r362R14oR15R16R17i1800R18i1786gR19r363gar69r99hR14oR15R16R17i1803R18i1786gR19jR11:5:2i2r11goR3jR4:5:3r217oR3jR4:3:1oR3jR4:5:3r215oR3jR4:9:2oR3jR4:1:1r362R14oR15R16R17i1821R18i1807gR19r363gar69r99hR14oR15R16R17i1824R18i1807gR19jR11:5:2i2r11goR3jR4:9:2oR3jR4:1:1oR6r38R8y8:viewportR10jR11:5:2i4r11R13i-27gR14oR15R16R17i1835R18i1827gR19r447gar69r99hR14oR15R16R17i1838R18i1827gR19jR11:5:2i2r11gR14oR15R16R17i1838R18i1807gR19jR11:5:2i2r11gR14oR15R16R17i1839R18i1806gR19r456goR3jR4:9:2oR3jR4:1:1r446R14oR15R16R17i1850R18i1842gR19r447gar171r172hR14oR15R16R17i1853R18i1842gR19jR11:5:2i2r11gR14oR15R16R17i1853R18i1806gR19jR11:5:2i2r11gR14oR15R16R17i1853R18i1786gR19r432goR3jR4:10:3oR3jR4:1:1oR6r38R8y10:pixelAlignR10r54R29ajR30:0:1nhR13i-25gR14oR15R16R17i1959R18i1949gR19r54goR3jR4:5:3jR5:20:1jR5:3:0oR3jR4:9:2oR3jR4:1:1r362R14oR15R16R17i1976R18i1962gR19r363gar69r99hR14oR15R16R17i1979R18i1962gR19jR11:5:2i2r11goR3jR4:1:1oR6r38R8y16:halfPixelInverseR10jR11:5:2i2r11R13i-26gR14oR15R16R17i1999R18i1983gR19r492gR14oR15R16R17i1999R18i1962gR19r489gnR14oR15R16R17i1999R18i1945gR19r188goR3jR4:5:3r7oR3jR4:1:1oR6r10R8R21R10jR11:5:2i4r11R22oR6r10R8y6:outputR10jR11:12:1ar501oR6r10R8R25R10jR11:5:2i4r11R22r503R13i-7ghR13i-5gR13i-6gR14oR15R16R17i2020R18i2005gR19r502goR3jR4:1:1r362R14oR15R16R17i2037R18i2023gR19r363gR14oR15R16R17i2037R18i2005gR19r502ghR14oR15R16R17i2043R18i1531gR19r188gR6jR44:0:0R45oR6r327R8y6:vertexR10jR11:13:1aoR1ahR35r188ghR13i-30gR35r188goR1ahR2oR3jR4:4:1aoR3jR4:10:3oR3jR4:5:3jR5:14:0oR3jR4:1:1oR6r38R8y9:killAlphaR10r54R29ajR30:0:1nhR13i-24gR14oR15R16R17i2088R18i2079gR19r54goR3jR4:5:3jR5:9:0oR3jR4:9:2oR3jR4:1:1r254R14oR15R16R17i2102R18i2092gR19r255gar172hR14oR15R16R17i2104R18i2092gR19r39goR3jR4:0:1jR27:3:1d0.001R14oR15R16R17i2112R18i2107gR19r39gR14oR15R16R17i2112R18i2092gR19r54gR14oR15R16R17i2112R18i2079gR19r54goR3jR4:11:0R14oR15R16R17i2122R18i2115gR19r188gnR14oR15R16R17i2122R18i2075gR19r188goR3jR4:5:3r7oR3jR4:1:1r505R14oR15R16R17i2140R18i2128gR19r506goR3jR4:1:1r254R14oR15R16R17i2153R18i2143gR19r255gR14oR15R16R17i2153R18i2128gR19r506ghR14oR15R16R17i2159R18i2069gR19r188gR6jR44:1:0R45oR6r327R8y8:fragmentR10jR11:13:1aoR1ahR35r188ghR13i-31gR35r188ghR8y17:h3d.shader.Base2dy4:varsar27r503oR6jR7:0:0R8y4:timeR10r39R13i-8gr37r303r9r64r254r283r202r53r264r110r157r385r405r209r223r531r474r491r446r362r326r518r570hg",
Hr.SRC="oy4:funsaoy4:argsahy4:exproy1:ejy13:hxsl.TExprDef:4:1aoR3jR4:5:3jy16:haxe.macro.Binop:4:0oR3jR4:1:1oy4:kindjy12:hxsl.VarKind:4:0y4:namey16:relativePositiony4:typejy9:hxsl.Type:5:2i3jy12:hxsl.VecType:1:0y2:idi-97gy1:poy4:filey83:C%3A%5CHaxeToolkit_34%5Chaxe%5Clib%5Cheaps%2F1%2C0%2C0%2Fh3d%2Fshader%2FBaseMesh.hxy3:maxi1269y3:mini1253gy1:tr12goR3jR4:1:1oR6jR7:1:0R8y8:positionR10jR11:5:2i3r11y6:parentoR6r17R8y5:inputR10jR11:12:1ar16oR6r17R8y6:normalR10jR11:5:2i3r11R21r19R13i-91ghR13i-89gR13i-90gR14oR15R16R17i1286R18i1272gR19r18gR14oR15R16R17i1286R18i1253gR19r12goR3jR4:5:3r7oR3jR4:1:1oR6r10R8y19:transformedPositionR10jR11:5:2i3r11R13i-98gR14oR15R16R17i1311R18i1292gR19r31goR3jR4:5:3jR5:1:0oR3jR4:1:1r9R14oR15R16R17i1330R18i1314gR19r12goR3jR4:8:2oR3jR4:2:1jy12:hxsl.TGlobal:50:0R14oR15R16R17i1349R18i1333gR19jR11:13:1ahgaoR3jR4:1:1oR6jR7:0:0R8y9:modelViewR10jR11:7:0R21oR6r49R8y6:globalR10jR11:12:1aoR6r49R8y4:timeR10jR11:3:0R21r51R13i-85goR6r49R8y9:pixelSizeR10jR11:5:2i2r11R21r51R13i-86gr48oR6r49R8y16:modelViewInverseR10r50R21r51y10:qualifiersajy17:hxsl.VarQualifier:3:0hR13i-88ghR13i-84gR31ar59hR13i-87gR14oR15R16R17i1349R18i1333gR19r50ghR14oR15R16R17i1358R18i1333gR19jR11:8:0gR14oR15R16R17i1358R18i1314gR19jR11:5:2i3r11gR14oR15R16R17i1358R18i1292gR19r31goR3jR4:5:3r7oR3jR4:1:1oR6r10R8y17:projectedPositionR10jR11:5:2i4r11R13i-101gR14oR15R16R17i1381R18i1364gR19r75goR3jR4:5:3r35oR3jR4:8:2oR3jR4:2:1jR25:40:0R14oR15R16R17i1388R18i1384gR19jR11:13:1ahgaoR3jR4:1:1r30R14oR15R16R17i1408R18i1389gR19r31goR3jR4:0:1jy10:hxsl.Const:3:1i1R14oR15R16R17i1411R18i1410gR19r54ghR14oR15R16R17i1412R18i1384gR19jR11:5:2i4r11goR3jR4:1:1oR6r49R8y8:viewProjR10r50R21oR6r49R8y6:cameraR10jR11:12:1aoR6r49R8y4:viewR10r50R21r99R13i-75goR6r49R8y4:projR10r50R21r99R13i-76goR6r49R8R20R10jR11:5:2i3r11R21r99R13i-77goR6r49R8y8:projDiagR10jR11:5:2i3r11R21r99R13i-78gr98oR6r49R8y15:inverseViewProjR10r50R21r99R13i-80goR6r49R8y5:zNearR10r54R21r99R13i-81goR6r49R8y4:zFarR10r54R21r99R13i-82goR6jR7:3:0R8y3:dirR10jR11:5:2i3r11R21r99R13i-83ghR13i-74gR13i-79gR14oR15R16R17i1430R18i1415gR19r50gR14oR15R16R17i1430R18i1384gR19jR11:5:2i4r11gR14oR15R16R17i1430R18i1364gR19r75goR3jR4:5:3r7oR3jR4:1:1oR6r10R8y17:transformedNormalR10jR11:5:2i3r11R13i-100gR14oR15R16R17i1453R18i1436gR19r124goR3jR4:8:2oR3jR4:2:1jR25:31:0R14oR15R16R17i1496R18i1456gR19jR11:13:1aoR1aoR8y1:_R10r69ghy3:retr69ghgaoR3jR4:3:1oR3jR4:5:3r35oR3jR4:1:1r21R14oR15R16R17i1469R18i1457gR19r22goR3jR4:8:2oR3jR4:2:1jR25:48:0R14oR15R16R17i1488R18i1472gR19jR11:13:1ahgaoR3jR4:1:1r48R14oR15R16R17i1488R18i1472gR19r50ghR14oR15R16R17i1495R18i1472gR19jR11:6:0gR14oR15R16R17i1495R18i1457gR19r69gR14oR15R16R17i1496R18i1456gR19r69ghR14oR15R16R17i1508R18i1456gR19r69gR14oR15R16R17i1508R18i1436gR19r124goR3jR4:5:3r7oR3jR4:1:1r110R14oR15R16R17i1524R18i1514gR19r112goR3jR4:8:2oR3jR4:2:1r129R14oR15R16R17i1566R18i1527gR19jR11:13:1aoR1aoR8R45R10jR11:5:2i3r11ghR46r69ghgaoR3jR4:3:1oR3jR4:5:3jR5:3:0oR3jR4:1:1r103R14oR15R16R17i1543R18i1528gR19r104goR3jR4:1:1r30R14oR15R16R17i1565R18i1546gR19r31gR14oR15R16R17i1565R18i1528gR19r177gR14oR15R16R17i1566R18i1527gR19r177ghR14oR15R16R17i1578R18i1527gR19r69gR14oR15R16R17i1578R18i1514gR19r112goR3jR4:5:3r7oR3jR4:1:1oR6r10R8y10:pixelColorR10jR11:5:2i4r11R13i-102gR14oR15R16R17i1594R18i1584gR19r200goR3jR4:1:1oR6jR7:2:0R8y5:colorR10jR11:5:2i4r11R13i-107gR14oR15R16R17i1602R18i1597gR19r206gR14oR15R16R17i1602R18i1584gR19r200goR3jR4:5:3r7oR3jR4:1:1oR6r10R8y9:specPowerR10r54R13i-105gR14oR15R16R17i1617R18i1608gR19r54goR3jR4:1:1oR6r205R8y13:specularPowerR10r54R31ajR32:7:2d0d100hR13i-108gR14oR15R16R17i1633R18i1620gR19r54gR14oR15R16R17i1633R18i1608gR19r54goR3jR4:5:3r7oR3jR4:1:1oR6r10R8y9:specColorR10jR11:5:2i3r11R13i-106gR14oR15R16R17i1648R18i1639gR19r227goR3jR4:5:3r35oR3jR4:1:1oR6r205R8y13:specularColorR10jR11:5:2i3r11R13i-110gR14oR15R16R17i1664R18i1651gR19r233goR3jR4:1:1oR6r205R8y14:specularAmountR10r54R31ajR32:7:2d0d10hR13i-109gR14oR15R16R17i1681R18i1667gR19r54gR14oR15R16R17i1681R18i1651gR19r233gR14oR15R16R17i1681R18i1639gR19r227goR3jR4:5:3r7oR3jR4:1:1oR6r10R8y8:screenUVR10jR11:5:2i2r11R13i-104gR14oR15R16R17i1695R18i1687gR19r249goR3jR4:5:3jR5:0:0oR3jR4:5:3r35oR3jR4:3:1oR3jR4:5:3jR5:2:0oR3jR4:9:2oR3jR4:1:1r74R14oR15R16R17i1716R18i1699gR19r75gajy14:hxsl.Component:0:0jR55:1:0hR14oR15R16R17i1719R18i1699gR19jR11:5:2i2r11goR3jR4:9:2oR3jR4:1:1r74R14oR15R16R17i1739R18i1722gR19r75gajR55:3:0hR14oR15R16R17i1741R18i1722gR19r54gR14oR15R16R17i1741R18i1699gR19r267gR14oR15R16R17i1742R18i1698gR19r267goR3jR4:8:2oR3jR4:2:1jR25:38:0R14oR15R16R17i1749R18i1745gR19jR11:13:1ahgaoR3jR4:0:1jR34:3:1d0.5R14oR15R16R17i1753R18i1750gR19r54goR3jR4:0:1jR34:3:1d-0.5R14oR15R16R17i1759R18i1755gR19r54ghR14oR15R16R17i1760R18i1745gR19jR11:5:2i2r11gR14oR15R16R17i1760R18i1698gR19jR11:5:2i2r11goR3jR4:0:1jR34:3:1d0.5R14oR15R16R17i1766R18i1763gR19r54gR14oR15R16R17i1766R18i1698gR19r301gR14oR15R16R17i1766R18i1687gR19r249goR3jR4:5:3r7oR3jR4:1:1oR6r10R8y5:depthR10r54R13i-103gR14oR15R16R17i1777R18i1772gR19r54goR3jR4:5:3r257oR3jR4:9:2oR3jR4:1:1r74R14oR15R16R17i1797R18i1780gR19r75gajR55:2:0hR14oR15R16R17i1799R18i1780gR19r54goR3jR4:9:2oR3jR4:1:1r74R14oR15R16R17i1819R18i1802gR19r75gar273hR14oR15R16R17i1821R18i1802gR19r54gR14oR15R16R17i1821R18i1780gR19r54gR14oR15R16R17i1821R18i1772gR19r54ghR14oR15R16R17i1827R18i1247gR19jR11:0:0gR6jy17:hxsl.FunctionKind:2:0y3:refoR6jR7:6:0R8y8:__init__R10jR11:13:1aoR1ahR46r337ghR13i-111gR46r337goR1ahR2oR3jR4:4:1aoR3jR4:5:3r7oR3jR4:1:1r123R14oR15R16R17i1884R18i1867gR19r124goR3jR4:8:2oR3jR4:2:1r129R14oR15R16R17i1904R18i1887gR19jR11:13:1aoR1aoR8R45R10r124ghR46r69ghgaoR3jR4:1:1r123R14oR15R16R17i1904R18i1887gR19r124ghR14oR15R16R17i1916R18i1887gR19r69gR14oR15R16R17i1916R18i1867gR19r124goR3jR4:5:3r7oR3jR4:1:1r248R14oR15R16R17i2025R18i2017gR19r249goR3jR4:5:3r253oR3jR4:5:3r35oR3jR4:3:1oR3jR4:5:3r257oR3jR4:9:2oR3jR4:1:1r74R14oR15R16R17i2046R18i2029gR19r75gar263r264hR14oR15R16R17i2049R18i2029gR19jR11:5:2i2r11goR3jR4:9:2oR3jR4:1:1r74R14oR15R16R17i2069R18i2052gR19r75gar273hR14oR15R16R17i2071R18i2052gR19r54gR14oR15R16R17i2071R18i2029gR19r385gR14oR15R16R17i2072R18i2028gR19r385goR3jR4:8:2oR3jR4:2:1r282R14oR15R16R17i2079R18i2075gR19r286gaoR3jR4:0:1jR34:3:1d0.5R14oR15R16R17i2083R18i2080gR19r54goR3jR4:0:1jR34:3:1d-0.5R14oR15R16R17i2089R18i2085gR19r54ghR14oR15R16R17i2090R18i2075gR19jR11:5:2i2r11gR14oR15R16R17i2090R18i2028gR19jR11:5:2i2r11goR3jR4:0:1jR34:3:1d0.5R14oR15R16R17i2096R18i2093gR19r54gR14oR15R16R17i2096R18i2028gR19r415gR14oR15R16R17i2096R18i2017gR19r249goR3jR4:5:3r7oR3jR4:1:1r312R14oR15R16R17i2107R18i2102gR19r54goR3jR4:5:3r257oR3jR4:9:2oR3jR4:1:1r74R14oR15R16R17i2127R18i2110gR19r75gar321hR14oR15R16R17i2129R18i2110gR19r54goR3jR4:9:2oR3jR4:1:1r74R14oR15R16R17i2149R18i2132gR19r75gar273hR14oR15R16R17i2151R18i2132gR19r54gR14oR15R16R17i2151R18i2110gR19r54gR14oR15R16R17i2151R18i2102gR19r54goR3jR4:5:3r7oR3jR4:1:1r213R14oR15R16R17i2244R18i2235gR19r54goR3jR4:1:1r217R14oR15R16R17i2260R18i2247gR19r54gR14oR15R16R17i2260R18i2235gR19r54goR3jR4:5:3r7oR3jR4:1:1r226R14oR15R16R17i2275R18i2266gR19r227goR3jR4:5:3r35oR3jR4:1:1r232R14oR15R16R17i2291R18i2278gR19r233goR3jR4:1:1r237R14oR15R16R17i2308R18i2294gR19r54gR14oR15R16R17i2308R18i2278gR19r233gR14oR15R16R17i2308R18i2266gR19r227ghR14oR15R16R17i2314R18i1861gR19r337gR6r338R58oR6r340R8y16:__init__fragmentR10jR11:13:1aoR1ahR46r337ghR13i-112gR46r337goR1ahR2oR3jR4:4:1aoR3jR4:5:3r7oR3jR4:1:1oR6r10R8R20R10jR11:5:2i4r11R21oR6r10R8y6:outputR10jR11:12:1ar484oR6r10R8R48R10jR11:5:2i4r11R21r486R13i-94goR6r10R8R56R10r54R21r486R13i-95goR6r10R8R23R10jR11:5:2i3r11R21r486R13i-96ghR13i-92gR13i-93gR14oR15R16R17i2359R18i2344gR19r485goR3jR4:1:1r74R14oR15R16R17i2379R18i2362gR19r75gR14oR15R16R17i2379R18i2344gR19r485goR3jR4:5:3r7oR3jR4:1:1oR6r10R8y24:pixelTransformedPositionR10jR11:5:2i3r11R13i-99gR14oR15R16R17i2409R18i2385gR19r504goR3jR4:1:1r30R14oR15R16R17i2431R18i2412gR19r31gR14oR15R16R17i2431R18i2385gR19r504ghR14oR15R16R17i2437R18i2338gR19r337gR6jR57:0:0R58oR6r340R8y6:vertexR10jR11:13:1aoR1ahR46r337ghR13i-113gR46r337goR1ahR2oR3jR4:4:1aoR3jR4:5:3r7oR3jR4:1:1r488R14oR15R16R17i2481R18i2469gR19r489goR3jR4:1:1r199R14oR15R16R17i2494R18i2484gR19r200gR14oR15R16R17i2494R18i2469gR19r489goR3jR4:5:3r7oR3jR4:1:1r490R14oR15R16R17i2512R18i2500gR19r54goR3jR4:1:1r312R14oR15R16R17i2520R18i2515gR19r54gR14oR15R16R17i2520R18i2500gR19r54goR3jR4:5:3r7oR3jR4:1:1r491R14oR15R16R17i2539R18i2526gR19r492goR3jR4:1:1r123R14oR15R16R17i2559R18i2542gR19r124gR14oR15R16R17i2559R18i2526gR19r492ghR14oR15R16R17i2565R18i2463gR19r337gR6jR57:1:0R58oR6r340R8y8:fragmentR10jR11:13:1aoR1ahR46r337ghR13i-114gR46r337ghR8y19:h3d.shader.BaseMeshy4:varsar99r51r19r486r9r30r503r123r74r199r312r248r213r226r204r217r237r232r339r473r515r554hg",Xr.SRC="oy4:funsaoy4:argsahy4:exproy1:ejy13:hxsl.TExprDef:4:1aoR3jR4:5:3jy16:haxe.macro.Binop:4:0oR3jR4:1:1oy4:kindjy12:hxsl.VarKind:4:0y4:namey8:positiony4:typejy9:hxsl.Type:5:2i4jy12:hxsl.VecType:1:0y6:parentoR6r10R8y6:outputR10jR11:12:1ar9oR6r10R8y5:colorR10jR11:5:2i4r11R13r13y2:idi-270ghR16i-268gR16i-269gy1:poy4:filey87:C%3A%5CHaxeToolkit_34%5Chaxe%5Clib%5Cheaps%2F1%2C0%2C0%2Fh3d%2Fshader%2FScreenShader.hxy3:maxi262y3:mini247gy1:tr12goR3jR4:8:2oR3jR4:2:1jy12:hxsl.TGlobal:40:0R17oR18R19R20i269R21i265gR22jR11:13:1ahgaoR3jR4:1:1oR6jR7:1:0R8R9R10jR11:5:2i2r11R13oR6r30R8y5:inputR10jR11:12:1ar29oR6r30R8y2:uvR10jR11:5:2i2r11R13r32R16i-267ghR16i-265gR16i-266gR17oR18R19R20i284R21i270gR22r31goR3jR4:0:1jy10:hxsl.Const:3:1zR17oR18R19R20i287R21i286gR22jR11:3:0goR3jR4:0:1jR26:3:1i1R17oR18R19R20i290R21i289gR22r43ghR17oR18R19R20i291R21i265gR22jR11:5:2i4r11gR17oR18R19R20i291R21i247gR22r12ghR17oR18R19R20i297R21i241gR22jR11:0:0gR6jy17:hxsl.FunctionKind:0:0y3:refoR6jR7:6:0R8y6:vertexR10jR11:13:1aoR1ahy3:retr55ghR16i-284gR30r55goR1ahR2oR3jR4:4:1aoR3jR4:10:3oR3jR4:1:1oR6jR7:2:0R8y16:isDepthDependantR10jR11:2:0y10:qualifiersajy17:hxsl.VarQualifier:0:1nhR16i-281gR17oR18y79:C%3A%5CHaxeToolkit_34%5Chaxe%5Clib%5Cheaps%2F1%2C0%2C0%2Fh3d%2Fshader%2FBlur.hxR20i638R21i622gR22r71goR3jR4:4:1aoR3jR4:7:2oR6r10R8y4:pcurR10jR11:5:2i3r11R16i-288goR3jR4:8:2oR3jR4:1:1oR6r58R8y11:getPositionR10jR11:13:1aoR1aoR8R25R10jR11:5:2i2r11ghR30r80ghR16i-287gR17oR18R34R20i670R21i659gR22r89gaoR3jR4:1:1r34R17oR18R34R20i679R21i671gR22r35ghR17oR18R34R20i680R21i659gR22r80gR17oR18R34R20i681R21i648gR22r55goR3jR4:7:2oR6r10R8y4:ccurR10jR11:5:2i4r11R16i-289goR3jR4:8:2oR3jR4:2:1jR23:33:0R17oR18R34R20i705R21i698gR22jR11:13:1aoR1aoR8y1:_R10jR11:10:0goR8R25R10jR11:5:2i2r11ghR30r102ghgaoR3jR4:1:1oR6r70R8y7:textureR10r112R16i-272gR17oR18R34R20i705R21i698gR22r112goR3jR4:1:1r34R17oR18R34R20i718R21i710gR22r35ghR17oR18R34R20i719R21i698gR22r102gR17oR18R34R20i720R21i687gR22r55goR3jR4:7:2oR6r10R8R15R10jR11:5:2i4r11R16i-290goR3jR4:8:2oR3jR4:2:1r22R17oR18R34R20i742R21i738gR22r26gaoR3jR4:0:1jR26:3:1zR17oR18R34R20i744R21i743gR22r43goR3jR4:0:1jR26:3:1zR17oR18R34R20i747R21i746gR22r43goR3jR4:0:1jR26:3:1zR17oR18R34R20i750R21i749gR22r43goR3jR4:0:1jR26:3:1zR17oR18R34R20i753R21i752gR22r43ghR17oR18R34R20i754R21i738gR22r130gR17oR18R34R20i755R21i726gR22r55goR3jR4:7:2oR6r10R8y4:ncurR10jR11:5:2i3r11R16i-291goR3jR4:8:2oR3jR4:2:1jR23:55:0R17oR18R34R20i784R21i772gR22jR11:13:1aoR1aoR8y5:valueR10jR11:5:2i4r11ghR30r158ghgaoR3jR4:8:2oR3jR4:2:1r105R17oR18R34R20i798R21i785gR22jR11:13:1aoR1aoR8R38R10r112gr113hR30r102ghgaoR3jR4:1:1oR6r70R8y13:normalTextureR10r112R16i-283gR17oR18R34R20i798R21i785gR22r112goR3jR4:1:1r34R17oR18R34R20i811R21i803gR22r35ghR17oR18R34R20i812R21i785gR22r102ghR17oR18R34R20i813R21i772gR22r158gR17oR18R34R20i814R21i761gR22r55goR3jR4:20:3y6:unrollahoR3jR4:13:3oR6r10R8y1:iR10jR11:1:0R16i-292goR3jR4:5:3jR5:21:0oR3jR4:5:3jR5:0:0oR3jR4:6:2jy15:haxe.macro.Unop:3:0oR3jR4:1:1oR6r70R8y7:QualityR10r198R32ajR33:0:1nhR16i-274gR17oR18R34R20i846R21i839gR22r198gR17oR18R34R20i846R21i838gR22r198goR3jR4:0:1jR26:2:1i1R17oR18R34R20i853R21i849gR22r198gR17oR18R34R20i853R21i838gR22r198goR3jR4:1:1r206R17oR18R34R20i860R21i853gR22r198gR17oR18R34R20i860R21i838gR22jR11:14:2r198jy13:hxsl.SizeDecl:0:1zgoR3jR4:4:1aoR3jR4:7:2oR6r10R8R25R10jR11:5:2i2r11R16i-293goR3jR4:5:3r202oR3jR4:1:1r34R17oR18R34R20i888R21i880gR22r35goR3jR4:5:3jR5:1:0oR3jR4:1:1oR6r70R8y5:pixelR10jR11:5:2i2r11R16i-277gR17oR18R34R20i896R21i891gR22r239goR3jR4:8:2oR3jR4:2:1jR23:36:0R17oR18R34R20i904R21i899gR22jR11:13:1aoR1aoR8R41R10r198ghR30r43ghgaoR3jR4:1:1r197R17oR18R34R20i906R21i905gR22r198ghR17oR18R34R20i907R21i899gR22r43gR17oR18R34R20i907R21i891gR22r239gR17oR18R34R20i907R21i880gR22r230gR17oR18R34R20i908R21i871gR22r55goR3jR4:7:2oR6r10R8y1:cR10r102R16i-294goR3jR4:8:2oR3jR4:2:1r105R17oR18R34R20i930R21i923gR22jR11:13:1aoR1aoR8R38R10r112gr113hR30r102ghgaoR3jR4:1:1r118R17oR18R34R20i930R21i923gR22r112goR3jR4:1:1r229R17oR18R34R20i937R21i935gR22r230ghR17oR18R34R20i938R21i923gR22r102gR17oR18R34R20i939R21i915gR22r55goR3jR4:7:2oR6r10R8R17R10r80R16i-295goR3jR4:8:2oR3jR4:1:1r83R17oR18R34R20i965R21i954gR22r89gaoR3jR4:1:1r229R17oR18R34R20i968R21i966gR22r230ghR17oR18R34R20i969R21i954gR22r80gR17oR18R34R20i970R21i946gR22r55goR3jR4:7:2oR6r10R8y1:dR10r43R16i-296goR3jR4:8:2oR3jR4:2:1jR23:29:0R17oR18R34R20i995R21i985gR22jR11:13:1aoR1aoR8R38R10jR11:5:2i3r11goR8y1:bR10jR11:5:2i3r11ghR30r43ghgaoR3jR4:3:1oR3jR4:5:3jR5:3:0oR3jR4:1:1r287R17oR18R34R20i987R21i986gR22r80goR3jR4:1:1r79R17oR18R34R20i994R21i990gR22r80gR17oR18R34R20i994R21i986gR22r311gR17oR18R34R20i995R21i985gR22r311goR3jR4:5:3r318oR3jR4:1:1r287R17oR18R34R20i1001R21i1000gR22r80goR3jR4:1:1r79R17oR18R34R20i1008R21i1004gR22r80gR17oR18R34R20i1008R21i1000gR22jR11:5:2i3r11ghR17oR18R34R20i1009R21i985gR22r43gR17oR18R34R20i1010R21i977gR22r55goR3jR4:7:2oR6r10R8y1:nR10r158R16i-297goR3jR4:8:2oR3jR4:2:1r161R17oR18R34R20i1037R21i1025gR22r169gaoR3jR4:8:2oR3jR4:2:1r105R17oR18R34R20i1051R21i1038gR22jR11:13:1aoR1aoR8R38R10r112gr113hR30r102ghgaoR3jR4:1:1r182R17oR18R34R20i1051R21i1038gR22r112goR3jR4:1:1r229R17oR18R34R20i1058R21i1056gR22r230ghR17oR18R34R20i1059R21i1038gR22r102ghR17oR18R34R20i1060R21i1025gR22r158gR17oR18R34R20i1061R21i1017gR22r55goR3jR4:5:3r7oR3jR4:1:1r265R17oR18R34R20i1071R21i1070gR22r102goR3jR4:8:2oR3jR4:2:1jR23:24:0R17oR18R34R20i1077R21i1074gR22jR11:13:1aoR1aoR8y1:xR10r102goR8y1:yR10r102goR8y1:aR10r43ghR30r102ghgaoR3jR4:1:1r101R17oR18R34R20i1082R21i1078gR22r102goR3jR4:1:1r265R17oR18R34R20i1085R21i1084gR22r102goR3jR4:8:2oR3jR4:2:1r304R17oR18R34R20i1091R21i1087gR22jR11:13:1aoR1aoR8R38R10r158gr312hR30r43ghgaoR3jR4:1:1r157R17oR18R34R20i1091R21i1087gR22r158goR3jR4:1:1r344R17oR18R34R20i1097R21i1096gR22r158ghR17oR18R34R20i1098R21i1087gR22r43ghR17oR18R34R20i1099R21i1074gR22r102gR17oR18R34R20i1099R21i1070gR22r102goR3jR4:5:3r7oR3jR4:1:1r265R17oR18R34R20i1108R21i1107gR22r102goR3jR4:8:2oR3jR4:2:1r378R17oR18R34R20i1114R21i1111gR22jR11:13:1ar382hgaoR3jR4:1:1r265R17oR18R34R20i1116R21i1115gR22r102goR3jR4:1:1r101R17oR18R34R20i1122R21i1118gR22r102goR3jR4:8:2oR3jR4:2:1jR23:21:0R17oR18R34R20i1154R21i1124gR22jR11:13:1aoR1aoR8R38R10r43goR8R51R10r43ghR30r43ghgaoR3jR4:3:1oR3jR4:5:3r236oR3jR4:8:2oR3jR4:2:1jR23:22:0R17oR18R34R20i1136R21i1125gR22jR11:13:1aoR1aoR8R38R10r43gr443hR30r43ghgaoR3jR4:3:1oR3jR4:5:3r318oR3jR4:1:1r301R17oR18R34R20i1127R21i1126gR22r43goR3jR4:0:1jR26:3:1d0.001R17oR18R34R20i1135R21i1130gR22r43gR17oR18R34R20i1135R21i1126gR22r43gR17oR18R34R20i1136R21i1125gR22r43goR3jR4:0:1jR26:3:1d0R17oR18R34R20i1143R21i1141gR22r43ghR17oR18R34R20i1144R21i1125gR22r43goR3jR4:0:1jR26:3:1i100000R17oR18R34R20i1153R21i1147gR22r43gR17oR18R34R20i1153R21i1125gR22r43gR17oR18R34R20i1154R21i1124gR22r43goR3jR4:0:1jR26:3:1d1R17oR18R34R20i1161R21i1159gR22r43ghR17oR18R34R20i1162R21i1124gR22r43ghR17oR18R34R20i1163R21i1111gR22r102gR17oR18R34R20i1163R21i1107gR22r102goR3jR4:5:3jR5:20:1r202oR3jR4:1:1r129R17oR18R34R20i1176R21i1171gR22r130goR3jR4:5:3r236oR3jR4:1:1r265R17oR18R34R20i1181R21i1180gR22r102goR3jR4:16:2oR3jR4:1:1oR6r70R8y6:valuesR10jR11:14:2r43jR47:1:1r206R16i-276gR17oR18R34R20i1190R21i1184gR22r509goR3jR4:10:3oR3jR4:5:3jR5:9:0oR3jR4:1:1r197R17oR18R34R20i1192R21i1191gR22r198goR3jR4:0:1jR26:2:1zR17oR18R34R20i1196R21i1195gR22r198gR17oR18R34R20i1196R21i1191gR22r71goR3jR4:6:2r204oR3jR4:1:1r197R17oR18R34R20i1201R21i1200gR22r198gR17oR18R34R20i1201R21i1199gR22r198goR3jR4:1:1r197R17oR18R34R20i1205R21i1204gR22r198gR17oR18R34R20i1205R21i1191gR22r198gR17oR18R34R20i1206R21i1184gR22r43gR17oR18R34R20i1206R21i1180gR22r102gR17oR18R34R20i1206R21i1171gR22r130ghR17oR18R34R20i1214R21i863gR22r55gR17oR18R34R20i1214R21i828gR22r55gR17oR18R34R20i1214R21i821gR22r55goR3jR4:5:3r7oR3jR4:1:1r15R17oR18R34R20i1232R21i1220gR22r16goR3jR4:1:1r129R17oR18R34R20i1240R21i1235gR22r130gR17oR18R34R20i1240R21i1220gR22r16ghR17oR18R34R20i1247R21i641gR22r55goR3jR4:10:3oR3jR4:1:1oR6r70R8y7:isDepthR10r71R32ajR33:0:1nhR16i-275gR17oR18R34R20i1268R21i1261gR22r71goR3jR4:4:1aoR3jR4:7:2oR6r10R8y3:valR10r43R16i-298goR3jR4:0:1jR26:3:1d0R17oR18R34R20i1290R21i1288gR22r43gR17oR18R34R20i1291R21i1278gR22r55goR3jR4:20:3R43ahoR3jR4:13:3oR6r10R8R44R10r198R16i-299goR3jR4:5:3r200oR3jR4:5:3r202oR3jR4:6:2r204oR3jR4:1:1r206R17oR18R34R20i1323R21i1316gR22r198gR17oR18R34R20i1323R21i1315gR22r198goR3jR4:0:1jR26:2:1i1R17oR18R34R20i1330R21i1326gR22r198gR17oR18R34R20i1330R21i1315gR22r198goR3jR4:1:1r206R17oR18R34R20i1337R21i1330gR22r198gR17oR18R34R20i1337R21i1315gR22jR11:14:2r198jR47:0:1zgoR3jR4:5:3jR5:20:1r202oR3jR4:1:1r568R17oR18R34R20i1349R21i1346gR22r43goR3jR4:5:3r236oR3jR4:8:2oR3jR4:2:1jR23:53:0R17oR18R34R20i1359R21i1353gR22jR11:13:1aoR1aoR8R41R10jR11:5:2i4r11ghR30r43ghgaoR3jR4:8:2oR3jR4:2:1r105R17oR18R34R20i1367R21i1360gR22jR11:13:1aoR1aoR8R38R10r112gr113hR30r102ghgaoR3jR4:1:1r118R17oR18R34R20i1367R21i1360gR22r112goR3jR4:5:3r202oR3jR4:1:1r34R17oR18R34R20i1380R21i1372gR22r35goR3jR4:5:3r236oR3jR4:1:1r238R17oR18R34R20i1388R21i1383gR22r239goR3jR4:8:2oR3jR4:2:1r244R17oR18R34R20i1396R21i1391gR22jR11:13:1ar248hgaoR3jR4:1:1r578R17oR18R34R20i1398R21i1397gR22r198ghR17oR18R34R20i1399R21i1391gR22r43gR17oR18R34R20i1399R21i1383gR22r239gR17oR18R34R20i1399R21i1372gR22jR11:5:2i2r11ghR17oR18R34R20i1400R21i1360gR22r102ghR17oR18R34R20i1401R21i1353gR22r43goR3jR4:16:2oR3jR4:1:1r507R17oR18R34R20i1410R21i1404gR22r509goR3jR4:10:3oR3jR4:5:3r514oR3jR4:1:1r578R17oR18R34R20i1412R21i1411gR22r198goR3jR4:0:1jR26:2:1zR17oR18R34R20i1416R21i1415gR22r198gR17oR18R34R20i1416R21i1411gR22r71goR3jR4:6:2r204oR3jR4:1:1r578R17oR18R34R20i1421R21i1420gR22r198gR17oR18R34R20i1421R21i1419gR22r198goR3jR4:1:1r578R17oR18R34R20i1425R21i1424gR22r198gR17oR18R34R20i1425R21i1411gR22r198gR17oR18R34R20i1426R21i1404gR22r43gR17oR18R34R20i1426R21i1353gR22r43gR17oR18R34R20i1426R21i1346gR22r43gR17oR18R34R20i1426R21i1305gR22r55gR17oR18R34R20i1426R21i1298gR22r55goR3jR4:5:3r7oR3jR4:1:1r15R17oR18R34R20i1445R21i1433gR22r16goR3jR4:8:2oR3jR4:2:1jR23:52:0R17oR18R34R20i1452R21i1448gR22jR11:13:1aoR1aoR8R41R10r43ghR30jR11:5:2i4r11ghgaoR3jR4:8:2oR3jR4:2:1r436R17oR18R34R20i1456R21i1453gR22jR11:13:1aoR1aoR8R38R10r43gr443hR30r43ghgaoR3jR4:1:1r568R17oR18R34R20i1456R21i1453gR22r43goR3jR4:0:1jR26:3:1d0.9999999R17oR18R34R20i1470R21i1461gR22r43ghR17oR18R34R20i1471R21i1453gR22r43ghR17oR18R34R20i1472R21i1448gR22r709gR17oR18R34R20i1472R21i1433gR22r16ghR17oR18R34R20i1479R21i1271gR22r55goR3jR4:4:1aoR3jR4:7:2oR6r10R8R15R10jR11:5:2i4r11R16i-300goR3jR4:8:2oR3jR4:2:1r22R17oR18R34R20i1508R21i1504gR22r26gaoR3jR4:0:1jR26:3:1zR17oR18R34R20i1510R21i1509gR22r43goR3jR4:0:1jR26:3:1zR17oR18R34R20i1513R21i1512gR22r43goR3jR4:0:1jR26:3:1zR17oR18R34R20i1516R21i1515gR22r43goR3jR4:0:1jR26:3:1zR17oR18R34R20i1519R21i1518gR22r43ghR17oR18R34R20i1520R21i1504gR22r741gR17oR18R34R20i1521R21i1492gR22r55goR3jR4:20:3R43ahoR3jR4:13:3oR6r10R8R44R10r198R16i-301goR3jR4:5:3r200oR3jR4:5:3r202oR3jR4:6:2r204oR3jR4:1:1r206R17oR18R34R20i1553R21i1546gR22r198gR17oR18R34R20i1553R21i1545gR22r198goR3jR4:0:1jR26:2:1i1R17oR18R34R20i1560R21i1556gR22r198gR17oR18R34R20i1560R21i1545gR22r198goR3jR4:1:1r206R17oR18R34R20i1567R21i1560gR22r198gR17oR18R34R20i1567R21i1545gR22jR11:14:2r198jR47:0:1zgoR3jR4:5:3jR5:20:1r202oR3jR4:1:1r740R17oR18R34R20i1581R21i1576gR22r741goR3jR4:5:3r236oR3jR4:8:2oR3jR4:2:1r105R17oR18R34R20i1592R21i1585gR22jR11:13:1aoR1aoR8R38R10r112gr113hR30r102ghgaoR3jR4:1:1r118R17oR18R34R20i1592R21i1585gR22r112goR3jR4:5:3r202oR3jR4:1:1r34R17oR18R34R20i1605R21i1597gR22r35goR3jR4:5:3r236oR3jR4:1:1r238R17oR18R34R20i1613R21i1608gR22r239goR3jR4:8:2oR3jR4:2:1r244R17oR18R34R20i1621R21i1616gR22jR11:13:1ar248hgaoR3jR4:1:1r770R17oR18R34R20i1623R21i1622gR22r198ghR17oR18R34R20i1624R21i1616gR22r43gR17oR18R34R20i1624R21i1608gR22r239gR17oR18R34R20i1624R21i1597gR22jR11:5:2i2r11ghR17oR18R34R20i1625R21i1585gR22r102goR3jR4:16:2oR3jR4:1:1r507R17oR18R34R20i1634R21i1628gR22r509goR3jR4:10:3oR3jR4:5:3r514oR3jR4:1:1r770R17oR18R34R20i1636R21i1635gR22r198goR3jR4:0:1jR26:2:1zR17oR18R34R20i1640R21i1639gR22r198gR17oR18R34R20i1640R21i1635gR22r71goR3jR4:6:2r204oR3jR4:1:1r770R17oR18R34R20i1645R21i1644gR22r198gR17oR18R34R20i1645R21i1643gR22r198goR3jR4:1:1r770R17oR18R34R20i1649R21i1648gR22r198gR17oR18R34R20i1649R21i1635gR22r198gR17oR18R34R20i1650R21i1628gR22r43gR17oR18R34R20i1650R21i1585gR22r102gR17oR18R34R20i1650R21i1576gR22r741gR17oR18R34R20i1650R21i1535gR22r55gR17oR18R34R20i1650R21i1528gR22r55goR3jR4:5:3r7oR3jR4:1:1r15R17oR18R34R20i1669R21i1657gR22r16goR3jR4:1:1r740R17oR18R34R20i1677R21i1672gR22r741gR17oR18R34R20i1677R21i1657gR22r16ghR17oR18R34R20i1684R21i1485gR22r55gR17oR18R34R20i1684R21i1257gR22r55gR17oR18R34R20i1684R21i618gR22r55goR3jR4:10:3oR3jR4:1:1oR6r70R8y13:hasFixedColorR10r71R32ajR33:0:1nhR16i-278gR17oR18R34R20i1706R21i1693gR22r71goR3jR4:4:1aoR3jR4:5:3r7oR3jR4:9:2oR3jR4:1:1r15R17oR18R34R20i1728R21i1716gR22r16gajy14:hxsl.Component:0:0jR60:1:0jR60:2:0hR17oR18R34R20i1732R21i1716gR22jR11:5:2i3r11goR3jR4:9:2oR3jR4:1:1oR6r70R8y10:fixedColorR10jR11:5:2i4r11R16i-280gR17oR18R34R20i1745R21i1735gR22r913gar904r905r906hR17oR18R34R20i1749R21i1735gR22jR11:5:2i3r11gR17oR18R34R20i1749R21i1716gR22r909goR3jR4:10:3oR3jR4:1:1oR6r70R8y16:smoothFixedColorR10r71R32ajR33:0:1nhR16i-279gR17oR18R34R20i1776R21i1760gR22r71goR3jR4:5:3jR5:20:1r236oR3jR4:9:2oR3jR4:1:1r15R17oR18R34R20i1797R21i1785gR22r16gajR60:3:0hR17oR18R34R20i1799R21i1785gR22r43goR3jR4:9:2oR3jR4:1:1r912R17oR18R34R20i1813R21i1803gR22r913gar936hR17oR18R34R20i1815R21i1803gR22r43gR17oR18R34R20i1815R21i1785gR22r43goR3jR4:5:3r7oR3jR4:9:2oR3jR4:1:1r15R17oR18R34R20i1845R21i1833gR22r16gar936hR17oR18R34R20i1847R21i1833gR22r43goR3jR4:5:3r236oR3jR4:9:2oR3jR4:1:1r912R17oR18R34R20i1860R21i1850gR22r913gar936hR17oR18R34R20i1862R21i1850gR22r43goR3jR4:8:2oR3jR4:2:1r244R17oR18R34R20i1870R21i1865gR22jR11:13:1aoR1aoR8R41R10r71ghR30r43ghgaoR3jR4:5:3jR5:7:0oR3jR4:9:2oR3jR4:1:1r15R17oR18R34R20i1883R21i1871gR22r16gar936hR17oR18R34R20i1885R21i1871gR22r43goR3jR4:0:1jR26:3:1zR17oR18R34R20i1889R21i1888gR22r43gR17oR18R34R20i1889R21i1871gR22r71ghR17oR18R34R20i1890R21i1865gR22r43gR17oR18R34R20i1890R21i1850gR22r43gR17oR18R34R20i1890R21i1833gR22r43gR17oR18R34R20i1890R21i1756gR22r55ghR17oR18R34R20i1897R21i1709gR22r55gnR17oR18R34R20i1897R21i1689gR22r55ghR17oR18R34R20i1902R21i612gR22r55gR6jR27:1:0R28oR6r58R8y8:fragmentR10jR11:13:1aoR1ahR30r55ghR16i-285gR30r55goR1aoR6r10R8R25R10r88R16i-286ghR2oR3jR4:4:1aoR3jR4:7:2oR6r10R8y5:depthR10r43R16i-302goR3jR4:8:2oR3jR4:2:1r608R17oR18R34R20i1973R21i1967gR22r616gaoR3jR4:8:2oR3jR4:2:1r105R17oR18R34R20i1986R21i1974gR22jR11:13:1aoR1aoR8R38R10r112gr113hR30r102ghgaoR3jR4:1:1oR6r70R8y12:depthTextureR10r112R16i-273gR17oR18R34R20i1986R21i1974gR22r112goR3jR4:1:1r1011R17oR18R34R20i1993R21i1991gR22r88ghR17oR18R34R20i1994R21i1974gR22r102ghR17oR18R34R20i1995R21i1967gR22r43gR17oR18R34R20i1996R21i1955gR22r55goR3jR4:7:2oR6r10R8y3:uv2R10jR11:5:2i2r11R16i-303goR3jR4:5:3r236oR3jR4:3:1oR3jR4:5:3r318oR3jR4:1:1r1011R17oR18R34R20i2014R21i2012gR22r88goR3jR4:0:1jR26:3:1d0.5R17oR18R34R20i2020R21i2017gR22r43gR17oR18R34R20i2020R21i2012gR22r88gR17oR18R34R20i2021R21i2011gR22r88goR3jR4:8:2oR3jR4:2:1jR23:38:0R17oR18R34R20i2028R21i2024gR22jR11:13:1ahgaoR3jR4:0:1jR26:3:1i2R17oR18R34R20i2030R21i2029gR22r43goR3jR4:0:1jR26:3:1i-2R17oR18R34R20i2034R21i2032gR22r43ghR17oR18R34R20i2035R21i2024gR22jR11:5:2i2r11gR17oR18R34R20i2035R21i2011gR22r1046gR17oR18R34R20i2036R21i2001gR22r55goR3jR4:7:2oR6r10R8y4:tempR10r102R16i-304goR3jR4:5:3r236oR3jR4:8:2oR3jR4:2:1r22R17oR18R34R20i2056R21i2052gR22r26gaoR3jR4:1:1r1045R17oR18R34R20i2060R21i2057gR22r1046goR3jR4:1:1r1015R17oR18R34R20i2067R21i2062gR22r43goR3jR4:0:1jR26:3:1i1R17oR18R34R20i2070R21i2069gR22r43ghR17oR18R34R20i2071R21i2052gR22jR11:5:2i4r11goR3jR4:1:1oR6r70R8y21:cameraInverseViewProjR10jR11:7:0R16i-271gR17oR18R34R20i2095R21i2074gR22r1107gR17oR18R34R20i2095R21i2052gR22r102gR17oR18R34R20i2096R21i2041gR22r55goR3jR4:7:2oR6r10R8y8:originWSR10jR11:5:2i3r11R16i-305goR3jR4:5:3jR5:2:0oR3jR4:9:2oR3jR4:1:1r1085R17oR18R34R20i2120R21i2116gR22r102gar904r905r906hR17oR18R34R20i2124R21i2116gR22r1116goR3jR4:9:2oR3jR4:1:1r1085R17oR18R34R20i2131R21i2127gR22r102gar936hR17oR18R34R20i2133R21i2127gR22r43gR17oR18R34R20i2133R21i2116gR22r1116gR17oR18R34R20i2134R21i2101gR22r55goR3jR4:12:1oR3jR4:1:1r1115R17oR18R34R20i2154R21i2146gR22r1116gR17oR18R34R20i2154R21i2139gR22r55ghR17oR18R34R20i2160R21i1949gR22r55gR6jR27:3:0R28r83R30r80ghR8y15:h3d.shader.Blury4:varsar32r13r1106r118r1032r206r560r507r238r891r924r912r69oR6r70R8y9:hasNormalR10r71R32ajR33:0:1nhR16i-282gr182r57r1004r83hg",$r.SRC="oy4:funsaoy4:argsahy4:exproy1:ejy13:hxsl.TExprDef:4:1aoR3jR4:5:3jy16:haxe.macro.Binop:20:1jR5:0:0oR3jR4:9:2oR3jR4:1:1oy4:kindjy12:hxsl.VarKind:4:0y4:namey10:pixelColory4:typejy9:hxsl.Type:5:2i4jy12:hxsl.VecType:1:0y2:idi-306gy1:poy4:filey83:C%3A%5CHaxeToolkit_34%5Chaxe%5Clib%5Cheaps%2F1%2C0%2C0%2Fh3d%2Fshader%2FColorAdd.hxy3:maxi180y3:mini170gy1:tr14gajy14:hxsl.Component:0:0jR20:1:0jR20:2:0hR14oR15R16R17i184R18i170gR19jR11:5:2i3r13goR3jR4:1:1oR6jR7:2:0R8y5:colorR10jR11:5:2i3r13R13i-307gR14oR15R16R17i193R18i188gR19r27gR14oR15R16R17i193R18i170gR19r23ghR14oR15R16R17i199R18i164gR19jR11:0:0gR6jy17:hxsl.FunctionKind:1:0y3:refoR6jR7:6:0R8y8:fragmentR10jR11:13:1aoR1ahy3:retr34ghR13i-308gR25r34ghR8y19:h3d.shader.ColorAddy4:varsar11r25r36hg",Qr.SRC="oy4:funsaoy4:argsahy4:exproy1:ejy13:hxsl.TExprDef:4:1aoR3jR4:7:2oy4:kindjy12:hxsl.VarKind:4:0y4:namey5:cdiffy4:typejy9:hxsl.Type:5:2i4jy12:hxsl.VecType:1:0y2:idi-312goR3jR4:5:3jy16:haxe.macro.Binop:3:0oR3jR4:1:1oR5r8R7y12:textureColorR9jR10:5:2i4r9R12i-310gy1:poy4:filey83:C%3A%5CHaxeToolkit_34%5Chaxe%5Clib%5Cheaps%2F1%2C0%2C0%2Fh3d%2Fshader%2FColorKey.hxy3:maxi197y3:mini185gy1:tr15goR3jR4:1:1oR5jR6:2:0R7y8:colorKeyR9jR10:5:2i4r9R12i-309gR15oR16R17R18i208R19i200gR20r21gR15oR16R17R18i208R19i185gR20r10gR15oR16R17R18i209R19i173gR20jR10:0:0goR3jR4:10:3oR3jR4:5:3jR13:9:0oR3jR4:8:2oR3jR4:2:1jy12:hxsl.TGlobal:29:0R15oR16R17R18i223R19i218gR20jR10:13:1aoR1aoR7y1:_R9r10goR7y1:bR9jR10:5:2i4r9ghy3:retjR10:3:0ghgaoR3jR4:1:1r7R15oR16R17R18i223R19i218gR20r10goR3jR4:1:1r7R15oR16R17R18i233R19i228gR20r10ghR15oR16R17R18i234R19i218gR20r43goR3jR4:0:1jy10:hxsl.Const:3:1d1e-005R15oR16R17R18i244R19i237gR20r43gR15oR16R17R18i244R19i218gR20jR10:2:0goR3jR4:11:0R15oR16R17R18i254R19i247gR20r28gnR15oR16R17R18i254R19i214gR20r28ghR15oR16R17R18i260R19i167gR20r28gR5jy17:hxsl.FunctionKind:1:0y3:refoR5jR6:6:0R7y8:fragmentR9jR10:13:1aoR1ahR25r28ghR12i-311gR25r28ghR7y19:h3d.shader.ColorKeyy4:varsar19r14r69hg",Jr.SRC="oy4:funsaoy4:argsahy4:exproy1:ejy13:hxsl.TExprDef:4:1aoR3jR4:5:3jy16:haxe.macro.Binop:4:0oR3jR4:1:1oy4:kindjy12:hxsl.VarKind:4:0y4:namey10:pixelColory4:typejy9:hxsl.Type:5:2i4jy12:hxsl.VecType:1:0y2:idi-313gy1:poy4:filey86:C%3A%5CHaxeToolkit_34%5Chaxe%5Clib%5Cheaps%2F1%2C0%2C0%2Fh3d%2Fshader%2FColorMatrix.hxy3:maxi184y3:mini174gy1:tr12goR3jR4:8:2oR3jR4:2:1jy12:hxsl.TGlobal:40:0R14oR15R16R17i191R18i187gR19jR11:13:1ahgaoR3jR4:9:2oR3jR4:3:1oR3jR4:5:3jR5:1:0oR3jR4:8:2oR3jR4:2:1r17R14oR15R16R17i198R18i194gR19r21gaoR3jR4:9:2oR3jR4:1:1r9R14oR15R16R17i209R18i199gR19r12gajy14:hxsl.Component:0:0jR21:1:0jR21:2:0hR14oR15R16R17i213R18i199gR19jR11:5:2i3r11goR3jR4:0:1jy10:hxsl.Const:3:1d1R14oR15R16R17i216R18i214gR19jR11:3:0ghR14oR15R16R17i217R18i194gR19jR11:5:2i4r11goR3jR4:1:1oR6jR7:2:0R8y6:matrixR10jR11:7:0R13i-314gR14oR15R16R17i226R18i220gR19r54gR14oR15R16R17i226R18i194gR19jR11:5:2i4r11gR14oR15R16R17i227R18i193gR19r59gar37r38r39hR14oR15R16R17i231R18i193gR19jR11:5:2i3r11goR3jR4:9:2oR3jR4:3:1oR3jR4:5:3r26oR3jR4:1:1r9R14oR15R16R17i244R18i234gR19r12goR3jR4:1:1r52R14oR15R16R17i253R18i247gR19r54gR14oR15R16R17i253R18i234gR19r59gR14oR15R16R17i254R18i233gR19r59gajR21:3:0hR14oR15R16R17i256R18i233gR19r47ghR14oR15R16R17i257R18i187gR19jR11:5:2i4r11gR14oR15R16R17i257R18i174gR19r12ghR14oR15R16R17i263R18i168gR19jR11:0:0gR6jy17:hxsl.FunctionKind:1:0y3:refoR6jR7:6:0R8y8:fragmentR10jR11:13:1aoR1ahy3:retr90ghR13i-315gR27r90ghR8y22:h3d.shader.ColorMatrixy4:varsar9r52r92hg",ti.SRC="oy4:funsaoy4:argsahy4:exproy1:ejy13:hxsl.TExprDef:4:1aoR3jR4:7:2oy4:kindjy12:hxsl.VarKind:4:0y4:namey4:diffy4:typejy9:hxsl.Type:3:0y2:idi-54goR3jR4:8:2oR3jR4:2:1jy12:hxsl.TGlobal:22:0y1:poy4:filey83:C%3A%5CHaxeToolkit_34%5Chaxe%5Clib%5Cheaps%2F1%2C0%2C0%2Fh3d%2Fshader%2FDirLight.hxy3:maxi501y3:mini468gy1:tjR10:13:1aoR1aoR7y1:_R9r9goR7y1:bR9r9ghy3:retr9ghgaoR3jR4:8:2oR3jR4:2:1jR12:29:0R13oR14R15R16i485R17i468gR18jR10:13:1aoR1aoR7R19R9jR10:5:2i3jy12:hxsl.VecType:1:0goR7R20R9jR10:5:2i3r31ghR21r9ghgaoR3jR4:1:1oR5r8R7y17:transformedNormalR9r32R11i-47gR13oR14R15R16i485R17i468gR18r32goR3jR4:6:2jy15:haxe.macro.Unop:3:0oR3jR4:1:1oR5jR6:2:0R7y9:directionR9jR10:5:2i3r31R11i-41gR13oR14R15R16i500R17i491gR18r46gR13oR14R15R16i500R17i490gR18r46ghR13oR14R15R16i501R17i468gR18r9goR3jR4:0:1jy10:hxsl.Const:3:1d0R13oR14R15R16i508R17i506gR18r9ghR13oR14R15R16i509R17i468gR18r9gR13oR14R15R16i510R17i457gR18jR10:0:0goR3jR4:10:3oR3jR4:6:2jR24:2:0oR3jR4:1:1oR5r45R7y14:enableSpecularR9jR10:2:0y10:qualifiersajy17:hxsl.VarQualifier:0:1nhR11i-42gR13oR14R15R16i534R17i520gR18r67gR13oR14R15R16i534R17i519gR18r67goR3jR4:12:1oR3jR4:5:3jy16:haxe.macro.Binop:1:0oR3jR4:1:1oR5r45R7y5:colorR9jR10:5:2i3r31R11i-40gR13oR14R15R16i554R17i549gR18r79goR3jR4:1:1r7R13oR14R15R16i561R17i557gR18r9gR13oR14R15R16i561R17i549gR18r79gR13oR14R15R16i561R17i542gR18r61gnR13oR14R15R16i561R17i515gR18r61goR3jR4:7:2oR5r8R7y1:rR9r34R11i-55goR3jR4:8:2oR3jR4:2:1jR12:31:0R13oR14R15R16i612R17i575gR18jR10:13:1aoR1aoR7R19R9r34ghR21r34ghgaoR3jR4:8:2oR3jR4:2:1jR12:32:0R13oR14R15R16i582R17i575gR18jR10:13:1aoR1aoR7y1:aR9r34goR7R20R9r34ghR21r34ghgaoR3jR4:1:1r44R13oR14R15R16i592R17i583gR18r46goR3jR4:1:1r38R13oR14R15R16i611R17i594gR18r32ghR13oR14R15R16i612R17i575gR18r34ghR13oR14R15R16i624R17i575gR18r34gR13oR14R15R16i625R17i567gR18r61goR3jR4:7:2oR5r8R7y9:specValueR9r9R11i-56goR3jR4:8:2oR3jR4:2:1r12R13oR14R15R16i704R17i646gR18jR10:13:1aoR1aoR7R19R9r9gr19hR21r9ghgaoR3jR4:8:2oR3jR4:2:1r24R13oR14R15R16i647R17i646gR18jR10:13:1aoR1aoR7R19R9r34gr33hR21r9ghgaoR3jR4:1:1r92R13oR14R15R16i647R17i646gR18r34goR3jR4:8:2oR3jR4:2:1r95R13oR14R15R16i691R17i652gR18jR10:13:1aoR1aoR7R19R9jR10:5:2i3r31ghR21r34ghgaoR3jR4:3:1oR3jR4:5:3jR30:3:0oR3jR4:1:1oR5jR6:0:0R7y8:positionR9jR10:5:2i3r31y6:parentoR5r169R7y6:cameraR9jR10:12:1ar168hR11i-43gR11i-44gR13oR14R15R16i668R17i653gR18r170goR3jR4:1:1oR5r8R7y19:transformedPositionR9jR10:5:2i3r31R11i-48gR13oR14R15R16i690R17i671gR18r178gR13oR14R15R16i690R17i653gR18r161gR13oR14R15R16i691R17i652gR18r161ghR13oR14R15R16i703R17i652gR18r34ghR13oR14R15R16i704R17i646gR18r9goR3jR4:0:1jR26:3:1d0R13oR14R15R16i711R17i709gR18r9ghR13oR14R15R16i712R17i646gR18r9gR13oR14R15R16i713R17i630gR18r61goR3jR4:12:1oR3jR4:5:3r76oR3jR4:1:1r78R13oR14R15R16i730R17i725gR18r79goR3jR4:3:1oR3jR4:5:3jR30:0:0oR3jR4:1:1r7R13oR14R15R16i738R17i734gR18r9goR3jR4:5:3r76oR3jR4:1:1oR5r8R7y9:specColorR9jR10:5:2i3r31R11i-50gR13oR14R15R16i750R17i741gR18r211goR3jR4:8:2oR3jR4:2:1jR12:8:0R13oR14R15R16i756R17i753gR18jR10:13:1aoR1aoR7R33R9r9gr19hR21r9ghgaoR3jR4:1:1r129R13oR14R15R16i766R17i757gR18r9goR3jR4:1:1oR5r8R7y9:specPowerR9r9R11i-49gR13oR14R15R16i777R17i768gR18r9ghR13oR14R15R16i778R17i753gR18r9gR13oR14R15R16i778R17i741gR18r211gR13oR14R15R16i778R17i734gR18r211gR13oR14R15R16i779R17i733gR18r211gR13oR14R15R16i779R17i725gR18jR10:5:2i3r31gR13oR14R15R16i779R17i718gR18r61ghR13oR14R15R16i785R17i451gR18r61gR5jy17:hxsl.FunctionKind:3:0y3:refoR5jR6:6:0R7y12:calcLightingR9jR10:13:1aoR1ahR21jR10:5:2i3r31ghR11i-51gR21r253goR1ahR2oR3jR4:4:1aoR3jR4:5:3jR30:20:1r204oR3jR4:9:2oR3jR4:1:1oR5r8R7y10:lightColorR9jR10:5:2i3r31R11i-45gR13oR14R15R16i825R17i815gR18r264gajy14:hxsl.Component:0:0jR45:1:0jR45:2:0hR13oR14R15R16i829R17i815gR18jR10:5:2i3r31goR3jR4:8:2oR3jR4:1:1r248R13oR14R15R16i845R17i833gR18r254gahR13oR14R15R16i847R17i833gR18r253gR13oR14R15R16i847R17i815gR18r273ghR13oR14R15R16i853R17i809gR18r61gR5jR41:0:0R42oR5r249R7y6:vertexR9jR10:13:1aoR1ahR21r61ghR11i-52gR21r61goR1ahR2oR3jR4:4:1aoR3jR4:5:3jR30:20:1r204oR3jR4:9:2oR3jR4:1:1oR5r8R7y15:lightPixelColorR9jR10:5:2i3r31R11i-46gR13oR14R15R16i900R17i885gR18r300gar268r269r270hR13oR14R15R16i904R17i885gR18jR10:5:2i3r31goR3jR4:8:2oR3jR4:1:1r248R13oR14R15R16i920R17i908gR18r254gahR13oR14R15R16i922R17i908gR18r253gR13oR14R15R16i922R17i885gR18r306ghR13oR14R15R16i928R17i879gR18r61gR5jR41:1:0R42oR5r249R7y8:fragmentR9jR10:13:1aoR1ahR21r61ghR11i-53gR21r61ghR7y19:h3d.shader.DirLighty4:varsar78r44r66r171r263r299r38r177r229r210r248r286r319hg",
ei.SRC="oy4:funsaoy4:argsahy4:exproy1:ejy13:hxsl.TExprDef:4:1aoR3jR4:4:1aoR3jR4:7:2oy4:kindjy12:hxsl.VarKind:4:0y4:namey3:diry4:typejy9:hxsl.Type:5:2i3jy12:hxsl.VecType:1:0y2:idi-136goR3jR4:5:3jy16:haxe.macro.Binop:1:0oR3jR4:1:1oR5jR6:1:0R7y6:normalR9jR10:5:2i3r11y6:parentoR5r17R7y5:inputR9jR10:12:1aoR5r17R7y8:positionR9jR10:5:2i3r11R15r19R12i-123gr16oR5r17R7y2:uvR9jR10:5:2i2r11R15r19R12i-125ghR12i-122gR12i-124gy1:poy4:filey85:C%3A%5CHaxeToolkit_34%5Chaxe%5Clib%5Cheaps%2F1%2C0%2C0%2Fh3d%2Fshader%2FLineShader.hxy3:maxi683y3:mini671gy1:tr18goR3jR4:8:2oR3jR4:2:1jy12:hxsl.TGlobal:48:0R19oR20R21R22i702R23i686gR24jR10:13:1ahgaoR3jR4:1:1oR5jR6:0:0R7y9:modelViewR9jR10:7:0R15oR5r38R7y6:globalR9jR10:12:1aoR5r38R7y9:pixelSizeR9jR10:5:2i2r11R15r40R12i-120gr37hR12i-119gy10:qualifiersajy17:hxsl.VarQualifier:3:0hR12i-121gR19oR20R21R22i702R23i686gR24r39ghR19oR20R21R22i709R23i686gR24jR10:6:0gR19oR20R21R22i709R23i671gR24r12gR19oR20R21R22i710R23i661gR24jR10:0:0goR3jR4:5:3jR13:4:0oR3jR4:1:1oR5r10R7y4:pdirR9jR10:5:2i4r11R12i-133gR19oR20R21R22i734R23i730gR24r61goR3jR4:5:3r14oR3jR4:8:2oR3jR4:2:1jR25:40:0R19oR20R21R22i741R23i737gR24jR10:13:1ahgaoR3jR4:5:3r14oR3jR4:1:1r9R19oR20R21R22i745R23i742gR24r12goR3jR4:8:2oR3jR4:2:1r30R19oR20R21R22i752R23i748gR24jR10:13:1ahgaoR3jR4:1:1oR5r38R7y4:viewR9r39R15oR5r38R7y6:cameraR9jR10:12:1ar85oR5r38R7y4:projR9r39R15r86R12i-117goR5r38R7y8:viewProjR9r39R15r86R12i-118ghR12i-115gR12i-116gR19oR20R21R22i764R23i753gR24r39ghR19oR20R21R22i765R23i748gR24r51gR19oR20R21R22i765R23i742gR24r12goR3jR4:0:1jy10:hxsl.Const:3:1i1R19oR20R21R22i768R23i767gR24jR10:3:0ghR19oR20R21R22i769R23i737gR24jR10:5:2i4r11goR3jR4:1:1r88R19oR20R21R22i783R23i772gR24r39gR19oR20R21R22i783R23i737gR24jR10:5:2i4r11gR19oR20R21R22i783R23i730gR24r61goR3jR4:5:3jR13:20:1r14oR3jR4:9:2oR3jR4:1:1r60R19oR20R21R22i794R23i790gR24r61gajy14:hxsl.Component:0:0jR37:1:0hR19oR20R21R22i797R23i790gR24jR10:5:2i2r11goR3jR4:5:3jR13:2:0oR3jR4:0:1jR36:3:1i1R19oR20R21R22i802R23i801gR24r101goR3jR4:8:2oR3jR4:2:1jR25:13:0R19oR20R21R22i809R23i805gR24jR10:13:1aoR1aoR7y5:valueR9r101ghy3:retr101ghgaoR3jR4:5:3jR13:0:0oR3jR4:5:3r14oR3jR4:9:2oR3jR4:1:1r60R19oR20R21R22i814R23i810gR24r61gar120hR19oR20R21R22i816R23i810gR24r101goR3jR4:9:2oR3jR4:1:1r60R19oR20R21R22i823R23i819gR24r61gar120hR19oR20R21R22i825R23i819gR24r101gR19oR20R21R22i825R23i810gR24r101goR3jR4:5:3r14oR3jR4:9:2oR3jR4:1:1r60R19oR20R21R22i832R23i828gR24r61gar121hR19oR20R21R22i834R23i828gR24r101goR3jR4:9:2oR3jR4:1:1r60R19oR20R21R22i841R23i837gR24r61gar121hR19oR20R21R22i843R23i837gR24r101gR19oR20R21R22i843R23i828gR24r101gR19oR20R21R22i843R23i810gR24r101ghR19oR20R21R22i844R23i805gR24r101gR19oR20R21R22i844R23i801gR24r101gR19oR20R21R22i844R23i790gR24r124goR3jR4:5:3jR13:20:1r143oR3jR4:1:1oR5r10R7y19:transformedPositionR9jR10:5:2i3r11R12i-129gR19oR20R21R22i870R23i851gR24r190goR3jR4:5:3r14oR3jR4:5:3r14oR3jR4:1:1r9R19oR20R21R22i877R23i874gR24r12goR3jR4:9:2oR3jR4:1:1r23R19oR20R21R22i888R23i880gR24r24gar120hR19oR20R21R22i890R23i880gR24r101gR19oR20R21R22i890R23i874gR24r12goR3jR4:1:1oR5jR6:2:0R7y11:lengthScaleR9r101R12i-131gR19oR20R21R22i904R23i893gR24r101gR19oR20R21R22i904R23i874gR24r12gR19oR20R21R22i904R23i851gR24r190goR3jR4:5:3r58oR3jR4:1:1oR5r10R7y17:transformedNormalR9jR10:5:2i3r11R12i-128gR19oR20R21R22i928R23i911gR24r219goR3jR4:8:2oR3jR4:2:1jR25:31:0R19oR20R21R22i934R23i931gR24jR10:13:1aoR1aoR7y1:_R9r12ghR39r12ghgaoR3jR4:1:1r9R19oR20R21R22i934R23i931gR24r12ghR19oR20R21R22i946R23i931gR24r12gR19oR20R21R22i946R23i911gR24r219ghR19oR20R21R22i953R23i654gR24r56ghR19oR20R21R22i958R23i648gR24r56gR5jy17:hxsl.FunctionKind:2:0y3:refoR5jR6:6:0R7y8:__init__R9jR10:13:1aoR1ahR39r56ghR12i-134gR39r56goR1ahR2oR3jR4:4:1aoR3jR4:5:3jR13:20:1r143oR3jR4:9:2oR3jR4:1:1oR5r10R7y17:projectedPositionR9jR10:5:2i4r11R12i-130gR19oR20R21R22i1005R23i988gR24r260gar120r121hR19oR20R21R22i1008R23i988gR24jR10:5:2i2r11goR3jR4:5:3r14oR3jR4:5:3r14oR3jR4:5:3r14oR3jR4:5:3r14oR3jR4:3:1oR3jR4:5:3r14oR3jR4:9:2oR3jR4:1:1r60R19oR20R21R22i1017R23i1013gR24r61gar121r120hR19oR20R21R22i1020R23i1013gR24jR10:5:2i2r11goR3jR4:8:2oR3jR4:2:1jR25:38:0R19oR20R21R22i1027R23i1023gR24jR10:13:1ahgaoR3jR4:0:1jR36:3:1i1R19oR20R21R22i1029R23i1028gR24r101goR3jR4:0:1jR36:3:1i-1R19oR20R21R22i1032R23i1030gR24r101ghR19oR20R21R22i1033R23i1023gR24jR10:5:2i2r11gR19oR20R21R22i1033R23i1013gR24jR10:5:2i2r11gR19oR20R21R22i1034R23i1012gR24r302goR3jR4:3:1oR3jR4:5:3jR13:3:0oR3jR4:9:2oR3jR4:1:1r23R19oR20R21R22i1046R23i1038gR24r24gar121hR19oR20R21R22i1048R23i1038gR24r101goR3jR4:0:1jR36:3:1d0.5R19oR20R21R22i1054R23i1051gR24r101gR19oR20R21R22i1054R23i1038gR24r101gR19oR20R21R22i1055R23i1037gR24r101gR19oR20R21R22i1055R23i1012gR24r302goR3jR4:9:2oR3jR4:1:1r259R19oR20R21R22i1075R23i1058gR24r260gajR37:2:0hR19oR20R21R22i1077R23i1058gR24r101gR19oR20R21R22i1077R23i1012gR24r302goR3jR4:1:1r42R19oR20R21R22i1096R23i1080gR24r43gR19oR20R21R22i1096R23i1012gR24jR10:5:2i2r11goR3jR4:1:1oR5r209R7y5:widthR9r101R12i-132gR19oR20R21R22i1104R23i1099gR24r101gR19oR20R21R22i1104R23i1012gR24r340gR19oR20R21R22i1104R23i988gR24r266ghR19oR20R21R22i1110R23i982gR24r56gR5jR44:0:0R45oR5r246R7y6:vertexR9jR10:13:1aoR1ahR39r56ghR12i-135gR39r56ghR7y21:h3d.shader.LineShadery4:varsar86r40r19oR5r10R7y6:outputR9jR10:12:1aoR5r10R7R17R9jR10:5:2i4r11R15r358R12i-127ghR12i-126gr218r189r259r208r342r60r245r352hg",ri.SRC="oy4:funsaoy4:argsahy4:exproy1:ejy13:hxsl.TExprDef:4:1aoR3jR4:10:3oR3jR4:6:2jy15:haxe.macro.Unop:2:0oR3jR4:1:1oy4:kindjy12:hxsl.VarKind:2:0y4:namey8:perPixely4:typejy9:hxsl.Type:2:0y10:qualifiersajy17:hxsl.VarQualifier:0:1nhy2:idi-178gy1:poy4:filey81:C%3A%5CHaxeToolkit_34%5Chaxe%5Clib%5Cheaps%2F1%2C0%2C0%2Fh3d%2Fshader%2FShadow.hxy3:maxi414y3:mini406gy1:tr12gR15oR16R17R18i414R19i405gR20r12goR3jR4:5:3jy16:haxe.macro.Binop:4:0oR3jR4:1:1oR6jR7:3:0R8y9:shadowPosR10jR11:5:2i3jy12:hxsl.VecType:1:0R12ajR13:1:0hR14i-177gR15oR16R17R18i426R19i417gR20r25goR3jR4:5:3jR21:0:0oR3jR4:5:3jR21:1:0oR3jR4:5:3r33oR3jR4:1:1oR6jR7:4:0R8y19:transformedPositionR10jR11:5:2i3r24R14i-175gR15oR16R17R18i448R19i429gR20r38goR3jR4:1:1oR6jR7:0:0R8y4:projR10jR11:8:0y6:parentoR6r43R8y6:shadowR10jR11:12:1aoR6r43R8y3:mapR10jR11:15:1i1R26r45R14i-169gr42oR6r43R8y5:colorR10jR11:5:2i3r24R26r45R14i-171goR6r43R8y5:powerR10jR11:3:0R26r45R14i-172goR6r43R8y4:biasR10r52R26r45R14i-173ghR14i-168gR14i-170gR15oR16R17R18i462R19i451gR20r44gR15oR16R17R18i462R19i429gR20jR11:5:2i3r24goR3jR4:8:2oR3jR4:2:1jy12:hxsl.TGlobal:39:0R15oR16R17R18i469R19i465gR20jR11:13:1ahgaoR3jR4:0:1jy10:hxsl.Const:3:1d0.5R15oR16R17R18i473R19i470gR20r52goR3jR4:0:1jR33:3:1d-0.5R15oR16R17R18i479R19i475gR20r52goR3jR4:0:1jR33:3:1i1R15oR16R17R18i482R19i481gR20r52ghR15oR16R17R18i483R19i465gR20jR11:5:2i3r24gR15oR16R17R18i483R19i429gR20jR11:5:2i3r24goR3jR4:8:2oR3jR4:2:1r62R15oR16R17R18i490R19i486gR20r66gaoR3jR4:0:1jR33:3:1d0.5R15oR16R17R18i494R19i491gR20r52goR3jR4:0:1jR33:3:1d0.5R15oR16R17R18i499R19i496gR20r52goR3jR4:0:1jR33:3:1zR15oR16R17R18i502R19i501gR20r52ghR15oR16R17R18i503R19i486gR20jR11:5:2i3r24gR15oR16R17R18i503R19i429gR20jR11:5:2i3r24gR15oR16R17R18i503R19i417gR20r25gnR15oR16R17R18i503R19i401gR20jR11:0:0ghR15oR16R17R18i509R19i395gR20r113gR6jy17:hxsl.FunctionKind:0:0y3:refoR6jR7:6:0R8y6:vertexR10jR11:13:1aoR1ahy3:retr113ghR14i-179gR37r113goR1ahR2oR3jR4:4:1aoR3jR4:7:2oR6r37R8R22R10jR11:5:2i3r24R14i-181goR3jR4:10:3oR3jR4:1:1r10R15oR16R17R18i571R19i563gR20r12goR3jR4:5:3r31oR3jR4:5:3r33oR3jR4:5:3r33oR3jR4:1:1oR6r37R8y24:pixelTransformedPositionR10jR11:5:2i3r24R14i-176gR15oR16R17R18i598R19i574gR20r139goR3jR4:1:1r42R15oR16R17R18i612R19i601gR20r44gR15oR16R17R18i612R19i574gR20r59goR3jR4:8:2oR3jR4:2:1r62R15oR16R17R18i619R19i615gR20r66gaoR3jR4:0:1jR33:3:1d0.5R15oR16R17R18i623R19i620gR20r52goR3jR4:0:1jR33:3:1d-0.5R15oR16R17R18i629R19i625gR20r52goR3jR4:0:1jR33:3:1i1R15oR16R17R18i632R19i631gR20r52ghR15oR16R17R18i633R19i615gR20jR11:5:2i3r24gR15oR16R17R18i633R19i574gR20jR11:5:2i3r24goR3jR4:8:2oR3jR4:2:1r62R15oR16R17R18i640R19i636gR20r66gaoR3jR4:0:1jR33:3:1d0.5R15oR16R17R18i644R19i641gR20r52goR3jR4:0:1jR33:3:1d0.5R15oR16R17R18i649R19i646gR20r52goR3jR4:0:1jR33:3:1zR15oR16R17R18i652R19i651gR20r52ghR15oR16R17R18i653R19i636gR20jR11:5:2i3r24gR15oR16R17R18i653R19i574gR20r129goR3jR4:1:1r22R15oR16R17R18i668R19i659gR20r25gR15oR16R17R18i668R19i559gR20r129gR15oR16R17R18i669R19i543gR20r113goR3jR4:7:2oR6r37R8y5:depthR10r52R14i-182goR3jR4:8:2oR3jR4:2:1jR32:61:0R15oR16R17R18i698R19i688gR20jR11:13:1aoR1aoR8y1:_R10r48goR8y2:uvR10jR11:5:2i2r24ghR37r52ghgaoR3jR4:1:1r47R15oR16R17R18i698R19i688gR20r48goR3jR4:9:2oR3jR4:1:1r128R15oR16R17R18i712R19i703gR20r129gajy14:hxsl.Component:0:0jR42:1:0hR15oR16R17R18i715R19i703gR20jR11:5:2i2r24ghR15oR16R17R18i716R19i688gR20r52gR15oR16R17R18i717R19i676gR20r113goR3jR4:7:2oR6r37R8y4:zMaxR10r52R14i-183goR3jR4:8:2oR3jR4:2:1jR32:51:0R15oR16R17R18i909R19i898gR20jR11:13:1aoR1aoR8R40R10r52ghR37r52ghgaoR3jR4:9:2oR3jR4:1:1r128R15oR16R17R18i907R19i898gR20r129gajR42:2:0hR15oR16R17R18i909R19i898gR20r52ghR15oR16R17R18i920R19i898gR20r52gR15oR16R17R18i921R19i887gR20r113goR3jR4:7:2oR6r37R8y5:deltaR10r52R14i-184goR3jR4:5:3jR21:3:0oR3jR4:8:2oR3jR4:2:1jR32:21:0R15oR16R17R18i959R19i938gR20jR11:13:1aoR1aoR8R40R10r52goR8y1:bR10r52ghR37r52ghgaoR3jR4:3:1oR3jR4:5:3r31oR3jR4:1:1r200R15oR16R17R18i944R19i939gR20r52goR3jR4:1:1r53R15oR16R17R18i958R19i947gR20r52gR15oR16R17R18i958R19i939gR20r52gR15oR16R17R18i959R19i938gR20r52goR3jR4:1:1r232R15oR16R17R18i968R19i964gR20r52ghR15oR16R17R18i969R19i938gR20r52goR3jR4:1:1r232R15oR16R17R18i976R19i972gR20r52gR15oR16R17R18i976R19i938gR20r52gR15oR16R17R18i977R19i926gR20r113goR3jR4:7:2oR6r37R8y5:shadeR10r52R14i-185goR3jR4:8:2oR3jR4:2:1r235R15oR16R17R18i1022R19i994gR20jR11:13:1aoR1aoR8R40R10r52ghR37r52ghgaoR3jR4:8:2oR3jR4:2:1jR32:9:0R15oR16R17R18i997R19i994gR20jR11:13:1aoR1aoR8y5:valueR10r52ghR37r52ghgaoR3jR4:5:3r33oR3jR4:1:1r51R15oR16R17R18i1011R19i999gR20r52goR3jR4:1:1r257R15oR16R17R18i1019R19i1014gR20r52gR15oR16R17R18i1019R19i999gR20r52ghR15oR16R17R18i1022R19i994gR20r52ghR15oR16R17R18i1033R19i994gR20r52gR15oR16R17R18i1034R19i982gR20r113goR3jR4:5:3jR21:20:1r33oR3jR4:9:2oR3jR4:1:1oR6r37R8y10:pixelColorR10jR11:5:2i4r24R14i-174gR15oR16R17R18i1049R19i1039gR20r339gar222r223r249hR15oR16R17R18i1053R19i1039gR20jR11:5:2i3r24goR3jR4:5:3r31oR3jR4:5:3r33oR3jR4:3:1oR3jR4:5:3r259oR3jR4:0:1jR33:3:1i1R15oR16R17R18i1059R19i1058gR20r52goR3jR4:1:1r297R15oR16R17R18i1067R19i1062gR20r52gR15oR16R17R18i1067R19i1058gR20r52gR15oR16R17R18i1068R19i1057gR20r52goR3jR4:9:2oR3jR4:1:1r49R15oR16R17R18i1083R19i1071gR20r50gar222r223r249hR15oR16R17R18i1087R19i1071gR20jR11:5:2i3r24gR15oR16R17R18i1087R19i1057gR20r368goR3jR4:1:1r297R15oR16R17R18i1095R19i1090gR20r52gR15oR16R17R18i1095R19i1057gR20r368gR15oR16R17R18i1095R19i1039gR20r345ghR15oR16R17R18i1101R19i535gR20r113gR6jR34:1:0R35oR6r118R8y8:fragmentR10jR11:13:1aoR1ahR37r113ghR14i-180gR37r113ghR8y17:h3d.shader.Shadowy4:varsar45r338r36r138r22r10r117r381hg",ii.SRC="oy4:funsaoy4:argsahy4:exproy1:ejy13:hxsl.TExprDef:4:1aoR3jR4:5:3jy16:haxe.macro.Binop:4:0oR3jR4:1:1oy4:kindjy12:hxsl.VarKind:4:0y4:namey19:transformedPositiony4:typejy9:hxsl.Type:5:2i3jy12:hxsl.VecType:1:0y2:idi-143gy1:poy4:filey79:C%3A%5CHaxeToolkit_34%5Chaxe%5Clib%5Cheaps%2F1%2C0%2C0%2Fh3d%2Fshader%2FSkin.hxy3:maxi546y3:mini527gy1:tr12goR3jR4:5:3jR5:0:0oR3jR4:5:3r16oR3jR4:5:3jR5:1:0oR3jR4:3:1oR3jR4:5:3r19oR3jR4:1:1oR6r10R8y16:relativePositionR10jR11:5:2i3r11R13i-142gR14oR15R16R17i571R18i555gR19r24goR3jR4:16:2oR3jR4:1:1oR6jR7:2:0R8y13:bonesMatrixesR10jR11:14:2jR11:8:0jy13:hxsl.SizeDecl:1:1oR6r30R8y8:MaxBonesR10jR11:1:0y10:qualifiersajy17:hxsl.VarQualifier:0:1nhR13i-145gR24ajR25:8:0hR13i-146gR14oR15R16R17i587R18i574gR19r37goR3jR4:9:2oR3jR4:1:1oR6jR7:1:0R8y7:indexesR10jR11:9:1i4y6:parentoR6r45R8y5:inputR10jR11:12:1aoR6r45R8y8:positionR10jR11:5:2i3r11R27r47R13i-138goR6r45R8y6:normalR10jR11:5:2i3r11R27r47R13i-139goR6r45R8y7:weightsR10jR11:5:2i3r11R27r47R13i-140gr44hR13i-137gR13i-141gR14oR15R16R17i601R18i588gR19r46gajy14:hxsl.Component:0:0hR14oR15R16R17i603R18i588gR19r33gR14oR15R16R17i604R18i574gR19r31gR14oR15R16R17i604R18i555gR19jR11:5:2i3r11gR14oR15R16R17i605R18i554gR19r66goR3jR4:9:2oR3jR4:1:1r53R14oR15R16R17i621R18i608gR19r54gar59hR14oR15R16R17i623R18i608gR19jR11:3:0gR14oR15R16R17i623R18i554gR19r66goR3jR4:5:3r19oR3jR4:3:1oR3jR4:5:3r19oR3jR4:1:1r23R14oR15R16R17i648R18i632gR19r24goR3jR4:16:2oR3jR4:1:1r29R14oR15R16R17i664R18i651gR19r37goR3jR4:9:2oR3jR4:1:1r44R14oR15R16R17i678R18i665gR19r46gajR32:1:0hR14oR15R16R17i680R18i665gR19r33gR14oR15R16R17i681R18i651gR19r31gR14oR15R16R17i681R18i632gR19r66gR14oR15R16R17i682R18i631gR19r66goR3jR4:9:2oR3jR4:1:1r53R14oR15R16R17i698R18i685gR19r54gar94hR14oR15R16R17i700R18i685gR19r76gR14oR15R16R17i700R18i631gR19r66gR14oR15R16R17i700R18i554gR19jR11:5:2i3r11goR3jR4:5:3r19oR3jR4:3:1oR3jR4:5:3r19oR3jR4:1:1r23R14oR15R16R17i725R18i709gR19r24goR3jR4:16:2oR3jR4:1:1r29R14oR15R16R17i741R18i728gR19r37goR3jR4:9:2oR3jR4:1:1r44R14oR15R16R17i755R18i742gR19r46gajR32:2:0hR14oR15R16R17i757R18i742gR19r33gR14oR15R16R17i758R18i728gR19r31gR14oR15R16R17i758R18i709gR19r66gR14oR15R16R17i759R18i708gR19r66goR3jR4:9:2oR3jR4:1:1r53R14oR15R16R17i775R18i762gR19r54gar130hR14oR15R16R17i777R18i762gR19r76gR14oR15R16R17i777R18i708gR19r66gR14oR15R16R17i777R18i554gR19jR11:5:2i3r11gR14oR15R16R17i777R18i527gR19r12goR3jR4:5:3r7oR3jR4:1:1oR6r10R8y17:transformedNormalR10jR11:5:2i3r11R13i-144gR14oR15R16R17i800R18i783gR19r156goR3jR4:8:2oR3jR4:2:1jy12:hxsl.TGlobal:31:0R14oR15R16R17i812R18i803gR19jR11:13:1aoR1aoR8y5:valueR10r66ghy3:retr66ghgaoR3jR4:5:3r16oR3jR4:5:3r16oR3jR4:5:3r19oR3jR4:3:1oR3jR4:5:3r19oR3jR4:1:1r51R14oR15R16R17i832R18i820gR19r52goR3jR4:8:2oR3jR4:2:1jR34:48:0R14oR15R16R17i839R18i835gR19jR11:13:1ahgaoR3jR4:16:2oR3jR4:1:1r29R14oR15R16R17i853R18i840gR19r37goR3jR4:9:2oR3jR4:1:1r44R14oR15R16R17i867R18i854gR19r46gar59hR14oR15R16R17i869R18i854gR19r33gR14oR15R16R17i870R18i840gR19r31ghR14oR15R16R17i871R18i835gR19jR11:6:0gR14oR15R16R17i871R18i820gR19r66gR14oR15R16R17i872R18i819gR19r66goR3jR4:9:2oR3jR4:1:1r53R14oR15R16R17i888R18i875gR19r54gar59hR14oR15R16R17i890R18i875gR19r76gR14oR15R16R17i890R18i819gR19r66goR3jR4:5:3r19oR3jR4:3:1oR3jR4:5:3r19oR3jR4:1:1r51R14oR15R16R17i911R18i899gR19r52goR3jR4:8:2oR3jR4:2:1r180R14oR15R16R17i918R18i914gR19r184gaoR3jR4:16:2oR3jR4:1:1r29R14oR15R16R17i932R18i919gR19r37goR3jR4:9:2oR3jR4:1:1r44R14oR15R16R17i946R18i933gR19r46gar94hR14oR15R16R17i948R18i933gR19r33gR14oR15R16R17i949R18i919gR19r31ghR14oR15R16R17i950R18i914gR19r201gR14oR15R16R17i950R18i899gR19r66gR14oR15R16R17i951R18i898gR19r66goR3jR4:9:2oR3jR4:1:1r53R14oR15R16R17i967R18i954gR19r54gar94hR14oR15R16R17i969R18i954gR19r76gR14oR15R16R17i969R18i898gR19r66gR14oR15R16R17i969R18i819gR19jR11:5:2i3r11goR3jR4:5:3r19oR3jR4:3:1oR3jR4:5:3r19oR3jR4:1:1r51R14oR15R16R17i990R18i978gR19r52goR3jR4:8:2oR3jR4:2:1r180R14oR15R16R17i997R18i993gR19r184gaoR3jR4:16:2oR3jR4:1:1r29R14oR15R16R17i1011R18i998gR19r37goR3jR4:9:2oR3jR4:1:1r44R14oR15R16R17i1025R18i1012gR19r46gar130hR14oR15R16R17i1027R18i1012gR19r33gR14oR15R16R17i1028R18i998gR19r31ghR14oR15R16R17i1029R18i993gR19r201gR14oR15R16R17i1029R18i978gR19r66gR14oR15R16R17i1030R18i977gR19r66goR3jR4:9:2oR3jR4:1:1r53R14oR15R16R17i1046R18i1033gR19r54gar130hR14oR15R16R17i1048R18i1033gR19r76gR14oR15R16R17i1048R18i977gR19r66gR14oR15R16R17i1048R18i819gR19jR11:5:2i3r11ghR14oR15R16R17i1049R18i803gR19r66gR14oR15R16R17i1049R18i783gR19r156ghR14oR15R16R17i1064R18i428gR19jR11:0:0gR6jy17:hxsl.FunctionKind:0:0y3:refoR6jR7:6:0R8y6:vertexR10jR11:13:1aoR1ahR36r305ghR13i-147gR36r305ghR8y15:h3d.shader.Skiny4:varsar47r23r9r155r32r29r307hg",ni.SRC="oy4:funsaoy4:argsahy4:exproy1:ejy13:hxsl.TExprDef:4:1aoR3jR4:5:3jy16:haxe.macro.Binop:20:1jR5:1:0oR3jR4:1:1oy4:kindjy12:hxsl.VarKind:4:0y4:namey9:specColory4:typejy9:hxsl.Type:5:2i3jy12:hxsl.VecType:1:0y2:idi-59gy1:poy4:filey90:C%3A%5CHaxeToolkit_34%5Chaxe%5Clib%5Cheaps%2F1%2C0%2C0%2Fh3d%2Fshader%2FSpecularTexture.hxy3:maxi218y3:mini209gy1:tr13goR3jR4:9:2oR3jR4:8:2oR3jR4:2:1jy12:hxsl.TGlobal:33:0R14oR15R16R17i229R18i222gR19jR11:13:1aoR1aoR8y1:_R10jR11:10:0goR8y2:uvR10jR11:5:2i2r12ghy3:retjR11:5:2i4r12ghgaoR3jR4:1:1oR6jR7:2:0R8y7:textureR10r26R13i-57gR14oR15R16R17i229R18i222gR19r26goR3jR4:1:1oR6r11R8y12:calculatedUVR10jR11:5:2i2r12R13i-58gR14oR15R16R17i246R18i234gR19r39ghR14oR15R16R17i247R18i222gR19r29gajy14:hxsl.Component:0:0jR26:1:0jR26:2:0hR14oR15R16R17i251R18i222gR19jR11:5:2i3r12gR14oR15R16R17i251R18i209gR19r13ghR14oR15R16R17i257R18i203gR19jR11:0:0gR6jy17:hxsl.FunctionKind:1:0y3:refoR6jR7:6:0R8y8:fragmentR10jR11:13:1aoR1ahR23r55ghR13i-60gR23r55ghR8y26:h3d.shader.SpecularTexturey4:varsar33r38r10r57hg",ai.SRC="oy4:funsaoy4:argsahy4:exproy1:ejy13:hxsl.TExprDef:4:1aoR3jR4:5:3jy16:haxe.macro.Binop:4:0oR3jR4:1:1oy4:kindjy12:hxsl.VarKind:4:0y4:namey12:calculatedUVy4:typejy9:hxsl.Type:5:2i2jy12:hxsl.VecType:1:0y2:idi-68gy1:poy4:filey82:C%3A%5CHaxeToolkit_34%5Chaxe%5Clib%5Cheaps%2F1%2C0%2C0%2Fh3d%2Fshader%2FTexture.hxy3:maxi443y3:mini431gy1:tr12goR3jR4:1:1oR6jR7:1:0R8y2:uvR10jR11:5:2i2r11y6:parentoR6r17R8y5:inputR10jR11:12:1ar16hR13i-61gR13i-62gR14oR15R16R17i454R18i446gR19r18gR14oR15R16R17i454R18i431gR19r12ghR14oR15R16R17i460R18i425gR19jR11:0:0gR6jy17:hxsl.FunctionKind:0:0y3:refoR6jR7:6:0R8y6:vertexR10jR11:13:1aoR1ahy3:retr28ghR13i-71gR26r28goR1ahR2oR3jR4:4:1aoR3jR4:7:2oR6r10R8y1:cR10jR11:5:2i4r11R13i-73goR3jR4:8:2oR3jR4:2:1jy12:hxsl.TGlobal:33:0R14oR15R16R17i507R18i500gR19jR11:13:1aoR1aoR8y1:_R10jR11:10:0goR8R20R10jR11:5:2i2r11ghR26r42ghgaoR3jR4:1:1oR6jR7:2:0R8y7:textureR10r52R13i-67gR14oR15R16R17i507R18i500gR19r52goR3jR4:1:1r9R14oR15R16R17i524R18i512gR19r12ghR14oR15R16R17i525R18i500gR19r42gR14oR15R16R17i526R18i492gR19r28goR3jR4:10:3oR3jR4:5:3jR5:14:0oR3jR4:1:1oR6r59R8y9:killAlphaR10jR11:2:0y10:qualifiersajy17:hxsl.VarQualifier:0:1nhR13i-64gR14oR15R16R17i544R18i535gR19r74goR3jR4:5:3jR5:9:0oR3jR4:5:3jR5:3:0oR3jR4:9:2oR3jR4:1:1r41R14oR15R16R17i549R18i548gR19r42gajy14:hxsl.Component:3:0hR14oR15R16R17i551R18i548gR19jR11:3:0goR3jR4:1:1oR6r59R8y18:killAlphaThresholdR10r91R32ajR33:7:2d0d1hR13i-66gR14oR15R16R17i572R18i554gR19r91gR14oR15R16R17i572R18i548gR19r91goR3jR4:0:1jy10:hxsl.Const:3:1zR14oR15R16R17i576R18i575gR19r91gR14oR15R16R17i576R18i548gR19r74gR14oR15R16R17i576R18i535gR19r74goR3jR4:11:0R14oR15R16R17i586R18i579gR19r28gnR14oR15R16R17i586R18i531gR19r28goR3jR4:10:3oR3jR4:1:1oR6r59R8y8:additiveR10r74R32ajR33:0:1nhR13i-63gR14oR15R16R17i604R18i596gR19r74goR3jR4:5:3jR5:20:1jR5:0:0oR3jR4:1:1oR6r10R8y10:pixelColorR10jR11:5:2i4r11R13i-69gR14oR15R16R17i622R18i612gR19r125goR3jR4:1:1r41R14oR15R16R17i627R18i626gR19r42gR14oR15R16R17i627R18i612gR19r125goR3jR4:5:3jR5:20:1jR5:1:0oR3jR4:1:1r124R14oR15R16R17i653R18i643gR19r125goR3jR4:1:1r41R14oR15R16R17i658R18i657gR19r42gR14oR15R16R17i658R18i643gR19r125gR14oR15R16R17i658R18i592gR19r28goR3jR4:10:3oR3jR4:1:1oR6r59R8y13:specularAlphaR10r74R32ajR33:0:1nhR13i-65gR14oR15R16R17i681R18i668gR19r74goR3jR4:5:3jR5:20:1r134oR3jR4:1:1oR6r10R8y9:specColorR10jR11:5:2i3r11R13i-70gR14oR15R16R17i698R18i689gR19r157goR3jR4:9:2oR3jR4:1:1r41R14oR15R16R17i703R18i702gR19r42gar88r88r88hR14oR15R16R17i707R18i702gR19jR11:5:2i3r11gR14oR15R16R17i707R18i689gR19r157gnR14oR15R16R17i707R18i664gR19r28ghR14oR15R16R17i713R18i486gR19r28gR6jR23:1:0R24oR6r31R8y8:fragmentR10jR11:13:1aoR1ahR26r28ghR13i-72gR26r28ghR8y18:h3d.shader.Texturey4:varsar19r115r73r148r93r58r9r124r156r30r175hg",si.SRC="oy4:funsaoy4:argsahy4:exproy1:ejy13:hxsl.TExprDef:4:1aoR3jR4:5:3jy16:haxe.macro.Binop:4:0oR3jR4:1:1oy4:kindjy12:hxsl.VarKind:4:0y4:namey12:calculatedUVy4:typejy9:hxsl.Type:5:2i2jy12:hxsl.VecType:1:0y2:idi-242gy1:poy4:filey82:C%3A%5CHaxeToolkit_34%5Chaxe%5Clib%5Cheaps%2F1%2C0%2C0%2Fh3d%2Fshader%2FUVDelta.hxy3:maxi209y3:mini197gy1:tr12goR3jR4:5:3jR5:0:0oR3jR4:5:3jR5:1:0oR3jR4:1:1r9R14oR15R16R17i224R18i212gR19r12goR3jR4:1:1oR6jR7:2:0R8y7:uvScaleR10jR11:5:2i2r11R13i-241gR14oR15R16R17i234R18i227gR19r25gR14oR15R16R17i234R18i212gR19jR11:5:2i2r11goR3jR4:1:1oR6r24R8y7:uvDeltaR10jR11:5:2i2r11R13i-240gR14oR15R16R17i244R18i237gR19r33gR14oR15R16R17i244R18i212gR19jR11:5:2i2r11gR14oR15R16R17i244R18i197gR19r12ghR14oR15R16R17i250R18i191gR19jR11:0:0gR6jy17:hxsl.FunctionKind:0:0y3:refoR6jR7:6:0R8y6:vertexR10jR11:13:1aoR1ahy3:retr43ghR13i-243gR25r43ghR8y18:h3d.shader.UVDeltay4:varsar32r23r9r45hg",oi.SRC="oy4:funsaoy4:argsahy4:exproy1:ejy13:hxsl.TExprDef:4:1aoR3jR4:10:3oR3jR4:1:1oy4:kindjy12:hxsl.VarKind:2:0y4:namey8:additivey4:typejy9:hxsl.Type:2:0y10:qualifiersajy17:hxsl.VarQualifier:0:1nhy2:idi-238gy1:poy4:filey91:C%3A%5CHaxeToolkit_34%5Chaxe%5Clib%5Cheaps%2F1%2C0%2C0%2Fh3d%2Fshader%2FVertexColorAlpha.hxy3:maxi245y3:mini237gy1:tr10goR3jR4:5:3jy16:haxe.macro.Binop:20:1jR20:0:0oR3jR4:1:1oR5jR6:4:0R7y10:pixelColorR9jR10:5:2i4jy12:hxsl.VecType:1:0R13i-237gR14oR15R16R17i263R18i253gR19r22goR3jR4:1:1oR5jR6:1:0R7y5:colorR9jR10:5:2i4r21y6:parentoR5r27R7y5:inputR9jR10:12:1ar26hR13i-235gR13i-236gR14oR15R16R17i278R18i267gR19r28gR14oR15R16R17i278R18i253gR19r22goR3jR4:5:3jR20:20:1jR20:1:0oR3jR4:1:1r19R14oR15R16R17i304R18i294gR19r22goR3jR4:1:1r26R14oR15R16R17i319R18i308gR19r28gR14oR15R16R17i319R18i294gR19r22gR14oR15R16R17i319R18i233gR19jR10:0:0ghR14oR15R16R17i325R18i227gR19r49gR5jy17:hxsl.FunctionKind:1:0y3:refoR5jR6:6:0R7y8:fragmentR9jR10:13:1aoR1ahy3:retr49ghR13i-239gR29r49ghR7y27:h3d.shader.VertexColorAlphay4:varsar29r19r8r53hg",hi.SRC="oy4:funsaoy4:argsahy4:exproy1:ejy13:hxsl.TExprDef:4:1aoR3jR4:5:3jy16:haxe.macro.Binop:4:0oR3jR4:1:1oy4:kindjy12:hxsl.VarKind:4:0y4:namey17:transformedNormaly4:typejy9:hxsl.Type:5:2i3jy12:hxsl.VecType:1:0y2:idi-212gy1:poy4:filey86:C%3A%5CHaxeToolkit_34%5Chaxe%5Clib%5Cheaps%2F1%2C0%2C0%2Fh3d%2Fshader%2FVolumeDecal.hxy3:maxi282y3:mini265gy1:tr12goR3jR4:1:1oR6jR7:2:0R8y6:normalR10jR11:5:2i3r11R13i-225gR14oR15R16R17i291R18i285gR19r18gR14oR15R16R17i291R18i265gR19r12ghR14oR15R16R17i297R18i259gR19jR11:0:0gR6jy17:hxsl.FunctionKind:0:0y3:refoR6jR7:6:0R8y6:vertexR10jR11:13:1aoR1ahy3:retr25ghR13i-227gR24r25goR1ahR2oR3jR4:4:1aoR3jR4:7:2oR6r10R8y6:matrixR10jR11:7:0R13i-229goR3jR4:5:3jR5:1:0oR3jR4:1:1oR6jR7:0:0R8y15:inverseViewProjR10r39y6:parentoR6r44R8y6:cameraR10jR11:12:1aoR6r44R8y4:viewR10r39R27r45R13i-187goR6r44R8y4:projR10r39R27r45R13i-188goR6r44R8y8:positionR10jR11:5:2i3r11R27r45R13i-189goR6r44R8y8:projDiagR10jR11:5:2i3r11R27r45R13i-190goR6r44R8y8:viewProjR10r39R27r45R13i-191gr43oR6r44R8y5:zNearR10jR11:3:0R27r45R13i-193goR6r44R8y4:zFarR10r55R27r45R13i-194goR6jR7:3:0R8y3:dirR10jR11:5:2i3r11R27r45R13i-195ghR13i-186gR13i-192gR14oR15R16R17i364R18i342gR19r39goR3jR4:1:1oR6r44R8y16:modelViewInverseR10r39R27oR6r44R8y6:globalR10jR11:12:1aoR6r44R8y4:timeR10r55R27r65R13i-197goR6r44R8y9:pixelSizeR10jR11:5:2i2r11R27r65R13i-198goR6r44R8y9:modelViewR10r39R27r65y10:qualifiersajy17:hxsl.VarQualifier:3:0hR13i-199gr64hR13i-196gR42ar72hR13i-200gR14oR15R16R17i390R18i367gR19r39gR14oR15R16R17i390R18i342gR19r39gR14oR15R16R17i391R18i329gR19r25goR3jR4:7:2oR6r10R8y9:screenPosR10jR11:5:2i2r11R13i-230goR3jR4:5:3jR5:2:0oR3jR4:9:2oR3jR4:1:1oR6r10R8y17:projectedPositionR10jR11:5:2i4r11R13i-213gR14oR15R16R17i429R18i412gR19r89gajy14:hxsl.Component:0:0jR46:1:0hR14oR15R16R17i432R18i412gR19r83goR3jR4:9:2oR3jR4:1:1r88R14oR15R16R17i452R18i435gR19r89gajR46:3:0hR14oR15R16R17i454R18i435gR19r55gR14oR15R16R17i454R18i412gR19r83gR14oR15R16R17i455R18i396gR19r25goR3jR4:7:2oR6r10R8y3:tuvR10jR11:5:2i2r11R13i-231goR3jR4:5:3jR5:0:0oR3jR4:5:3r41oR3jR4:1:1r82R14oR15R16R17i479R18i470gR19r83goR3jR4:8:2oR3jR4:2:1jy12:hxsl.TGlobal:38:0R14oR15R16R17i486R18i482gR19jR11:13:1ahgaoR3jR4:0:1jy10:hxsl.Const:3:1d0.5R14oR15R16R17i490R18i487gR19r55goR3jR4:0:1jR49:3:1d-0.5R14oR15R16R17i496R18i492gR19r55ghR14oR15R16R17i497R18i482gR19jR11:5:2i2r11gR14oR15R16R17i497R18i470gR19jR11:5:2i2r11goR3jR4:8:2oR3jR4:2:1r120R14oR15R16R17i504R18i500gR19r124gaoR3jR4:0:1jR49:3:1d0.5R14oR15R16R17i508R18i505gR19r55goR3jR4:0:1jR49:3:1d0.5R14oR15R16R17i513R18i510gR19r55ghR14oR15R16R17i514R18i500gR19jR11:5:2i2r11gR14oR15R16R17i514R18i470gR19r111gR14oR15R16R17i515R18i460gR19r25goR3jR4:7:2oR6r10R8y3:ruvR10jR11:5:2i4r11R13i-232goR3jR4:8:2oR3jR4:2:1jR48:40:0R14oR15R16R17i534R18i530gR19jR11:13:1ahgaoR3jR4:1:1r82R14oR15R16R17i550R18i541gR19r83goR3jR4:8:2oR3jR4:2:1jR48:53:0R14oR15R16R17i563R18i557gR19jR11:13:1aoR1aoR8y5:valueR10jR11:5:2i4r11ghR24r55ghgaoR3jR4:8:2oR3jR4:2:1jR48:33:0R14oR15R16R17i572R18i564gR19jR11:13:1aoR1aoR8y1:_R10jR11:10:0goR8y2:uvR10jR11:5:2i2r11ghR24jR11:5:2i4r11ghgaoR3jR4:1:1oR6r44R8y8:depthMapR10r195R13i-223gR14oR15R16R17i572R18i564gR19r195goR3jR4:1:1r110R14oR15R16R17i580R18i577gR19r111ghR14oR15R16R17i581R18i564gR19r198ghR14oR15R16R17i582R18i557gR19r55goR3jR4:0:1jR49:3:1i1R14oR15R16R17i590R18i589gR19r55ghR14oR15R16R17i596R18i530gR19r162gR14oR15R16R17i597R18i520gR19r25goR3jR4:7:2oR6r10R8y4:wposR10r198R13i-233goR3jR4:5:3r41oR3jR4:1:1r161R14oR15R16R17i616R18i613gR19r162goR3jR4:1:1r38R14oR15R16R17i625R18i619gR19r39gR14oR15R16R17i625R18i613gR19r198gR14oR15R16R17i626R18i602gR19r25goR3jR4:7:2oR6r10R8y4:pposR10r198R13i-234goR3jR4:5:3r41oR3jR4:1:1r161R14oR15R16R17i645R18i642gR19r162goR3jR4:1:1r43R14oR15R16R17i670R18i648gR19r39gR14oR15R16R17i670R18i642gR19r198gR14oR15R16R17i671R18i631gR19r25goR3jR4:5:3r7oR3jR4:1:1oR6r10R8y24:pixelTransformedPositionR10jR11:5:2i3r11R13i-211gR14oR15R16R17i700R18i676gR19r249goR3jR4:5:3r85oR3jR4:9:2oR3jR4:1:1r234R14oR15R16R17i707R18i703gR19r198gar93r94jR46:2:0hR14oR15R16R17i711R18i703gR19jR11:5:2i3r11goR3jR4:9:2oR3jR4:1:1r234R14oR15R16R17i718R18i714gR19r198gar102hR14oR15R16R17i720R18i714gR19r55gR14oR15R16R17i720R18i703gR19r261gR14oR15R16R17i720R18i676gR19r249goR3jR4:5:3r7oR3jR4:1:1oR6r10R8y12:calculatedUVR10jR11:5:2i2r11R13i-226gR14oR15R16R17i738R18i726gR19r276goR3jR4:5:3r113oR3jR4:5:3r41oR3jR4:1:1oR6r17R8y5:scaleR10jR11:5:2i2r11R13i-224gR14oR15R16R17i746R18i741gR19r283goR3jR4:3:1oR3jR4:5:3r85oR3jR4:9:2oR3jR4:1:1r221R14oR15R16R17i754R18i750gR19r198gar93r94hR14oR15R16R17i757R18i750gR19jR11:5:2i2r11goR3jR4:9:2oR3jR4:1:1r221R14oR15R16R17i764R18i760gR19r198gar102hR14oR15R16R17i766R18i760gR19r55gR14oR15R16R17i766R18i750gR19r295gR14oR15R16R17i767R18i749gR19r295gR14oR15R16R17i767R18i741gR19jR11:5:2i2r11goR3jR4:0:1jR49:3:1d0.5R14oR15R16R17i773R18i770gR19r55gR14oR15R16R17i773R18i741gR19r309gR14oR15R16R17i773R18i726gR19r276goR3jR4:10:3oR3jR4:5:3jR5:9:0oR3jR4:8:2oR3jR4:2:1jR48:21:0R14oR15R16R17i786R18i783gR19jR11:13:1aoR1aoR8y1:aR10r55goR8y1:bR10r55ghR24r55ghgaoR3jR4:8:2oR3jR4:2:1r323R14oR15R16R17i790R18i787gR19jR11:13:1ar327hgaoR3jR4:9:2oR3jR4:1:1r275R14oR15R16R17i803R18i791gR19r276gar93hR14oR15R16R17i805R18i791gR19r55goR3jR4:9:2oR3jR4:1:1r275R14oR15R16R17i819R18i807gR19r276gar94hR14oR15R16R17i821R18i807gR19r55ghR14oR15R16R17i822R18i787gR19r55goR3jR4:8:2oR3jR4:2:1r323R14oR15R16R17i827R18i824gR19jR11:13:1ar327hgaoR3jR4:5:3jR5:3:0oR3jR4:0:1jR49:3:1i1R14oR15R16R17i829R18i828gR19r55goR3jR4:9:2oR3jR4:1:1r275R14oR15R16R17i844R18i832gR19r276gar93hR14oR15R16R17i846R18i832gR19r55gR14oR15R16R17i846R18i828gR19r55goR3jR4:5:3r364oR3jR4:0:1jR49:3:1i1R14oR15R16R17i849R18i848gR19r55goR3jR4:9:2oR3jR4:1:1r275R14oR15R16R17i864R18i852gR19r276gar94hR14oR15R16R17i866R18i852gR19r55gR14oR15R16R17i866R18i848gR19r55ghR14oR15R16R17i867R18i824gR19r55ghR14oR15R16R17i868R18i783gR19r55goR3jR4:0:1jR49:3:1zR14oR15R16R17i872R18i871gR19r55gR14oR15R16R17i872R18i783gR19jR11:2:0goR3jR4:11:0R14oR15R16R17i882R18i875gR19r25gnR14oR15R16R17i882R18i779gR19r25ghR14oR15R16R17i888R18i323gR19r25gR6jR21:1:0R22oR6r28R8y8:fragmentR10jR11:13:1aoR1ahR24r25ghR13i-228gR24r25ghR8y22:h3d.shader.VolumeDecaly4:varsar45r65oR6jR7:1:0R8y5:inputR10jR11:12:1aoR6r418R8R31R10jR11:5:2i3r11R27r417R13i-202goR6r418R8R20R10jR11:5:2i3r11R27r417R13i-203ghR13i-201goR6r10R8y6:outputR10jR11:12:1aoR6r10R8R31R10jR11:5:2i4r11R27r425R13i-205goR6r10R8y5:colorR10jR11:5:2i4r11R27r425R13i-206goR6r10R8y5:depthR10r55R27r425R13i-207goR6r10R8R20R10jR11:5:2i3r11R27r425R13i-208ghR13i-204goR6r10R8y16:relativePositionR10jR11:5:2i3r11R13i-209goR6r10R8y19:transformedPositionR10jR11:5:2i3r11R13i-210gr248r9r88oR6r10R8y10:pixelColorR10jR11:5:2i4r11R13i-214goR6r10R8R68R10r55R13i-215goR6r10R8y8:screenUVR10jR11:5:2i2r11R13i-216goR6r10R8y9:specPowerR10r55R13i-217goR6r10R8y9:specColorR10jR11:5:2i3r11R13i-218gr202r282r16r275r27r411hg",ui.pending=[],ui.threadCount=0,pi.DEFAULT_RESOLVER=new gi,pi.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",wi.count=0,Di.stack=[],zi.initDone=!1,zi.keyPressed=[],zi.ALLOW_KEY_REPEAT=!1,Zi.setCursor=Zi.setNativeCursor,Zi.loopInit=!1,Ki.wantedFPS=60,Ki.maxDeltaTime=.5,Ki.oldTime=(new Date).getTime()/1e3,Ki.tmod_factor=.95,Ki.calc_tmod=1,Ki.tmod=1,Ki.deltaT=1,Ki.frameCount=0,en.stack=[],en.inst=new tn,rn.bytes=[],pn.UID=0,pn.SWIZ=fn.__empty_constructs__,pn.MAX_CHANNELS_BITS=3,En.__toStr={}.toString,An.KWD_LIST=["input","output","discard","dvec2","dvec3","dvec4"],An.KWDS=function(t){for(var e,r=new Ti,i=0,n=An.KWD_LIST;i<n.length;){var a=n[i];++i,null!=_a[a]?r.setReserved(a,!0):r.h[a]=!0}return e=r}(this),An.GLOBALS=function(t){for(var e,r=new xi,i=0,n=_n.__empty_constructs__;i<n.length;){var a=n[i];++i;var s=""+g.string(a);s=s.charAt(0).toLowerCase()+o.substr(s,1,null),r.set(a,s)}r.set(_n.ToInt,"int"),r.set(_n.ToFloat,"float"),r.set(_n.ToBool,"bool"),r.set(_n.Texture2D,"_texture2D"),r.set(_n.LReflect,"reflect"),r.set(_n.Mat3x4,"_mat3x4");for(var h=r.iterator();h.hasNext();){var l=h.next(),u=An.KWDS;null!=_a[l]?u.setReserved(l,!0):u.h[l]=!0}return e=r}(this),An.MAT34="struct _mat3x4 { vec4 a; vec4 b; vec4 c; };",Vn.SWIZ=["x","y","z","w"],Gn.UID=0,Qn.BYTES_PER_ELEMENT=4,Jn.BYTES_PER_ELEMENT=1,c.main(),ui.run()}("undefined"!=typeof window?window:"undefined"!=typeof t?t:"undefined"!=typeof self?self:this)}).call(e,function(){return this}())},function(t,e,r){var i;(function(t,n){(function(){function a(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function s(t,e,r,i){for(var n=-1,a=null==t?0:t.length;++n<a;){var s=t[n];e(i,s,r(s),t)}return i}function o(t,e){for(var r=-1,i=null==t?0:t.length;++r<i&&e(t[r],r,t)!==!1;);return t}function h(t,e){for(var r=null==t?0:t.length;r--&&e(t[r],r,t)!==!1;);return t}function l(t,e){for(var r=-1,i=null==t?0:t.length;++r<i;)if(!e(t[r],r,t))return!1;return!0}function u(t,e){for(var r=-1,i=null==t?0:t.length,n=0,a=[];++r<i;){var s=t[r];e(s,r,t)&&(a[n++]=s)}return a}function R(t,e){var r=null==t?0:t.length;return!!r&&b(t,e,0)>-1}function c(t,e,r){for(var i=-1,n=null==t?0:t.length;++i<n;)if(r(e,t[i]))return!0;return!1}function _(t,e){for(var r=-1,i=null==t?0:t.length,n=Array(i);++r<i;)n[r]=e(t[r],r,t);return n}function f(t,e){for(var r=-1,i=e.length,n=t.length;++r<i;)t[n+r]=e[r];return t}function g(t,e,r,i){var n=-1,a=null==t?0:t.length;for(i&&a&&(r=t[++n]);++n<a;)r=e(r,t[n],n,t);return r}function p(t,e,r,i){var n=null==t?0:t.length;for(i&&n&&(r=t[--n]);n--;)r=e(r,t[n],n,t);return r}function d(t,e){for(var r=-1,i=null==t?0:t.length;++r<i;)if(e(t[r],r,t))return!0;return!1}function v(t){return t.split("")}function m(t){return t.match(ze)||[]}function y(t,e,r){var i;return r(t,function(t,r,n){if(e(t,r,n))return i=r,!1}),i}function x(t,e,r,i){for(var n=t.length,a=r+(i?1:-1);i?a--:++a<n;)if(e(t[a],a,t))return a;return-1}function b(t,e,r){return e===e?K(t,e,r):x(t,j,r)}function w(t,e,r,i){for(var n=r-1,a=t.length;++n<a;)if(i(t[n],e))return n;return-1}function j(t){return t!==t}function T(t,e){var r=null==t?0:t.length;return r?E(t,e)/r:Ft}function S(t){return function(e){return null==e?nt:e[t]}}function C(t){return function(e){return null==t?nt:t[e]}}function M(t,e,r,i,n){return n(t,function(t,n,a){r=i?(i=!1,t):e(r,t,n,a)}),r}function k(t,e){var r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}function E(t,e){for(var r,i=-1,n=t.length;++i<n;){var a=e(t[i]);a!==nt&&(r=r===nt?a:r+a)}return r}function A(t,e){for(var r=-1,i=Array(t);++r<t;)i[r]=e(r);return i}function I(t,e){return _(e,function(e){return[e,t[e]]})}function P(t){return t?t.slice(0,tt(t)+1).replace(Oe,""):t}function D(t){return function(e){return t(e)}}function B(t,e){return _(e,function(e){return t[e]})}function V(t,e){return t.has(e)}function O(t,e){for(var r=-1,i=t.length;++r<i&&b(e,t[r],0)>-1;);return r}function F(t,e){for(var r=t.length;r--&&b(e,t[r],0)>-1;);return r}function L(t,e){for(var r=t.length,i=0;r--;)t[r]===e&&++i;return i}function G(t){
return"\\"+ei[t]}function N(t,e){return null==t?nt:t[e]}function z(t){return Wr.test(t)}function q(t){return Hr.test(t)}function U(t){for(var e,r=[];!(e=t.next()).done;)r.push(e.value);return r}function Y(t){var e=-1,r=Array(t.size);return t.forEach(function(t,i){r[++e]=[i,t]}),r}function W(t,e){return function(r){return t(e(r))}}function H(t,e){for(var r=-1,i=t.length,n=0,a=[];++r<i;){var s=t[r];s!==e&&s!==ct||(t[r]=ct,a[n++]=r)}return a}function X(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}function Z(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=[t,t]}),r}function K(t,e,r){for(var i=r-1,n=t.length;++i<n;)if(t[i]===e)return i;return-1}function $(t,e,r){for(var i=r+1;i--;)if(t[i]===e)return i;return i}function Q(t){return z(t)?et(t):vi(t)}function J(t){return z(t)?rt(t):v(t)}function tt(t){for(var e=t.length;e--&&Fe.test(t.charAt(e)););return e}function et(t){for(var e=Ur.lastIndex=0;Ur.test(t);)++e;return e}function rt(t){return t.match(Ur)||[]}function it(t){return t.match(Yr)||[]}var nt,at="4.17.21",st=200,ot="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",ht="Expected a function",lt="Invalid `variable` option passed into `_.template`",ut="__lodash_hash_undefined__",Rt=500,ct="__lodash_placeholder__",_t=1,ft=2,gt=4,pt=1,dt=2,vt=1,mt=2,yt=4,xt=8,bt=16,wt=32,jt=64,Tt=128,St=256,Ct=512,Mt=30,kt="...",Et=800,At=16,It=1,Pt=2,Dt=3,Bt=1/0,Vt=9007199254740991,Ot=1.7976931348623157e308,Ft=NaN,Lt=4294967295,Gt=Lt-1,Nt=Lt>>>1,zt=[["ary",Tt],["bind",vt],["bindKey",mt],["curry",xt],["curryRight",bt],["flip",Ct],["partial",wt],["partialRight",jt],["rearg",St]],qt="[object Arguments]",Ut="[object Array]",Yt="[object AsyncFunction]",Wt="[object Boolean]",Ht="[object Date]",Xt="[object DOMException]",Zt="[object Error]",Kt="[object Function]",$t="[object GeneratorFunction]",Qt="[object Map]",Jt="[object Number]",te="[object Null]",ee="[object Object]",re="[object Promise]",ie="[object Proxy]",ne="[object RegExp]",ae="[object Set]",se="[object String]",oe="[object Symbol]",he="[object Undefined]",le="[object WeakMap]",ue="[object WeakSet]",Re="[object ArrayBuffer]",ce="[object DataView]",_e="[object Float32Array]",fe="[object Float64Array]",ge="[object Int8Array]",pe="[object Int16Array]",de="[object Int32Array]",ve="[object Uint8Array]",me="[object Uint8ClampedArray]",ye="[object Uint16Array]",xe="[object Uint32Array]",be=/\b__p \+= '';/g,we=/\b(__p \+=) '' \+/g,je=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Te=/&(?:amp|lt|gt|quot|#39);/g,Se=/[&<>"']/g,Ce=RegExp(Te.source),Me=RegExp(Se.source),ke=/<%-([\s\S]+?)%>/g,Ee=/<%([\s\S]+?)%>/g,Ae=/<%=([\s\S]+?)%>/g,Ie=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Pe=/^\w*$/,De=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Be=/[\\^$.*+?()[\]{}|]/g,Ve=RegExp(Be.source),Oe=/^\s+/,Fe=/\s/,Le=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ge=/\{\n\/\* \[wrapped with (.+)\] \*/,Ne=/,? & /,ze=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,qe=/[()=,{}\[\]\/\s]/,Ue=/\\(\\)?/g,Ye=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,We=/\w*$/,He=/^[-+]0x[0-9a-f]+$/i,Xe=/^0b[01]+$/i,Ze=/^\[object .+?Constructor\]$/,Ke=/^0o[0-7]+$/i,$e=/^(?:0|[1-9]\d*)$/,Qe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Je=/($^)/,tr=/['\n\r\u2028\u2029\\]/g,er="\\ud800-\\udfff",rr="\\u0300-\\u036f",ir="\\ufe20-\\ufe2f",nr="\\u20d0-\\u20ff",ar=rr+ir+nr,sr="\\u2700-\\u27bf",or="a-z\\xdf-\\xf6\\xf8-\\xff",hr="\\xac\\xb1\\xd7\\xf7",lr="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ur="\\u2000-\\u206f",Rr=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",cr="A-Z\\xc0-\\xd6\\xd8-\\xde",_r="\\ufe0e\\ufe0f",fr=hr+lr+ur+Rr,gr="['’]",pr="["+er+"]",dr="["+fr+"]",vr="["+ar+"]",mr="\\d+",yr="["+sr+"]",xr="["+or+"]",br="[^"+er+fr+mr+sr+or+cr+"]",wr="\\ud83c[\\udffb-\\udfff]",jr="(?:"+vr+"|"+wr+")",Tr="[^"+er+"]",Sr="(?:\\ud83c[\\udde6-\\uddff]){2}",Cr="[\\ud800-\\udbff][\\udc00-\\udfff]",Mr="["+cr+"]",kr="\\u200d",Er="(?:"+xr+"|"+br+")",Ar="(?:"+Mr+"|"+br+")",Ir="(?:"+gr+"(?:d|ll|m|re|s|t|ve))?",Pr="(?:"+gr+"(?:D|LL|M|RE|S|T|VE))?",Dr=jr+"?",Br="["+_r+"]?",Vr="(?:"+kr+"(?:"+[Tr,Sr,Cr].join("|")+")"+Br+Dr+")*",Or="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Fr="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Lr=Br+Dr+Vr,Gr="(?:"+[yr,Sr,Cr].join("|")+")"+Lr,Nr="(?:"+[Tr+vr+"?",vr,Sr,Cr,pr].join("|")+")",zr=RegExp(gr,"g"),qr=RegExp(vr,"g"),Ur=RegExp(wr+"(?="+wr+")|"+Nr+Lr,"g"),Yr=RegExp([Mr+"?"+xr+"+"+Ir+"(?="+[dr,Mr,"$"].join("|")+")",Ar+"+"+Pr+"(?="+[dr,Mr+Er,"$"].join("|")+")",Mr+"?"+Er+"+"+Ir,Mr+"+"+Pr,Fr,Or,mr,Gr].join("|"),"g"),Wr=RegExp("["+kr+er+ar+_r+"]"),Hr=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Xr=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Zr=-1,Kr={};Kr[_e]=Kr[fe]=Kr[ge]=Kr[pe]=Kr[de]=Kr[ve]=Kr[me]=Kr[ye]=Kr[xe]=!0,Kr[qt]=Kr[Ut]=Kr[Re]=Kr[Wt]=Kr[ce]=Kr[Ht]=Kr[Zt]=Kr[Kt]=Kr[Qt]=Kr[Jt]=Kr[ee]=Kr[ne]=Kr[ae]=Kr[se]=Kr[le]=!1;var $r={};$r[qt]=$r[Ut]=$r[Re]=$r[ce]=$r[Wt]=$r[Ht]=$r[_e]=$r[fe]=$r[ge]=$r[pe]=$r[de]=$r[Qt]=$r[Jt]=$r[ee]=$r[ne]=$r[ae]=$r[se]=$r[oe]=$r[ve]=$r[me]=$r[ye]=$r[xe]=!0,$r[Zt]=$r[Kt]=$r[le]=!1;var Qr={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"},Jr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ti={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},ei={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ri=parseFloat,ii=parseInt,ni="object"==typeof t&&t&&t.Object===Object&&t,ai="object"==typeof self&&self&&self.Object===Object&&self,si=ni||ai||Function("return this")(),oi="object"==typeof e&&e&&!e.nodeType&&e,hi=oi&&"object"==typeof n&&n&&!n.nodeType&&n,li=hi&&hi.exports===oi,ui=li&&ni.process,Ri=function(){try{var t=hi&&hi.require&&hi.require("util").types;return t?t:ui&&ui.binding&&ui.binding("util")}catch(t){}}(),ci=Ri&&Ri.isArrayBuffer,_i=Ri&&Ri.isDate,fi=Ri&&Ri.isMap,gi=Ri&&Ri.isRegExp,pi=Ri&&Ri.isSet,di=Ri&&Ri.isTypedArray,vi=S("length"),mi=C(Qr),yi=C(Jr),xi=C(ti),bi=function t(e){function r(t){if(oh(t)&&!vc(t)&&!(t instanceof v)){if(t instanceof n)return t;if(vu.call(t,"__wrapped__"))return is(t)}return new n(t)}function i(){}function n(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=nt}function v(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Lt,this.__views__=[]}function C(){var t=new v(this.__wrapped__);return t.__actions__=On(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=On(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=On(this.__views__),t}function K(){if(this.__filtered__){var t=new v(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function et(){var t=this.__wrapped__.value(),e=this.__dir__,r=vc(t),i=e<0,n=r?t.length:0,a=Sa(0,n,this.__views__),s=a.start,o=a.end,h=o-s,l=i?o:s-1,u=this.__iteratees__,R=u.length,c=0,_=Xu(h,this.__takeCount__);if(!r||!i&&n==h&&_==h)return yn(t,this.__actions__);var f=[];t:for(;h--&&c<_;){l+=e;for(var g=-1,p=t[l];++g<R;){var d=u[g],v=d.iteratee,m=d.type,y=v(p);if(m==Pt)p=y;else if(!y){if(m==It)continue t;break t}}f[c++]=p}return f}function rt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function Fe(){this.__data__=nR?nR(null):{},this.size=0}function ze(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function er(t){var e=this.__data__;if(nR){var r=e[t];return r===ut?nt:r}return vu.call(e,t)?e[t]:nt}function rr(t){var e=this.__data__;return nR?e[t]!==nt:vu.call(e,t)}function ir(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=nR&&e===nt?ut:e,this}function nr(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function ar(){this.__data__=[],this.size=0}function sr(t){var e=this.__data__,r=Ar(e,t);if(r<0)return!1;var i=e.length-1;return r==i?e.pop():Iu.call(e,r,1),--this.size,!0}function or(t){var e=this.__data__,r=Ar(e,t);return r<0?nt:e[r][1]}function hr(t){return Ar(this.__data__,t)>-1}function lr(t,e){var r=this.__data__,i=Ar(r,t);return i<0?(++this.size,r.push([t,e])):r[i][1]=e,this}function ur(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function Rr(){this.size=0,this.__data__={hash:new rt,map:new(tR||nr),string:new rt}}function cr(t){var e=ba(this,t).delete(t);return this.size-=e?1:0,e}function _r(t){return ba(this,t).get(t)}function fr(t){return ba(this,t).has(t)}function gr(t,e){var r=ba(this,t),i=r.size;return r.set(t,e),this.size+=r.size==i?0:1,this}function pr(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new ur;++e<r;)this.add(t[e])}function dr(t){return this.__data__.set(t,ut),this}function vr(t){return this.__data__.has(t)}function mr(t){var e=this.__data__=new nr(t);this.size=e.size}function yr(){this.__data__=new nr,this.size=0}function xr(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function br(t){return this.__data__.get(t)}function wr(t){return this.__data__.has(t)}function jr(t,e){var r=this.__data__;if(r instanceof nr){var i=r.__data__;if(!tR||i.length<st-1)return i.push([t,e]),this.size=++r.size,this;r=this.__data__=new ur(i)}return r.set(t,e),this.size=r.size,this}function Tr(t,e){var r=vc(t),i=!r&&dc(t),n=!r&&!i&&yc(t),a=!r&&!i&&!n&&Tc(t),s=r||i||n||a,o=s?A(t.length,Ru):[],h=o.length;for(var l in t)!e&&!vu.call(t,l)||s&&("length"==l||n&&("offset"==l||"parent"==l)||a&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Da(l,h))||o.push(l);return o}function Sr(t){var e=t.length;return e?t[tn(0,e-1)]:nt}function Cr(t,e){return Ja(On(t),Or(e,0,t.length))}function Mr(t){return Ja(On(t))}function kr(t,e,r){(r===nt||Ho(t[e],r))&&(r!==nt||e in t)||Br(t,e,r)}function Er(t,e,r){var i=t[e];vu.call(t,e)&&Ho(i,r)&&(r!==nt||e in t)||Br(t,e,r)}function Ar(t,e){for(var r=t.length;r--;)if(Ho(t[r][0],e))return r;return-1}function Ir(t,e,r,i){return pR(t,function(t,n,a){e(i,t,r(t),a)}),i}function Pr(t,e){return t&&Fn(e,zh(e),t)}function Dr(t,e){return t&&Fn(e,qh(e),t)}function Br(t,e,r){"__proto__"==e&&Vu?Vu(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function Vr(t,e){for(var r=-1,i=e.length,n=nu(i),a=null==t;++r<i;)n[r]=a?nt:Lh(t,e[r]);return n}function Or(t,e,r){return t===t&&(r!==nt&&(t=t<=r?t:r),e!==nt&&(t=t>=e?t:e)),t}function Fr(t,e,r,i,n,a){var s,h=e&_t,l=e&ft,u=e&gt;if(r&&(s=n?r(t,i,n,a):r(t)),s!==nt)return s;if(!sh(t))return t;var R=vc(t);if(R){if(s=ka(t),!h)return On(t,s)}else{var c=MR(t),_=c==Kt||c==$t;if(yc(t))return Cn(t,h);if(c==ee||c==qt||_&&!n){if(s=l||_?{}:Ea(t),!h)return l?Gn(t,Dr(s,t)):Ln(t,Pr(s,t))}else{if(!$r[c])return n?t:{};s=Aa(t,c,h)}}a||(a=new mr);var f=a.get(t);if(f)return f;a.set(t,s),jc(t)?t.forEach(function(i){s.add(Fr(i,e,r,i,t,a))}):bc(t)&&t.forEach(function(i,n){s.set(n,Fr(i,e,r,n,t,a))});var g=u?l?va:da:l?qh:zh,p=R?nt:g(t);return o(p||t,function(i,n){p&&(n=i,i=t[n]),Er(s,n,Fr(i,e,r,n,t,a))}),s}function Lr(t){var e=zh(t);return function(r){return Gr(r,t,e)}}function Gr(t,e,r){var i=r.length;if(null==t)return!i;for(t=lu(t);i--;){var n=r[i],a=e[n],s=t[n];if(s===nt&&!(n in t)||!a(s))return!1}return!0}function Nr(t,e,r){if("function"!=typeof t)throw new cu(ht);return AR(function(){t.apply(nt,r)},e)}function Ur(t,e,r,i){var n=-1,a=R,s=!0,o=t.length,h=[],l=e.length;if(!o)return h;r&&(e=_(e,D(r))),i?(a=c,s=!1):e.length>=st&&(a=V,s=!1,e=new pr(e));t:for(;++n<o;){var u=t[n],f=null==r?u:r(u);if(u=i||0!==u?u:0,s&&f===f){for(var g=l;g--;)if(e[g]===f)continue t;h.push(u)}else a(e,f,i)||h.push(u)}return h}function Yr(t,e){var r=!0;return pR(t,function(t,i,n){return r=!!e(t,i,n)}),r}function Wr(t,e,r){for(var i=-1,n=t.length;++i<n;){var a=t[i],s=e(a);if(null!=s&&(o===nt?s===s&&!vh(s):r(s,o)))var o=s,h=a}return h}function Hr(t,e,r,i){var n=t.length;for(r=jh(r),r<0&&(r=-r>n?0:n+r),i=i===nt||i>n?n:jh(i),i<0&&(i+=n),i=r>i?0:Th(i);r<i;)t[r++]=e;return t}function Qr(t,e){var r=[];return pR(t,function(t,i,n){e(t,i,n)&&r.push(t)}),r}function Jr(t,e,r,i,n){var a=-1,s=t.length;for(r||(r=Pa),n||(n=[]);++a<s;){var o=t[a];e>0&&r(o)?e>1?Jr(o,e-1,r,i,n):f(n,o):i||(n[n.length]=o)}return n}function ti(t,e){return t&&vR(t,e,zh)}function ei(t,e){return t&&mR(t,e,zh)}function ni(t,e){return u(e,function(e){return ih(t[e])})}function ai(t,e){e=Tn(e,t);for(var r=0,i=e.length;null!=t&&r<i;)t=t[ts(e[r++])];return r&&r==i?t:nt}function oi(t,e,r){var i=e(t);return vc(t)?i:f(i,r(t))}function hi(t){return null==t?t===nt?he:te:Bu&&Bu in lu(t)?Ta(t):Wa(t)}function ui(t,e){return t>e}function Ri(t,e){return null!=t&&vu.call(t,e)}function vi(t,e){return null!=t&&e in lu(t)}function bi(t,e,r){return t>=Xu(e,r)&&t<Hu(e,r)}function ji(t,e,r){for(var i=r?c:R,n=t[0].length,a=t.length,s=a,o=nu(a),h=1/0,l=[];s--;){var u=t[s];s&&e&&(u=_(u,D(e))),h=Xu(u.length,h),o[s]=!r&&(e||n>=120&&u.length>=120)?new pr(s&&u):nt}u=t[0];var f=-1,g=o[0];t:for(;++f<n&&l.length<h;){var p=u[f],d=e?e(p):p;if(p=r||0!==p?p:0,!(g?V(g,d):i(l,d,r))){for(s=a;--s;){var v=o[s];if(!(v?V(v,d):i(t[s],d,r)))continue t}g&&g.push(d),l.push(p)}}return l}function Ti(t,e,r,i){return ti(t,function(t,n,a){e(i,r(t),n,a)}),i}function Si(t,e,r){e=Tn(e,t),t=Xa(t,e);var i=null==t?t:t[ts(bs(e))];return null==i?nt:a(i,t,r)}function Ci(t){return oh(t)&&hi(t)==qt}function Mi(t){return oh(t)&&hi(t)==Re}function ki(t){return oh(t)&&hi(t)==Ht}function Ei(t,e,r,i,n){return t===e||(null==t||null==e||!oh(t)&&!oh(e)?t!==t&&e!==e:Ai(t,e,r,i,Ei,n))}function Ai(t,e,r,i,n,a){var s=vc(t),o=vc(e),h=s?Ut:MR(t),l=o?Ut:MR(e);h=h==qt?ee:h,l=l==qt?ee:l;var u=h==ee,R=l==ee,c=h==l;if(c&&yc(t)){if(!yc(e))return!1;s=!0,u=!1}if(c&&!u)return a||(a=new mr),s||Tc(t)?_a(t,e,r,i,n,a):fa(t,e,h,r,i,n,a);if(!(r&pt)){var _=u&&vu.call(t,"__wrapped__"),f=R&&vu.call(e,"__wrapped__");if(_||f){var g=_?t.value():t,p=f?e.value():e;return a||(a=new mr),n(g,p,r,i,a)}}return!!c&&(a||(a=new mr),ga(t,e,r,i,n,a))}function Ii(t){return oh(t)&&MR(t)==Qt}function Pi(t,e,r,i){var n=r.length,a=n,s=!i;if(null==t)return!a;for(t=lu(t);n--;){var o=r[n];if(s&&o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++n<a;){o=r[n];var h=o[0],l=t[h],u=o[1];if(s&&o[2]){if(l===nt&&!(h in t))return!1}else{var R=new mr;if(i)var c=i(l,u,h,t,e,R);if(!(c===nt?Ei(u,l,pt|dt,i,R):c))return!1}}return!0}function Di(t){if(!sh(t)||La(t))return!1;var e=ih(t)?ju:Ze;return e.test(es(t))}function Bi(t){return oh(t)&&hi(t)==ne}function Vi(t){return oh(t)&&MR(t)==ae}function Oi(t){return oh(t)&&ah(t.length)&&!!Kr[hi(t)]}function Fi(t){return"function"==typeof t?t:null==t?Il:"object"==typeof t?vc(t)?Ui(t[0],t[1]):qi(t):Gl(t)}function Li(t){if(!Ga(t))return Wu(t);var e=[];for(var r in lu(t))vu.call(t,r)&&"constructor"!=r&&e.push(r);return e}function Gi(t){if(!sh(t))return Ya(t);var e=Ga(t),r=[];for(var i in t)("constructor"!=i||!e&&vu.call(t,i))&&r.push(i);return r}function Ni(t,e){return t<e}function zi(t,e){var r=-1,i=Xo(t)?nu(t.length):[];return pR(t,function(t,n,a){i[++r]=e(t,n,a)}),i}function qi(t){var e=wa(t);return 1==e.length&&e[0][2]?za(e[0][0],e[0][1]):function(r){return r===t||Pi(r,t,e)}}function Ui(t,e){return Va(t)&&Na(e)?za(ts(t),e):function(r){var i=Lh(r,t);return i===nt&&i===e?Nh(r,t):Ei(e,i,pt|dt)}}function Yi(t,e,r,i,n){t!==e&&vR(e,function(a,s){if(n||(n=new mr),sh(a))Wi(t,e,s,r,Yi,i,n);else{var o=i?i(Ka(t,s),a,s+"",t,e,n):nt;o===nt&&(o=a),kr(t,s,o)}},qh)}function Wi(t,e,r,i,n,a,s){var o=Ka(t,r),h=Ka(e,r),l=s.get(h);if(l)return void kr(t,r,l);var u=a?a(o,h,r+"",t,e,s):nt,R=u===nt;if(R){var c=vc(h),_=!c&&yc(h),f=!c&&!_&&Tc(h);u=h,c||_||f?vc(o)?u=o:Zo(o)?u=On(o):_?(R=!1,u=Cn(h,!0)):f?(R=!1,u=In(h,!0)):u=[]:gh(h)||dc(h)?(u=o,dc(o)?u=Ch(o):sh(o)&&!ih(o)||(u=Ea(h))):R=!1}R&&(s.set(h,u),n(u,h,i,a,s),s.delete(h)),kr(t,r,u)}function Hi(t,e){var r=t.length;if(r)return e+=e<0?r:0,Da(e,r)?t[e]:nt}function Xi(t,e,r){e=e.length?_(e,function(t){return vc(t)?function(e){return ai(e,1===t.length?t[0]:t)}:t}):[Il];var i=-1;e=_(e,D(xa()));var n=zi(t,function(t,r,n){var a=_(e,function(e){return e(t)});return{criteria:a,index:++i,value:t}});return k(n,function(t,e){return Dn(t,e,r)})}function Zi(t,e){return Ki(t,e,function(e,r){return Nh(t,r)})}function Ki(t,e,r){for(var i=-1,n=e.length,a={};++i<n;){var s=e[i],o=ai(t,s);r(o,s)&&on(a,Tn(s,t),o)}return a}function $i(t){return function(e){return ai(e,t)}}function Qi(t,e,r,i){var n=i?w:b,a=-1,s=e.length,o=t;for(t===e&&(e=On(e)),r&&(o=_(t,D(r)));++a<s;)for(var h=0,l=e[a],u=r?r(l):l;(h=n(o,u,h,i))>-1;)o!==t&&Iu.call(o,h,1),Iu.call(t,h,1);return t}function Ji(t,e){for(var r=t?e.length:0,i=r-1;r--;){var n=e[r];if(r==i||n!==a){var a=n;Da(n)?Iu.call(t,n,1):dn(t,n)}}return t}function tn(t,e){return t+Nu($u()*(e-t+1))}function en(t,e,r,i){for(var n=-1,a=Hu(Gu((e-t)/(r||1)),0),s=nu(a);a--;)s[i?a:++n]=t,t+=r;return s}function rn(t,e){var r="";if(!t||e<1||e>Vt)return r;do e%2&&(r+=t),e=Nu(e/2),e&&(t+=t);while(e);return r}function nn(t,e){return IR(Ha(t,e,Il),t+"")}function an(t){return Sr(el(t))}function sn(t,e){var r=el(t);return Ja(r,Or(e,0,r.length))}function on(t,e,r,i){if(!sh(t))return t;e=Tn(e,t);for(var n=-1,a=e.length,s=a-1,o=t;null!=o&&++n<a;){var h=ts(e[n]),l=r;if("__proto__"===h||"constructor"===h||"prototype"===h)return t;if(n!=s){var u=o[h];l=i?i(u,h,o):nt,l===nt&&(l=sh(u)?u:Da(e[n+1])?[]:{})}Er(o,h,l),o=o[h]}return t}function hn(t){return Ja(el(t))}function ln(t,e,r){var i=-1,n=t.length;e<0&&(e=-e>n?0:n+e),r=r>n?n:r,r<0&&(r+=n),n=e>r?0:r-e>>>0,e>>>=0;for(var a=nu(n);++i<n;)a[i]=t[i+e];return a}function un(t,e){var r;return pR(t,function(t,i,n){return r=e(t,i,n),!r}),!!r}function Rn(t,e,r){var i=0,n=null==t?i:t.length;if("number"==typeof e&&e===e&&n<=Nt){for(;i<n;){var a=i+n>>>1,s=t[a];null!==s&&!vh(s)&&(r?s<=e:s<e)?i=a+1:n=a}return n}return cn(t,e,Il,r)}function cn(t,e,r,i){var n=0,a=null==t?0:t.length;if(0===a)return 0;e=r(e);for(var s=e!==e,o=null===e,h=vh(e),l=e===nt;n<a;){var u=Nu((n+a)/2),R=r(t[u]),c=R!==nt,_=null===R,f=R===R,g=vh(R);if(s)var p=i||f;else p=l?f&&(i||c):o?f&&c&&(i||!_):h?f&&c&&!_&&(i||!g):!_&&!g&&(i?R<=e:R<e);p?n=u+1:a=u}return Xu(a,Gt)}function _n(t,e){for(var r=-1,i=t.length,n=0,a=[];++r<i;){var s=t[r],o=e?e(s):s;if(!r||!Ho(o,h)){var h=o;a[n++]=0===s?0:s}}return a}function fn(t){return"number"==typeof t?t:vh(t)?Ft:+t}function gn(t){if("string"==typeof t)return t;if(vc(t))return _(t,gn)+"";if(vh(t))return fR?fR.call(t):"";var e=t+"";return"0"==e&&1/t==-Bt?"-0":e}function pn(t,e,r){var i=-1,n=R,a=t.length,s=!0,o=[],h=o;if(r)s=!1,n=c;else if(a>=st){var l=e?null:jR(t);if(l)return X(l);s=!1,n=V,h=new pr}else h=e?[]:o;t:for(;++i<a;){var u=t[i],_=e?e(u):u;if(u=r||0!==u?u:0,s&&_===_){for(var f=h.length;f--;)if(h[f]===_)continue t;e&&h.push(_),o.push(u)}else n(h,_,r)||(h!==o&&h.push(_),o.push(u))}return o}function dn(t,e){return e=Tn(e,t),t=Xa(t,e),null==t||delete t[ts(bs(e))]}function vn(t,e,r,i){return on(t,e,r(ai(t,e)),i)}function mn(t,e,r,i){for(var n=t.length,a=i?n:-1;(i?a--:++a<n)&&e(t[a],a,t););return r?ln(t,i?0:a,i?a+1:n):ln(t,i?a+1:0,i?n:a)}function yn(t,e){var r=t;return r instanceof v&&(r=r.value()),g(e,function(t,e){return e.func.apply(e.thisArg,f([t],e.args))},r)}function xn(t,e,r){var i=t.length;if(i<2)return i?pn(t[0]):[];for(var n=-1,a=nu(i);++n<i;)for(var s=t[n],o=-1;++o<i;)o!=n&&(a[n]=Ur(a[n]||s,t[o],e,r));return pn(Jr(a,1),e,r)}function bn(t,e,r){for(var i=-1,n=t.length,a=e.length,s={};++i<n;){var o=i<a?e[i]:nt;r(s,t[i],o)}return s}function wn(t){return Zo(t)?t:[]}function jn(t){return"function"==typeof t?t:Il}function Tn(t,e){return vc(t)?t:Va(t,e)?[t]:PR(kh(t))}function Sn(t,e,r){var i=t.length;return r=r===nt?i:r,!e&&r>=i?t:ln(t,e,r)}function Cn(t,e){if(e)return t.slice();var r=t.length,i=Mu?Mu(r):new t.constructor(r);return t.copy(i),i}function Mn(t){var e=new t.constructor(t.byteLength);return new Cu(e).set(new Cu(t)),e}function kn(t,e){var r=e?Mn(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}function En(t){var e=new t.constructor(t.source,We.exec(t));return e.lastIndex=t.lastIndex,e}function An(t){return _R?lu(_R.call(t)):{}}function In(t,e){var r=e?Mn(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}function Pn(t,e){if(t!==e){var r=t!==nt,i=null===t,n=t===t,a=vh(t),s=e!==nt,o=null===e,h=e===e,l=vh(e);if(!o&&!l&&!a&&t>e||a&&s&&h&&!o&&!l||i&&s&&h||!r&&h||!n)return 1;if(!i&&!a&&!l&&t<e||l&&r&&n&&!i&&!a||o&&r&&n||!s&&n||!h)return-1}return 0}function Dn(t,e,r){for(var i=-1,n=t.criteria,a=e.criteria,s=n.length,o=r.length;++i<s;){var h=Pn(n[i],a[i]);if(h){if(i>=o)return h;var l=r[i];return h*("desc"==l?-1:1)}}return t.index-e.index}function Bn(t,e,r,i){for(var n=-1,a=t.length,s=r.length,o=-1,h=e.length,l=Hu(a-s,0),u=nu(h+l),R=!i;++o<h;)u[o]=e[o];for(;++n<s;)(R||n<a)&&(u[r[n]]=t[n]);for(;l--;)u[o++]=t[n++];return u}function Vn(t,e,r,i){for(var n=-1,a=t.length,s=-1,o=r.length,h=-1,l=e.length,u=Hu(a-o,0),R=nu(u+l),c=!i;++n<u;)R[n]=t[n];for(var _=n;++h<l;)R[_+h]=e[h];for(;++s<o;)(c||n<a)&&(R[_+r[s]]=t[n++]);return R}function On(t,e){var r=-1,i=t.length;for(e||(e=nu(i));++r<i;)e[r]=t[r];return e}function Fn(t,e,r,i){var n=!r;r||(r={});for(var a=-1,s=e.length;++a<s;){var o=e[a],h=i?i(r[o],t[o],o,r,t):nt;h===nt&&(h=t[o]),n?Br(r,o,h):Er(r,o,h)}return r}function Ln(t,e){return Fn(t,SR(t),e)}function Gn(t,e){return Fn(t,CR(t),e)}function Nn(t,e){return function(r,i){var n=vc(r)?s:Ir,a=e?e():{};return n(r,t,xa(i,2),a)}}function zn(t){return nn(function(e,r){var i=-1,n=r.length,a=n>1?r[n-1]:nt,s=n>2?r[2]:nt;for(a=t.length>3&&"function"==typeof a?(n--,a):nt,s&&Ba(r[0],r[1],s)&&(a=n<3?nt:a,n=1),e=lu(e);++i<n;){var o=r[i];o&&t(e,o,i,a)}return e})}function qn(t,e){return function(r,i){if(null==r)return r;if(!Xo(r))return t(r,i);for(var n=r.length,a=e?n:-1,s=lu(r);(e?a--:++a<n)&&i(s[a],a,s)!==!1;);return r}}function Un(t){return function(e,r,i){for(var n=-1,a=lu(e),s=i(e),o=s.length;o--;){var h=s[t?o:++n];if(r(a[h],h,a)===!1)break}return e}}function Yn(t,e,r){function i(){var e=this&&this!==si&&this instanceof i?a:t;return e.apply(n?r:this,arguments)}var n=e&vt,a=Xn(t);return i}function Wn(t){return function(e){e=kh(e);var r=z(e)?J(e):nt,i=r?r[0]:e.charAt(0),n=r?Sn(r,1).join(""):e.slice(1);return i[t]()+n}}function Hn(t){return function(e){return g(Cl(ol(e).replace(zr,"")),t,"")}}function Xn(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var r=gR(t.prototype),i=t.apply(r,e);return sh(i)?i:r}}function Zn(t,e,r){function i(){for(var s=arguments.length,o=nu(s),h=s,l=ya(i);h--;)o[h]=arguments[h];var u=s<3&&o[0]!==l&&o[s-1]!==l?[]:H(o,l);if(s-=u.length,s<r)return sa(t,e,Qn,i.placeholder,nt,o,u,nt,nt,r-s);var R=this&&this!==si&&this instanceof i?n:t;return a(R,this,o)}var n=Xn(t);return i}function Kn(t){return function(e,r,i){var n=lu(e);if(!Xo(e)){var a=xa(r,3);e=zh(e),r=function(t){return a(n[t],t,n)}}var s=t(e,r,i);return s>-1?n[a?e[s]:s]:nt}}function $n(t){return pa(function(e){var r=e.length,i=r,a=n.prototype.thru;for(t&&e.reverse();i--;){var s=e[i];if("function"!=typeof s)throw new cu(ht);if(a&&!o&&"wrapper"==ma(s))var o=new n([],!0)}for(i=o?i:r;++i<r;){s=e[i];var h=ma(s),l="wrapper"==h?TR(s):nt;o=l&&Fa(l[0])&&l[1]==(Tt|xt|wt|St)&&!l[4].length&&1==l[9]?o[ma(l[0])].apply(o,l[3]):1==s.length&&Fa(s)?o[h]():o.thru(s)}return function(){var t=arguments,i=t[0];if(o&&1==t.length&&vc(i))return o.plant(i).value();for(var n=0,a=r?e[n].apply(this,t):i;++n<r;)a=e[n].call(this,a);return a}})}function Qn(t,e,r,i,n,a,s,o,h,l){function u(){for(var d=arguments.length,v=nu(d),m=d;m--;)v[m]=arguments[m];if(f)var y=ya(u),x=L(v,y);if(i&&(v=Bn(v,i,n,f)),a&&(v=Vn(v,a,s,f)),d-=x,f&&d<l){var b=H(v,y);return sa(t,e,Qn,u.placeholder,r,v,b,o,h,l-d)}var w=c?r:this,j=_?w[t]:t;return d=v.length,o?v=Za(v,o):g&&d>1&&v.reverse(),R&&h<d&&(v.length=h),this&&this!==si&&this instanceof u&&(j=p||Xn(j)),j.apply(w,v)}var R=e&Tt,c=e&vt,_=e&mt,f=e&(xt|bt),g=e&Ct,p=_?nt:Xn(t);return u}function Jn(t,e){return function(r,i){return Ti(r,t,e(i),{})}}function ta(t,e){return function(r,i){var n;if(r===nt&&i===nt)return e;if(r!==nt&&(n=r),i!==nt){if(n===nt)return i;"string"==typeof r||"string"==typeof i?(r=gn(r),i=gn(i)):(r=fn(r),i=fn(i)),n=t(r,i)}return n}}function ea(t){return pa(function(e){return e=_(e,D(xa())),nn(function(r){var i=this;return t(e,function(t){return a(t,i,r)})})})}function ra(t,e){e=e===nt?" ":gn(e);var r=e.length;if(r<2)return r?rn(e,t):e;var i=rn(e,Gu(t/Q(e)));return z(e)?Sn(J(i),0,t).join(""):i.slice(0,t)}function ia(t,e,r,i){function n(){for(var e=-1,h=arguments.length,l=-1,u=i.length,R=nu(u+h),c=this&&this!==si&&this instanceof n?o:t;++l<u;)R[l]=i[l];for(;h--;)R[l++]=arguments[++e];return a(c,s?r:this,R)}var s=e&vt,o=Xn(t);return n}function na(t){return function(e,r,i){return i&&"number"!=typeof i&&Ba(e,r,i)&&(r=i=nt),e=wh(e),r===nt?(r=e,e=0):r=wh(r),i=i===nt?e<r?1:-1:wh(i),en(e,r,i,t)}}function aa(t){return function(e,r){return"string"==typeof e&&"string"==typeof r||(e=Sh(e),r=Sh(r)),t(e,r)}}function sa(t,e,r,i,n,a,s,o,h,l){var u=e&xt,R=u?s:nt,c=u?nt:s,_=u?a:nt,f=u?nt:a;e|=u?wt:jt,e&=~(u?jt:wt),e&yt||(e&=~(vt|mt));var g=[t,e,n,_,R,f,c,o,h,l],p=r.apply(nt,g);return Fa(t)&&ER(p,g),p.placeholder=i,$a(p,t,e)}function oa(t){var e=hu[t];return function(t,r){if(t=Sh(t),r=null==r?0:Xu(jh(r),292),r&&Uu(t)){var i=(kh(t)+"e").split("e"),n=e(i[0]+"e"+(+i[1]+r));return i=(kh(n)+"e").split("e"),+(i[0]+"e"+(+i[1]-r))}return e(t)}}function ha(t){return function(e){var r=MR(e);return r==Qt?Y(e):r==ae?Z(e):I(e,t(e))}}function la(t,e,r,i,n,a,s,o){var h=e&mt;if(!h&&"function"!=typeof t)throw new cu(ht);var l=i?i.length:0;if(l||(e&=~(wt|jt),i=n=nt),s=s===nt?s:Hu(jh(s),0),o=o===nt?o:jh(o),l-=n?n.length:0,e&jt){var u=i,R=n;i=n=nt}var c=h?nt:TR(t),_=[t,e,r,i,n,u,R,a,s,o];if(c&&Ua(_,c),t=_[0],e=_[1],r=_[2],i=_[3],n=_[4],o=_[9]=_[9]===nt?h?0:t.length:Hu(_[9]-l,0),!o&&e&(xt|bt)&&(e&=~(xt|bt)),e&&e!=vt)f=e==xt||e==bt?Zn(t,e,o):e!=wt&&e!=(vt|wt)||n.length?Qn.apply(nt,_):ia(t,e,r,i);else var f=Yn(t,e,r);var g=c?yR:ER;return $a(g(f,_),t,e)}function ua(t,e,r,i){return t===nt||Ho(t,gu[r])&&!vu.call(i,r)?e:t}function Ra(t,e,r,i,n,a){return sh(t)&&sh(e)&&(a.set(e,t),Yi(t,e,nt,Ra,a),a.delete(e)),t}function ca(t){return gh(t)?nt:t}function _a(t,e,r,i,n,a){var s=r&pt,o=t.length,h=e.length;if(o!=h&&!(s&&h>o))return!1;var l=a.get(t),u=a.get(e);if(l&&u)return l==e&&u==t;var R=-1,c=!0,_=r&dt?new pr:nt;for(a.set(t,e),a.set(e,t);++R<o;){var f=t[R],g=e[R];if(i)var p=s?i(g,f,R,e,t,a):i(f,g,R,t,e,a);if(p!==nt){if(p)continue;c=!1;break}if(_){if(!d(e,function(t,e){if(!V(_,e)&&(f===t||n(f,t,r,i,a)))return _.push(e)})){c=!1;break}}else if(f!==g&&!n(f,g,r,i,a)){c=!1;break}}return a.delete(t),a.delete(e),c}function fa(t,e,r,i,n,a,s){switch(r){case ce:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Re:return!(t.byteLength!=e.byteLength||!a(new Cu(t),new Cu(e)));case Wt:case Ht:case Jt:return Ho(+t,+e);case Zt:return t.name==e.name&&t.message==e.message;case ne:case se:return t==e+"";case Qt:var o=Y;case ae:var h=i&pt;if(o||(o=X),t.size!=e.size&&!h)return!1;var l=s.get(t);if(l)return l==e;i|=dt,s.set(t,e);var u=_a(o(t),o(e),i,n,a,s);return s.delete(t),u;case oe:if(_R)return _R.call(t)==_R.call(e)}return!1}function ga(t,e,r,i,n,a){var s=r&pt,o=da(t),h=o.length,l=da(e),u=l.length;if(h!=u&&!s)return!1;for(var R=h;R--;){var c=o[R];if(!(s?c in e:vu.call(e,c)))return!1}var _=a.get(t),f=a.get(e);if(_&&f)return _==e&&f==t;var g=!0;a.set(t,e),a.set(e,t);for(var p=s;++R<h;){c=o[R];var d=t[c],v=e[c];if(i)var m=s?i(v,d,c,e,t,a):i(d,v,c,t,e,a);if(!(m===nt?d===v||n(d,v,r,i,a):m)){g=!1;break}p||(p="constructor"==c)}if(g&&!p){var y=t.constructor,x=e.constructor;y!=x&&"constructor"in t&&"constructor"in e&&!("function"==typeof y&&y instanceof y&&"function"==typeof x&&x instanceof x)&&(g=!1)}return a.delete(t),a.delete(e),g}function pa(t){return IR(Ha(t,nt,fs),t+"")}function da(t){return oi(t,zh,SR)}function va(t){return oi(t,qh,CR)}function ma(t){for(var e=t.name+"",r=sR[e],i=vu.call(sR,e)?r.length:0;i--;){var n=r[i],a=n.func;if(null==a||a==t)return n.name}return e}function ya(t){var e=vu.call(r,"placeholder")?r:t;return e.placeholder}function xa(){var t=r.iteratee||Pl;return t=t===Pl?Fi:t,arguments.length?t(arguments[0],arguments[1]):t}function ba(t,e){var r=t.__data__;return Oa(e)?r["string"==typeof e?"string":"hash"]:r.map}function wa(t){for(var e=zh(t),r=e.length;r--;){var i=e[r],n=t[i];e[r]=[i,n,Na(n)]}return e}function ja(t,e){var r=N(t,e);return Di(r)?r:nt}function Ta(t){var e=vu.call(t,Bu),r=t[Bu];try{t[Bu]=nt;var i=!0}catch(t){}var n=xu.call(t);return i&&(e?t[Bu]=r:delete t[Bu]),n}function Sa(t,e,r){for(var i=-1,n=r.length;++i<n;){var a=r[i],s=a.size;switch(a.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=Xu(e,t+s);break;case"takeRight":t=Hu(t,e-s)}}return{start:t,end:e}}function Ca(t){var e=t.match(Ge);return e?e[1].split(Ne):[]}function Ma(t,e,r){e=Tn(e,t);for(var i=-1,n=e.length,a=!1;++i<n;){var s=ts(e[i]);if(!(a=null!=t&&r(t,s)))break;t=t[s]}return a||++i!=n?a:(n=null==t?0:t.length,!!n&&ah(n)&&Da(s,n)&&(vc(t)||dc(t)))}function ka(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&vu.call(t,"index")&&(r.index=t.index,r.input=t.input),r}function Ea(t){return"function"!=typeof t.constructor||Ga(t)?{}:gR(ku(t))}function Aa(t,e,r){var i=t.constructor;switch(e){case Re:return Mn(t);case Wt:case Ht:return new i(+t);case ce:return kn(t,r);case _e:case fe:case ge:case pe:case de:case ve:case me:case ye:case xe:return In(t,r);case Qt:return new i;case Jt:case se:return new i(t);case ne:return En(t);case ae:return new i;case oe:return An(t)}}function Ia(t,e){var r=e.length;if(!r)return t;var i=r-1;return e[i]=(r>1?"& ":"")+e[i],e=e.join(r>2?", ":" "),t.replace(Le,"{\n/* [wrapped with "+e+"] */\n")}function Pa(t){return vc(t)||dc(t)||!!(Pu&&t&&t[Pu])}function Da(t,e){var r=typeof t;return e=null==e?Vt:e,!!e&&("number"==r||"symbol"!=r&&$e.test(t))&&t>-1&&t%1==0&&t<e;
}function Ba(t,e,r){if(!sh(r))return!1;var i=typeof e;return!!("number"==i?Xo(r)&&Da(e,r.length):"string"==i&&e in r)&&Ho(r[e],t)}function Va(t,e){if(vc(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!vh(t))||(Pe.test(t)||!Ie.test(t)||null!=e&&t in lu(e))}function Oa(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function Fa(t){var e=ma(t),i=r[e];if("function"!=typeof i||!(e in v.prototype))return!1;if(t===i)return!0;var n=TR(i);return!!n&&t===n[0]}function La(t){return!!yu&&yu in t}function Ga(t){var e=t&&t.constructor,r="function"==typeof e&&e.prototype||gu;return t===r}function Na(t){return t===t&&!sh(t)}function za(t,e){return function(r){return null!=r&&(r[t]===e&&(e!==nt||t in lu(r)))}}function qa(t){var e=Po(t,function(t){return r.size===Rt&&r.clear(),t}),r=e.cache;return e}function Ua(t,e){var r=t[1],i=e[1],n=r|i,a=n<(vt|mt|Tt),s=i==Tt&&r==xt||i==Tt&&r==St&&t[7].length<=e[8]||i==(Tt|St)&&e[7].length<=e[8]&&r==xt;if(!a&&!s)return t;i&vt&&(t[2]=e[2],n|=r&vt?0:yt);var o=e[3];if(o){var h=t[3];t[3]=h?Bn(h,o,e[4]):o,t[4]=h?H(t[3],ct):e[4]}return o=e[5],o&&(h=t[5],t[5]=h?Vn(h,o,e[6]):o,t[6]=h?H(t[5],ct):e[6]),o=e[7],o&&(t[7]=o),i&Tt&&(t[8]=null==t[8]?e[8]:Xu(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=n,t}function Ya(t){var e=[];if(null!=t)for(var r in lu(t))e.push(r);return e}function Wa(t){return xu.call(t)}function Ha(t,e,r){return e=Hu(e===nt?t.length-1:e,0),function(){for(var i=arguments,n=-1,s=Hu(i.length-e,0),o=nu(s);++n<s;)o[n]=i[e+n];n=-1;for(var h=nu(e+1);++n<e;)h[n]=i[n];return h[e]=r(o),a(t,this,h)}}function Xa(t,e){return e.length<2?t:ai(t,ln(e,0,-1))}function Za(t,e){for(var r=t.length,i=Xu(e.length,r),n=On(t);i--;){var a=e[i];t[i]=Da(a,r)?n[a]:nt}return t}function Ka(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}function $a(t,e,r){var i=e+"";return IR(t,Ia(i,rs(Ca(i),r)))}function Qa(t){var e=0,r=0;return function(){var i=Zu(),n=At-(i-r);if(r=i,n>0){if(++e>=Et)return arguments[0]}else e=0;return t.apply(nt,arguments)}}function Ja(t,e){var r=-1,i=t.length,n=i-1;for(e=e===nt?i:e;++r<e;){var a=tn(r,n),s=t[a];t[a]=t[r],t[r]=s}return t.length=e,t}function ts(t){if("string"==typeof t||vh(t))return t;var e=t+"";return"0"==e&&1/t==-Bt?"-0":e}function es(t){if(null!=t){try{return du.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function rs(t,e){return o(zt,function(r){var i="_."+r[0];e&r[1]&&!R(t,i)&&t.push(i)}),t.sort()}function is(t){if(t instanceof v)return t.clone();var e=new n(t.__wrapped__,t.__chain__);return e.__actions__=On(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}function ns(t,e,r){e=(r?Ba(t,e,r):e===nt)?1:Hu(jh(e),0);var i=null==t?0:t.length;if(!i||e<1)return[];for(var n=0,a=0,s=nu(Gu(i/e));n<i;)s[a++]=ln(t,n,n+=e);return s}function as(t){for(var e=-1,r=null==t?0:t.length,i=0,n=[];++e<r;){var a=t[e];a&&(n[i++]=a)}return n}function ss(){var t=arguments.length;if(!t)return[];for(var e=nu(t-1),r=arguments[0],i=t;i--;)e[i-1]=arguments[i];return f(vc(r)?On(r):[r],Jr(e,1))}function os(t,e,r){var i=null==t?0:t.length;return i?(e=r||e===nt?1:jh(e),ln(t,e<0?0:e,i)):[]}function hs(t,e,r){var i=null==t?0:t.length;return i?(e=r||e===nt?1:jh(e),e=i-e,ln(t,0,e<0?0:e)):[]}function ls(t,e){return t&&t.length?mn(t,xa(e,3),!0,!0):[]}function us(t,e){return t&&t.length?mn(t,xa(e,3),!0):[]}function Rs(t,e,r,i){var n=null==t?0:t.length;return n?(r&&"number"!=typeof r&&Ba(t,e,r)&&(r=0,i=n),Hr(t,e,r,i)):[]}function cs(t,e,r){var i=null==t?0:t.length;if(!i)return-1;var n=null==r?0:jh(r);return n<0&&(n=Hu(i+n,0)),x(t,xa(e,3),n)}function _s(t,e,r){var i=null==t?0:t.length;if(!i)return-1;var n=i-1;return r!==nt&&(n=jh(r),n=r<0?Hu(i+n,0):Xu(n,i-1)),x(t,xa(e,3),n,!0)}function fs(t){var e=null==t?0:t.length;return e?Jr(t,1):[]}function gs(t){var e=null==t?0:t.length;return e?Jr(t,Bt):[]}function ps(t,e){var r=null==t?0:t.length;return r?(e=e===nt?1:jh(e),Jr(t,e)):[]}function ds(t){for(var e=-1,r=null==t?0:t.length,i={};++e<r;){var n=t[e];i[n[0]]=n[1]}return i}function vs(t){return t&&t.length?t[0]:nt}function ms(t,e,r){var i=null==t?0:t.length;if(!i)return-1;var n=null==r?0:jh(r);return n<0&&(n=Hu(i+n,0)),b(t,e,n)}function ys(t){var e=null==t?0:t.length;return e?ln(t,0,-1):[]}function xs(t,e){return null==t?"":Yu.call(t,e)}function bs(t){var e=null==t?0:t.length;return e?t[e-1]:nt}function ws(t,e,r){var i=null==t?0:t.length;if(!i)return-1;var n=i;return r!==nt&&(n=jh(r),n=n<0?Hu(i+n,0):Xu(n,i-1)),e===e?$(t,e,n):x(t,j,n,!0)}function js(t,e){return t&&t.length?Hi(t,jh(e)):nt}function Ts(t,e){return t&&t.length&&e&&e.length?Qi(t,e):t}function Ss(t,e,r){return t&&t.length&&e&&e.length?Qi(t,e,xa(r,2)):t}function Cs(t,e,r){return t&&t.length&&e&&e.length?Qi(t,e,nt,r):t}function Ms(t,e){var r=[];if(!t||!t.length)return r;var i=-1,n=[],a=t.length;for(e=xa(e,3);++i<a;){var s=t[i];e(s,i,t)&&(r.push(s),n.push(i))}return Ji(t,n),r}function ks(t){return null==t?t:Qu.call(t)}function Es(t,e,r){var i=null==t?0:t.length;return i?(r&&"number"!=typeof r&&Ba(t,e,r)?(e=0,r=i):(e=null==e?0:jh(e),r=r===nt?i:jh(r)),ln(t,e,r)):[]}function As(t,e){return Rn(t,e)}function Is(t,e,r){return cn(t,e,xa(r,2))}function Ps(t,e){var r=null==t?0:t.length;if(r){var i=Rn(t,e);if(i<r&&Ho(t[i],e))return i}return-1}function Ds(t,e){return Rn(t,e,!0)}function Bs(t,e,r){return cn(t,e,xa(r,2),!0)}function Vs(t,e){var r=null==t?0:t.length;if(r){var i=Rn(t,e,!0)-1;if(Ho(t[i],e))return i}return-1}function Os(t){return t&&t.length?_n(t):[]}function Fs(t,e){return t&&t.length?_n(t,xa(e,2)):[]}function Ls(t){var e=null==t?0:t.length;return e?ln(t,1,e):[]}function Gs(t,e,r){return t&&t.length?(e=r||e===nt?1:jh(e),ln(t,0,e<0?0:e)):[]}function Ns(t,e,r){var i=null==t?0:t.length;return i?(e=r||e===nt?1:jh(e),e=i-e,ln(t,e<0?0:e,i)):[]}function zs(t,e){return t&&t.length?mn(t,xa(e,3),!1,!0):[]}function qs(t,e){return t&&t.length?mn(t,xa(e,3)):[]}function Us(t){return t&&t.length?pn(t):[]}function Ys(t,e){return t&&t.length?pn(t,xa(e,2)):[]}function Ws(t,e){return e="function"==typeof e?e:nt,t&&t.length?pn(t,nt,e):[]}function Hs(t){if(!t||!t.length)return[];var e=0;return t=u(t,function(t){if(Zo(t))return e=Hu(t.length,e),!0}),A(e,function(e){return _(t,S(e))})}function Xs(t,e){if(!t||!t.length)return[];var r=Hs(t);return null==e?r:_(r,function(t){return a(e,nt,t)})}function Zs(t,e){return bn(t||[],e||[],Er)}function Ks(t,e){return bn(t||[],e||[],on)}function $s(t){var e=r(t);return e.__chain__=!0,e}function Qs(t,e){return e(t),t}function Js(t,e){return e(t)}function to(){return $s(this)}function eo(){return new n(this.value(),this.__chain__)}function ro(){this.__values__===nt&&(this.__values__=bh(this.value()));var t=this.__index__>=this.__values__.length,e=t?nt:this.__values__[this.__index__++];return{done:t,value:e}}function io(){return this}function no(t){for(var e,r=this;r instanceof i;){var n=is(r);n.__index__=0,n.__values__=nt,e?a.__wrapped__=n:e=n;var a=n;r=r.__wrapped__}return a.__wrapped__=t,e}function ao(){var t=this.__wrapped__;if(t instanceof v){var e=t;return this.__actions__.length&&(e=new v(this)),e=e.reverse(),e.__actions__.push({func:Js,args:[ks],thisArg:nt}),new n(e,this.__chain__)}return this.thru(ks)}function so(){return yn(this.__wrapped__,this.__actions__)}function oo(t,e,r){var i=vc(t)?l:Yr;return r&&Ba(t,e,r)&&(e=nt),i(t,xa(e,3))}function ho(t,e){var r=vc(t)?u:Qr;return r(t,xa(e,3))}function lo(t,e){return Jr(go(t,e),1)}function uo(t,e){return Jr(go(t,e),Bt)}function Ro(t,e,r){return r=r===nt?1:jh(r),Jr(go(t,e),r)}function co(t,e){var r=vc(t)?o:pR;return r(t,xa(e,3))}function _o(t,e){var r=vc(t)?h:dR;return r(t,xa(e,3))}function fo(t,e,r,i){t=Xo(t)?t:el(t),r=r&&!i?jh(r):0;var n=t.length;return r<0&&(r=Hu(n+r,0)),dh(t)?r<=n&&t.indexOf(e,r)>-1:!!n&&b(t,e,r)>-1}function go(t,e){var r=vc(t)?_:zi;return r(t,xa(e,3))}function po(t,e,r,i){return null==t?[]:(vc(e)||(e=null==e?[]:[e]),r=i?nt:r,vc(r)||(r=null==r?[]:[r]),Xi(t,e,r))}function vo(t,e,r){var i=vc(t)?g:M,n=arguments.length<3;return i(t,xa(e,4),r,n,pR)}function mo(t,e,r){var i=vc(t)?p:M,n=arguments.length<3;return i(t,xa(e,4),r,n,dR)}function yo(t,e){var r=vc(t)?u:Qr;return r(t,Do(xa(e,3)))}function xo(t){var e=vc(t)?Sr:an;return e(t)}function bo(t,e,r){e=(r?Ba(t,e,r):e===nt)?1:jh(e);var i=vc(t)?Cr:sn;return i(t,e)}function wo(t){var e=vc(t)?Mr:hn;return e(t)}function jo(t){if(null==t)return 0;if(Xo(t))return dh(t)?Q(t):t.length;var e=MR(t);return e==Qt||e==ae?t.size:Li(t).length}function To(t,e,r){var i=vc(t)?d:un;return r&&Ba(t,e,r)&&(e=nt),i(t,xa(e,3))}function So(t,e){if("function"!=typeof e)throw new cu(ht);return t=jh(t),function(){if(--t<1)return e.apply(this,arguments)}}function Co(t,e,r){return e=r?nt:e,e=t&&null==e?t.length:e,la(t,Tt,nt,nt,nt,nt,e)}function Mo(t,e){var r;if("function"!=typeof e)throw new cu(ht);return t=jh(t),function(){return--t>0&&(r=e.apply(this,arguments)),t<=1&&(e=nt),r}}function ko(t,e,r){e=r?nt:e;var i=la(t,xt,nt,nt,nt,nt,nt,e);return i.placeholder=ko.placeholder,i}function Eo(t,e,r){e=r?nt:e;var i=la(t,bt,nt,nt,nt,nt,nt,e);return i.placeholder=Eo.placeholder,i}function Ao(t,e,r){function i(e){var r=c,i=_;return c=_=nt,v=e,g=t.apply(i,r)}function n(t){return v=t,p=AR(o,e),m?i(t):g}function a(t){var r=t-d,i=t-v,n=e-r;return y?Xu(n,f-i):n}function s(t){var r=t-d,i=t-v;return d===nt||r>=e||r<0||y&&i>=f}function o(){var t=sc();return s(t)?h(t):void(p=AR(o,a(t)))}function h(t){return p=nt,x&&c?i(t):(c=_=nt,g)}function l(){p!==nt&&wR(p),v=0,c=d=_=p=nt}function u(){return p===nt?g:h(sc())}function R(){var t=sc(),r=s(t);if(c=arguments,_=this,d=t,r){if(p===nt)return n(d);if(y)return wR(p),p=AR(o,e),i(d)}return p===nt&&(p=AR(o,e)),g}var c,_,f,g,p,d,v=0,m=!1,y=!1,x=!0;if("function"!=typeof t)throw new cu(ht);return e=Sh(e)||0,sh(r)&&(m=!!r.leading,y="maxWait"in r,f=y?Hu(Sh(r.maxWait)||0,e):f,x="trailing"in r?!!r.trailing:x),R.cancel=l,R.flush=u,R}function Io(t){return la(t,Ct)}function Po(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new cu(ht);var r=function(){var i=arguments,n=e?e.apply(this,i):i[0],a=r.cache;if(a.has(n))return a.get(n);var s=t.apply(this,i);return r.cache=a.set(n,s)||a,s};return r.cache=new(Po.Cache||ur),r}function Do(t){if("function"!=typeof t)throw new cu(ht);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function Bo(t){return Mo(2,t)}function Vo(t,e){if("function"!=typeof t)throw new cu(ht);return e=e===nt?e:jh(e),nn(t,e)}function Oo(t,e){if("function"!=typeof t)throw new cu(ht);return e=null==e?0:Hu(jh(e),0),nn(function(r){var i=r[e],n=Sn(r,0,e);return i&&f(n,i),a(t,this,n)})}function Fo(t,e,r){var i=!0,n=!0;if("function"!=typeof t)throw new cu(ht);return sh(r)&&(i="leading"in r?!!r.leading:i,n="trailing"in r?!!r.trailing:n),Ao(t,e,{leading:i,maxWait:e,trailing:n})}function Lo(t){return Co(t,1)}function Go(t,e){return cc(jn(e),t)}function No(){if(!arguments.length)return[];var t=arguments[0];return vc(t)?t:[t]}function zo(t){return Fr(t,gt)}function qo(t,e){return e="function"==typeof e?e:nt,Fr(t,gt,e)}function Uo(t){return Fr(t,_t|gt)}function Yo(t,e){return e="function"==typeof e?e:nt,Fr(t,_t|gt,e)}function Wo(t,e){return null==e||Gr(t,e,zh(e))}function Ho(t,e){return t===e||t!==t&&e!==e}function Xo(t){return null!=t&&ah(t.length)&&!ih(t)}function Zo(t){return oh(t)&&Xo(t)}function Ko(t){return t===!0||t===!1||oh(t)&&hi(t)==Wt}function $o(t){return oh(t)&&1===t.nodeType&&!gh(t)}function Qo(t){if(null==t)return!0;if(Xo(t)&&(vc(t)||"string"==typeof t||"function"==typeof t.splice||yc(t)||Tc(t)||dc(t)))return!t.length;var e=MR(t);if(e==Qt||e==ae)return!t.size;if(Ga(t))return!Li(t).length;for(var r in t)if(vu.call(t,r))return!1;return!0}function Jo(t,e){return Ei(t,e)}function th(t,e,r){r="function"==typeof r?r:nt;var i=r?r(t,e):nt;return i===nt?Ei(t,e,nt,r):!!i}function eh(t){if(!oh(t))return!1;var e=hi(t);return e==Zt||e==Xt||"string"==typeof t.message&&"string"==typeof t.name&&!gh(t)}function rh(t){return"number"==typeof t&&Uu(t)}function ih(t){if(!sh(t))return!1;var e=hi(t);return e==Kt||e==$t||e==Yt||e==ie}function nh(t){return"number"==typeof t&&t==jh(t)}function ah(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Vt}function sh(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function oh(t){return null!=t&&"object"==typeof t}function hh(t,e){return t===e||Pi(t,e,wa(e))}function lh(t,e,r){return r="function"==typeof r?r:nt,Pi(t,e,wa(e),r)}function uh(t){return fh(t)&&t!=+t}function Rh(t){if(kR(t))throw new su(ot);return Di(t)}function ch(t){return null===t}function _h(t){return null==t}function fh(t){return"number"==typeof t||oh(t)&&hi(t)==Jt}function gh(t){if(!oh(t)||hi(t)!=ee)return!1;var e=ku(t);if(null===e)return!0;var r=vu.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&du.call(r)==bu}function ph(t){return nh(t)&&t>=-Vt&&t<=Vt}function dh(t){return"string"==typeof t||!vc(t)&&oh(t)&&hi(t)==se}function vh(t){return"symbol"==typeof t||oh(t)&&hi(t)==oe}function mh(t){return t===nt}function yh(t){return oh(t)&&MR(t)==le}function xh(t){return oh(t)&&hi(t)==ue}function bh(t){if(!t)return[];if(Xo(t))return dh(t)?J(t):On(t);if(Du&&t[Du])return U(t[Du]());var e=MR(t),r=e==Qt?Y:e==ae?X:el;return r(t)}function wh(t){if(!t)return 0===t?t:0;if(t=Sh(t),t===Bt||t===-Bt){var e=t<0?-1:1;return e*Ot}return t===t?t:0}function jh(t){var e=wh(t),r=e%1;return e===e?r?e-r:e:0}function Th(t){return t?Or(jh(t),0,Lt):0}function Sh(t){if("number"==typeof t)return t;if(vh(t))return Ft;if(sh(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=sh(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=P(t);var r=Xe.test(t);return r||Ke.test(t)?ii(t.slice(2),r?2:8):He.test(t)?Ft:+t}function Ch(t){return Fn(t,qh(t))}function Mh(t){return t?Or(jh(t),-Vt,Vt):0===t?t:0}function kh(t){return null==t?"":gn(t)}function Eh(t,e){var r=gR(t);return null==e?r:Pr(r,e)}function Ah(t,e){return y(t,xa(e,3),ti)}function Ih(t,e){return y(t,xa(e,3),ei)}function Ph(t,e){return null==t?t:vR(t,xa(e,3),qh)}function Dh(t,e){return null==t?t:mR(t,xa(e,3),qh)}function Bh(t,e){return t&&ti(t,xa(e,3))}function Vh(t,e){return t&&ei(t,xa(e,3))}function Oh(t){return null==t?[]:ni(t,zh(t))}function Fh(t){return null==t?[]:ni(t,qh(t))}function Lh(t,e,r){var i=null==t?nt:ai(t,e);return i===nt?r:i}function Gh(t,e){return null!=t&&Ma(t,e,Ri)}function Nh(t,e){return null!=t&&Ma(t,e,vi)}function zh(t){return Xo(t)?Tr(t):Li(t)}function qh(t){return Xo(t)?Tr(t,!0):Gi(t)}function Uh(t,e){var r={};return e=xa(e,3),ti(t,function(t,i,n){Br(r,e(t,i,n),t)}),r}function Yh(t,e){var r={};return e=xa(e,3),ti(t,function(t,i,n){Br(r,i,e(t,i,n))}),r}function Wh(t,e){return Hh(t,Do(xa(e)))}function Hh(t,e){if(null==t)return{};var r=_(va(t),function(t){return[t]});return e=xa(e),Ki(t,r,function(t,r){return e(t,r[0])})}function Xh(t,e,r){e=Tn(e,t);var i=-1,n=e.length;for(n||(n=1,t=nt);++i<n;){var a=null==t?nt:t[ts(e[i])];a===nt&&(i=n,a=r),t=ih(a)?a.call(t):a}return t}function Zh(t,e,r){return null==t?t:on(t,e,r)}function Kh(t,e,r,i){return i="function"==typeof i?i:nt,null==t?t:on(t,e,r,i)}function $h(t,e,r){var i=vc(t),n=i||yc(t)||Tc(t);if(e=xa(e,4),null==r){var a=t&&t.constructor;r=n?i?new a:[]:sh(t)&&ih(a)?gR(ku(t)):{}}return(n?o:ti)(t,function(t,i,n){return e(r,t,i,n)}),r}function Qh(t,e){return null==t||dn(t,e)}function Jh(t,e,r){return null==t?t:vn(t,e,jn(r))}function tl(t,e,r,i){return i="function"==typeof i?i:nt,null==t?t:vn(t,e,jn(r),i)}function el(t){return null==t?[]:B(t,zh(t))}function rl(t){return null==t?[]:B(t,qh(t))}function il(t,e,r){return r===nt&&(r=e,e=nt),r!==nt&&(r=Sh(r),r=r===r?r:0),e!==nt&&(e=Sh(e),e=e===e?e:0),Or(Sh(t),e,r)}function nl(t,e,r){return e=wh(e),r===nt?(r=e,e=0):r=wh(r),t=Sh(t),bi(t,e,r)}function al(t,e,r){if(r&&"boolean"!=typeof r&&Ba(t,e,r)&&(e=r=nt),r===nt&&("boolean"==typeof e?(r=e,e=nt):"boolean"==typeof t&&(r=t,t=nt)),t===nt&&e===nt?(t=0,e=1):(t=wh(t),e===nt?(e=t,t=0):e=wh(e)),t>e){var i=t;t=e,e=i}if(r||t%1||e%1){var n=$u();return Xu(t+n*(e-t+ri("1e-"+((n+"").length-1))),e)}return tn(t,e)}function sl(t){return $c(kh(t).toLowerCase())}function ol(t){return t=kh(t),t&&t.replace(Qe,mi).replace(qr,"")}function hl(t,e,r){t=kh(t),e=gn(e);var i=t.length;r=r===nt?i:Or(jh(r),0,i);var n=r;return r-=e.length,r>=0&&t.slice(r,n)==e}function ll(t){return t=kh(t),t&&Me.test(t)?t.replace(Se,yi):t}function ul(t){return t=kh(t),t&&Ve.test(t)?t.replace(Be,"\\$&"):t}function Rl(t,e,r){t=kh(t),e=jh(e);var i=e?Q(t):0;if(!e||i>=e)return t;var n=(e-i)/2;return ra(Nu(n),r)+t+ra(Gu(n),r)}function cl(t,e,r){t=kh(t),e=jh(e);var i=e?Q(t):0;return e&&i<e?t+ra(e-i,r):t}function _l(t,e,r){t=kh(t),e=jh(e);var i=e?Q(t):0;return e&&i<e?ra(e-i,r)+t:t}function fl(t,e,r){return r||null==e?e=0:e&&(e=+e),Ku(kh(t).replace(Oe,""),e||0)}function gl(t,e,r){return e=(r?Ba(t,e,r):e===nt)?1:jh(e),rn(kh(t),e)}function pl(){var t=arguments,e=kh(t[0]);return t.length<3?e:e.replace(t[1],t[2])}function dl(t,e,r){return r&&"number"!=typeof r&&Ba(t,e,r)&&(e=r=nt),(r=r===nt?Lt:r>>>0)?(t=kh(t),t&&("string"==typeof e||null!=e&&!wc(e))&&(e=gn(e),!e&&z(t))?Sn(J(t),0,r):t.split(e,r)):[]}function vl(t,e,r){return t=kh(t),r=null==r?0:Or(jh(r),0,t.length),e=gn(e),t.slice(r,r+e.length)==e}function ml(t,e,i){var n=r.templateSettings;i&&Ba(t,e,i)&&(e=nt),t=kh(t),e=Ec({},e,n,ua);var a,s,o=Ec({},e.imports,n.imports,ua),h=zh(o),l=B(o,h),u=0,R=e.interpolate||Je,c="__p += '",_=uu((e.escape||Je).source+"|"+R.source+"|"+(R===Ae?Ye:Je).source+"|"+(e.evaluate||Je).source+"|$","g"),f="//# sourceURL="+(vu.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Zr+"]")+"\n";t.replace(_,function(e,r,i,n,o,h){return i||(i=n),c+=t.slice(u,h).replace(tr,G),r&&(a=!0,c+="' +\n__e("+r+") +\n'"),o&&(s=!0,c+="';\n"+o+";\n__p += '"),i&&(c+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),u=h+e.length,e}),c+="';\n";var g=vu.call(e,"variable")&&e.variable;if(g){if(qe.test(g))throw new su(lt)}else c="with (obj) {\n"+c+"\n}\n";c=(s?c.replace(be,""):c).replace(we,"$1").replace(je,"$1;"),c="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+c+"return __p\n}";var p=Qc(function(){return ou(h,f+"return "+c).apply(nt,l)});if(p.source=c,eh(p))throw p;return p}function yl(t){return kh(t).toLowerCase()}function xl(t){return kh(t).toUpperCase()}function bl(t,e,r){if(t=kh(t),t&&(r||e===nt))return P(t);if(!t||!(e=gn(e)))return t;var i=J(t),n=J(e),a=O(i,n),s=F(i,n)+1;return Sn(i,a,s).join("")}function wl(t,e,r){if(t=kh(t),t&&(r||e===nt))return t.slice(0,tt(t)+1);if(!t||!(e=gn(e)))return t;var i=J(t),n=F(i,J(e))+1;return Sn(i,0,n).join("")}function jl(t,e,r){if(t=kh(t),t&&(r||e===nt))return t.replace(Oe,"");if(!t||!(e=gn(e)))return t;var i=J(t),n=O(i,J(e));return Sn(i,n).join("")}function Tl(t,e){var r=Mt,i=kt;if(sh(e)){var n="separator"in e?e.separator:n;r="length"in e?jh(e.length):r,i="omission"in e?gn(e.omission):i}t=kh(t);var a=t.length;if(z(t)){var s=J(t);a=s.length}if(r>=a)return t;var o=r-Q(i);if(o<1)return i;var h=s?Sn(s,0,o).join(""):t.slice(0,o);if(n===nt)return h+i;if(s&&(o+=h.length-o),wc(n)){if(t.slice(o).search(n)){var l,u=h;for(n.global||(n=uu(n.source,kh(We.exec(n))+"g")),n.lastIndex=0;l=n.exec(u);)var R=l.index;h=h.slice(0,R===nt?o:R)}}else if(t.indexOf(gn(n),o)!=o){var c=h.lastIndexOf(n);c>-1&&(h=h.slice(0,c))}return h+i}function Sl(t){return t=kh(t),t&&Ce.test(t)?t.replace(Te,xi):t}function Cl(t,e,r){return t=kh(t),e=r?nt:e,e===nt?q(t)?it(t):m(t):t.match(e)||[]}function Ml(t){var e=null==t?0:t.length,r=xa();return t=e?_(t,function(t){if("function"!=typeof t[1])throw new cu(ht);return[r(t[0]),t[1]]}):[],nn(function(r){for(var i=-1;++i<e;){var n=t[i];if(a(n[0],this,r))return a(n[1],this,r)}})}function kl(t){return Lr(Fr(t,_t))}function El(t){return function(){return t}}function Al(t,e){return null==t||t!==t?e:t}function Il(t){return t}function Pl(t){return Fi("function"==typeof t?t:Fr(t,_t))}function Dl(t){return qi(Fr(t,_t))}function Bl(t,e){return Ui(t,Fr(e,_t))}function Vl(t,e,r){var i=zh(e),n=ni(e,i);null!=r||sh(e)&&(n.length||!i.length)||(r=e,e=t,t=this,n=ni(e,zh(e)));var a=!(sh(r)&&"chain"in r&&!r.chain),s=ih(t);return o(n,function(r){var i=e[r];t[r]=i,s&&(t.prototype[r]=function(){var e=this.__chain__;if(a||e){var r=t(this.__wrapped__),n=r.__actions__=On(this.__actions__);return n.push({func:i,args:arguments,thisArg:t}),r.__chain__=e,r}return i.apply(t,f([this.value()],arguments))})}),t}function Ol(){return si._===this&&(si._=wu),this}function Fl(){}function Ll(t){return t=jh(t),nn(function(e){return Hi(e,t)})}function Gl(t){return Va(t)?S(ts(t)):$i(t)}function Nl(t){return function(e){return null==t?nt:ai(t,e)}}function zl(){return[]}function ql(){return!1}function Ul(){return{}}function Yl(){return""}function Wl(){return!0}function Hl(t,e){if(t=jh(t),t<1||t>Vt)return[];var r=Lt,i=Xu(t,Lt);e=xa(e),t-=Lt;for(var n=A(i,e);++r<t;)e(r);return n}function Xl(t){return vc(t)?_(t,ts):vh(t)?[t]:On(PR(kh(t)))}function Zl(t){var e=++mu;return kh(t)+e}function Kl(t){return t&&t.length?Wr(t,Il,ui):nt}function $l(t,e){return t&&t.length?Wr(t,xa(e,2),ui):nt}function Ql(t){return T(t,Il)}function Jl(t,e){return T(t,xa(e,2))}function tu(t){return t&&t.length?Wr(t,Il,Ni):nt}function eu(t,e){return t&&t.length?Wr(t,xa(e,2),Ni):nt}function ru(t){return t&&t.length?E(t,Il):0}function iu(t,e){return t&&t.length?E(t,xa(e,2)):0}e=null==e?si:wi.defaults(si.Object(),e,wi.pick(si,Xr));var nu=e.Array,au=e.Date,su=e.Error,ou=e.Function,hu=e.Math,lu=e.Object,uu=e.RegExp,Ru=e.String,cu=e.TypeError,_u=nu.prototype,fu=ou.prototype,gu=lu.prototype,pu=e["__core-js_shared__"],du=fu.toString,vu=gu.hasOwnProperty,mu=0,yu=function(){var t=/[^.]+$/.exec(pu&&pu.keys&&pu.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),xu=gu.toString,bu=du.call(lu),wu=si._,ju=uu("^"+du.call(vu).replace(Be,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Tu=li?e.Buffer:nt,Su=e.Symbol,Cu=e.Uint8Array,Mu=Tu?Tu.allocUnsafe:nt,ku=W(lu.getPrototypeOf,lu),Eu=lu.create,Au=gu.propertyIsEnumerable,Iu=_u.splice,Pu=Su?Su.isConcatSpreadable:nt,Du=Su?Su.iterator:nt,Bu=Su?Su.toStringTag:nt,Vu=function(){try{var t=ja(lu,"defineProperty");return t({},"",{}),t}catch(t){}}(),Ou=e.clearTimeout!==si.clearTimeout&&e.clearTimeout,Fu=au&&au.now!==si.Date.now&&au.now,Lu=e.setTimeout!==si.setTimeout&&e.setTimeout,Gu=hu.ceil,Nu=hu.floor,zu=lu.getOwnPropertySymbols,qu=Tu?Tu.isBuffer:nt,Uu=e.isFinite,Yu=_u.join,Wu=W(lu.keys,lu),Hu=hu.max,Xu=hu.min,Zu=au.now,Ku=e.parseInt,$u=hu.random,Qu=_u.reverse,Ju=ja(e,"DataView"),tR=ja(e,"Map"),eR=ja(e,"Promise"),rR=ja(e,"Set"),iR=ja(e,"WeakMap"),nR=ja(lu,"create"),aR=iR&&new iR,sR={},oR=es(Ju),hR=es(tR),lR=es(eR),uR=es(rR),RR=es(iR),cR=Su?Su.prototype:nt,_R=cR?cR.valueOf:nt,fR=cR?cR.toString:nt,gR=function(){function t(){}return function(e){if(!sh(e))return{};if(Eu)return Eu(e);t.prototype=e;var r=new t;return t.prototype=nt,r}}();r.templateSettings={escape:ke,evaluate:Ee,interpolate:Ae,variable:"",imports:{_:r}},r.prototype=i.prototype,r.prototype.constructor=r,n.prototype=gR(i.prototype),n.prototype.constructor=n,v.prototype=gR(i.prototype),v.prototype.constructor=v,rt.prototype.clear=Fe,rt.prototype.delete=ze,rt.prototype.get=er,rt.prototype.has=rr,rt.prototype.set=ir,nr.prototype.clear=ar,nr.prototype.delete=sr,nr.prototype.get=or,nr.prototype.has=hr,nr.prototype.set=lr,ur.prototype.clear=Rr,ur.prototype.delete=cr,ur.prototype.get=_r,ur.prototype.has=fr,ur.prototype.set=gr,pr.prototype.add=pr.prototype.push=dr,pr.prototype.has=vr,mr.prototype.clear=yr,mr.prototype.delete=xr,mr.prototype.get=br,mr.prototype.has=wr,mr.prototype.set=jr;var pR=qn(ti),dR=qn(ei,!0),vR=Un(),mR=Un(!0),yR=aR?function(t,e){return aR.set(t,e),t}:Il,xR=Vu?function(t,e){return Vu(t,"toString",{configurable:!0,enumerable:!1,value:El(e),writable:!0})}:Il,bR=nn,wR=Ou||function(t){return si.clearTimeout(t)},jR=rR&&1/X(new rR([,-0]))[1]==Bt?function(t){return new rR(t)}:Fl,TR=aR?function(t){return aR.get(t)}:Fl,SR=zu?function(t){return null==t?[]:(t=lu(t),u(zu(t),function(e){return Au.call(t,e)}))}:zl,CR=zu?function(t){for(var e=[];t;)f(e,SR(t)),t=ku(t);return e}:zl,MR=hi;(Ju&&MR(new Ju(new ArrayBuffer(1)))!=ce||tR&&MR(new tR)!=Qt||eR&&MR(eR.resolve())!=re||rR&&MR(new rR)!=ae||iR&&MR(new iR)!=le)&&(MR=function(t){var e=hi(t),r=e==ee?t.constructor:nt,i=r?es(r):"";if(i)switch(i){case oR:return ce;case hR:return Qt;case lR:return re;case uR:return ae;case RR:return le}return e});var kR=pu?ih:ql,ER=Qa(yR),AR=Lu||function(t,e){return si.setTimeout(t,e)},IR=Qa(xR),PR=qa(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(De,function(t,r,i,n){e.push(i?n.replace(Ue,"$1"):r||t)}),e}),DR=nn(function(t,e){return Zo(t)?Ur(t,Jr(e,1,Zo,!0)):[]}),BR=nn(function(t,e){var r=bs(e);return Zo(r)&&(r=nt),Zo(t)?Ur(t,Jr(e,1,Zo,!0),xa(r,2)):[]}),VR=nn(function(t,e){var r=bs(e);return Zo(r)&&(r=nt),Zo(t)?Ur(t,Jr(e,1,Zo,!0),nt,r):[]}),OR=nn(function(t){var e=_(t,wn);return e.length&&e[0]===t[0]?ji(e):[]}),FR=nn(function(t){var e=bs(t),r=_(t,wn);return e===bs(r)?e=nt:r.pop(),r.length&&r[0]===t[0]?ji(r,xa(e,2)):[]}),LR=nn(function(t){var e=bs(t),r=_(t,wn);return e="function"==typeof e?e:nt,e&&r.pop(),r.length&&r[0]===t[0]?ji(r,nt,e):[]}),GR=nn(Ts),NR=pa(function(t,e){var r=null==t?0:t.length,i=Vr(t,e);return Ji(t,_(e,function(t){return Da(t,r)?+t:t}).sort(Pn)),i}),zR=nn(function(t){return pn(Jr(t,1,Zo,!0))}),qR=nn(function(t){var e=bs(t);return Zo(e)&&(e=nt),pn(Jr(t,1,Zo,!0),xa(e,2))}),UR=nn(function(t){var e=bs(t);return e="function"==typeof e?e:nt,pn(Jr(t,1,Zo,!0),nt,e)}),YR=nn(function(t,e){return Zo(t)?Ur(t,e):[]}),WR=nn(function(t){return xn(u(t,Zo))}),HR=nn(function(t){var e=bs(t);return Zo(e)&&(e=nt),xn(u(t,Zo),xa(e,2))}),XR=nn(function(t){var e=bs(t);return e="function"==typeof e?e:nt,xn(u(t,Zo),nt,e)}),ZR=nn(Hs),KR=nn(function(t){var e=t.length,r=e>1?t[e-1]:nt;return r="function"==typeof r?(t.pop(),r):nt,Xs(t,r)}),$R=pa(function(t){var e=t.length,r=e?t[0]:0,i=this.__wrapped__,a=function(e){return Vr(e,t)};return!(e>1||this.__actions__.length)&&i instanceof v&&Da(r)?(i=i.slice(r,+r+(e?1:0)),i.__actions__.push({func:Js,args:[a],thisArg:nt}),new n(i,this.__chain__).thru(function(t){return e&&!t.length&&t.push(nt),t})):this.thru(a)}),QR=Nn(function(t,e,r){vu.call(t,r)?++t[r]:Br(t,r,1)}),JR=Kn(cs),tc=Kn(_s),ec=Nn(function(t,e,r){vu.call(t,r)?t[r].push(e):Br(t,r,[e])}),rc=nn(function(t,e,r){var i=-1,n="function"==typeof e,s=Xo(t)?nu(t.length):[];return pR(t,function(t){s[++i]=n?a(e,t,r):Si(t,e,r)}),s}),ic=Nn(function(t,e,r){Br(t,r,e)}),nc=Nn(function(t,e,r){t[r?0:1].push(e)},function(){return[[],[]]}),ac=nn(function(t,e){if(null==t)return[];var r=e.length;return r>1&&Ba(t,e[0],e[1])?e=[]:r>2&&Ba(e[0],e[1],e[2])&&(e=[e[0]]),Xi(t,Jr(e,1),[])}),sc=Fu||function(){return si.Date.now()},oc=nn(function(t,e,r){var i=vt;if(r.length){var n=H(r,ya(oc));i|=wt}return la(t,i,e,r,n)}),hc=nn(function(t,e,r){var i=vt|mt;if(r.length){var n=H(r,ya(hc));i|=wt}return la(e,i,t,r,n)}),lc=nn(function(t,e){return Nr(t,1,e)}),uc=nn(function(t,e,r){return Nr(t,Sh(e)||0,r)});Po.Cache=ur;var Rc=bR(function(t,e){e=1==e.length&&vc(e[0])?_(e[0],D(xa())):_(Jr(e,1),D(xa()));var r=e.length;return nn(function(i){for(var n=-1,s=Xu(i.length,r);++n<s;)i[n]=e[n].call(this,i[n]);return a(t,this,i)})}),cc=nn(function(t,e){var r=H(e,ya(cc));return la(t,wt,nt,e,r)}),_c=nn(function(t,e){var r=H(e,ya(_c));return la(t,jt,nt,e,r)}),fc=pa(function(t,e){return la(t,St,nt,nt,nt,e)}),gc=aa(ui),pc=aa(function(t,e){return t>=e}),dc=Ci(function(){return arguments}())?Ci:function(t){return oh(t)&&vu.call(t,"callee")&&!Au.call(t,"callee")},vc=nu.isArray,mc=ci?D(ci):Mi,yc=qu||ql,xc=_i?D(_i):ki,bc=fi?D(fi):Ii,wc=gi?D(gi):Bi,jc=pi?D(pi):Vi,Tc=di?D(di):Oi,Sc=aa(Ni),Cc=aa(function(t,e){return t<=e}),Mc=zn(function(t,e){if(Ga(e)||Xo(e))return void Fn(e,zh(e),t);for(var r in e)vu.call(e,r)&&Er(t,r,e[r])}),kc=zn(function(t,e){Fn(e,qh(e),t)}),Ec=zn(function(t,e,r,i){Fn(e,qh(e),t,i)}),Ac=zn(function(t,e,r,i){Fn(e,zh(e),t,i)}),Ic=pa(Vr),Pc=nn(function(t,e){t=lu(t);var r=-1,i=e.length,n=i>2?e[2]:nt;for(n&&Ba(e[0],e[1],n)&&(i=1);++r<i;)for(var a=e[r],s=qh(a),o=-1,h=s.length;++o<h;){var l=s[o],u=t[l];(u===nt||Ho(u,gu[l])&&!vu.call(t,l))&&(t[l]=a[l])}return t}),Dc=nn(function(t){return t.push(nt,Ra),a(Lc,nt,t)}),Bc=Jn(function(t,e,r){null!=e&&"function"!=typeof e.toString&&(e=xu.call(e)),t[e]=r},El(Il)),Vc=Jn(function(t,e,r){null!=e&&"function"!=typeof e.toString&&(e=xu.call(e)),vu.call(t,e)?t[e].push(r):t[e]=[r]},xa),Oc=nn(Si),Fc=zn(function(t,e,r){Yi(t,e,r)}),Lc=zn(function(t,e,r,i){Yi(t,e,r,i)}),Gc=pa(function(t,e){var r={};if(null==t)return r;var i=!1;e=_(e,function(e){return e=Tn(e,t),i||(i=e.length>1),e}),Fn(t,va(t),r),i&&(r=Fr(r,_t|ft|gt,ca));for(var n=e.length;n--;)dn(r,e[n]);return r}),Nc=pa(function(t,e){return null==t?{}:Zi(t,e)}),zc=ha(zh),qc=ha(qh),Uc=Hn(function(t,e,r){return e=e.toLowerCase(),t+(r?sl(e):e)}),Yc=Hn(function(t,e,r){return t+(r?"-":"")+e.toLowerCase()}),Wc=Hn(function(t,e,r){return t+(r?" ":"")+e.toLowerCase()}),Hc=Wn("toLowerCase"),Xc=Hn(function(t,e,r){return t+(r?"_":"")+e.toLowerCase()}),Zc=Hn(function(t,e,r){return t+(r?" ":"")+$c(e)}),Kc=Hn(function(t,e,r){return t+(r?" ":"")+e.toUpperCase()}),$c=Wn("toUpperCase"),Qc=nn(function(t,e){try{return a(t,nt,e)}catch(t){return eh(t)?t:new su(t)}}),Jc=pa(function(t,e){return o(e,function(e){e=ts(e),Br(t,e,oc(t[e],t))}),t}),t_=$n(),e_=$n(!0),r_=nn(function(t,e){return function(r){return Si(r,t,e)}}),i_=nn(function(t,e){return function(r){return Si(t,r,e)}}),n_=ea(_),a_=ea(l),s_=ea(d),o_=na(),h_=na(!0),l_=ta(function(t,e){return t+e},0),u_=oa("ceil"),R_=ta(function(t,e){return t/e},1),c_=oa("floor"),__=ta(function(t,e){return t*e},1),f_=oa("round"),g_=ta(function(t,e){return t-e},0);return r.after=So,r.ary=Co,r.assign=Mc,r.assignIn=kc,r.assignInWith=Ec,r.assignWith=Ac,r.at=Ic,r.before=Mo,r.bind=oc,r.bindAll=Jc,r.bindKey=hc,r.castArray=No,r.chain=$s,r.chunk=ns,r.compact=as,r.concat=ss,r.cond=Ml,r.conforms=kl,r.constant=El,r.countBy=QR,r.create=Eh,r.curry=ko,r.curryRight=Eo,r.debounce=Ao,r.defaults=Pc,r.defaultsDeep=Dc,r.defer=lc,r.delay=uc,r.difference=DR,r.differenceBy=BR,r.differenceWith=VR,r.drop=os,r.dropRight=hs,r.dropRightWhile=ls,r.dropWhile=us,r.fill=Rs,r.filter=ho,r.flatMap=lo,r.flatMapDeep=uo,r.flatMapDepth=Ro,r.flatten=fs,r.flattenDeep=gs,r.flattenDepth=ps,r.flip=Io,r.flow=t_,r.flowRight=e_,r.fromPairs=ds,r.functions=Oh,r.functionsIn=Fh,r.groupBy=ec,r.initial=ys,r.intersection=OR,r.intersectionBy=FR,r.intersectionWith=LR,r.invert=Bc,r.invertBy=Vc,r.invokeMap=rc,r.iteratee=Pl,r.keyBy=ic,r.keys=zh,r.keysIn=qh,r.map=go,r.mapKeys=Uh,r.mapValues=Yh,r.matches=Dl,r.matchesProperty=Bl,r.memoize=Po,r.merge=Fc,r.mergeWith=Lc,r.method=r_,r.methodOf=i_,r.mixin=Vl,r.negate=Do,r.nthArg=Ll,r.omit=Gc,r.omitBy=Wh,r.once=Bo,r.orderBy=po,r.over=n_,r.overArgs=Rc,r.overEvery=a_,r.overSome=s_,r.partial=cc,r.partialRight=_c,r.partition=nc,r.pick=Nc,r.pickBy=Hh,r.property=Gl,r.propertyOf=Nl,r.pull=GR,r.pullAll=Ts,r.pullAllBy=Ss,r.pullAllWith=Cs,r.pullAt=NR,r.range=o_,r.rangeRight=h_,r.rearg=fc,r.reject=yo,r.remove=Ms,r.rest=Vo,r.reverse=ks,r.sampleSize=bo,r.set=Zh,r.setWith=Kh,r.shuffle=wo,r.slice=Es,r.sortBy=ac,r.sortedUniq=Os,r.sortedUniqBy=Fs,r.split=dl,r.spread=Oo,r.tail=Ls,r.take=Gs,r.takeRight=Ns,r.takeRightWhile=zs,r.takeWhile=qs,r.tap=Qs,r.throttle=Fo,r.thru=Js,r.toArray=bh,r.toPairs=zc,r.toPairsIn=qc,r.toPath=Xl,r.toPlainObject=Ch,r.transform=$h,r.unary=Lo,r.union=zR,r.unionBy=qR,r.unionWith=UR,r.uniq=Us,r.uniqBy=Ys,r.uniqWith=Ws,r.unset=Qh,r.unzip=Hs,r.unzipWith=Xs,r.update=Jh,r.updateWith=tl,r.values=el,r.valuesIn=rl,r.without=YR,r.words=Cl,r.wrap=Go,r.xor=WR,r.xorBy=HR,r.xorWith=XR,r.zip=ZR,r.zipObject=Zs,r.zipObjectDeep=Ks,
r.zipWith=KR,r.entries=zc,r.entriesIn=qc,r.extend=kc,r.extendWith=Ec,Vl(r,r),r.add=l_,r.attempt=Qc,r.camelCase=Uc,r.capitalize=sl,r.ceil=u_,r.clamp=il,r.clone=zo,r.cloneDeep=Uo,r.cloneDeepWith=Yo,r.cloneWith=qo,r.conformsTo=Wo,r.deburr=ol,r.defaultTo=Al,r.divide=R_,r.endsWith=hl,r.eq=Ho,r.escape=ll,r.escapeRegExp=ul,r.every=oo,r.find=JR,r.findIndex=cs,r.findKey=Ah,r.findLast=tc,r.findLastIndex=_s,r.findLastKey=Ih,r.floor=c_,r.forEach=co,r.forEachRight=_o,r.forIn=Ph,r.forInRight=Dh,r.forOwn=Bh,r.forOwnRight=Vh,r.get=Lh,r.gt=gc,r.gte=pc,r.has=Gh,r.hasIn=Nh,r.head=vs,r.identity=Il,r.includes=fo,r.indexOf=ms,r.inRange=nl,r.invoke=Oc,r.isArguments=dc,r.isArray=vc,r.isArrayBuffer=mc,r.isArrayLike=Xo,r.isArrayLikeObject=Zo,r.isBoolean=Ko,r.isBuffer=yc,r.isDate=xc,r.isElement=$o,r.isEmpty=Qo,r.isEqual=Jo,r.isEqualWith=th,r.isError=eh,r.isFinite=rh,r.isFunction=ih,r.isInteger=nh,r.isLength=ah,r.isMap=bc,r.isMatch=hh,r.isMatchWith=lh,r.isNaN=uh,r.isNative=Rh,r.isNil=_h,r.isNull=ch,r.isNumber=fh,r.isObject=sh,r.isObjectLike=oh,r.isPlainObject=gh,r.isRegExp=wc,r.isSafeInteger=ph,r.isSet=jc,r.isString=dh,r.isSymbol=vh,r.isTypedArray=Tc,r.isUndefined=mh,r.isWeakMap=yh,r.isWeakSet=xh,r.join=xs,r.kebabCase=Yc,r.last=bs,r.lastIndexOf=ws,r.lowerCase=Wc,r.lowerFirst=Hc,r.lt=Sc,r.lte=Cc,r.max=Kl,r.maxBy=$l,r.mean=Ql,r.meanBy=Jl,r.min=tu,r.minBy=eu,r.stubArray=zl,r.stubFalse=ql,r.stubObject=Ul,r.stubString=Yl,r.stubTrue=Wl,r.multiply=__,r.nth=js,r.noConflict=Ol,r.noop=Fl,r.now=sc,r.pad=Rl,r.padEnd=cl,r.padStart=_l,r.parseInt=fl,r.random=al,r.reduce=vo,r.reduceRight=mo,r.repeat=gl,r.replace=pl,r.result=Xh,r.round=f_,r.runInContext=t,r.sample=xo,r.size=jo,r.snakeCase=Xc,r.some=To,r.sortedIndex=As,r.sortedIndexBy=Is,r.sortedIndexOf=Ps,r.sortedLastIndex=Ds,r.sortedLastIndexBy=Bs,r.sortedLastIndexOf=Vs,r.startCase=Zc,r.startsWith=vl,r.subtract=g_,r.sum=ru,r.sumBy=iu,r.template=ml,r.times=Hl,r.toFinite=wh,r.toInteger=jh,r.toLength=Th,r.toLower=yl,r.toNumber=Sh,r.toSafeInteger=Mh,r.toString=kh,r.toUpper=xl,r.trim=bl,r.trimEnd=wl,r.trimStart=jl,r.truncate=Tl,r.unescape=Sl,r.uniqueId=Zl,r.upperCase=Kc,r.upperFirst=$c,r.each=co,r.eachRight=_o,r.first=vs,Vl(r,function(){var t={};return ti(r,function(e,i){vu.call(r.prototype,i)||(t[i]=e)}),t}(),{chain:!1}),r.VERSION=at,o(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){r[t].placeholder=r}),o(["drop","take"],function(t,e){v.prototype[t]=function(r){r=r===nt?1:Hu(jh(r),0);var i=this.__filtered__&&!e?new v(this):this.clone();return i.__filtered__?i.__takeCount__=Xu(r,i.__takeCount__):i.__views__.push({size:Xu(r,Lt),type:t+(i.__dir__<0?"Right":"")}),i},v.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),o(["filter","map","takeWhile"],function(t,e){var r=e+1,i=r==It||r==Dt;v.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:xa(t,3),type:r}),e.__filtered__=e.__filtered__||i,e}}),o(["head","last"],function(t,e){var r="take"+(e?"Right":"");v.prototype[t]=function(){return this[r](1).value()[0]}}),o(["initial","tail"],function(t,e){var r="drop"+(e?"":"Right");v.prototype[t]=function(){return this.__filtered__?new v(this):this[r](1)}}),v.prototype.compact=function(){return this.filter(Il)},v.prototype.find=function(t){return this.filter(t).head()},v.prototype.findLast=function(t){return this.reverse().find(t)},v.prototype.invokeMap=nn(function(t,e){return"function"==typeof t?new v(this):this.map(function(r){return Si(r,t,e)})}),v.prototype.reject=function(t){return this.filter(Do(xa(t)))},v.prototype.slice=function(t,e){t=jh(t);var r=this;return r.__filtered__&&(t>0||e<0)?new v(r):(t<0?r=r.takeRight(-t):t&&(r=r.drop(t)),e!==nt&&(e=jh(e),r=e<0?r.dropRight(-e):r.take(e-t)),r)},v.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},v.prototype.toArray=function(){return this.take(Lt)},ti(v.prototype,function(t,e){var i=/^(?:filter|find|map|reject)|While$/.test(e),a=/^(?:head|last)$/.test(e),s=r[a?"take"+("last"==e?"Right":""):e],o=a||/^find/.test(e);s&&(r.prototype[e]=function(){var e=this.__wrapped__,h=a?[1]:arguments,l=e instanceof v,u=h[0],R=l||vc(e),c=function(t){var e=s.apply(r,f([t],h));return a&&_?e[0]:e};R&&i&&"function"==typeof u&&1!=u.length&&(l=R=!1);var _=this.__chain__,g=!!this.__actions__.length,p=o&&!_,d=l&&!g;if(!o&&R){e=d?e:new v(this);var m=t.apply(e,h);return m.__actions__.push({func:Js,args:[c],thisArg:nt}),new n(m,_)}return p&&d?t.apply(this,h):(m=this.thru(c),p?a?m.value()[0]:m.value():m)})}),o(["pop","push","shift","sort","splice","unshift"],function(t){var e=_u[t],i=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",n=/^(?:pop|shift)$/.test(t);r.prototype[t]=function(){var t=arguments;if(n&&!this.__chain__){var r=this.value();return e.apply(vc(r)?r:[],t)}return this[i](function(r){return e.apply(vc(r)?r:[],t)})}}),ti(v.prototype,function(t,e){var i=r[e];if(i){var n=i.name+"";vu.call(sR,n)||(sR[n]=[]),sR[n].push({name:e,func:i})}}),sR[Qn(nt,mt).name]=[{name:"wrapper",func:nt}],v.prototype.clone=C,v.prototype.reverse=K,v.prototype.value=et,r.prototype.at=$R,r.prototype.chain=to,r.prototype.commit=eo,r.prototype.next=ro,r.prototype.plant=no,r.prototype.reverse=ao,r.prototype.toJSON=r.prototype.valueOf=r.prototype.value=so,r.prototype.first=r.prototype.head,Du&&(r.prototype[Du]=io),r},wi=bi();si._=wi,i=function(){return wi}.call(e,r,e,n),!(i!==nt&&(n.exports=i))}).call(this)}).call(e,function(){return this}(),r(17)(t))},function(t,e){function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function n(t){if(u===setTimeout)return setTimeout(t,0);if((u===r||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}function a(t){if(R===clearTimeout)return clearTimeout(t);if((R===i||!R)&&clearTimeout)return R=clearTimeout,clearTimeout(t);try{return R(t)}catch(e){try{return R.call(null,t)}catch(e){return R.call(this,t)}}}function s(){g&&_&&(g=!1,_.length?f=_.concat(f):p=-1,f.length&&o())}function o(){if(!g){var t=n(s);g=!0;for(var e=f.length;e;){for(_=f,f=[];++p<e;)_&&_[p].run();p=-1,e=f.length}_=null,g=!1,a(t)}}function h(t,e){this.fun=t,this.array=e}function l(){}var u,R,c=t.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:r}catch(t){u=r}try{R="function"==typeof clearTimeout?clearTimeout:i}catch(t){R=i}}();var _,f=[],g=!1,p=-1;c.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];f.push(new h(t,e)),1!==f.length||g||n(o)},h.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=l,c.addListener=l,c.once=l,c.off=l,c.removeListener=l,c.removeAllListeners=l,c.emit=l,c.prependListener=l,c.prependOnceListener=l,c.listeners=function(t){return[]},c.binding=function(t){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(t){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},function(t,e,r){var i;/*! Hammer.JS - v2.0.7 - 2016-04-22
	 * http://hammerjs.github.io/
	 *
	 * Copyright (c) 2016 Jorik Tangelder;
	 * Licensed under the MIT license */
!function(n,a,s,o){"use strict";function h(t,e,r){return setTimeout(_(t,r),e)}function l(t,e,r){return!!Array.isArray(t)&&(u(t,r[e],r),!0)}function u(t,e,r){var i;if(t)if(t.forEach)t.forEach(e,r);else if(t.length!==o)for(i=0;i<t.length;)e.call(r,t[i],i,t),i++;else for(i in t)t.hasOwnProperty(i)&&e.call(r,t[i],i,t)}function R(t,e,r){var i="DEPRECATED METHOD: "+e+"\n"+r+" AT \n";return function(){var e=new Error("get-stack-trace"),r=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",a=n.console&&(n.console.warn||n.console.log);return a&&a.call(n.console,i,r),t.apply(this,arguments)}}function c(t,e,r){var i,n=e.prototype;i=t.prototype=Object.create(n),i.constructor=t,i._super=n,r&&gt(i,r)}function _(t,e){return function(){return t.apply(e,arguments)}}function f(t,e){return typeof t==vt?t.apply(e?e[0]||o:o,e):t}function g(t,e){return t===o?e:t}function p(t,e,r){u(y(e),function(e){t.addEventListener(e,r,!1)})}function d(t,e,r){u(y(e),function(e){t.removeEventListener(e,r,!1)})}function v(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function m(t,e){return t.indexOf(e)>-1}function y(t){return t.trim().split(/\s+/g)}function x(t,e,r){if(t.indexOf&&!r)return t.indexOf(e);for(var i=0;i<t.length;){if(r&&t[i][r]==e||!r&&t[i]===e)return i;i++}return-1}function b(t){return Array.prototype.slice.call(t,0)}function w(t,e,r){for(var i=[],n=[],a=0;a<t.length;){var s=e?t[a][e]:t[a];x(n,s)<0&&i.push(t[a]),n[a]=s,a++}return r&&(i=e?i.sort(function(t,r){return t[e]>r[e]}):i.sort()),i}function j(t,e){for(var r,i,n=e[0].toUpperCase()+e.slice(1),a=0;a<pt.length;){if(r=pt[a],i=r?r+n:e,i in t)return i;a++}return o}function T(){return jt++}function S(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||n}function C(t,e){var r=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){f(t.options.enable,[t])&&r.handler(e)},this.init()}function M(t){var e,r=t.options.inputClass;return new(e=r?r:Ct?z:Mt?Y:St?H:N)(t,k)}function k(t,e,r){var i=r.pointers.length,n=r.changedPointers.length,a=e&Dt&&i-n===0,s=e&(Vt|Ot)&&i-n===0;r.isFirst=!!a,r.isFinal=!!s,a&&(t.session={}),r.eventType=e,E(t,r),t.emit("hammer.input",r),t.recognize(r),t.session.prevInput=r}function E(t,e){var r=t.session,i=e.pointers,n=i.length;r.firstInput||(r.firstInput=P(e)),n>1&&!r.firstMultiple?r.firstMultiple=P(e):1===n&&(r.firstMultiple=!1);var a=r.firstInput,s=r.firstMultiple,o=s?s.center:a.center,h=e.center=D(i);e.timeStamp=xt(),e.deltaTime=e.timeStamp-a.timeStamp,e.angle=F(o,h),e.distance=O(o,h),A(r,e),e.offsetDirection=V(e.deltaX,e.deltaY);var l=B(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=l.x,e.overallVelocityY=l.y,e.overallVelocity=yt(l.x)>yt(l.y)?l.x:l.y,e.scale=s?G(s.pointers,i):1,e.rotation=s?L(s.pointers,i):0,e.maxPointers=r.prevInput?e.pointers.length>r.prevInput.maxPointers?e.pointers.length:r.prevInput.maxPointers:e.pointers.length,I(r,e);var u=t.element;v(e.srcEvent.target,u)&&(u=e.srcEvent.target),e.target=u}function A(t,e){var r=e.center,i=t.offsetDelta||{},n=t.prevDelta||{},a=t.prevInput||{};e.eventType!==Dt&&a.eventType!==Vt||(n=t.prevDelta={x:a.deltaX||0,y:a.deltaY||0},i=t.offsetDelta={x:r.x,y:r.y}),e.deltaX=n.x+(r.x-i.x),e.deltaY=n.y+(r.y-i.y)}function I(t,e){var r,i,n,a,s=t.lastInterval||e,h=e.timeStamp-s.timeStamp;if(e.eventType!=Ot&&(h>Pt||s.velocity===o)){var l=e.deltaX-s.deltaX,u=e.deltaY-s.deltaY,R=B(h,l,u);i=R.x,n=R.y,r=yt(R.x)>yt(R.y)?R.x:R.y,a=V(l,u),t.lastInterval=e}else r=s.velocity,i=s.velocityX,n=s.velocityY,a=s.direction;e.velocity=r,e.velocityX=i,e.velocityY=n,e.direction=a}function P(t){for(var e=[],r=0;r<t.pointers.length;)e[r]={clientX:mt(t.pointers[r].clientX),clientY:mt(t.pointers[r].clientY)},r++;return{timeStamp:xt(),pointers:e,center:D(e),deltaX:t.deltaX,deltaY:t.deltaY}}function D(t){var e=t.length;if(1===e)return{x:mt(t[0].clientX),y:mt(t[0].clientY)};for(var r=0,i=0,n=0;n<e;)r+=t[n].clientX,i+=t[n].clientY,n++;return{x:mt(r/e),y:mt(i/e)}}function B(t,e,r){return{x:e/t||0,y:r/t||0}}function V(t,e){return t===e?Ft:yt(t)>=yt(e)?t<0?Lt:Gt:e<0?Nt:zt}function O(t,e,r){r||(r=Wt);var i=e[r[0]]-t[r[0]],n=e[r[1]]-t[r[1]];return Math.sqrt(i*i+n*n)}function F(t,e,r){r||(r=Wt);var i=e[r[0]]-t[r[0]],n=e[r[1]]-t[r[1]];return 180*Math.atan2(n,i)/Math.PI}function L(t,e){return F(e[1],e[0],Ht)+F(t[1],t[0],Ht)}function G(t,e){return O(e[0],e[1],Ht)/O(t[0],t[1],Ht)}function N(){this.evEl=Zt,this.evWin=Kt,this.pressed=!1,C.apply(this,arguments)}function z(){this.evEl=Jt,this.evWin=te,C.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function q(){this.evTarget=re,this.evWin=ie,this.started=!1,C.apply(this,arguments)}function U(t,e){var r=b(t.touches),i=b(t.changedTouches);return e&(Vt|Ot)&&(r=w(r.concat(i),"identifier",!0)),[r,i]}function Y(){this.evTarget=ae,this.targetIds={},C.apply(this,arguments)}function W(t,e){var r=b(t.touches),i=this.targetIds;if(e&(Dt|Bt)&&1===r.length)return i[r[0].identifier]=!0,[r,r];var n,a,s=b(t.changedTouches),o=[],h=this.target;if(a=r.filter(function(t){return v(t.target,h)}),e===Dt)for(n=0;n<a.length;)i[a[n].identifier]=!0,n++;for(n=0;n<s.length;)i[s[n].identifier]&&o.push(s[n]),e&(Vt|Ot)&&delete i[s[n].identifier],n++;return o.length?[w(a.concat(o),"identifier",!0),o]:void 0}function H(){C.apply(this,arguments);var t=_(this.handler,this);this.touch=new Y(this.manager,t),this.mouse=new N(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function X(t,e){t&Dt?(this.primaryTouch=e.changedPointers[0].identifier,Z.call(this,e)):t&(Vt|Ot)&&Z.call(this,e)}function Z(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var r={x:e.clientX,y:e.clientY};this.lastTouches.push(r);var i=this.lastTouches,n=function(){var t=i.indexOf(r);t>-1&&i.splice(t,1)};setTimeout(n,se)}}function K(t){for(var e=t.srcEvent.clientX,r=t.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var n=this.lastTouches[i],a=Math.abs(e-n.x),s=Math.abs(r-n.y);if(a<=oe&&s<=oe)return!0}return!1}function $(t,e){this.manager=t,this.set(e)}function Q(t){if(m(t,_e))return _e;var e=m(t,fe),r=m(t,ge);return e&&r?_e:e||r?e?fe:ge:m(t,ce)?ce:Re}function J(){if(!le)return!1;var t={},e=n.CSS&&n.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(r){t[r]=!e||n.CSS.supports("touch-action",r)}),t}function tt(t){this.options=gt({},this.defaults,t||{}),this.id=T(),this.manager=null,this.options.enable=g(this.options.enable,!0),this.state=de,this.simultaneous={},this.requireFail=[]}function et(t){return t&be?"cancel":t&ye?"end":t&me?"move":t&ve?"start":""}function rt(t){return t==zt?"down":t==Nt?"up":t==Lt?"left":t==Gt?"right":""}function it(t,e){var r=e.manager;return r?r.get(t):t}function nt(){tt.apply(this,arguments)}function at(){nt.apply(this,arguments),this.pX=null,this.pY=null}function st(){nt.apply(this,arguments)}function ot(){tt.apply(this,arguments),this._timer=null,this._input=null}function ht(){nt.apply(this,arguments)}function lt(){nt.apply(this,arguments)}function ut(){tt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Rt(t,e){return e=e||{},e.recognizers=g(e.recognizers,Rt.defaults.preset),new ct(t,e)}function ct(t,e){this.options=gt({},Rt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=M(this),this.touchAction=new $(this,this.options.touchAction),_t(this,!0),u(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function _t(t,e){var r=t.element;if(r.style){var i;u(t.options.cssProps,function(n,a){i=j(r.style,a),e?(t.oldCssProps[i]=r.style[i],r.style[i]=n):r.style[i]=t.oldCssProps[i]||""}),e||(t.oldCssProps={})}}function ft(t,e){var r=a.createEvent("Event");r.initEvent(t,!0,!0),r.gesture=e,e.target.dispatchEvent(r)}var gt,pt=["","webkit","Moz","MS","ms","o"],dt=a.createElement("div"),vt="function",mt=Math.round,yt=Math.abs,xt=Date.now;gt="function"!=typeof Object.assign?function(t){if(t===o||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),r=1;r<arguments.length;r++){var i=arguments[r];if(i!==o&&null!==i)for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])}return e}:Object.assign;var bt=R(function(t,e,r){for(var i=Object.keys(e),n=0;n<i.length;)(!r||r&&t[i[n]]===o)&&(t[i[n]]=e[i[n]]),n++;return t},"extend","Use `assign`."),wt=R(function(t,e){return bt(t,e,!0)},"merge","Use `assign`."),jt=1,Tt=/mobile|tablet|ip(ad|hone|od)|android/i,St="ontouchstart"in n,Ct=j(n,"PointerEvent")!==o,Mt=St&&Tt.test(navigator.userAgent),kt="touch",Et="pen",At="mouse",It="kinect",Pt=25,Dt=1,Bt=2,Vt=4,Ot=8,Ft=1,Lt=2,Gt=4,Nt=8,zt=16,qt=Lt|Gt,Ut=Nt|zt,Yt=qt|Ut,Wt=["x","y"],Ht=["clientX","clientY"];C.prototype={handler:function(){},init:function(){this.evEl&&p(this.element,this.evEl,this.domHandler),this.evTarget&&p(this.target,this.evTarget,this.domHandler),this.evWin&&p(S(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&d(this.element,this.evEl,this.domHandler),this.evTarget&&d(this.target,this.evTarget,this.domHandler),this.evWin&&d(S(this.element),this.evWin,this.domHandler)}};var Xt={mousedown:Dt,mousemove:Bt,mouseup:Vt},Zt="mousedown",Kt="mousemove mouseup";c(N,C,{handler:function(t){var e=Xt[t.type];e&Dt&&0===t.button&&(this.pressed=!0),e&Bt&&1!==t.which&&(e=Vt),this.pressed&&(e&Vt&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:At,srcEvent:t}))}});var $t={pointerdown:Dt,pointermove:Bt,pointerup:Vt,pointercancel:Ot,pointerout:Ot},Qt={2:kt,3:Et,4:At,5:It},Jt="pointerdown",te="pointermove pointerup pointercancel";n.MSPointerEvent&&!n.PointerEvent&&(Jt="MSPointerDown",te="MSPointerMove MSPointerUp MSPointerCancel"),c(z,C,{handler:function(t){var e=this.store,r=!1,i=t.type.toLowerCase().replace("ms",""),n=$t[i],a=Qt[t.pointerType]||t.pointerType,s=a==kt,o=x(e,t.pointerId,"pointerId");n&Dt&&(0===t.button||s)?o<0&&(e.push(t),o=e.length-1):n&(Vt|Ot)&&(r=!0),o<0||(e[o]=t,this.callback(this.manager,n,{pointers:e,changedPointers:[t],pointerType:a,srcEvent:t}),r&&e.splice(o,1))}});var ee={touchstart:Dt,touchmove:Bt,touchend:Vt,touchcancel:Ot},re="touchstart",ie="touchstart touchmove touchend touchcancel";c(q,C,{handler:function(t){var e=ee[t.type];if(e===Dt&&(this.started=!0),this.started){var r=U.call(this,t,e);e&(Vt|Ot)&&r[0].length-r[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:r[0],changedPointers:r[1],pointerType:kt,srcEvent:t})}}});var ne={touchstart:Dt,touchmove:Bt,touchend:Vt,touchcancel:Ot},ae="touchstart touchmove touchend touchcancel";c(Y,C,{handler:function(t){var e=ne[t.type],r=W.call(this,t,e);r&&this.callback(this.manager,e,{pointers:r[0],changedPointers:r[1],pointerType:kt,srcEvent:t})}});var se=2500,oe=25;c(H,C,{handler:function(t,e,r){var i=r.pointerType==kt,n=r.pointerType==At;if(!(n&&r.sourceCapabilities&&r.sourceCapabilities.firesTouchEvents)){if(i)X.call(this,e,r);else if(n&&K.call(this,r))return;this.callback(t,e,r)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var he=j(dt.style,"touchAction"),le=he!==o,ue="compute",Re="auto",ce="manipulation",_e="none",fe="pan-x",ge="pan-y",pe=J();$.prototype={set:function(t){t==ue&&(t=this.compute()),le&&this.manager.element.style&&pe[t]&&(this.manager.element.style[he]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return u(this.manager.recognizers,function(e){f(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),Q(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,r=t.offsetDirection;if(this.manager.session.prevented)return void e.preventDefault();var i=this.actions,n=m(i,_e)&&!pe[_e],a=m(i,ge)&&!pe[ge],s=m(i,fe)&&!pe[fe];if(n){var o=1===t.pointers.length,h=t.distance<2,l=t.deltaTime<250;if(o&&h&&l)return}return s&&a?void 0:n||a&&r&qt||s&&r&Ut?this.preventSrc(e):void 0},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var de=1,ve=2,me=4,ye=8,xe=ye,be=16,we=32;tt.prototype={defaults:{},set:function(t){return gt(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(l(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=it(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return l(t,"dropRecognizeWith",this)?this:(t=it(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(l(t,"requireFailure",this))return this;var e=this.requireFail;return t=it(t,this),x(e,t)===-1&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(l(t,"dropRequireFailure",this))return this;t=it(t,this);var e=x(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){function e(e){r.manager.emit(e,t)}var r=this,i=this.state;i<ye&&e(r.options.event+et(i)),e(r.options.event),t.additionalEvent&&e(t.additionalEvent),i>=ye&&e(r.options.event+et(i))},tryEmit:function(t){return this.canEmit()?this.emit(t):void(this.state=we)},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(we|de)))return!1;t++}return!0},recognize:function(t){var e=gt({},t);return f(this.options.enable,[this,e])?(this.state&(xe|be|we)&&(this.state=de),this.state=this.process(e),void(this.state&(ve|me|ye|be)&&this.tryEmit(e))):(this.reset(),void(this.state=we))},process:function(t){},getTouchAction:function(){},reset:function(){}},c(nt,tt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,r=t.eventType,i=e&(ve|me),n=this.attrTest(t);return i&&(r&Ot||!n)?e|be:i||n?r&Vt?e|ye:e&ve?e|me:ve:we}}),c(at,nt,{defaults:{event:"pan",threshold:10,pointers:1,direction:Yt},getTouchAction:function(){var t=this.options.direction,e=[];return t&qt&&e.push(ge),t&Ut&&e.push(fe),e},directionTest:function(t){var e=this.options,r=!0,i=t.distance,n=t.direction,a=t.deltaX,s=t.deltaY;return n&e.direction||(e.direction&qt?(n=0===a?Ft:a<0?Lt:Gt,r=a!=this.pX,i=Math.abs(t.deltaX)):(n=0===s?Ft:s<0?Nt:zt,r=s!=this.pY,i=Math.abs(t.deltaY))),t.direction=n,r&&i>e.threshold&&n&e.direction},attrTest:function(t){return nt.prototype.attrTest.call(this,t)&&(this.state&ve||!(this.state&ve)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=rt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),c(st,nt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[_e]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&ve)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),c(ot,tt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Re]},process:function(t){var e=this.options,r=t.pointers.length===e.pointers,i=t.distance<e.threshold,n=t.deltaTime>e.time;if(this._input=t,!i||!r||t.eventType&(Vt|Ot)&&!n)this.reset();else if(t.eventType&Dt)this.reset(),this._timer=h(function(){this.state=xe,this.tryEmit()},e.time,this);else if(t.eventType&Vt)return xe;return we},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===xe&&(t&&t.eventType&Vt?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=xt(),this.manager.emit(this.options.event,this._input)))}}),c(ht,nt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[_e]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&ve)}}),c(lt,nt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:qt|Ut,pointers:1},getTouchAction:function(){return at.prototype.getTouchAction.call(this)},attrTest:function(t){var e,r=this.options.direction;return r&(qt|Ut)?e=t.overallVelocity:r&qt?e=t.overallVelocityX:r&Ut&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&r&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&yt(e)>this.options.velocity&&t.eventType&Vt},emit:function(t){var e=rt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),c(ut,tt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ce]},process:function(t){var e=this.options,r=t.pointers.length===e.pointers,i=t.distance<e.threshold,n=t.deltaTime<e.time;if(this.reset(),t.eventType&Dt&&0===this.count)return this.failTimeout();if(i&&n&&r){if(t.eventType!=Vt)return this.failTimeout();var a=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||O(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,s&&a?this.count+=1:this.count=1,this._input=t;var o=this.count%e.taps;if(0===o)return this.hasRequireFailures()?(this._timer=h(function(){this.state=xe,this.tryEmit()},e.interval,this),ve):xe}return we},failTimeout:function(){return this._timer=h(function(){this.state=we},this.options.interval,this),we},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==xe&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Rt.VERSION="2.0.7",Rt.defaults={domEvents:!1,touchAction:ue,enable:!0,inputTarget:null,inputClass:null,preset:[[ht,{enable:!1}],[st,{enable:!1},["rotate"]],[lt,{direction:qt}],[at,{direction:qt},["swipe"]],[ut],[ut,{event:"doubletap",taps:2},["tap"]],[ot]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var je=1,Te=2;ct.prototype={set:function(t){return gt(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?Te:je},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var r,i=this.recognizers,n=e.curRecognizer;(!n||n&&n.state&xe)&&(n=e.curRecognizer=null);for(var a=0;a<i.length;)r=i[a],e.stopped===Te||n&&r!=n&&!r.canRecognizeWith(n)?r.reset():r.recognize(t),!n&&r.state&(ve|me|ye)&&(n=e.curRecognizer=r),a++}},get:function(t){if(t instanceof tt)return t;for(var e=this.recognizers,r=0;r<e.length;r++)if(e[r].options.event==t)return e[r];return null},add:function(t){if(l(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(l(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,r=x(e,t);r!==-1&&(e.splice(r,1),this.touchAction.update())}return this},on:function(t,e){if(t!==o&&e!==o){var r=this.handlers;return u(y(t),function(t){r[t]=r[t]||[],r[t].push(e)}),this}},off:function(t,e){if(t!==o){var r=this.handlers;return u(y(t),function(t){e?r[t]&&r[t].splice(x(r[t],e),1):delete r[t]}),this}},emit:function(t,e){this.options.domEvents&&ft(t,e);var r=this.handlers[t]&&this.handlers[t].slice();if(r&&r.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var i=0;i<r.length;)r[i](e),i++}},destroy:function(){this.element&&_t(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},gt(Rt,{INPUT_START:Dt,INPUT_MOVE:Bt,INPUT_END:Vt,INPUT_CANCEL:Ot,STATE_POSSIBLE:de,STATE_BEGAN:ve,STATE_CHANGED:me,STATE_ENDED:ye,STATE_RECOGNIZED:xe,STATE_CANCELLED:be,STATE_FAILED:we,DIRECTION_NONE:Ft,DIRECTION_LEFT:Lt,DIRECTION_RIGHT:Gt,DIRECTION_UP:Nt,DIRECTION_DOWN:zt,DIRECTION_HORIZONTAL:qt,DIRECTION_VERTICAL:Ut,DIRECTION_ALL:Yt,Manager:ct,Input:C,TouchAction:$,TouchInput:Y,MouseInput:N,PointerEventInput:z,TouchMouseInput:H,SingleTouchInput:q,Recognizer:tt,AttrRecognizer:nt,Tap:ut,Pan:at,Swipe:lt,Pinch:st,Rotate:ht,Press:ot,on:p,off:d,each:u,merge:wt,extend:bt,assign:gt,inherit:c,bindFn:_,prefixed:j});var Se="undefined"!=typeof n?n:"undefined"!=typeof self?self:{};Se.Hammer=Rt,i=function(){return Rt}.call(e,r,e,t),!(i!==o&&(t.exports=i))}(window,document,"Hammer")},function(t,e,r){(function(t,r){!function(){function i(t,e){var r=t.indexOf(e);r!=-1&&t.splice(r,1)}var n={},a=n.util={},s=Array.prototype.concat,o=Array.prototype.slice;a.bind=function(t,e){var r=o.call(arguments,2);return function(){t.apply(e,s.call(r,o.call(arguments)))}},a.extend=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};var h=n.SpringSystem=function(t){this._springRegistry={},this._activeSprings=[],this.listeners=[],this._idleSpringIndices=[],this.looper=t||new c,this.looper.springSystem=this};a.extend(h.prototype,{_springRegistry:null,_isIdle:!0,_lastTimeMillis:-1,_activeSprings:null,listeners:null,_idleSpringIndices:null,setLooper:function(t){this.looper=t,t.springSystem=this},createSpring:function(t,e){var r;return r=void 0===t||void 0===e?R.DEFAULT_ORIGAMI_SPRING_CONFIG:R.fromOrigamiTensionAndFriction(t,e),this.createSpringWithConfig(r)},createSpringWithBouncinessAndSpeed:function(t,e){var r;return r=void 0===t||void 0===e?R.DEFAULT_ORIGAMI_SPRING_CONFIG:R.fromBouncinessAndSpeed(t,e),this.createSpringWithConfig(r)},createSpringWithConfig:function(t){var e=new l(this);return this.registerSpring(e),e.setSpringConfig(t),e},getIsIdle:function(){return this._isIdle},getSpringById:function(t){return this._springRegistry[t]},getAllSprings:function(){var t=[];for(var e in this._springRegistry)this._springRegistry.hasOwnProperty(e)&&t.push(this._springRegistry[e]);return t},registerSpring:function(t){this._springRegistry[t.getId()]=t},deregisterSpring:function(t){i(this._activeSprings,t),delete this._springRegistry[t.getId()]},advance:function(t,e){for(;this._idleSpringIndices.length>0;)this._idleSpringIndices.pop();for(var r=0,i=this._activeSprings.length;r<i;r++){var n=this._activeSprings[r];n.systemShouldAdvance()?n.advance(t/1e3,e/1e3):this._idleSpringIndices.push(this._activeSprings.indexOf(n))}for(;this._idleSpringIndices.length>0;){var a=this._idleSpringIndices.pop();a>=0&&this._activeSprings.splice(a,1)}},loop:function(t){var e;this._lastTimeMillis===-1&&(this._lastTimeMillis=t-1);var r=t-this._lastTimeMillis;this._lastTimeMillis=t;var i=0,n=this.listeners.length;for(i=0;i<n;i++)e=this.listeners[i],e.onBeforeIntegrate&&e.onBeforeIntegrate(this);for(this.advance(t,r),0===this._activeSprings.length&&(this._isIdle=!0,this._lastTimeMillis=-1),i=0;i<n;i++)e=this.listeners[i],e.onAfterIntegrate&&e.onAfterIntegrate(this);this._isIdle||this.looper.run()},activateSpring:function(t){var e=this._springRegistry[t];this._activeSprings.indexOf(e)==-1&&this._activeSprings.push(e),this.getIsIdle()&&(this._isIdle=!1,this.looper.run())},addListener:function(t){this.listeners.push(t)},removeListener:function(t){i(this.listeners,t)},removeAllListeners:function(){this.listeners=[]}});var l=n.Spring=function t(e){this._id="s"+t._ID++,this._springSystem=e,this.listeners=[],this._currentState=new u,this._previousState=new u,this._tempState=new u};a.extend(l,{_ID:0,MAX_DELTA_TIME_SEC:.064,SOLVER_TIMESTEP_SEC:.001}),a.extend(l.prototype,{_id:0,_springConfig:null,_overshootClampingEnabled:!1,_currentState:null,_previousState:null,_tempState:null,_startValue:0,_endValue:0,_wasAtRest:!0,_restSpeedThreshold:.001,_displacementFromRestThreshold:.001,listeners:null,_timeAccumulator:0,_springSystem:null,destroy:function(){this.listeners=[],this.frames=[],this._springSystem.deregisterSpring(this)},getId:function(){return this._id},setSpringConfig:function(t){return this._springConfig=t,this},getSpringConfig:function(){return this._springConfig},setCurrentValue:function(t,e){return this._startValue=t,this._currentState.position=t,e||this.setAtRest(),this.notifyPositionUpdated(!1,!1),this},getStartValue:function(){return this._startValue},getCurrentValue:function(){return this._currentState.position},getCurrentDisplacementDistance:function(){return this.getDisplacementDistanceForState(this._currentState)},getDisplacementDistanceForState:function(t){return Math.abs(this._endValue-t.position)},setEndValue:function(t){if(this._endValue==t&&this.isAtRest())return this;this._startValue=this.getCurrentValue(),this._endValue=t,this._springSystem.activateSpring(this.getId());for(var e=0,r=this.listeners.length;e<r;e++){var i=this.listeners[e],n=i.onSpringEndStateChange;n&&n(this)}return this},getEndValue:function(){return this._endValue},setVelocity:function(t){return t===this._currentState.velocity?this:(this._currentState.velocity=t,this._springSystem.activateSpring(this.getId()),this)},getVelocity:function(){return this._currentState.velocity},setRestSpeedThreshold:function(t){return this._restSpeedThreshold=t,this},getRestSpeedThreshold:function(){return this._restSpeedThreshold},setRestDisplacementThreshold:function(t){this._displacementFromRestThreshold=t},getRestDisplacementThreshold:function(){return this._displacementFromRestThreshold},setOvershootClampingEnabled:function(t){return this._overshootClampingEnabled=t,this},isOvershootClampingEnabled:function(){return this._overshootClampingEnabled},isOvershooting:function(){var t=this._startValue,e=this._endValue;return this._springConfig.tension>0&&(t<e&&this.getCurrentValue()>e||t>e&&this.getCurrentValue()<e)},advance:function(t,e){var r=this.isAtRest();if(!r||!this._wasAtRest){var i=e;e>l.MAX_DELTA_TIME_SEC&&(i=l.MAX_DELTA_TIME_SEC),this._timeAccumulator+=i;for(var n,a,s,o,h,u,R,c,_,f,g=this._springConfig.tension,p=this._springConfig.friction,d=this._currentState.position,v=this._currentState.velocity,m=this._tempState.position,y=this._tempState.velocity;this._timeAccumulator>=l.SOLVER_TIMESTEP_SEC;)this._timeAccumulator-=l.SOLVER_TIMESTEP_SEC,this._timeAccumulator<l.SOLVER_TIMESTEP_SEC&&(this._previousState.position=d,this._previousState.velocity=v),n=v,a=g*(this._endValue-m)-p*v,m=d+n*l.SOLVER_TIMESTEP_SEC*.5,y=v+a*l.SOLVER_TIMESTEP_SEC*.5,s=y,o=g*(this._endValue-m)-p*y,m=d+s*l.SOLVER_TIMESTEP_SEC*.5,y=v+o*l.SOLVER_TIMESTEP_SEC*.5,h=y,u=g*(this._endValue-m)-p*y,m=d+h*l.SOLVER_TIMESTEP_SEC*.5,y=v+u*l.SOLVER_TIMESTEP_SEC*.5,R=y,c=g*(this._endValue-m)-p*y,_=1/6*(n+2*(s+h)+R),f=1/6*(a+2*(o+u)+c),d+=_*l.SOLVER_TIMESTEP_SEC,v+=f*l.SOLVER_TIMESTEP_SEC;this._tempState.position=m,this._tempState.velocity=y,this._currentState.position=d,this._currentState.velocity=v,this._timeAccumulator>0&&this._interpolate(this._timeAccumulator/l.SOLVER_TIMESTEP_SEC),(this.isAtRest()||this._overshootClampingEnabled&&this.isOvershooting())&&(this._springConfig.tension>0?(this._startValue=this._endValue,this._currentState.position=this._endValue):(this._endValue=this._currentState.position,this._startValue=this._endValue),this.setVelocity(0),r=!0);var x=!1;this._wasAtRest&&(this._wasAtRest=!1,x=!0);var b=!1;r&&(this._wasAtRest=!0,b=!0),this.notifyPositionUpdated(x,b)}},notifyPositionUpdated:function(t,e){for(var r=0,i=this.listeners.length;r<i;r++){var n=this.listeners[r];t&&n.onSpringActivate&&n.onSpringActivate(this),n.onSpringUpdate&&n.onSpringUpdate(this),e&&n.onSpringAtRest&&n.onSpringAtRest(this)}},systemShouldAdvance:function(){return!this.isAtRest()||!this.wasAtRest()},wasAtRest:function(){return this._wasAtRest},isAtRest:function(){return Math.abs(this._currentState.velocity)<this._restSpeedThreshold&&(this.getDisplacementDistanceForState(this._currentState)<=this._displacementFromRestThreshold||0===this._springConfig.tension)},setAtRest:function(){return this._endValue=this._currentState.position,this._tempState.position=this._currentState.position,this._currentState.velocity=0,this},_interpolate:function(t){this._currentState.position=this._currentState.position*t+this._previousState.position*(1-t),this._currentState.velocity=this._currentState.velocity*t+this._previousState.velocity*(1-t)},getListeners:function(){return this.listeners},addListener:function(t){return this.listeners.push(t),this},removeListener:function(t){return i(this.listeners,t),this},removeAllListeners:function(){return this.listeners=[],this},currentValueIsApproximately:function(t){return Math.abs(this.getCurrentValue()-t)<=this.getRestDisplacementThreshold()}});var u=function(){};a.extend(u.prototype,{position:0,velocity:0});var R=n.SpringConfig=function(t,e){this.tension=t,this.friction=e},c=n.AnimationLooper=function(){this.springSystem=null;var t=this,e=function(){t.springSystem.loop(Date.now())};this.run=function(){a.onFrame(e)}};n.SimulationLooper=function(t){this.springSystem=null;var e=0,r=!1;t=t||16.667,this.run=function(){if(!r){for(r=!0;!this.springSystem.getIsIdle();)this.springSystem.loop(e+=t);r=!1}}},n.SteppingSimulationLooper=function(t){this.springSystem=null;var e=0;this.run=function(){},this.step=function(t){this.springSystem.loop(e+=t)}};var _=n.OrigamiValueConverter={tensionFromOrigamiValue:function(t){return 3.62*(t-30)+194},origamiValueFromTension:function(t){return(t-194)/3.62+30},frictionFromOrigamiValue:function(t){return 3*(t-8)+25},origamiFromFriction:function(t){return(t-25)/3+8}},f=n.BouncyConversion=function(t,e){this.bounciness=t,this.speed=e;var r=this.normalize(t/1.7,0,20);r=this.projectNormal(r,0,.8);var i=this.normalize(e/1.7,0,20);this.bouncyTension=this.projectNormal(i,.5,200),this.bouncyFriction=this.quadraticOutInterpolation(r,this.b3Nobounce(this.bouncyTension),.01)};a.extend(f.prototype,{normalize:function(t,e,r){return(t-e)/(r-e)},projectNormal:function(t,e,r){return e+t*(r-e)},linearInterpolation:function(t,e,r){return t*r+(1-t)*e},quadraticOutInterpolation:function(t,e,r){return this.linearInterpolation(2*t-t*t,e,r)},b3Friction1:function(t){return 7e-4*Math.pow(t,3)-.031*Math.pow(t,2)+.64*t+1.28},b3Friction2:function(t){return 44e-6*Math.pow(t,3)-.006*Math.pow(t,2)+.36*t+2},b3Friction3:function(t){return 4.5e-7*Math.pow(t,3)-332e-6*Math.pow(t,2)+.1078*t+5.84},b3Nobounce:function(t){var e=0;return e=t<=18?this.b3Friction1(t):t>18&&t<=44?this.b3Friction2(t):this.b3Friction3(t)}}),a.extend(R,{fromOrigamiTensionAndFriction:function(t,e){return new R(_.tensionFromOrigamiValue(t),_.frictionFromOrigamiValue(e))},fromBouncinessAndSpeed:function(t,e){var r=new n.BouncyConversion(t,e);return this.fromOrigamiTensionAndFriction(r.bouncyTension,r.bouncyFriction)},coastingConfigWithOrigamiFriction:function(t){return new R(0,_.frictionFromOrigamiValue(t))}}),R.DEFAULT_ORIGAMI_SPRING_CONFIG=R.fromOrigamiTensionAndFriction(40,7),a.extend(R.prototype,{friction:0,tension:0});var g={};a.hexToRGB=function(t){if(g[t])return g[t];t=t.replace("#",""),3===t.length&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]);var e=t.match(/.{2}/g),r={r:parseInt(e[0],16),g:parseInt(e[1],16),b:parseInt(e[2],16)};return g[t]=r,r},a.rgbToHex=function(t,e,r){return t=t.toString(16),e=e.toString(16),r=r.toString(16),t=t.length<2?"0"+t:t,e=e.length<2?"0"+e:e,r=r.length<2?"0"+r:r,"#"+t+e+r};var p=n.MathUtil={mapValueInRange:function(t,e,r,i,n){var a=r-e,s=n-i,o=(t-e)/a;return i+o*s},interpolateColor:function(t,e,r,i,n,s){i=void 0===i?0:i,n=void 0===n?1:n,e=a.hexToRGB(e),r=a.hexToRGB(r);var o=Math.floor(a.mapValueInRange(t,i,n,e.r,r.r)),h=Math.floor(a.mapValueInRange(t,i,n,e.g,r.g)),l=Math.floor(a.mapValueInRange(t,i,n,e.b,r.b));return s?"rgb("+o+","+h+","+l+")":a.rgbToHex(o,h,l)},degreesToRadians:function(t){return t*Math.PI/180},radiansToDegrees:function(t){return 180*t/Math.PI}};a.extend(a,p);var d;"undefined"!=typeof window&&(d=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}),d||"undefined"==typeof t||"node"!==t.title||(d=r),
a.onFrame=function(t){return d(t)},a.extend(e,n)}()}).call(e,r(2),r(14).setImmediate)},function(t,e){"use strict";var r;/**
	* @link https://github.com/gajus/sister for the canonical source repository
	* @license https://github.com/gajus/sister/blob/master/LICENSE BSD 3-Clause
	*/
r=function(){var t={},e={};return t.on=function(t,r){var i={name:t,handler:r};return e[t]=e[t]||[],e[t].unshift(i),i},t.off=function(t){var r=e[t.name].indexOf(t);r!==-1&&e[t.name].splice(r,1)},t.trigger=function(t,r){var i,n=e[t];if(n)for(i=n.length;i--;)n[i].handler(r)},t},t.exports=r},function(t,e,r){(function(i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=r(1),s=n(a),o=r(5),h=n(o),l=r(3),u=n(l),R=r(4),c=n(R),_=r(15),f=n(_),g=r(10),p=n(g),d=r(7),v=n(d),m=r(13),y=function(t,e,r){var i=Math.abs(t)>Math.abs(e),n=t<0?v.default.LEFT:v.default.RIGHT,a=e<0?v.default.UP:v.default.DOWN,s=i?n:a;return r.indexOf(s)===-1?v.default.INVALID:s},x=function t(e,r,n){var a=void 0,s=void 0,o=void 0,l=void 0,R=void 0,_=void 0,f=void 0,g=void 0,d=void 0,x=void 0,b=void 0,w=void 0,j=void 0,T=void 0,S=void 0,C=void 0,M=void 0,k=void 0,E=void 0,A=void 0,I=function(){a={},s=t.makeConfig(e.getConfig()),_=(0,h.default)(),S=e.getSpringSystem(),C=S.createSpring(250,10),M=S.createSpring(500,20),d={},x={coordinateX:0,coordinateY:0},k={},k[v.default.LEFT]="throwoutleft",k[v.default.RIGHT]="throwoutright",k[v.default.UP]="throwoutup",k[v.default.DOWN]="throwoutdown",C.setRestSpeedThreshold(.05),C.setRestDisplacementThreshold(.05),M.setRestSpeedThreshold(.05),M.setRestDisplacementThreshold(.05),E=s.throwOutDistance(s.minThrowOutDistance,s.maxThrowOutDistance),j=new u.default.Manager(r,{recognizers:[[u.default.Pan,{threshold:2}]]}),n?t.prependToParent(r):t.appendToParent(r),_.on("panstart",function(){t.appendToParent(r),_.trigger("dragstart",{target:r}),o=0,l=0,f=!0,function t(){f&&(R(),(0,p.default)(t))}()}),_.on("panmove",function(t){o=t.deltaX,l=t.deltaY}),_.on("panend",function(t){f=!1;var e=x.coordinateX+t.deltaX,i=x.coordinateY+t.deltaY,n=s.isThrowOut(e,i,r,s.throwOutConfidence(e,i,r)),o=y(e,i,s.allowedDirections);n&&o!==v.default.INVALID?a.throwOut(e,i,o):a.throwIn(e,i,o),_.trigger("dragend",{target:r})}),(0,m.isTouchDevice)()?(r.addEventListener("touchstart",function(){_.trigger("panstart")}),r.addEventListener("touchend",function(){f&&!g&&_.trigger("dragend",{target:r})}),function(){var t=void 0;r.addEventListener("touchstart",function(){t=!0}),r.addEventListener("touchend",function(){t=!1}),i.addEventListener("touchmove",function(e){t&&e.preventDefault()})}()):(r.addEventListener("mousedown",function(){_.trigger("panstart")}),r.addEventListener("mouseup",function(){f&&!g&&_.trigger("dragend",{target:r})})),j.on("panstart",function(t){g=!0,_.trigger("panstart",t)}),j.on("panmove",function(t){_.trigger("panmove",t)}),j.on("panend",function(t){g=!1,_.trigger("panend",t)}),C.addListener({onSpringAtRest:function(){_.trigger("throwinend",{target:r})},onSpringUpdate:function(t){var e=t.getCurrentValue(),r=c.default.MathUtil.mapValueInRange(e,0,1,d.fromX,0),i=c.default.MathUtil.mapValueInRange(e,0,1,d.fromY,0);T(r,i)}}),M.addListener({onSpringAtRest:function(){_.trigger("throwoutend",{target:r})},onSpringUpdate:function(t){var e=t.getCurrentValue(),r=void 0,i=void 0,n=void 0;d.direction===v.default.RIGHT||d.direction===v.default.LEFT?(n=d.direction===v.default.RIGHT?1:-1,r=c.default.MathUtil.mapValueInRange(e,0,1,d.fromX,E*n),i=d.fromY):d.direction!==v.default.UP&&d.direction!==v.default.DOWN||(n=d.direction===v.default.DOWN?1:-1,r=d.fromX,i=c.default.MathUtil.mapValueInRange(e,0,1,d.fromY,E*n)),T(r,i)}}),R=function(){if(o!==b||l!==w){b=o,w=l;var t=x.coordinateX+o,e=x.coordinateY+l,i=s.rotation(t,e,r,s.maxRotation);s.transform(r,t,e,i),_.trigger("dragmove",{offset:t,target:r,throwDirection:y(t,e,s.allowedDirections),throwOutConfidence:s.throwOutConfidence(t,e,r)})}},T=function(t,e){var i=s.rotation(t,e,r,s.maxRotation);x.coordinateX=t||0,x.coordinateY=e||0,s.transform(r,t,e,i)},A=function(e,i,n,a){if(d.fromX=i,d.fromY=n,d.direction=a||y(i,n,s.allowedDirections),e===t.THROW_IN)C.setCurrentValue(0).setAtRest().setEndValue(1),_.trigger("throwin",{target:r,throwDirection:d.direction});else{if(e!==t.THROW_OUT)throw new Error("Invalid throw event.");M.setCurrentValue(0).setAtRest().setVelocity(100).setEndValue(1),_.trigger("throwout",{target:r,throwDirection:d.direction}),_.trigger(k[d.direction],{target:r,throwDirection:d.direction})}}};return I(),a.on=_.on,a.trigger=_.trigger,a.throwIn=function(e,r,i){A(t.THROW_IN,e,r,i)},a.throwOut=function(e,r,i){A(t.THROW_OUT,e,r,i)},a.destroy=function(){j.destroy(),C.destroy(),M.destroy(),e.destroyCard(a)},a};x.makeConfig=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={allowedDirections:[v.default.RIGHT,v.default.LEFT,v.default.UP],isThrowOut:x.isThrowOut,maxRotation:20,maxThrowOutDistance:500,minThrowOutDistance:400,rotation:x.rotation,throwOutConfidence:x.throwOutConfidence,throwOutDistance:x.throwOutDistance,transform:x.transform};return s.default.assign({},e,t)},x.transform=function(t,e,r,i){t.style[(0,f.default)("transform")]="translate3d(0, 0, 0) translate("+e+"px, "+r+"px) rotate("+i+"deg)"},x.appendToParent=function(t){var e=t.parentNode,r=(0,m.elementChildren)(e),i=r.indexOf(t);i+1!==r.length&&(e.removeChild(t),e.appendChild(t))},x.prependToParent=function(t){var e=t.parentNode;e.removeChild(t),e.insertBefore(t,e.firstChild)},x.throwOutConfidence=function(t,e,r){var i=Math.min(Math.abs(t)/r.offsetWidth,1),n=Math.min(Math.abs(e)/r.offsetHeight,1);return Math.max(i,n)},x.isThrowOut=function(t,e,r,i){return 1===i},x.throwOutDistance=function(t,e){return s.default.random(t,e)},x.rotation=function(t,e,r,i){var n=Math.min(Math.max(t/r.offsetWidth,-1),1),a=(e>0?1:-1)*Math.min(Math.abs(e)/100,1),s=n*a*i;return s},x.THROW_IN="in",x.THROW_OUT="out",e.default=x,t.exports=e.default}).call(e,function(){return this}())},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={DOWN:Symbol("DOWN"),INVALID:Symbol("INVALID"),LEFT:Symbol("LEFT"),RIGHT:Symbol("RIGHT"),UP:Symbol("UP")};e.default=r,t.exports=e.default},function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.Stack=e.Direction=e.Card=void 0;var n=r(6),a=i(n),s=r(7),o=i(s),h=r(12),l=i(h);e.Card=a.default,e.Direction=o.default,e.Stack=l.default},function(t,e,r){(function(e){(function(){var r,i,n,a,s,o;"undefined"!=typeof performance&&null!==performance&&performance.now?t.exports=function(){return performance.now()}:"undefined"!=typeof e&&null!==e&&e.hrtime?(t.exports=function(){return(r()-s)/1e6},i=e.hrtime,r=function(){var t;return t=i(),1e9*t[0]+t[1]},a=r(),o=1e9*e.uptime(),s=a-o):Date.now?(t.exports=function(){return Date.now()-n},n=Date.now()):(t.exports=function(){return(new Date).getTime()-n},n=(new Date).getTime())}).call(this)}).call(e,r(2))},function(t,e,r){(function(e){for(var i=r(9),n="undefined"==typeof window?e:window,a=["moz","webkit"],s="AnimationFrame",o=n["request"+s],h=n["cancel"+s]||n["cancelRequest"+s],l=0;!o&&l<a.length;l++)o=n[a[l]+"Request"+s],h=n[a[l]+"Cancel"+s]||n[a[l]+"CancelRequest"+s];if(!o||!h){var u=0,R=0,c=[],_=1e3/60;o=function(t){if(0===c.length){var e=i(),r=Math.max(0,_-(e-u));u=r+e,setTimeout(function(){var t=c.slice(0);c.length=0;for(var e=0;e<t.length;e++)if(!t[e].cancelled)try{t[e].callback(u)}catch(t){setTimeout(function(){throw t},0)}},Math.round(r))}return c.push({handle:++R,callback:t,cancelled:!1}),R},h=function(t){for(var e=0;e<c.length;e++)c[e].handle===t&&(c[e].cancelled=!0)}}t.exports=function(t){return o.call(n,t)},t.exports.cancel=function(){h.apply(n,arguments)},t.exports.polyfill=function(t){t||(t=n),t.requestAnimationFrame=o,t.cancelAnimationFrame=h}}).call(e,function(){return this}())},function(t,e,r){(function(t,e){!function(t,r){"use strict";function i(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),r=0;r<e.length;r++)e[r]=arguments[r+1];var i={callback:t,args:e};return g[f]=i,_(f),f++}function n(t){delete g[t]}function a(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(r,i)}}function s(t){if(p)setTimeout(s,0,t);else{var e=g[t];if(e){p=!0;try{a(e)}finally{n(t),p=!1}}}}function o(){_=function(t){e.nextTick(function(){s(t)})}}function h(){if(t.postMessage&&!t.importScripts){var e=!0,r=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=r,e}}function l(){var e="setImmediate$"+Math.random()+"$",r=function(r){r.source===t&&"string"==typeof r.data&&0===r.data.indexOf(e)&&s(+r.data.slice(e.length))};t.addEventListener?t.addEventListener("message",r,!1):t.attachEvent("onmessage",r),_=function(r){t.postMessage(e+r,"*")}}function u(){var t=new MessageChannel;t.port1.onmessage=function(t){var e=t.data;s(e)},_=function(e){t.port2.postMessage(e)}}function R(){var t=d.documentElement;_=function(e){var r=d.createElement("script");r.onreadystatechange=function(){s(e),r.onreadystatechange=null,t.removeChild(r),r=null},t.appendChild(r)}}function c(){_=function(t){setTimeout(s,0,t)}}if(!t.setImmediate){var _,f=1,g={},p=!1,d=t.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(t);v=v&&v.setTimeout?v:t,"[object process]"==={}.toString.call(t.process)?o():h()?l():t.MessageChannel?u():d&&"onreadystatechange"in d.createElement("script")?R():c(),v.setImmediate=i,v.clearImmediate=n}}("undefined"==typeof self?"undefined"==typeof t?this:t:self)}).call(e,function(){return this}(),r(2))},function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),a=i(n),s=r(5),o=i(s),h=r(4),l=i(h),u=r(6),R=i(u),c=function(t){var e=void 0,r=void 0,i=void 0,n=void 0,s=function(){n={},i=new l.default.SpringSystem,e=(0,o.default)(),r=[]};return s(),n.getConfig=function(){return t},n.getSpringSystem=function(){return i},n.on=function(t,r){e.on(t,r)},n.createCard=function(t,i){var a=(0,R.default)(n,t,i),s=["throwout","throwoutend","throwoutleft","throwoutright","throwoutup","throwoutdown","throwin","throwinend","dragstart","dragmove","dragend"];return s.forEach(function(t){a.on(t,function(r){e.trigger(t,r)})}),r.push({card:a,element:t}),a},n.getCard=function(t){var e=a.default.find(r,{element:t});return e?e.card:null},n.destroyCard=function(t){return e.trigger("destroyCard",t),a.default.remove(r,{card:t})},n};e.default=c,t.exports=e.default},function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.isTouchDevice=e.elementChildren=void 0;var n=r(1),a=i(n),s=function(t){return a.default.filter(t.childNodes,{nodeType:1})},o=function(){return"ontouchstart"in window||navigator.msMaxTouchPoints};e.elementChildren=s,e.isTouchDevice=o},function(t,e,r){(function(t){function i(t,e){this._id=t,this._clearFn=e}var n="undefined"!=typeof t&&t||"undefined"!=typeof self&&self||window,a=Function.prototype.apply;e.setTimeout=function(){return new i(a.call(setTimeout,n,arguments),clearTimeout)},e.setInterval=function(){return new i(a.call(setInterval,n,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(n,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},r(11),e.setImmediate="undefined"!=typeof self&&self.setImmediate||"undefined"!=typeof t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||"undefined"!=typeof t&&t.clearImmediate||this&&this.clearImmediate}).call(e,function(){return this}())},function(t,e){"use strict";function r(t){return t in l?l[t]:l[t]=i(t)}function i(t){var e,r=t.replace(/-([a-z])/g,function(t,e){return e.toUpperCase()}),i=o.length;if(void 0!==s[r])return r;for(r=n(t);i--;)if(e=o[i]+r,void 0!==s[e])return e;throw new Error("unable to prefix "+t)}function n(t){return t.charAt(0).toUpperCase()+t.slice(1)}function a(t){var e=r(t),i=/([A-Z])/g;return i.test(e)&&(e=(h.test(e)?"-":"")+e.replace(i,"-$1")),e.toLowerCase()}var s=document.createElement("p").style,o="O ms Moz webkit".split(" "),h=/^(o|ms|moz|webkit)/,l={};t.exports=r,t.exports.dash=a},function(t,e,r){!function(t,e){e(r(3))}(this,function(e){"use strict";function r(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];for(var i=0;i<e.length;i++)for(var n=e[i],a=Object.keys(n),s=0;s<a.length;s++){var o=a[s];t[o]=n[o]}return t}function i(){return{type:Object,default:function(){return{}}}}function n(t){return t.charAt(0).toUpperCase()+t.slice(1)}function a(t){var r=t.direction;if("string"==typeof r){var i="DIRECTION_"+r.toUpperCase();s.indexOf(r)>-1&&e.hasOwnProperty(i)?t.direction=e[i]:console.warn("[vue-touch] invalid direction: "+r)}return t}e="default"in e?e.default:e;var s=["up","down","left","right","horizontal","vertical","all"],o={},h={},l=["pan","panstart","panmove","panend","pancancel","panleft","panright","panup","pandown","pinch","pinchstart","pinchmove","pinchend","pinchcancel","pinchin","pinchout","press","pressup","rotate","rotatestart","rotatemove","rotateend","rotatecancel","swipe","swipeleft","swiperight","swipeup","swipedown","tap"],u={pan:"pan",panstart:"pan",panmove:"pan",panend:"pan",pancancel:"pan",panleft:"pan",panright:"pan",panup:"pan",pandown:"pan",pinch:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",pinchin:"pinch",pinchout:"pinch",press:"press",pressup:"press",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe",tap:"tap"},R={props:{options:i(),tapOptions:i(),panOptions:i(),pinchOptions:i(),pressOptions:i(),rotateOptions:i(),swipeOptions:i(),tag:{type:String,default:"div"},enabled:{default:!0,type:[Boolean,Object]}},mounted:function(){this.$isServer||(this.hammer=new e.Manager(this.$el,this.options),this.recognizers={},this.setupBuiltinRecognizers(),this.setupCustomRecognizers(),this.updateEnabled(this.enabled))},destroyed:function(){this.$isServer||this.hammer.destroy()},watch:{enabled:{deep:!0,handler:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];(r=this).updateEnabled.apply(r,t);var r}}},methods:{setupBuiltinRecognizers:function(){for(var t=this,e=0;e<l.length;e++){var i=l[e];if(t._events[i]){var n=u[i],a=r({},o[n]||{},t[n+"Options"]);t.addRecognizer(n,a),t.addEvent(i)}}},setupCustomRecognizers:function(){for(var t=this,e=Object.keys(h),i=0;i<e.length;i++){var n=e[i];if(t._events[n]){var a=h[n],s=t[n+"Options"]||{},o=r({},a,s);t.addRecognizer(n,o,{mainGesture:o.type}),t.addEvent(n)}}},addRecognizer:function(t,r,i){void 0===i&&(i={});var s=i.mainGesture;if(!this.recognizers[t]){var o=new(e[n(s||t)])(a(r));this.recognizers[t]=o,this.hammer.add(o),o.recognizeWith(this.hammer.recognizers)}},addEvent:function(t){var e=this;this.hammer.on(t,function(r){return e.$emit(t,r)})},updateEnabled:function(t,e){var r=this;if(t===!0)this.enableAll();else if(t===!1)this.disableAll();else if("object"==typeof t)for(var i=Object.keys(t),n=0;n<i.length;n++){var a=i[n];r.recognizers[a]&&(t[a]?r.enable(a):r.disable(a))}},enable:function(t){var e=this.recognizers[t];e.options.enable||e.set({enable:!0})},disable:function(t){var e=this.recognizers[t];e.options.enable&&e.set({enable:!1})},toggle:function(t){var e=this.recognizers[t];e&&(e.options.enable?this.disable(t):this.enable(t))},enableAll:function(t){this.toggleAll({enable:!0})},disableAll:function(t){this.toggleAll({enable:!1})},toggleAll:function(t){for(var e=this,r=t.enable,i=Object.keys(this.recognizers),n=0;n<i.length;n++){var a=e.recognizers[i[n]];a.options.enable!==r&&a.set({enable:r})}},isEnabled:function(t){return this.recognizers[t]&&this.recognizers[t].options.enable}},render:function(t){return t(this.tag,{},this.$slots.default)}},c=!1,_={config:o,customEvents:h};_.install=function(t,e){void 0===e&&(e={});var i=e.name||"v-touch";t.component(i,r(R,{name:i})),c=!0}.bind(_),_.registerCustomEvent=function(t,e){return void 0===e&&(e={}),c?void console.warn("\n      [vue-touch]: Custom Event '"+t+"' couldn't be added to vue-touch.\n      Custom Events have to be registered before installing the plugin.\n      "):(e.event=t,h[t]=e,void(R.props[t+"Options"]={type:Object,default:function(){return{}}}))}.bind(_),_.component=R,t.exports=_})},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}}]);